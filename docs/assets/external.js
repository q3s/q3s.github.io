function t(t){let e=t.length;for(;--e>=0;)t[e]=0}const e=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),r=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),n=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),i=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Array(576);t(o);const s=new Array(60);t(s);const a=new Array(512);t(a);const u=new Array(256);t(u);const l=new Array(29);t(l);const h=new Array(30);function c(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}let d,f,g;function w(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}t(h);const p=t=>t<256?a[t]:a[256+(t>>>7)],m=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},_=(t,e,r)=>{t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,m(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},A=(t,e,r)=>{_(t,r[2*e],r[2*e+1])},y=(t,e)=>{let r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1},E=(t,e,r)=>{const n=new Array(16);let i,o,s=0;for(i=1;i<=15;i++)n[i]=s=s+r[i-1]<<1;for(o=0;o<=e;o++){let e=t[2*o+1];0!==e&&(t[2*o]=y(n[e]++,e))}},C=t=>{let e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},I=t=>{t.bi_valid>8?m(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},b=(t,e,r,n)=>{const i=2*e,o=2*r;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]},S=(t,e,r)=>{const n=t.heap[r];let i=r<<1;for(;i<=t.heap_len&&(i<t.heap_len&&b(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!b(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n},v=(t,n,i)=>{let o,s,a,c,d=0;if(0!==t.last_lit)do{o=t.pending_buf[t.d_buf+2*d]<<8|t.pending_buf[t.d_buf+2*d+1],s=t.pending_buf[t.l_buf+d],d++,0===o?A(t,s,n):(a=u[s],A(t,a+256+1,n),c=e[a],0!==c&&(s-=l[a],_(t,s,c)),o--,a=p(o),A(t,a,i),c=r[a],0!==c&&(o-=h[a],_(t,o,c)))}while(d<t.last_lit);A(t,256,n)},T=(t,e)=>{const r=e.dyn_tree,n=e.stat_desc.static_tree,i=e.stat_desc.has_stree,o=e.stat_desc.elems;let s,a,u,l=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<o;s++)0!==r[2*s]?(t.heap[++t.heap_len]=l=s,t.depth[s]=0):r[2*s+1]=0;for(;t.heap_len<2;)u=t.heap[++t.heap_len]=l<2?++l:0,r[2*u]=1,t.depth[u]=0,t.opt_len--,i&&(t.static_len-=n[2*u+1]);for(e.max_code=l,s=t.heap_len>>1;s>=1;s--)S(t,r,s);u=o;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],S(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,r[2*u]=r[2*s]+r[2*a],t.depth[u]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,r[2*s+1]=r[2*a+1]=u,t.heap[1]=u++,S(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,e)=>{const r=e.dyn_tree,n=e.max_code,i=e.stat_desc.static_tree,o=e.stat_desc.has_stree,s=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,u=e.stat_desc.max_length;let l,h,c,d,f,g,w=0;for(d=0;d<=15;d++)t.bl_count[d]=0;for(r[2*t.heap[t.heap_max]+1]=0,l=t.heap_max+1;l<573;l++)h=t.heap[l],d=r[2*r[2*h+1]+1]+1,d>u&&(d=u,w++),r[2*h+1]=d,h>n||(t.bl_count[d]++,f=0,h>=a&&(f=s[h-a]),g=r[2*h],t.opt_len+=g*(d+f),o&&(t.static_len+=g*(i[2*h+1]+f)));if(0!==w){do{for(d=u-1;0===t.bl_count[d];)d--;t.bl_count[d]--,t.bl_count[d+1]+=2,t.bl_count[u]--,w-=2}while(w>0);for(d=u;0!==d;d--)for(h=t.bl_count[d];0!==h;)c=t.heap[--l],c>n||(r[2*c+1]!==d&&(t.opt_len+=(d-r[2*c+1])*r[2*c],r[2*c+1]=d),h--)}})(t,e),E(r,l,t.bl_count)},R=(t,e,r)=>{let n,i,o=-1,s=e[1],a=0,u=7,l=4;for(0===s&&(u=138,l=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=e[2*(n+1)+1],++a<u&&i===s||(a<l?t.bl_tree[2*i]+=a:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,o=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4))},N=(t,e,r)=>{let n,i,o=-1,s=e[1],a=0,u=7,l=4;for(0===s&&(u=138,l=3),n=0;n<=r;n++)if(i=s,s=e[2*(n+1)+1],!(++a<u&&i===s)){if(a<l)do{A(t,i,t.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(A(t,i,t.bl_tree),a--),A(t,16,t.bl_tree),_(t,a-3,2)):a<=10?(A(t,17,t.bl_tree),_(t,a-3,3)):(A(t,18,t.bl_tree),_(t,a-11,7));a=0,o=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4)}};let O=!1;const D=(t,e,r,n)=>{_(t,0+(n?1:0),3),((t,e,r,n)=>{I(t),n&&(m(t,r),m(t,~r)),t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r})(t,e,r,!0)};var M={_tr_init:t=>{O||((()=>{let t,i,w,p,m;const _=new Array(16);for(w=0,p=0;p<28;p++)for(l[p]=w,t=0;t<1<<e[p];t++)u[w++]=p;for(u[w-1]=p,m=0,p=0;p<16;p++)for(h[p]=m,t=0;t<1<<r[p];t++)a[m++]=p;for(m>>=7;p<30;p++)for(h[p]=m<<7,t=0;t<1<<r[p]-7;t++)a[256+m++]=p;for(i=0;i<=15;i++)_[i]=0;for(t=0;t<=143;)o[2*t+1]=8,t++,_[8]++;for(;t<=255;)o[2*t+1]=9,t++,_[9]++;for(;t<=279;)o[2*t+1]=7,t++,_[7]++;for(;t<=287;)o[2*t+1]=8,t++,_[8]++;for(E(o,287,_),t=0;t<30;t++)s[2*t+1]=5,s[2*t]=y(t,5);d=new c(o,e,257,286,15),f=new c(s,r,0,30,15),g=new c(new Array(0),n,0,19,7)})(),O=!0),t.l_desc=new w(t.dyn_ltree,d),t.d_desc=new w(t.dyn_dtree,f),t.bl_desc=new w(t.bl_tree,g),t.bi_buf=0,t.bi_valid=0,C(t)},_tr_stored_block:D,_tr_flush_block:(t,e,r,n)=>{let a,u,l=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),T(t,t.l_desc),T(t,t.d_desc),l=(t=>{let e;for(R(t,t.dyn_ltree,t.l_desc.max_code),R(t,t.dyn_dtree,t.d_desc.max_code),T(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*i[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e})(t),a=t.opt_len+3+7>>>3,u=t.static_len+3+7>>>3,u<=a&&(a=u)):a=u=r+5,r+4<=a&&-1!==e?D(t,e,r,n):4===t.strategy||u===a?(_(t,2+(n?1:0),3),v(t,o,s)):(_(t,4+(n?1:0),3),((t,e,r,n)=>{let o;for(_(t,e-257,5),_(t,r-1,5),_(t,n-4,4),o=0;o<n;o++)_(t,t.bl_tree[2*i[o]+1],3);N(t,t.dyn_ltree,e-1),N(t,t.dyn_dtree,r-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,l+1),v(t,t.dyn_ltree,t.dyn_dtree)),C(t),n&&I(t)},_tr_tally:(t,e,r)=>(t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(u[r]+256+1)]++,t.dyn_dtree[2*p(e)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{_(t,2,3),A(t,256,o),(t=>{16===t.bi_valid?(m(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}};var B=(t,e,r,n)=>{let i=65535&t|0,o=t>>>16&65535|0,s=0;for(;0!==r;){s=r>2e3?2e3:r,r-=s;do{i=i+e[n++]|0,o=o+i|0}while(--s);i%=65521,o%=65521}return i|o<<16|0};const P=new Uint32Array((()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e})());var k=(t,e,r,n)=>{const i=P,o=n+r;t^=-1;for(let r=n;r<o;r++)t=t>>>8^i[255&(t^e[r])];return-1^t},L={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},x={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:F,_tr_stored_block:U,_tr_flush_block:V,_tr_tally:H,_tr_align:z}=M,{Z_NO_FLUSH:G,Z_PARTIAL_FLUSH:X,Z_FULL_FLUSH:W,Z_FINISH:Y,Z_BLOCK:K,Z_OK:Z,Z_STREAM_END:j,Z_STREAM_ERROR:q,Z_DATA_ERROR:Q,Z_BUF_ERROR:J,Z_DEFAULT_COMPRESSION:$,Z_FILTERED:tt,Z_HUFFMAN_ONLY:et,Z_RLE:rt,Z_FIXED:nt,Z_DEFAULT_STRATEGY:it,Z_UNKNOWN:ot,Z_DEFLATED:st}=x,at=(t,e)=>(t.msg=L[e],e),ut=t=>(t<<1)-(t>4?9:0),lt=t=>{let e=t.length;for(;--e>=0;)t[e]=0};let ht=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask;const ct=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))},dt=(t,e)=>{V(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,ct(t.strm)},ft=(t,e)=>{t.pending_buf[t.pending++]=e},gt=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},wt=(t,e,r,n)=>{let i=t.avail_in;return i>n&&(i=n),0===i?0:(t.avail_in-=i,e.set(t.input.subarray(t.next_in,t.next_in+i),r),1===t.state.wrap?t.adler=B(t.adler,e,i,r):2===t.state.wrap&&(t.adler=k(t.adler,e,i,r)),t.next_in+=i,t.total_in+=i,i)},pt=(t,e)=>{let r,n,i=t.max_chain_length,o=t.strstart,s=t.prev_length,a=t.nice_match;const u=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,l=t.window,h=t.w_mask,c=t.prev,d=t.strstart+258;let f=l[o+s-1],g=l[o+s];t.prev_length>=t.good_match&&(i>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=e,l[r+s]===g&&l[r+s-1]===f&&l[r]===l[o]&&l[++r]===l[o+1]){o+=2,r++;do{}while(l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&o<d);if(n=258-(d-o),o=d-258,n>s){if(t.match_start=e,s=n,n>=a)break;f=l[o+s-1],g=l[o+s]}}}while((e=c[e&h])>u&&0!=--i);return s<=t.lookahead?s:t.lookahead},mt=t=>{const e=t.w_size;let r,n,i,o,s;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-262)){t.window.set(t.window.subarray(e,e+e),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,n=t.hash_size,r=n;do{i=t.head[--r],t.head[r]=i>=e?i-e:0}while(--n);n=e,r=n;do{i=t.prev[--r],t.prev[r]=i>=e?i-e:0}while(--n);o+=e}if(0===t.strm.avail_in)break;if(n=wt(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=ht(t,t.ins_h,t.window[s+1]);t.insert&&(t.ins_h=ht(t,t.ins_h,t.window[s+3-1]),t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)},_t=(t,e)=>{let r,n;for(;;){if(t.lookahead<262){if(mt(t),t.lookahead<262&&e===G)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=ht(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-262&&(t.match_length=pt(t,r)),t.match_length>=3)if(n=H(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=ht(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=ht(t,t.ins_h,t.window[t.strstart+1]);else n=H(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(dt(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,e===Y?(dt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(dt(t,!1),0===t.strm.avail_out)?1:2},At=(t,e)=>{let r,n,i;for(;;){if(t.lookahead<262){if(mt(t),t.lookahead<262&&e===G)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=ht(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-262&&(t.match_length=pt(t,r),t.match_length<=5&&(t.strategy===tt||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,n=H(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=ht(t,t.ins_h,t.window[t.strstart+3-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(dt(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(n=H(t,0,t.window[t.strstart-1]),n&&dt(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=H(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,e===Y?(dt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(dt(t,!1),0===t.strm.avail_out)?1:2};function yt(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}const Et=[new yt(0,0,0,0,((t,e)=>{let r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(mt(t),0===t.lookahead&&e===G)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,dt(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(dt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Y?(dt(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(dt(t,!1),t.strm.avail_out),1)})),new yt(4,4,8,4,_t),new yt(4,5,16,8,_t),new yt(4,6,32,32,_t),new yt(4,4,16,16,At),new yt(8,16,32,32,At),new yt(8,16,128,128,At),new yt(8,32,128,256,At),new yt(32,128,258,1024,At),new yt(32,258,258,4096,At)];function Ct(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=st,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),lt(this.dyn_ltree),lt(this.dyn_dtree),lt(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),lt(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),lt(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const It=t=>{if(!t||!t.state)return at(t,q);t.total_in=t.total_out=0,t.data_type=ot;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=G,F(e),Z},bt=t=>{const e=It(t);var r;return e===Z&&((r=t.state).window_size=2*r.w_size,lt(r.head),r.max_lazy_match=Et[r.level].max_lazy,r.good_match=Et[r.level].good_length,r.nice_match=Et[r.level].nice_length,r.max_chain_length=Et[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=2,r.match_available=0,r.ins_h=0),e},St=(t,e,r,n,i,o)=>{if(!t)return q;let s=1;if(e===$&&(e=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>9||r!==st||n<8||n>15||e<0||e>9||o<0||o>nt)return at(t,q);8===n&&(n=9);const a=new Ct;return t.state=a,a.strm=t,a.wrap=s,a.gzhead=null,a.w_bits=n,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=3*a.lit_bufsize,a.level=e,a.strategy=o,a.method=r,bt(t)};var vt={deflateInit:(t,e)=>St(t,e,st,15,8,it),deflateInit2:St,deflateReset:bt,deflateResetKeep:It,deflateSetHeader:(t,e)=>t&&t.state?2!==t.state.wrap?q:(t.state.gzhead=e,Z):q,deflate:(t,e)=>{let r,n;if(!t||!t.state||e>K||e<0)return t?at(t,q):q;const i=t.state;if(!t.output||!t.input&&0!==t.avail_in||666===i.status&&e!==Y)return at(t,0===t.avail_out?J:q);i.strm=t;const o=i.last_flush;if(i.last_flush=e,42===i.status)if(2===i.wrap)t.adler=0,ft(i,31),ft(i,139),ft(i,8),i.gzhead?(ft(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),ft(i,255&i.gzhead.time),ft(i,i.gzhead.time>>8&255),ft(i,i.gzhead.time>>16&255),ft(i,i.gzhead.time>>24&255),ft(i,9===i.level?2:i.strategy>=et||i.level<2?4:0),ft(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(ft(i,255&i.gzhead.extra.length),ft(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(t.adler=k(t.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69):(ft(i,0),ft(i,0),ft(i,0),ft(i,0),ft(i,0),ft(i,9===i.level?2:i.strategy>=et||i.level<2?4:0),ft(i,3),i.status=113);else{let e=st+(i.w_bits-8<<4)<<8,r=-1;r=i.strategy>=et||i.level<2?0:i.level<6?1:6===i.level?2:3,e|=r<<6,0!==i.strstart&&(e|=32),e+=31-e%31,i.status=113,gt(i,e),0!==i.strstart&&(gt(i,t.adler>>>16),gt(i,65535&t.adler)),t.adler=1}if(69===i.status)if(i.gzhead.extra){for(r=i.pending;i.gzindex<(65535&i.gzhead.extra.length)&&(i.pending!==i.pending_buf_size||(i.gzhead.hcrc&&i.pending>r&&(t.adler=k(t.adler,i.pending_buf,i.pending-r,r)),ct(t),r=i.pending,i.pending!==i.pending_buf_size));)ft(i,255&i.gzhead.extra[i.gzindex]),i.gzindex++;i.gzhead.hcrc&&i.pending>r&&(t.adler=k(t.adler,i.pending_buf,i.pending-r,r)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=73)}else i.status=73;if(73===i.status)if(i.gzhead.name){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=k(t.adler,i.pending_buf,i.pending-r,r)),ct(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}n=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,ft(i,n)}while(0!==n);i.gzhead.hcrc&&i.pending>r&&(t.adler=k(t.adler,i.pending_buf,i.pending-r,r)),0===n&&(i.gzindex=0,i.status=91)}else i.status=91;if(91===i.status)if(i.gzhead.comment){r=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>r&&(t.adler=k(t.adler,i.pending_buf,i.pending-r,r)),ct(t),r=i.pending,i.pending===i.pending_buf_size)){n=1;break}n=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,ft(i,n)}while(0!==n);i.gzhead.hcrc&&i.pending>r&&(t.adler=k(t.adler,i.pending_buf,i.pending-r,r)),0===n&&(i.status=103)}else i.status=103;if(103===i.status&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&ct(t),i.pending+2<=i.pending_buf_size&&(ft(i,255&t.adler),ft(i,t.adler>>8&255),t.adler=0,i.status=113)):i.status=113),0!==i.pending){if(ct(t),0===t.avail_out)return i.last_flush=-1,Z}else if(0===t.avail_in&&ut(e)<=ut(o)&&e!==Y)return at(t,J);if(666===i.status&&0!==t.avail_in)return at(t,J);if(0!==t.avail_in||0!==i.lookahead||e!==G&&666!==i.status){let r=i.strategy===et?((t,e)=>{let r;for(;;){if(0===t.lookahead&&(mt(t),0===t.lookahead)){if(e===G)return 1;break}if(t.match_length=0,r=H(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(dt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Y?(dt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(dt(t,!1),0===t.strm.avail_out)?1:2})(i,e):i.strategy===rt?((t,e)=>{let r,n,i,o;const s=t.window;for(;;){if(t.lookahead<=258){if(mt(t),t.lookahead<=258&&e===G)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(i=t.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){o=t.strstart+258;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);t.match_length=258-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(r=H(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=H(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(dt(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,e===Y?(dt(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(dt(t,!1),0===t.strm.avail_out)?1:2})(i,e):Et[i.level].func(i,e);if(3!==r&&4!==r||(i.status=666),1===r||3===r)return 0===t.avail_out&&(i.last_flush=-1),Z;if(2===r&&(e===X?z(i):e!==K&&(U(i,0,0,!1),e===W&&(lt(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),ct(t),0===t.avail_out))return i.last_flush=-1,Z}return e!==Y?Z:i.wrap<=0?j:(2===i.wrap?(ft(i,255&t.adler),ft(i,t.adler>>8&255),ft(i,t.adler>>16&255),ft(i,t.adler>>24&255),ft(i,255&t.total_in),ft(i,t.total_in>>8&255),ft(i,t.total_in>>16&255),ft(i,t.total_in>>24&255)):(gt(i,t.adler>>>16),gt(i,65535&t.adler)),ct(t),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?Z:j)},deflateEnd:t=>{if(!t||!t.state)return q;const e=t.state.status;return 42!==e&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?at(t,q):(t.state=null,113===e?at(t,Q):Z)},deflateSetDictionary:(t,e)=>{let r=e.length;if(!t||!t.state)return q;const n=t.state,i=n.wrap;if(2===i||1===i&&42!==n.status||n.lookahead)return q;if(1===i&&(t.adler=B(t.adler,e,r,0)),n.wrap=0,r>=n.w_size){0===i&&(lt(n.head),n.strstart=0,n.block_start=0,n.insert=0);let t=new Uint8Array(n.w_size);t.set(e.subarray(r-n.w_size,r),0),e=t,r=n.w_size}const o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=r,t.next_in=0,t.input=e,mt(n);n.lookahead>=3;){let t=n.strstart,e=n.lookahead-2;do{n.ins_h=ht(n,n.ins_h,n.window[t+3-1]),n.prev[t&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=t,t++}while(--e);n.strstart=t,n.lookahead=2,mt(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,n.wrap=i,Z},deflateInfo:"pako deflate (from Nodeca project)"};const Tt=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var Rt=function(t){const e=Array.prototype.slice.call(arguments,1);for(;e.length;){const r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(const e in r)Tt(r,e)&&(t[e]=r[e])}}return t},Nt=t=>{let e=0;for(let r=0,n=t.length;r<n;r++)e+=t[r].length;const r=new Uint8Array(e);for(let e=0,n=0,i=t.length;e<i;e++){let i=t[e];r.set(i,n),n+=i.length}return r};let Ot=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){Ot=!1}const Dt=new Uint8Array(256);for(let t=0;t<256;t++)Dt[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Dt[254]=Dt[254]=1;var Mt=t=>{let e,r,n,i,o,s=t.length,a=0;for(i=0;i<s;i++)r=t.charCodeAt(i),55296==(64512&r)&&i+1<s&&(n=t.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(a),o=0,i=0;o<a;i++)r=t.charCodeAt(i),55296==(64512&r)&&i+1<s&&(n=t.charCodeAt(i+1),56320==(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?e[o++]=r:r<2048?(e[o++]=192|r>>>6,e[o++]=128|63&r):r<65536?(e[o++]=224|r>>>12,e[o++]=128|r>>>6&63,e[o++]=128|63&r):(e[o++]=240|r>>>18,e[o++]=128|r>>>12&63,e[o++]=128|r>>>6&63,e[o++]=128|63&r);return e},Bt=(t,e)=>{let r,n;const i=e||t.length,o=new Array(2*i);for(n=0,r=0;r<i;){let e=t[r++];if(e<128){o[n++]=e;continue}let s=Dt[e];if(s>4)o[n++]=65533,r+=s-1;else{for(e&=2===s?31:3===s?15:7;s>1&&r<i;)e=e<<6|63&t[r++],s--;s>1?o[n++]=65533:e<65536?o[n++]=e:(e-=65536,o[n++]=55296|e>>10&1023,o[n++]=56320|1023&e)}}return((t,e)=>{if(e<65534&&t.subarray&&Ot)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let n=0;n<e;n++)r+=String.fromCharCode(t[n]);return r})(o,n)},Pt=(t,e)=>{(e=e||t.length)>t.length&&(e=t.length);let r=e-1;for(;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+Dt[t[r]]>e?r:e};var kt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const Lt=Object.prototype.toString,{Z_NO_FLUSH:xt,Z_SYNC_FLUSH:Ft,Z_FULL_FLUSH:Ut,Z_FINISH:Vt,Z_OK:Ht,Z_STREAM_END:zt,Z_DEFAULT_COMPRESSION:Gt,Z_DEFAULT_STRATEGY:Xt,Z_DEFLATED:Wt}=x;function Yt(t){this.options=Rt({level:Gt,method:Wt,chunkSize:16384,windowBits:15,memLevel:8,strategy:Xt},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kt,this.strm.avail_out=0;let r=vt.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==Ht)throw new Error(L[r]);if(e.header&&vt.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"==typeof e.dictionary?Mt(e.dictionary):"[object ArrayBuffer]"===Lt.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,r=vt.deflateSetDictionary(this.strm,t),r!==Ht)throw new Error(L[r]);this._dict_set=!0}}function Kt(t,e){const r=new Yt(e);if(r.push(t,!0),r.err)throw r.msg||L[r.err];return r.result}Yt.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize;let i,o;if(this.ended)return!1;for(o=e===~~e?e:!0===e?Vt:xt,"string"==typeof t?r.input=Mt(t):"[object ArrayBuffer]"===Lt.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(o===Ft||o===Ut)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(i=vt.deflate(r,o),i===zt)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=vt.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Ht;if(0!==r.avail_out){if(o>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},Yt.prototype.onData=function(t){this.chunks.push(t)},Yt.prototype.onEnd=function(t){t===Ht&&(this.result=Nt(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Zt={Deflate:Yt,deflate:Kt,deflateRaw:function(t,e){return(e=e||{}).raw=!0,Kt(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,Kt(t,e)},constants:x};var jt=function(t,e){let r,n,i,o,s,a,u,l,h,c,d,f,g,w,p,m,_,A,y,E,C,I,b,S;const v=t.state;r=t.next_in,b=t.input,n=r+(t.avail_in-5),i=t.next_out,S=t.output,o=i-(e-t.avail_out),s=i+(t.avail_out-257),a=v.dmax,u=v.wsize,l=v.whave,h=v.wnext,c=v.window,d=v.hold,f=v.bits,g=v.lencode,w=v.distcode,p=(1<<v.lenbits)-1,m=(1<<v.distbits)-1;t:do{f<15&&(d+=b[r++]<<f,f+=8,d+=b[r++]<<f,f+=8),_=g[d&p];e:for(;;){if(A=_>>>24,d>>>=A,f-=A,A=_>>>16&255,0===A)S[i++]=65535&_;else{if(!(16&A)){if(0==(64&A)){_=g[(65535&_)+(d&(1<<A)-1)];continue e}if(32&A){v.mode=12;break t}t.msg="invalid literal/length code",v.mode=30;break t}y=65535&_,A&=15,A&&(f<A&&(d+=b[r++]<<f,f+=8),y+=d&(1<<A)-1,d>>>=A,f-=A),f<15&&(d+=b[r++]<<f,f+=8,d+=b[r++]<<f,f+=8),_=w[d&m];r:for(;;){if(A=_>>>24,d>>>=A,f-=A,A=_>>>16&255,!(16&A)){if(0==(64&A)){_=w[(65535&_)+(d&(1<<A)-1)];continue r}t.msg="invalid distance code",v.mode=30;break t}if(E=65535&_,A&=15,f<A&&(d+=b[r++]<<f,f+=8,f<A&&(d+=b[r++]<<f,f+=8)),E+=d&(1<<A)-1,E>a){t.msg="invalid distance too far back",v.mode=30;break t}if(d>>>=A,f-=A,A=i-o,E>A){if(A=E-A,A>l&&v.sane){t.msg="invalid distance too far back",v.mode=30;break t}if(C=0,I=c,0===h){if(C+=u-A,A<y){y-=A;do{S[i++]=c[C++]}while(--A);C=i-E,I=S}}else if(h<A){if(C+=u+h-A,A-=h,A<y){y-=A;do{S[i++]=c[C++]}while(--A);if(C=0,h<y){A=h,y-=A;do{S[i++]=c[C++]}while(--A);C=i-E,I=S}}}else if(C+=h-A,A<y){y-=A;do{S[i++]=c[C++]}while(--A);C=i-E,I=S}for(;y>2;)S[i++]=I[C++],S[i++]=I[C++],S[i++]=I[C++],y-=3;y&&(S[i++]=I[C++],y>1&&(S[i++]=I[C++]))}else{C=i-E;do{S[i++]=S[C++],S[i++]=S[C++],S[i++]=S[C++],y-=3}while(y>2);y&&(S[i++]=S[C++],y>1&&(S[i++]=S[C++]))}break}}break}}while(r<n&&i<s);y=f>>3,r-=y,f-=y<<3,d&=(1<<f)-1,t.next_in=r,t.next_out=i,t.avail_in=r<n?n-r+5:5-(r-n),t.avail_out=i<s?s-i+257:257-(i-s),v.hold=d,v.bits=f};const qt=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Qt=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Jt=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),$t=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var te=(t,e,r,n,i,o,s,a)=>{const u=a.bits;let l,h,c,d,f,g,w=0,p=0,m=0,_=0,A=0,y=0,E=0,C=0,I=0,b=0,S=null,v=0;const T=new Uint16Array(16),R=new Uint16Array(16);let N,O,D,M=null,B=0;for(w=0;w<=15;w++)T[w]=0;for(p=0;p<n;p++)T[e[r+p]]++;for(A=u,_=15;_>=1&&0===T[_];_--);if(A>_&&(A=_),0===_)return i[o++]=20971520,i[o++]=20971520,a.bits=1,0;for(m=1;m<_&&0===T[m];m++);for(A<m&&(A=m),C=1,w=1;w<=15;w++)if(C<<=1,C-=T[w],C<0)return-1;if(C>0&&(0===t||1!==_))return-1;for(R[1]=0,w=1;w<15;w++)R[w+1]=R[w]+T[w];for(p=0;p<n;p++)0!==e[r+p]&&(s[R[e[r+p]]++]=p);if(0===t?(S=M=s,g=19):1===t?(S=qt,v-=257,M=Qt,B-=257,g=256):(S=Jt,M=$t,g=-1),b=0,p=0,w=m,f=o,y=A,E=0,c=-1,I=1<<A,d=I-1,1===t&&I>852||2===t&&I>592)return 1;for(;;){N=w-E,s[p]<g?(O=0,D=s[p]):s[p]>g?(O=M[B+s[p]],D=S[v+s[p]]):(O=96,D=0),l=1<<w-E,h=1<<y,m=h;do{h-=l,i[f+(b>>E)+h]=N<<24|O<<16|D|0}while(0!==h);for(l=1<<w-1;b&l;)l>>=1;if(0!==l?(b&=l-1,b+=l):b=0,p++,0==--T[w]){if(w===_)break;w=e[r+s[p]]}if(w>A&&(b&d)!==c){for(0===E&&(E=A),f+=m,y=w-E,C=1<<y;y+E<_&&(C-=T[y+E],!(C<=0));)y++,C<<=1;if(I+=1<<y,1===t&&I>852||2===t&&I>592)return 1;c=b&d,i[c]=A<<24|y<<16|f-o|0}}return 0!==b&&(i[f+b]=w-E<<24|64<<16|0),a.bits=A,0};const{Z_FINISH:ee,Z_BLOCK:re,Z_TREES:ne,Z_OK:ie,Z_STREAM_END:oe,Z_NEED_DICT:se,Z_STREAM_ERROR:ae,Z_DATA_ERROR:ue,Z_MEM_ERROR:le,Z_BUF_ERROR:he,Z_DEFLATED:ce}=x,de=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function fe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ge=t=>{if(!t||!t.state)return ae;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array(852),e.distcode=e.distdyn=new Int32Array(592),e.sane=1,e.back=-1,ie},we=t=>{if(!t||!t.state)return ae;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,ge(t)},pe=(t,e)=>{let r;if(!t||!t.state)return ae;const n=t.state;return e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?ae:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,we(t))},me=(t,e)=>{if(!t)return ae;const r=new fe;t.state=r,r.window=null;const n=pe(t,e);return n!==ie&&(t.state=null),n};let _e,Ae,ye=!0;const Ee=t=>{if(ye){_e=new Int32Array(512),Ae=new Int32Array(32);let e=0;for(;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(te(1,t.lens,0,288,_e,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;te(2,t.lens,0,32,Ae,0,t.work,{bits:5}),ye=!1}t.lencode=_e,t.lenbits=9,t.distcode=Ae,t.distbits=5},Ce=(t,e,r,n)=>{let i;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),n>=o.wsize?(o.window.set(e.subarray(r-o.wsize,r),0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),o.window.set(e.subarray(r-n,r-n+i),o.wnext),(n-=i)?(o.window.set(e.subarray(r-n,r),0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0};var Ie={inflateReset:we,inflateReset2:pe,inflateResetKeep:ge,inflateInit:t=>me(t,15),inflateInit2:me,inflate:(t,e)=>{let r,n,i,o,s,a,u,l,h,c,d,f,g,w,p,m,_,A,y,E,C,I,b=0;const S=new Uint8Array(4);let v,T;const R=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return ae;r=t.state,12===r.mode&&(r.mode=13),s=t.next_out,i=t.output,u=t.avail_out,o=t.next_in,n=t.input,a=t.avail_in,l=r.hold,h=r.bits,c=a,d=u,I=ie;t:for(;;)switch(r.mode){case 1:if(0===r.wrap){r.mode=13;break}for(;h<16;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(2&r.wrap&&35615===l){r.check=0,S[0]=255&l,S[1]=l>>>8&255,r.check=k(r.check,S,2,0),l=0,h=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&l)<<8)+(l>>8))%31){t.msg="incorrect header check",r.mode=30;break}if((15&l)!==ce){t.msg="unknown compression method",r.mode=30;break}if(l>>>=4,h-=4,C=8+(15&l),0===r.wbits)r.wbits=C;else if(C>r.wbits){t.msg="invalid window size",r.mode=30;break}r.dmax=1<<r.wbits,t.adler=r.check=1,r.mode=512&l?10:12,l=0,h=0;break;case 2:for(;h<16;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(r.flags=l,(255&r.flags)!==ce){t.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=l>>8&1),512&r.flags&&(S[0]=255&l,S[1]=l>>>8&255,r.check=k(r.check,S,2,0)),l=0,h=0,r.mode=3;case 3:for(;h<32;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}r.head&&(r.head.time=l),512&r.flags&&(S[0]=255&l,S[1]=l>>>8&255,S[2]=l>>>16&255,S[3]=l>>>24&255,r.check=k(r.check,S,4,0)),l=0,h=0,r.mode=4;case 4:for(;h<16;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}r.head&&(r.head.xflags=255&l,r.head.os=l>>8),512&r.flags&&(S[0]=255&l,S[1]=l>>>8&255,r.check=k(r.check,S,2,0)),l=0,h=0,r.mode=5;case 5:if(1024&r.flags){for(;h<16;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}r.length=l,r.head&&(r.head.extra_len=l),512&r.flags&&(S[0]=255&l,S[1]=l>>>8&255,r.check=k(r.check,S,2,0)),l=0,h=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(f=r.length,f>a&&(f=a),f&&(r.head&&(C=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(o,o+f),C)),512&r.flags&&(r.check=k(r.check,n,f,o)),a-=f,o+=f,r.length-=f),r.length))break t;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===a)break t;f=0;do{C=n[o+f++],r.head&&C&&r.length<65536&&(r.head.name+=String.fromCharCode(C))}while(C&&f<a);if(512&r.flags&&(r.check=k(r.check,n,f,o)),a-=f,o+=f,C)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===a)break t;f=0;do{C=n[o+f++],r.head&&C&&r.length<65536&&(r.head.comment+=String.fromCharCode(C))}while(C&&f<a);if(512&r.flags&&(r.check=k(r.check,n,f,o)),a-=f,o+=f,C)break t}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;h<16;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(l!==(65535&r.check)){t.msg="header crc mismatch",r.mode=30;break}l=0,h=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=12;break;case 10:for(;h<32;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}t.adler=r.check=de(l),l=0,h=0,r.mode=11;case 11:if(0===r.havedict)return t.next_out=s,t.avail_out=u,t.next_in=o,t.avail_in=a,r.hold=l,r.bits=h,se;t.adler=r.check=1,r.mode=12;case 12:if(e===re||e===ne)break t;case 13:if(r.last){l>>>=7&h,h-=7&h,r.mode=27;break}for(;h<3;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}switch(r.last=1&l,l>>>=1,h-=1,3&l){case 0:r.mode=14;break;case 1:if(Ee(r),r.mode=20,e===ne){l>>>=2,h-=2;break t}break;case 2:r.mode=17;break;case 3:t.msg="invalid block type",r.mode=30}l>>>=2,h-=2;break;case 14:for(l>>>=7&h,h-=7&h;h<32;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if((65535&l)!=(l>>>16^65535)){t.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&l,l=0,h=0,r.mode=15,e===ne)break t;case 15:r.mode=16;case 16:if(f=r.length,f){if(f>a&&(f=a),f>u&&(f=u),0===f)break t;i.set(n.subarray(o,o+f),s),a-=f,o+=f,u-=f,s+=f,r.length-=f;break}r.mode=12;break;case 17:for(;h<14;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(r.nlen=257+(31&l),l>>>=5,h-=5,r.ndist=1+(31&l),l>>>=5,h-=5,r.ncode=4+(15&l),l>>>=4,h-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;h<3;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}r.lens[R[r.have++]]=7&l,l>>>=3,h-=3}for(;r.have<19;)r.lens[R[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,v={bits:r.lenbits},I=te(0,r.lens,0,19,r.lencode,0,r.work,v),r.lenbits=v.bits,I){t.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;b=r.lencode[l&(1<<r.lenbits)-1],p=b>>>24,m=b>>>16&255,_=65535&b,!(p<=h);){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(_<16)l>>>=p,h-=p,r.lens[r.have++]=_;else{if(16===_){for(T=p+2;h<T;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(l>>>=p,h-=p,0===r.have){t.msg="invalid bit length repeat",r.mode=30;break}C=r.lens[r.have-1],f=3+(3&l),l>>>=2,h-=2}else if(17===_){for(T=p+3;h<T;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}l>>>=p,h-=p,C=0,f=3+(7&l),l>>>=3,h-=3}else{for(T=p+7;h<T;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}l>>>=p,h-=p,C=0,f=11+(127&l),l>>>=7,h-=7}if(r.have+f>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=30;break}for(;f--;)r.lens[r.have++]=C}}if(30===r.mode)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,v={bits:r.lenbits},I=te(1,r.lens,0,r.nlen,r.lencode,0,r.work,v),r.lenbits=v.bits,I){t.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,v={bits:r.distbits},I=te(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,v),r.distbits=v.bits,I){t.msg="invalid distances set",r.mode=30;break}if(r.mode=20,e===ne)break t;case 20:r.mode=21;case 21:if(a>=6&&u>=258){t.next_out=s,t.avail_out=u,t.next_in=o,t.avail_in=a,r.hold=l,r.bits=h,jt(t,d),s=t.next_out,i=t.output,u=t.avail_out,o=t.next_in,n=t.input,a=t.avail_in,l=r.hold,h=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;b=r.lencode[l&(1<<r.lenbits)-1],p=b>>>24,m=b>>>16&255,_=65535&b,!(p<=h);){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(m&&0==(240&m)){for(A=p,y=m,E=_;b=r.lencode[E+((l&(1<<A+y)-1)>>A)],p=b>>>24,m=b>>>16&255,_=65535&b,!(A+p<=h);){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}l>>>=A,h-=A,r.back+=A}if(l>>>=p,h-=p,r.back+=p,r.length=_,0===m){r.mode=26;break}if(32&m){r.back=-1,r.mode=12;break}if(64&m){t.msg="invalid literal/length code",r.mode=30;break}r.extra=15&m,r.mode=22;case 22:if(r.extra){for(T=r.extra;h<T;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}r.length+=l&(1<<r.extra)-1,l>>>=r.extra,h-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;b=r.distcode[l&(1<<r.distbits)-1],p=b>>>24,m=b>>>16&255,_=65535&b,!(p<=h);){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(0==(240&m)){for(A=p,y=m,E=_;b=r.distcode[E+((l&(1<<A+y)-1)>>A)],p=b>>>24,m=b>>>16&255,_=65535&b,!(A+p<=h);){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}l>>>=A,h-=A,r.back+=A}if(l>>>=p,h-=p,r.back+=p,64&m){t.msg="invalid distance code",r.mode=30;break}r.offset=_,r.extra=15&m,r.mode=24;case 24:if(r.extra){for(T=r.extra;h<T;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}r.offset+=l&(1<<r.extra)-1,l>>>=r.extra,h-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===u)break t;if(f=d-u,r.offset>f){if(f=r.offset-f,f>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=30;break}f>r.wnext?(f-=r.wnext,g=r.wsize-f):g=r.wnext-f,f>r.length&&(f=r.length),w=r.window}else w=i,g=s-r.offset,f=r.length;f>u&&(f=u),u-=f,r.length-=f;do{i[s++]=w[g++]}while(--f);0===r.length&&(r.mode=21);break;case 26:if(0===u)break t;i[s++]=r.length,u--,r.mode=21;break;case 27:if(r.wrap){for(;h<32;){if(0===a)break t;a--,l|=n[o++]<<h,h+=8}if(d-=u,t.total_out+=d,r.total+=d,d&&(t.adler=r.check=r.flags?k(r.check,i,d,s-d):B(r.check,i,d,s-d)),d=u,(r.flags?l:de(l))!==r.check){t.msg="incorrect data check",r.mode=30;break}l=0,h=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;h<32;){if(0===a)break t;a--,l+=n[o++]<<h,h+=8}if(l!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=30;break}l=0,h=0}r.mode=29;case 29:I=oe;break t;case 30:I=ue;break t;case 31:return le;case 32:default:return ae}return t.next_out=s,t.avail_out=u,t.next_in=o,t.avail_in=a,r.hold=l,r.bits=h,(r.wsize||d!==t.avail_out&&r.mode<30&&(r.mode<27||e!==ee))&&Ce(t,t.output,t.next_out,d-t.avail_out),c-=t.avail_in,d-=t.avail_out,t.total_in+=c,t.total_out+=d,r.total+=d,r.wrap&&d&&(t.adler=r.check=r.flags?k(r.check,i,d,t.next_out-d):B(r.check,i,d,t.next_out-d)),t.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0===c&&0===d||e===ee)&&I===ie&&(I=he),I},inflateEnd:t=>{if(!t||!t.state)return ae;let e=t.state;return e.window&&(e.window=null),t.state=null,ie},inflateGetHeader:(t,e)=>{if(!t||!t.state)return ae;const r=t.state;return 0==(2&r.wrap)?ae:(r.head=e,e.done=!1,ie)},inflateSetDictionary:(t,e)=>{const r=e.length;let n,i,o;return t&&t.state?(n=t.state,0!==n.wrap&&11!==n.mode?ae:11===n.mode&&(i=1,i=B(i,e,r,0),i!==n.check)?ue:(o=Ce(t,e,r,r),o?(n.mode=31,le):(n.havedict=1,ie))):ae},inflateInfo:"pako inflate (from Nodeca project)"};var be=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const Se=Object.prototype.toString,{Z_NO_FLUSH:ve,Z_FINISH:Te,Z_OK:Re,Z_STREAM_END:Ne,Z_NEED_DICT:Oe,Z_STREAM_ERROR:De,Z_DATA_ERROR:Me,Z_MEM_ERROR:Be}=x;function Pe(t){this.options=Rt({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kt,this.strm.avail_out=0;let r=Ie.inflateInit2(this.strm,e.windowBits);if(r!==Re)throw new Error(L[r]);if(this.header=new be,Ie.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=Mt(e.dictionary):"[object ArrayBuffer]"===Se.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=Ie.inflateSetDictionary(this.strm,e.dictionary),r!==Re)))throw new Error(L[r])}function ke(t,e){const r=new Pe(e);if(r.push(t),r.err)throw r.msg||L[r.err];return r.result}Pe.prototype.push=function(t,e){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=e===~~e?e:!0===e?Te:ve,"[object ArrayBuffer]"===Se.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),o=Ie.inflate(r,s),o===Oe&&i&&(o=Ie.inflateSetDictionary(r,i),o===Re?o=Ie.inflate(r,s):o===Me&&(o=Oe));r.avail_in>0&&o===Ne&&r.state.wrap>0&&0!==t[r.next_in];)Ie.inflateReset(r),o=Ie.inflate(r,s);switch(o){case De:case Me:case Oe:case Be:return this.onEnd(o),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(0===r.avail_out||o===Ne))if("string"===this.options.to){let t=Pt(r.output,r.next_out),e=r.next_out-t,i=Bt(r.output,t);r.next_out=e,r.avail_out=n-e,e&&r.output.set(r.output.subarray(t,t+e),0),this.onData(i)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(o!==Re||0!==a){if(o===Ne)return o=Ie.inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},Pe.prototype.onData=function(t){this.chunks.push(t)},Pe.prototype.onEnd=function(t){t===Re&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=Nt(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Le={Inflate:Pe,inflate:ke,inflateRaw:function(t,e){return(e=e||{}).raw=!0,ke(t,e)},ungzip:ke,constants:x};const{Deflate:xe,deflate:Fe,deflateRaw:Ue,gzip:Ve}=Zt,{Inflate:He,inflate:ze,inflateRaw:Ge,ungzip:Xe}=Le;var We={Deflate:xe,deflate:Fe,deflateRaw:Ue,gzip:Ve,Inflate:He,inflate:ze,inflateRaw:Ge,ungzip:Xe,constants:x},Ye=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},Ke={}.toString,Ze=Array.isArray||function(t){return"[object Array]"==Ke.call(t)};qe.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}();var je=qe.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function qe(t,e,r){return qe.TYPED_ARRAY_SUPPORT||this instanceof qe?"number"==typeof t?$e(this,t):function(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return function(t,e,r,n){if(r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");var i;i=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);qe.TYPED_ARRAY_SUPPORT?i.__proto__=qe.prototype:i=tr(t,i);return i}(t,e,r,n);if("string"==typeof e)return function(t,e){var r=0|rr(e),n=Je(t,r),i=n.write(e);i!==r&&(n=n.slice(0,i));return n}(t,e);return function(t,e){if(qe.isBuffer(e)){var r=0|Qe(e.length),n=Je(t,r);return 0===n.length||e.copy(n,0,0,r),n}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?Je(t,0):tr(t,e);if("Buffer"===e.type&&Array.isArray(e.data))return tr(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}(this,t,e,r):new qe(t,e,r)}function Qe(t){if(t>=je)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+je.toString(16)+" bytes");return 0|t}function Je(t,e){var r;return qe.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(e)).__proto__=qe.prototype:(null===(r=t)&&(r=new qe(e)),r.length=e),r}function $e(t,e){var r=Je(t,e<0?0:0|Qe(e));if(!qe.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)r[n]=0;return r}function tr(t,e){for(var r=e.length<0?0:0|Qe(e.length),n=Je(t,r),i=0;i<r;i+=1)n[i]=255&e[i];return n}function er(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function rr(t){return qe.isBuffer(t)?t.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)?t.byteLength:("string"!=typeof t&&(t=""+t),0===t.length?0:er(t).length)}qe.TYPED_ARRAY_SUPPORT&&(qe.prototype.__proto__=Uint8Array.prototype,qe.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&qe[Symbol.species]===qe&&Object.defineProperty(qe,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),qe.prototype.write=function(t,e,r){void 0===e||void 0===r&&"string"==typeof e?(r=this.length,e=0):isFinite(e)&&(e|=0,isFinite(r)?r|=0:r=void 0);var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return function(t,e,r,n){return function(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}(er(e,t.length-r),t,r,n)}(this,t,e,r)},qe.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),qe.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=qe.prototype;else{var i=e-t;r=new qe(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},qe.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(o<1e3||!qe.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},qe.prototype.fill=function(t,e,r){if("string"==typeof t){if("string"==typeof e?(e=0,r=this.length):"string"==typeof r&&(r=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var o=qe.isBuffer(t)?t:new qe(t),s=o.length;for(i=0;i<r-e;++i)this[i+e]=o[i%s]}return this},qe.concat=function(t,e){if(!Ze(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Je(null,0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=$e(null,e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(!qe.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},qe.byteLength=rr,qe.prototype._isBuffer=!0,qe.isBuffer=function(t){return!(null==t||!t._isBuffer)};var nr,ir=function(t){var e=new qe(t);return e.fill(0),e},or=function(t){return new qe(t)},sr=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],ar=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},ur=function(t){return sr[t]},lr=function(t){for(var e=0;0!==t;)e++,t>>>=1;return e},hr=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');nr=t},cr=function(){return void 0!==nr},dr=function(t){return nr(t)},fr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function gr(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var wr=gr((function(t,e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return r}}}));function pr(){this.buffer=[],this.length=0}pr.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var mr=pr;function _r(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=ir(t*t),this.reservedBit=ir(t*t)}_r.prototype.set=function(t,e,r,n){var i=t*this.size+e;this.data[i]=r,n&&(this.reservedBit[i]=!0)},_r.prototype.get=function(t,e){return this.data[t*this.size+e]},_r.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r},_r.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var Ar=_r,yr=gr((function(t,e){var r=ar;e.getRowColCoords=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,n=r(t),i=145===n?26:2*Math.ceil((n-13)/(2*e-2)),o=[n-7],s=1;s<e-1;s++)o[s]=o[s-1]-i;return o.push(6),o.reverse()},e.getPositions=function(t){for(var r=[],n=e.getRowColCoords(t),i=n.length,o=0;o<i;o++)for(var s=0;s<i;s++)0===o&&0===s||0===o&&s===i-1||o===i-1&&0===s||r.push([n[o],n[s]]);return r}})),Er=ar,Cr=function(t){var e=Er(t);return[[0,0],[e-7,0],[0,e-7]]},Ir=gr((function(t,e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var r=3,n=3,i=40,o=10;function s(t,r,n){switch(t){case e.Patterns.PATTERN000:return(r+n)%2==0;case e.Patterns.PATTERN001:return r%2==0;case e.Patterns.PATTERN010:return n%3==0;case e.Patterns.PATTERN011:return(r+n)%3==0;case e.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case e.Patterns.PATTERN101:return r*n%2+r*n%3==0;case e.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case e.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){for(var e=t.size,n=0,i=0,o=0,s=null,a=null,u=0;u<e;u++){i=o=0,s=a=null;for(var l=0;l<e;l++){var h=t.get(u,l);h===s?i++:(i>=5&&(n+=r+(i-5)),s=h,i=1),(h=t.get(l,u))===a?o++:(o>=5&&(n+=r+(o-5)),a=h,o=1)}i>=5&&(n+=r+(i-5)),o>=5&&(n+=r+(o-5))}return n},e.getPenaltyN2=function(t){for(var e=t.size,r=0,i=0;i<e-1;i++)for(var o=0;o<e-1;o++){var s=t.get(i,o)+t.get(i,o+1)+t.get(i+1,o)+t.get(i+1,o+1);4!==s&&0!==s||r++}return r*n},e.getPenaltyN3=function(t){for(var e=t.size,r=0,n=0,o=0,s=0;s<e;s++){n=o=0;for(var a=0;a<e;a++)n=n<<1&2047|t.get(s,a),a>=10&&(1488===n||93===n)&&r++,o=o<<1&2047|t.get(a,s),a>=10&&(1488===o||93===o)&&r++}return r*i},e.getPenaltyN4=function(t){for(var e=0,r=t.data.length,n=0;n<r;n++)e+=t.data[n];return Math.abs(Math.ceil(100*e/r/5)-10)*o},e.applyMask=function(t,e){for(var r=e.size,n=0;n<r;n++)for(var i=0;i<r;i++)e.isReserved(i,n)||e.xor(i,n,s(t,i,n))},e.getBestMask=function(t,r){for(var n=Object.keys(e.Patterns).length,i=0,o=1/0,s=0;s<n;s++){r(s),e.applyMask(s,t);var a=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(s,t),a<o&&(o=a,i=s)}return i}})),br=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Sr=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],vr=function(t,e){switch(e){case wr.L:return br[4*(t-1)+0];case wr.M:return br[4*(t-1)+1];case wr.Q:return br[4*(t-1)+2];case wr.H:return br[4*(t-1)+3];default:return}},Tr=function(t,e){switch(e){case wr.L:return Sr[4*(t-1)+0];case wr.M:return Sr[4*(t-1)+1];case wr.Q:return Sr[4*(t-1)+2];case wr.H:return Sr[4*(t-1)+3];default:return}},Rr=ir(512),Nr=ir(256);!function(){for(var t=1,e=0;e<255;e++)Rr[e]=t,Nr[t]=e,256&(t<<=1)&&(t^=285);for(e=255;e<512;e++)Rr[e]=Rr[e-255]}();for(var Or=function(t){return Rr[t]},Dr=function(t,e){return 0===t||0===e?0:Rr[Nr[t]+Nr[e]]},Mr=gr((function(t,e){e.mul=function(t,e){for(var r=ir(t.length+e.length-1),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)r[n+i]^=Dr(t[n],e[i]);return r},e.mod=function(t,e){for(var r=or(t);r.length-e.length>=0;){for(var n=r[0],i=0;i<e.length;i++)r[i]^=Dr(e[i],n);for(var o=0;o<r.length&&0===r[o];)o++;r=r.slice(o)}return r},e.generateECPolynomial=function(t){for(var r=or([1]),n=0;n<t;n++)r=e.mul(r,[1,Or(n)]);return r}})),Br=function(t){var e=zr(t),r=e[0],n=e[1];return 3*(r+n)/4-n},Pr=function(t){var e,r,n=zr(t),i=n[0],o=n[1],s=new Fr(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),a=0,u=o>0?i-4:i;for(r=0;r<u;r+=4)e=xr[t.charCodeAt(r)]<<18|xr[t.charCodeAt(r+1)]<<12|xr[t.charCodeAt(r+2)]<<6|xr[t.charCodeAt(r+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===o&&(e=xr[t.charCodeAt(r)]<<2|xr[t.charCodeAt(r+1)]>>4,s[a++]=255&e);1===o&&(e=xr[t.charCodeAt(r)]<<10|xr[t.charCodeAt(r+1)]<<4|xr[t.charCodeAt(r+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},kr=function(t){for(var e,r=t.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(Gr(t,s,s+o>a?a:s+o));1===n?(e=t[r-1],i.push(Lr[e>>2]+Lr[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],i.push(Lr[e>>10]+Lr[e>>4&63]+Lr[e<<2&63]+"="));return i.join("")},Lr=[],xr=[],Fr="undefined"!=typeof Uint8Array?Uint8Array:Array,Ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Vr=0,Hr=Ur.length;Vr<Hr;++Vr)Lr[Vr]=Ur[Vr],xr[Ur.charCodeAt(Vr)]=Vr;function zr(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function Gr(t,e,r){for(var n,i,o=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(Lr[(i=n)>>18&63]+Lr[i>>12&63]+Lr[i>>6&63]+Lr[63&i]);return o.join("")}xr["-".charCodeAt(0)]=62,xr["_".charCodeAt(0)]=63;var Xr={byteLength:Br,toByteArray:Pr,fromByteArray:kr},Wr=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,l=u>>1,h=-7,c=r?i-1:0,d=r?-1:1,f=t[e+c];for(c+=d,o=f&(1<<-h)-1,f>>=-h,h+=a;h>0;o=256*o+t[e+c],c+=d,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[e+c],c+=d,h-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=l}return(f?-1:1)*s*Math.pow(2,o-n)},Yr=function(t,e,r,n,i,o){var s,a,u,l=8*o-i-1,h=(1<<l)-1,c=h>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,g=n?1:-1,w=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+c>=1?d/u:d*Math.pow(2,1-c))*u>=2&&(s++,u/=2),s+c>=h?(a=0,s=h):s+c>=1?(a=(e*u-1)*Math.pow(2,i),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[r+f]=255&a,f+=g,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[r+f]=255&s,f+=g,s/=256,l-=8);t[r+f-g]|=128*w},Kr=gr((function(t,e){var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=function(t){+t!=t&&(t=0);return o.alloc(+t)},e.INSPECT_MAX_BYTES=50;var n=2147483647;function i(t){if(t>n)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,o.prototype),e}function o(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return s(t,e,r)}function s(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|d(t,e),n=i(r),s=n.write(t,e);s!==r&&(n=n.slice(0,s));return n}(t,e);if(ArrayBuffer.isView(t))return function(t){if(F(t,Uint8Array)){var e=new Uint8Array(t);return h(e.buffer,e.byteOffset,e.byteLength)}return l(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(F(t,ArrayBuffer)||t&&F(t.buffer,ArrayBuffer))return h(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(F(t,SharedArrayBuffer)||t&&F(t.buffer,SharedArrayBuffer)))return h(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return o.from(n,e,r);var s=function(t){if(o.isBuffer(t)){var e=0|c(t.length),r=i(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||U(t.length)?i(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return a(t),i(t<0?0:0|c(t))}function l(t){for(var e=t.length<0?0:0|c(t.length),r=i(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function h(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,o.prototype),n}function c(t){if(t>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|t}function d(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||F(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return k(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return L(t).length;default:if(i)return n?-1:k(t).length;e=(""+e).toLowerCase(),i=!0}}function f(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return T(this,e,r);case"utf8":case"utf-8":return I(this,e,r);case"ascii":return S(this,e,r);case"latin1":case"binary":return v(this,e,r);case"base64":return C(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function w(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),U(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=o.from(e,n)),o.isBuffer(e))return 0===e.length?-1:p(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):p(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function p(t,e,r,n,i){var o,s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function l(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var h=-1;for(o=r;o<a;o++)if(l(t,o)===l(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var c=!0,d=0;d<u;d++)if(l(t,o+d)!==l(e,d)){c=!1;break}if(c)return o}return-1}function m(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(U(a))return s;t[r+s]=a}return s}function _(t,e,r,n){return x(k(e,t.length-r),t,r,n)}function A(t,e,r,n){return x(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function y(t,e,r,n){return x(L(e),t,r,n)}function E(t,e,r,n){return x(function(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function C(t,e,r){return 0===e&&r===t.length?Xr.fromByteArray(t):Xr.fromByteArray(t.slice(e,r))}function I(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,a,u,l=t[i],h=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=r)switch(c){case 1:l<128&&(h=l);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)>127&&(h=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&l)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(h=u)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}return function(t){var e=t.length;if(e<=b)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=b));return r}(n)}e.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(t,e,r){return s(t,e,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(t,e,r){return function(t,e,r){return a(t),t<=0?i(t):void 0!==e?"string"==typeof r?i(t).fill(e,r):i(t).fill(e):i(t)}(t,e,r)},o.allocUnsafe=function(t){return u(t)},o.allocUnsafeSlow=function(t){return u(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(F(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),F(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=o.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(F(s,Uint8Array))i+s.length>n.length?o.from(s).copy(n,i):Uint8Array.prototype.set.call(n,s,i);else{if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i)}i+=s.length}return n},o.byteLength=d,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?I(this,0,t):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(t,e,r,n,i){if(F(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),u=Math.min(s,a),l=this.slice(n,i),h=t.slice(e,r),c=0;c<u;++c)if(l[c]!==h[c]){s=l[c],a=h[c];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},o.prototype.indexOf=function(t,e,r){return w(this,t,e,r,!0)},o.prototype.lastIndexOf=function(t,e,r){return w(this,t,e,r,!1)},o.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return m(this,t,e,r);case"utf8":case"utf-8":return _(this,t,e,r);case"ascii":case"latin1":case"binary":return A(this,t,e,r);case"base64":return y(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var b=4096;function S(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function v(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function T(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=V[t[o]];return i}function R(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function N(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function O(t,e,r,n,i,s){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function D(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function M(t,e,r,n,i){return e=+e,r>>>=0,i||D(t,0,r,4),Yr(t,e,r,n,23,4),r+4}function B(t,e,r,n,i){return e=+e,r>>>=0,i||D(t,0,r,8),Yr(t,e,r,n,52,8),r+8}o.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUintLE=o.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},o.prototype.readUintBE=o.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},o.prototype.readUint8=o.prototype.readUInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),this[t]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},o.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},o.prototype.readInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||N(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(t,e){t>>>=0,e||N(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||N(t,4,this.length),Wr(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||N(t,4,this.length),Wr(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||N(t,8,this.length),Wr(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||N(t,8,this.length),Wr(this,t,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||O(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||O(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},o.prototype.writeUint8=o.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);O(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},o.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);O(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},o.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||O(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,r){return M(this,t,e,!0,r)},o.prototype.writeFloatBE=function(t,e,r){return M(this,t,e,!1,r)},o.prototype.writeDoubleLE=function(t,e,r){return B(this,t,e,!0,r)},o.prototype.writeDoubleBE=function(t,e,r){return B(this,t,e,!1,r)},o.prototype.copy=function(t,e,r,n){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,n):Uint8Array.prototype.set.call(t,this.subarray(r,n),e),i},o.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var a=o.isBuffer(t)?t:o.from(t,n),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=a[s%u]}return this};var P=/[^+/0-9A-Za-z-_]/g;function k(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function L(t){return Xr.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(P,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function x(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function F(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function U(t){return t!=t}var V=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()})).Buffer;function Zr(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}Zr.prototype.initialize=function(t){this.degree=t,this.genPoly=Mr.generateECPolynomial(this.degree)},Zr.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");var e=ir(this.degree),r=Kr.concat([t,e],t.length+this.degree),n=Mr.mod(r,this.genPoly),i=this.degree-n.length;if(i>0){var o=ir(this.degree);return n.copy(o,i),o}return n};var jr=Zr,qr=function(t){return!isNaN(t)&&t>=1&&t<=40},Qr="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",Jr="(?:(?![A-Z0-9 $%*+\\-./:]|"+(Qr=Qr.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+",$r=new RegExp(Qr,"g"),tn=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),en=new RegExp(Jr,"g"),rn=new RegExp("[0-9]+","g"),nn=new RegExp("[A-Z $%*+\\-./:]+","g"),on=new RegExp("^"+Qr+"$"),sn=new RegExp("^[0-9]+$"),an=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),un={KANJI:$r,BYTE_KANJI:tn,BYTE:en,NUMERIC:rn,ALPHANUMERIC:nn,testKanji:function(t){return on.test(t)},testNumeric:function(t){return sn.test(t)},testAlphanumeric:function(t){return an.test(t)}},ln=gr((function(t,e){e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!qr(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return un.testNumeric(t)?e.NUMERIC:un.testAlphanumeric(t)?e.ALPHANUMERIC:un.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return r}}})),hn=gr((function(t,e){var r=lr(7973);function n(t,e){return ln.getCharCountIndicator(t,e)+4}function i(t,e){var r=0;return t.forEach((function(t){var i=n(t.mode,e);r+=i+t.getBitsLength()})),r}e.from=function(t,e){return qr(t)?parseInt(t,10):e},e.getCapacity=function(t,e,r){if(!qr(t))throw new Error("Invalid QR Code version");void 0===r&&(r=ln.BYTE);var i=8*(ur(t)-Tr(t,e));if(r===ln.MIXED)return i;var o=i-n(r,t);switch(r){case ln.NUMERIC:return Math.floor(o/10*3);case ln.ALPHANUMERIC:return Math.floor(o/11*2);case ln.KANJI:return Math.floor(o/13);case ln.BYTE:default:return Math.floor(o/8)}},e.getBestVersionForData=function(t,r){var n,o=wr.from(r,wr.M);if(Ze(t)){if(t.length>1)return function(t,r){for(var n=1;n<=40;n++)if(i(t,n)<=e.getCapacity(n,r,ln.MIXED))return n}(t,o);if(0===t.length)return 1;n=t[0]}else n=t;return function(t,r,n){for(var i=1;i<=40;i++)if(r<=e.getCapacity(i,n,t))return i}(n.mode,n.getLength(),o)},e.getEncodedBits=function(t){if(!qr(t)||t<7)throw new Error("Invalid QR Code version");for(var e=t<<12;lr(e)-r>=0;)e^=7973<<lr(e)-r;return t<<12|e}})),cn=lr(1335),dn=function(t,e){for(var r=t.bit<<3|e,n=r<<10;lr(n)-cn>=0;)n^=1335<<lr(n)-cn;return 21522^(r<<10|n)};function fn(t){this.mode=ln.NUMERIC,this.data=t.toString()}fn.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},fn.prototype.getLength=function(){return this.data.length},fn.prototype.getBitsLength=function(){return fn.getBitsLength(this.data.length)},fn.prototype.write=function(t){var e,r,n;for(e=0;e+3<=this.data.length;e+=3)r=this.data.substr(e,3),n=parseInt(r,10),t.put(n,10);var i=this.data.length-e;i>0&&(r=this.data.substr(e),n=parseInt(r,10),t.put(n,3*i+1))};var gn=fn,wn=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function pn(t){this.mode=ln.ALPHANUMERIC,this.data=t}pn.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},pn.prototype.getLength=function(){return this.data.length},pn.prototype.getBitsLength=function(){return pn.getBitsLength(this.data.length)},pn.prototype.write=function(t){var e;for(e=0;e+2<=this.data.length;e+=2){var r=45*wn.indexOf(this.data[e]);r+=wn.indexOf(this.data[e+1]),t.put(r,11)}this.data.length%2&&t.put(wn.indexOf(this.data[e]),6)};var mn=pn;function _n(t){this.mode=ln.BYTE,this.data=or(t)}_n.getBitsLength=function(t){return 8*t},_n.prototype.getLength=function(){return this.data.length},_n.prototype.getBitsLength=function(){return _n.getBitsLength(this.data.length)},_n.prototype.write=function(t){for(var e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var An=_n;function yn(t){this.mode=ln.KANJI,this.data=t}yn.getBitsLength=function(t){return 13*t},yn.prototype.getLength=function(){return this.data.length},yn.prototype.getBitsLength=function(){return yn.getBitsLength(this.data.length)},yn.prototype.write=function(t){var e;for(e=0;e<this.data.length;e++){var r=dr(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13)}};var En=yn,Cn=gr((function(t){var e={single_source_shortest_paths:function(t,r,n){var i={},o={};o[r]=0;var s,a,u,l,h,c,d,f=e.PriorityQueue.make();for(f.push(r,0);!f.empty();)for(u in a=(s=f.pop()).value,l=s.cost,h=t[a]||{})h.hasOwnProperty(u)&&(c=l+h[u],d=o[u],(void 0===o[u]||d>c)&&(o[u]=c,f.push(u,c),i[u]=a));if(void 0!==n&&void 0===o[n]){var g=["Could not find a path from ",r," to ",n,"."].join("");throw new Error(g)}return i},extract_shortest_path_from_predecessor_list:function(t,e){for(var r=[],n=e;n;)r.push(n),t[n],n=t[n];return r.reverse(),r},find_path:function(t,r,n){var i=e.single_source_shortest_paths(t,r,n);return e.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(t){var r,n=e.PriorityQueue,i={};for(r in t=t||{},n)n.hasOwnProperty(r)&&(i[r]=n[r]);return i.queue=[],i.sorter=t.sorter||n.default_sorter,i},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var r={value:t,cost:e};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e})),In=gr((function(t,e){function r(t){return unescape(encodeURIComponent(t)).length}function n(t,e,r){for(var n,i=[];null!==(n=t.exec(r));)i.push({data:n[0],index:n.index,mode:e,length:n[0].length});return i}function i(t){var e,r,i=n(un.NUMERIC,ln.NUMERIC,t),o=n(un.ALPHANUMERIC,ln.ALPHANUMERIC,t);return cr()?(e=n(un.BYTE,ln.BYTE,t),r=n(un.KANJI,ln.KANJI,t)):(e=n(un.BYTE_KANJI,ln.BYTE,t),r=[]),i.concat(o,e,r).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function o(t,e){switch(e){case ln.NUMERIC:return gn.getBitsLength(t);case ln.ALPHANUMERIC:return mn.getBitsLength(t);case ln.KANJI:return En.getBitsLength(t);case ln.BYTE:return An.getBitsLength(t)}}function s(t,e){var r,n=ln.getBestModeForData(t);if((r=ln.from(e,n))!==ln.BYTE&&r.bit<n.bit)throw new Error('"'+t+'" cannot be encoded with mode '+ln.toString(r)+".\n Suggested mode is: "+ln.toString(n));switch(r!==ln.KANJI||cr()||(r=ln.BYTE),r){case ln.NUMERIC:return new gn(t);case ln.ALPHANUMERIC:return new mn(t);case ln.KANJI:return new En(t);case ln.BYTE:return new An(t)}}e.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(s(e,null)):e.data&&t.push(s(e.data,e.mode)),t}),[])},e.fromString=function(t,n){for(var s=function(t,e){for(var r={},n={start:{}},i=["start"],s=0;s<t.length;s++){for(var a=t[s],u=[],l=0;l<a.length;l++){var h=a[l],c=""+s+l;u.push(c),r[c]={node:h,lastCount:0},n[c]={};for(var d=0;d<i.length;d++){var f=i[d];r[f]&&r[f].node.mode===h.mode?(n[f][c]=o(r[f].lastCount+h.length,h.mode)-o(r[f].lastCount,h.mode),r[f].lastCount+=h.length):(r[f]&&(r[f].lastCount=h.length),n[f][c]=o(h.length,h.mode)+4+ln.getCharCountIndicator(h.mode,e))}}i=u}for(d=0;d<i.length;d++)n[i[d]].end=0;return{map:n,table:r}}(function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];switch(i.mode){case ln.NUMERIC:e.push([i,{data:i.data,mode:ln.ALPHANUMERIC,length:i.length},{data:i.data,mode:ln.BYTE,length:i.length}]);break;case ln.ALPHANUMERIC:e.push([i,{data:i.data,mode:ln.BYTE,length:i.length}]);break;case ln.KANJI:e.push([i,{data:i.data,mode:ln.BYTE,length:r(i.data)}]);break;case ln.BYTE:e.push([{data:i.data,mode:ln.BYTE,length:r(i.data)}])}}return e}(i(t,cr())),n),a=Cn.find_path(s.map,"start","end"),u=[],l=1;l<a.length-1;l++)u.push(s.table[a[l]].node);return e.fromArray(function(t){return t.reduce((function(t,e){var r=t.length-1>=0?t[t.length-1]:null;return r&&r.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[])}(u))},e.rawSplit=function(t){return e.fromArray(i(t,cr()))}}));function bn(t,e,r){var n,i,o=t.size,s=dn(e,r);for(n=0;n<15;n++)i=1==(s>>n&1),n<6?t.set(n,8,i,!0):n<8?t.set(n+1,8,i,!0):t.set(o-15+n,8,i,!0),n<8?t.set(8,o-n-1,i,!0):n<9?t.set(8,15-n-1+1,i,!0):t.set(8,15-n-1,i,!0);t.set(o-8,8,1,!0)}function Sn(t,e,r){var n=new mr;r.forEach((function(e){n.put(e.mode.bit,4),n.put(e.getLength(),ln.getCharCountIndicator(e.mode,t)),e.write(n)}));var i=8*(ur(t)-Tr(t,e));for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);for(var o=(i-n.getLengthInBits())/8,s=0;s<o;s++)n.put(s%2?17:236,8);return function(t,e,r){for(var n=ur(e),i=Tr(e,r),o=n-i,s=vr(e,r),a=s-n%s,u=Math.floor(n/s),l=Math.floor(o/s),h=l+1,c=u-l,d=new jr(c),f=0,g=new Array(s),w=new Array(s),p=0,m=or(t.buffer),_=0;_<s;_++){var A=_<a?l:h;g[_]=m.slice(f,f+A),w[_]=d.encode(g[_]),f+=A,p=Math.max(p,A)}var y,E,C=ir(n),I=0;for(y=0;y<p;y++)for(E=0;E<s;E++)y<g[E].length&&(C[I++]=g[E][y]);for(y=0;y<c;y++)for(E=0;E<s;E++)C[I++]=w[E][y];return C}(n,t,e)}function vn(t,e,r,n){var i;if(Ze(t))i=In.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");var o=e;if(!o){var s=In.rawSplit(t);o=hn.getBestVersionForData(s,r)}i=In.fromString(t,o||40)}var a=hn.getBestVersionForData(i,r);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<a)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+a+".\n")}else e=a;var u=Sn(e,r,i),l=ar(e),h=new Ar(l);return function(t,e){for(var r=t.size,n=Cr(e),i=0;i<n.length;i++)for(var o=n[i][0],s=n[i][1],a=-1;a<=7;a++)if(!(o+a<=-1||r<=o+a))for(var u=-1;u<=7;u++)s+u<=-1||r<=s+u||(a>=0&&a<=6&&(0===u||6===u)||u>=0&&u<=6&&(0===a||6===a)||a>=2&&a<=4&&u>=2&&u<=4?t.set(o+a,s+u,!0,!0):t.set(o+a,s+u,!1,!0))}(h,e),function(t){for(var e=t.size,r=8;r<e-8;r++){var n=r%2==0;t.set(r,6,n,!0),t.set(6,r,n,!0)}}(h),function(t,e){for(var r=yr.getPositions(e),n=0;n<r.length;n++)for(var i=r[n][0],o=r[n][1],s=-2;s<=2;s++)for(var a=-2;a<=2;a++)-2===s||2===s||-2===a||2===a||0===s&&0===a?t.set(i+s,o+a,!0,!0):t.set(i+s,o+a,!1,!0)}(h,e),bn(h,r,0),e>=7&&function(t,e){for(var r,n,i,o=t.size,s=hn.getEncodedBits(e),a=0;a<18;a++)r=Math.floor(a/3),n=a%3+o-8-3,i=1==(s>>a&1),t.set(r,n,i,!0),t.set(n,r,i,!0)}(h,e),function(t,e){for(var r=t.size,n=-1,i=r-1,o=7,s=0,a=r-1;a>0;a-=2)for(6===a&&a--;;){for(var u=0;u<2;u++)if(!t.isReserved(i,a-u)){var l=!1;s<e.length&&(l=1==(e[s]>>>o&1)),t.set(i,a-u,l),-1==--o&&(s++,o=7)}if((i+=n)<0||r<=i){i-=n,n=-n;break}}}(h,u),isNaN(n)&&(n=Ir.getBestMask(h,bn.bind(null,h,r))),Ir.applyMask(n,h),bn(h,r,n),{modules:h,version:e,errorCorrectionLevel:r,maskPattern:n,segments:i}}var Tn=function(t,e){if(void 0===t||""===t)throw new Error("No input text");var r,n,i=wr.M;return void 0!==e&&(i=wr.from(e.errorCorrectionLevel,wr.M),r=hn.from(e.version),n=Ir.from(e.maskPattern),e.toSJISFunc&&hr(e.toSJISFunc)),vn(t,r,i,n)},Rn=gr((function(t,e){function r(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");var r=parseInt(e.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});var e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,n=t.width&&t.width>=21?t.width:void 0,i=t.scale||4;return{width:n,scale:n?4:i,margin:e,color:{dark:r(t.color.dark||"#000000ff"),light:r(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,r){var n=e.getScale(t,r);return Math.floor((t+2*r.margin)*n)},e.qrToImageData=function(t,r,n){for(var i=r.modules.size,o=r.modules.data,s=e.getScale(i,n),a=Math.floor((i+2*n.margin)*s),u=n.margin*s,l=[n.color.light,n.color.dark],h=0;h<a;h++)for(var c=0;c<a;c++){var d=4*(h*a+c),f=n.color.light;if(h>=u&&c>=u&&h<a-u&&c<a-u)f=l[o[Math.floor((h-u)/s)*i+Math.floor((c-u)/s)]?1:0];t[d++]=f.r,t[d++]=f.g,t[d++]=f.b,t[d]=f.a}}})),Nn=gr((function(t,e){e.render=function(t,e,r){var n=r,i=e;void 0!==n||e&&e.getContext||(n=e,e=void 0),e||(i=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),n=Rn.getOptions(n);var o=Rn.getImageWidth(t.modules.size,n),s=i.getContext("2d"),a=s.createImageData(o,o);return Rn.qrToImageData(a.data,t,n),function(t,e,r){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=r,e.width=r,e.style.height=r+"px",e.style.width=r+"px"}(s,i,o),s.putImageData(a,0,0),i},e.renderToDataURL=function(t,r,n){var i=n;void 0!==i||r&&r.getContext||(i=r,r=void 0),i||(i={});var o=e.render(t,r,i),s=i.type||"image/png",a=i.rendererOpts||{};return o.toDataURL(s,a.quality)}}));function On(t,e){var r=t.a/255,n=e+'="'+t.hex+'"';return r<1?n+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function Dn(t,e,r){var n=t+e;return void 0!==r&&(n+=" "+r),n}var Mn=function(t,e,r){var n=Rn.getOptions(e),i=t.modules.size,o=t.modules.data,s=i+2*n.margin,a=n.color.light.a?"<path "+On(n.color.light,"fill")+' d="M0 0h'+s+"v"+s+'H0z"/>':"",u="<path "+On(n.color.dark,"stroke")+' d="'+function(t,e,r){for(var n="",i=0,o=!1,s=0,a=0;a<t.length;a++){var u=Math.floor(a%e),l=Math.floor(a/e);u||o||(o=!0),t[a]?(s++,a>0&&u>0&&t[a-1]||(n+=o?Dn("M",u+r,.5+l+r):Dn("m",i,0),i=0,o=!1),u+1<e&&t[a+1]||(n+=Dn("h",s),s=0)):i++}return n}(o,i,n.margin)+'"/>',l='viewBox="0 0 '+s+" "+s+'"',h='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+l+' shape-rendering="crispEdges">'+a+u+"</svg>\n";return"function"==typeof r&&r(null,h),h};function Bn(t,e,r,n,i){var o=[].slice.call(arguments,1),s=o.length,a="function"==typeof o[s-1];if(!a&&!Ye())throw new Error("Callback required as last argument");if(!a){if(s<1)throw new Error("Too few arguments provided");return 1===s?(r=e,e=n=void 0):2!==s||e.getContext||(n=r,r=e,e=void 0),new Promise((function(i,o){try{var s=Tn(r,n);i(t(s,e,n))}catch(t){o(t)}}))}if(s<2)throw new Error("Too few arguments provided");2===s?(i=r,r=e,e=n=void 0):3===s&&(e.getContext&&void 0===i?(i=n,n=void 0):(i=n,n=r,r=e,e=void 0));try{var u=Tn(r,n);i(null,t(u,e,n))}catch(t){i(t)}}var Pn,kn={create:Tn,toCanvas:Bn.bind(null,Nn.render),toDataURL:Bn.bind(null,Nn.renderToDataURL),toString:Bn.bind(null,(function(t,e,r){return Mn(t,r)}))},Ln=gr((function(t,e){!function(t){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};function r(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}function n(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function i(t,e){void 0===e&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var o,s=function(t){function e(e){var r=this.constructor,o=t.call(this,e)||this;return Object.defineProperty(o,"name",{value:r.name,enumerable:!1}),n(o,r.prototype),i(o),o}return r(e,t),e}(Error);class a extends s{constructor(t){super(t),this.message=t}getKind(){return this.constructor.kind}}a.kind="Exception";class u extends a{}u.kind="ArgumentException";class l extends a{}l.kind="IllegalArgumentException";class h{constructor(t){if(this.binarizer=t,null===t)throw new l("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(t,e){return this.binarizer.getBlackRow(t,e)}getBlackMatrix(){return null!==this.matrix&&void 0!==this.matrix||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(t,e,r,n){const i=this.binarizer.getLuminanceSource().crop(t,e,r,n);return new h(this.binarizer.createBinarizer(i))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new h(this.binarizer.createBinarizer(t))}rotateCounterClockwise45(){const t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new h(this.binarizer.createBinarizer(t))}toString(){try{return this.getBlackMatrix().toString()}catch(t){return""}}}class c extends a{static getChecksumInstance(){return new c}}c.kind="ChecksumException";class d{constructor(t){this.source=t}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class f{static arraycopy(t,e,r,n,i){for(;i--;)r[n++]=t[e++]}static currentTimeMillis(){return Date.now()}}class g extends a{}g.kind="IndexOutOfBoundsException";class w extends g{constructor(t,e){super(e),this.index=t,this.message=e}}w.kind="ArrayIndexOutOfBoundsException";class p{static fill(t,e){for(let r=0,n=t.length;r<n;r++)t[r]=e}static fillWithin(t,e,r,n){p.rangeCheck(t.length,e,r);for(let i=e;i<r;i++)t[i]=n}static rangeCheck(t,e,r){if(e>r)throw new l("fromIndex("+e+") > toIndex("+r+")");if(e<0)throw new w(e);if(r>t)throw new w(r)}static asList(...t){return t}static create(t,e,r){return Array.from({length:t}).map((t=>Array.from({length:e}).fill(r)))}static createInt32Array(t,e,r){return Array.from({length:t}).map((t=>Int32Array.from({length:e}).fill(r)))}static equals(t,e){if(!t)return!1;if(!e)return!1;if(!t.length)return!1;if(!e.length)return!1;if(t.length!==e.length)return!1;for(let r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}static hashCode(t){if(null===t)return 0;let e=1;for(const r of t)e=31*e+r;return e}static fillUint8Array(t,e){for(let r=0;r!==t.length;r++)t[r]=e}static copyOf(t,e){return t.slice(0,e)}static copyOfUint8Array(t,e){if(t.length<=e){const r=new Uint8Array(e);return r.set(t),r}return t.slice(0,e)}static copyOfRange(t,e,r){const n=r-e,i=new Int32Array(n);return f.arraycopy(t,e,i,0,n),i}static binarySearch(t,e,r){void 0===r&&(r=p.numberComparator);let n=0,i=t.length-1;for(;n<=i;){const o=i+n>>1,s=r(e,t[o]);if(s>0)n=o+1;else{if(!(s<0))return o;i=o-1}}return-n-1}static numberComparator(t,e){return t-e}}class m{static numberOfTrailingZeros(t){let e;if(0===t)return 32;let r=31;return e=t<<16,0!==e&&(r-=16,t=e),e=t<<8,0!==e&&(r-=8,t=e),e=t<<4,0!==e&&(r-=4,t=e),e=t<<2,0!==e&&(r-=2,t=e),r-(t<<1>>>31)}static numberOfLeadingZeros(t){if(0===t)return 32;let e=1;return t>>>16==0&&(e+=16,t<<=16),t>>>24==0&&(e+=8,t<<=8),t>>>28==0&&(e+=4,t<<=4),t>>>30==0&&(e+=2,t<<=2),e-=t>>>31,e}static toHexString(t){return t.toString(16)}static toBinaryString(t){return String(parseInt(String(t),2))}static bitCount(t){return t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135,t+=t>>>8,63&(t+=t>>>16)}static truncDivision(t,e){return Math.trunc(t/e)}static parseInt(t,e){return parseInt(t,e)}}m.MIN_VALUE_32_BITS=-2147483648,m.MAX_VALUE=Number.MAX_SAFE_INTEGER;class _{constructor(t,e){void 0===t?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,this.bits=null==e?_.makeArray(t):e)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(t){if(t>32*this.bits.length){const e=_.makeArray(t);f.arraycopy(this.bits,0,e,0,this.bits.length),this.bits=e}}get(t){return 0!=(this.bits[Math.floor(t/32)]&1<<(31&t))}set(t){this.bits[Math.floor(t/32)]|=1<<(31&t)}flip(t){this.bits[Math.floor(t/32)]^=1<<(31&t)}getNextSet(t){const e=this.size;if(t>=e)return e;const r=this.bits;let n=Math.floor(t/32),i=r[n];i&=~((1<<(31&t))-1);const o=r.length;for(;0===i;){if(++n===o)return e;i=r[n]}const s=32*n+m.numberOfTrailingZeros(i);return s>e?e:s}getNextUnset(t){const e=this.size;if(t>=e)return e;const r=this.bits;let n=Math.floor(t/32),i=~r[n];i&=~((1<<(31&t))-1);const o=r.length;for(;0===i;){if(++n===o)return e;i=~r[n]}const s=32*n+m.numberOfTrailingZeros(i);return s>e?e:s}setBulk(t,e){this.bits[Math.floor(t/32)]=e}setRange(t,e){if(e<t||t<0||e>this.size)throw new l;if(e===t)return;e--;const r=Math.floor(t/32),n=Math.floor(e/32),i=this.bits;for(let o=r;o<=n;o++){const s=(2<<(o<n?31:31&e))-(1<<(o>r?0:31&t));i[o]|=s}}clear(){const t=this.bits.length,e=this.bits;for(let r=0;r<t;r++)e[r]=0}isRange(t,e,r){if(e<t||t<0||e>this.size)throw new l;if(e===t)return!0;e--;const n=Math.floor(t/32),i=Math.floor(e/32),o=this.bits;for(let s=n;s<=i;s++){const a=(2<<(s<i?31:31&e))-(1<<(s>n?0:31&t))&4294967295;if((o[s]&a)!==(r?a:0))return!1}return!0}appendBit(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++}appendBits(t,e){if(e<0||e>32)throw new l("Num bits must be between 0 and 32");this.ensureCapacity(this.size+e);for(let r=e;r>0;r--)this.appendBit(1==(t>>r-1&1))}appendBitArray(t){const e=t.size;this.ensureCapacity(this.size+e);for(let r=0;r<e;r++)this.appendBit(t.get(r))}xor(t){if(this.size!==t.size)throw new l("Sizes don't match");const e=this.bits;for(let r=0,n=e.length;r<n;r++)e[r]^=t.bits[r]}toBytes(t,e,r,n){for(let i=0;i<n;i++){let n=0;for(let e=0;e<8;e++)this.get(t)&&(n|=1<<7-e),t++;e[r+i]=n}}getBitArray(){return this.bits}reverse(){const t=new Int32Array(this.bits.length),e=Math.floor((this.size-1)/32),r=e+1,n=this.bits;for(let i=0;i<r;i++){let r=n[i];r=r>>1&1431655765|(1431655765&r)<<1,r=r>>2&858993459|(858993459&r)<<2,r=r>>4&252645135|(252645135&r)<<4,r=r>>8&16711935|(16711935&r)<<8,r=r>>16&65535|(65535&r)<<16,t[e-i]=r}if(this.size!==32*r){const e=32*r-this.size;let n=t[0]>>>e;for(let i=1;i<r;i++){const r=t[i];n|=r<<32-e,t[i-1]=n,n=r>>>e}t[r-1]=n}this.bits=t}static makeArray(t){return new Int32Array(Math.floor((t+31)/32))}equals(t){if(!(t instanceof _))return!1;const e=t;return this.size===e.size&&p.equals(this.bits,e.bits)}hashCode(){return 31*this.size+p.hashCode(this.bits)}toString(){let t="";for(let e=0,r=this.size;e<r;e++)0==(7&e)&&(t+=" "),t+=this.get(e)?"X":".";return t}clone(){return new _(this.size,this.bits.slice())}}!function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ASSUME_GS1=7]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"}(o||(o={}));var A,y=o;class E extends a{static getFormatInstance(){return new E}}E.kind="FormatException",function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"}(A||(A={}));class C{constructor(t,e,r,...n){this.valueIdentifier=t,this.name=r,this.values="number"==typeof e?Int32Array.from([e]):e,this.otherEncodingNames=n,C.VALUE_IDENTIFIER_TO_ECI.set(t,this),C.NAME_TO_ECI.set(r,this);const i=this.values;for(let t=0,e=i.length;t!==e;t++){const e=i[t];C.VALUES_TO_ECI.set(e,this)}for(const t of n)C.NAME_TO_ECI.set(t,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(t){if(t<0||t>=900)throw new E("incorect value");const e=C.VALUES_TO_ECI.get(t);if(void 0===e)throw new E("incorect value");return e}static getCharacterSetECIByName(t){const e=C.NAME_TO_ECI.get(t);if(void 0===e)throw new E("incorect value");return e}equals(t){if(!(t instanceof C))return!1;const e=t;return this.getName()===e.getName()}}C.VALUE_IDENTIFIER_TO_ECI=new Map,C.VALUES_TO_ECI=new Map,C.NAME_TO_ECI=new Map,C.Cp437=new C(A.Cp437,Int32Array.from([0,2]),"Cp437"),C.ISO8859_1=new C(A.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),C.ISO8859_2=new C(A.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),C.ISO8859_3=new C(A.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),C.ISO8859_4=new C(A.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),C.ISO8859_5=new C(A.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),C.ISO8859_6=new C(A.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),C.ISO8859_7=new C(A.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),C.ISO8859_8=new C(A.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),C.ISO8859_9=new C(A.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),C.ISO8859_10=new C(A.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),C.ISO8859_11=new C(A.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),C.ISO8859_13=new C(A.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),C.ISO8859_14=new C(A.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),C.ISO8859_15=new C(A.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),C.ISO8859_16=new C(A.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),C.SJIS=new C(A.SJIS,20,"SJIS","Shift_JIS"),C.Cp1250=new C(A.Cp1250,21,"Cp1250","windows-1250"),C.Cp1251=new C(A.Cp1251,22,"Cp1251","windows-1251"),C.Cp1252=new C(A.Cp1252,23,"Cp1252","windows-1252"),C.Cp1256=new C(A.Cp1256,24,"Cp1256","windows-1256"),C.UnicodeBigUnmarked=new C(A.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),C.UTF8=new C(A.UTF8,26,"UTF8","UTF-8"),C.ASCII=new C(A.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),C.Big5=new C(A.Big5,28,"Big5"),C.GB18030=new C(A.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),C.EUC_KR=new C(A.EUC_KR,30,"EUC_KR","EUC-KR");class I extends a{}I.kind="UnsupportedOperationException";class b{static decode(t,e){const r=this.encodingName(e);return this.customDecoder?this.customDecoder(t,r):"undefined"==typeof TextDecoder||this.shouldDecodeOnFallback(r)?this.decodeFallback(t,r):new TextDecoder(r).decode(t)}static shouldDecodeOnFallback(t){return!b.isBrowser()&&"ISO-8859-1"===t}static encode(t,e){const r=this.encodingName(e);return this.customEncoder?this.customEncoder(t,r):"undefined"==typeof TextEncoder?this.encodeFallback(t):(new TextEncoder).encode(t)}static isBrowser(){return"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)}static encodingName(t){return"string"==typeof t?t:t.getName()}static encodingCharacterSet(t){return t instanceof C?t:C.getCharacterSetECIByName(t)}static decodeFallback(t,e){const r=this.encodingCharacterSet(e);if(b.isDecodeFallbackSupported(r)){let e="";for(let r=0,n=t.length;r<n;r++){let n=t[r].toString(16);n.length<2&&(n="0"+n),e+="%"+n}return decodeURIComponent(e)}if(r.equals(C.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new I(`Encoding ${this.encodingName(e)} not supported by fallback.`)}static isDecodeFallbackSupported(t){return t.equals(C.UTF8)||t.equals(C.ISO8859_1)||t.equals(C.ASCII)}static encodeFallback(t){const e=btoa(unescape(encodeURIComponent(t))).split(""),r=[];for(let t=0;t<e.length;t++)r.push(e[t].charCodeAt(0));return new Uint8Array(r)}}class S{static castAsNonUtf8Char(t,e=null){const r=e?e.getName():this.ISO88591;return b.decode(new Uint8Array([t]),r)}static guessEncoding(t,e){if(null!=e&&void 0!==e.get(y.CHARACTER_SET))return e.get(y.CHARACTER_SET).toString();const r=t.length;let n=!0,i=!0,o=!0,s=0,a=0,u=0,l=0,h=0,c=0,d=0,f=0,g=0,w=0,p=0;const m=t.length>3&&239===t[0]&&187===t[1]&&191===t[2];for(let e=0;e<r&&(n||i||o);e++){const r=255&t[e];o&&(s>0?0==(128&r)?o=!1:s--:0!=(128&r)&&(0==(64&r)?o=!1:(s++,0==(32&r)?a++:(s++,0==(16&r)?u++:(s++,0==(8&r)?l++:o=!1))))),n&&(r>127&&r<160?n=!1:r>159&&(r<192||215===r||247===r)&&p++),i&&(h>0?r<64||127===r||r>252?i=!1:h--:128===r||160===r||r>239?i=!1:r>160&&r<224?(c++,f=0,d++,d>g&&(g=d)):r>127?(h++,d=0,f++,f>w&&(w=f)):(d=0,f=0))}return o&&s>0&&(o=!1),i&&h>0&&(i=!1),o&&(m||a+u+l>0)?S.UTF8:i&&(S.ASSUME_SHIFT_JIS||g>=3||w>=3)?S.SHIFT_JIS:n&&i?2===g&&2===c||10*p>=r?S.SHIFT_JIS:S.ISO88591:n?S.ISO88591:i?S.SHIFT_JIS:o?S.UTF8:S.PLATFORM_DEFAULT_ENCODING}static format(t,...e){let r=-1;function n(t,n,i,o,s,a){if("%%"===t)return"%";if(void 0===e[++r])return;t=o?parseInt(o.substr(1)):void 0;let u,l=s?parseInt(s.substr(1)):void 0;switch(a){case"s":u=e[r];break;case"c":u=e[r][0];break;case"f":u=parseFloat(e[r]).toFixed(t);break;case"p":u=parseFloat(e[r]).toPrecision(t);break;case"e":u=parseFloat(e[r]).toExponential(t);break;case"x":u=parseInt(e[r]).toString(l||16);break;case"d":u=parseFloat(parseInt(e[r],l||10).toPrecision(t)).toFixed(0)}u="object"==typeof u?JSON.stringify(u):(+u).toString(l);let h=parseInt(i),c=i&&i[0]+""=="0"?"0":" ";for(;u.length<h;)u=void 0!==n?u+c:c+u;return u}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(i,n)}static getBytes(t,e){return b.encode(t,e)}static getCharCode(t,e=0){return t.charCodeAt(e)}static getCharAt(t){return String.fromCharCode(t)}}S.SHIFT_JIS=C.SJIS.getName(),S.GB2312="GB2312",S.ISO88591=C.ISO8859_1.getName(),S.EUC_JP="EUC_JP",S.UTF8=C.UTF8.getName(),S.PLATFORM_DEFAULT_ENCODING=S.UTF8,S.ASSUME_SHIFT_JIS=!1;class v{constructor(t=""){this.value=t}enableDecoding(t){return this.encoding=t,this}append(t){return"string"==typeof t?this.value+=t.toString():this.encoding?this.value+=S.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this}appendChars(t,e,r){for(let n=e;e<e+r;n++)this.append(t[n]);return this}length(){return this.value.length}charAt(t){return this.value.charAt(t)}deleteCharAt(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)}setCharAt(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+1)}substring(t,e){return this.value.substring(t,e)}setLengthToZero(){this.value=""}toString(){return this.value}insert(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+e.length)}}class T{constructor(t,e,r,n){if(this.width=t,this.height=e,this.rowSize=r,this.bits=n,null==e&&(e=t),this.height=e,t<1||e<1)throw new l("Both dimensions must be greater than 0");null==r&&(r=Math.floor((t+31)/32)),this.rowSize=r,null==n&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(t){const e=t.length,r=t[0].length,n=new T(r,e);for(let i=0;i<e;i++){const e=t[i];for(let t=0;t<r;t++)e[t]&&n.set(t,i)}return n}static parseFromString(t,e,r){if(null===t)throw new l("stringRepresentation cannot be null");const n=new Array(t.length);let i=0,o=0,s=-1,a=0,u=0;for(;u<t.length;)if("\n"===t.charAt(u)||"\r"===t.charAt(u)){if(i>o){if(-1===s)s=i-o;else if(i-o!==s)throw new l("row lengths do not match");o=i,a++}u++}else if(t.substring(u,u+e.length)===e)u+=e.length,n[i]=!0,i++;else{if(t.substring(u,u+r.length)!==r)throw new l("illegal character encountered: "+t.substring(u));u+=r.length,n[i]=!1,i++}if(i>o){if(-1===s)s=i-o;else if(i-o!==s)throw new l("row lengths do not match");a++}const h=new T(s,a);for(let t=0;t<i;t++)n[t]&&h.set(Math.floor(t%s),Math.floor(t/s));return h}get(t,e){const r=e*this.rowSize+Math.floor(t/32);return 0!=(this.bits[r]>>>(31&t)&1)}set(t,e){const r=e*this.rowSize+Math.floor(t/32);this.bits[r]|=1<<(31&t)&4294967295}unset(t,e){const r=e*this.rowSize+Math.floor(t/32);this.bits[r]&=~(1<<(31&t)&4294967295)}flip(t,e){const r=e*this.rowSize+Math.floor(t/32);this.bits[r]^=1<<(31&t)&4294967295}xor(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new l("input matrix dimensions do not match");const e=new _(Math.floor(this.width/32)+1),r=this.rowSize,n=this.bits;for(let i=0,o=this.height;i<o;i++){const o=i*r,s=t.getRow(i,e).getBitArray();for(let t=0;t<r;t++)n[o+t]^=s[t]}}clear(){const t=this.bits,e=t.length;for(let r=0;r<e;r++)t[r]=0}setRegion(t,e,r,n){if(e<0||t<0)throw new l("Left and top must be nonnegative");if(n<1||r<1)throw new l("Height and width must be at least 1");const i=t+r,o=e+n;if(o>this.height||i>this.width)throw new l("The region must fit inside the matrix");const s=this.rowSize,a=this.bits;for(let r=e;r<o;r++){const e=r*s;for(let r=t;r<i;r++)a[e+Math.floor(r/32)]|=1<<(31&r)&4294967295}}getRow(t,e){null==e||e.getSize()<this.width?e=new _(this.width):e.clear();const r=this.rowSize,n=this.bits,i=t*r;for(let t=0;t<r;t++)e.setBulk(32*t,n[i+t]);return e}setRow(t,e){f.arraycopy(e.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)}rotate180(){const t=this.getWidth(),e=this.getHeight();let r=new _(t),n=new _(t);for(let t=0,i=Math.floor((e+1)/2);t<i;t++)r=this.getRow(t,r),n=this.getRow(e-1-t,n),r.reverse(),n.reverse(),this.setRow(t,n),this.setRow(e-1-t,r)}getEnclosingRectangle(){const t=this.width,e=this.height,r=this.rowSize,n=this.bits;let i=t,o=e,s=-1,a=-1;for(let t=0;t<e;t++)for(let e=0;e<r;e++){const u=n[t*r+e];if(0!==u){if(t<o&&(o=t),t>a&&(a=t),32*e<i){let t=0;for(;0==(u<<31-t&4294967295);)t++;32*e+t<i&&(i=32*e+t)}if(32*e+31>s){let t=31;for(;u>>>t==0;)t--;32*e+t>s&&(s=32*e+t)}}}return s<i||a<o?null:Int32Array.from([i,o,s-i+1,a-o+1])}getTopLeftOnBit(){const t=this.rowSize,e=this.bits;let r=0;for(;r<e.length&&0===e[r];)r++;if(r===e.length)return null;const n=r/t;let i=r%t*32;const o=e[r];let s=0;for(;0==(o<<31-s&4294967295);)s++;return i+=s,Int32Array.from([i,n])}getBottomRightOnBit(){const t=this.rowSize,e=this.bits;let r=e.length-1;for(;r>=0&&0===e[r];)r--;if(r<0)return null;const n=Math.floor(r/t);let i=32*Math.floor(r%t);const o=e[r];let s=31;for(;o>>>s==0;)s--;return i+=s,Int32Array.from([i,n])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(t){if(!(t instanceof T))return!1;const e=t;return this.width===e.width&&this.height===e.height&&this.rowSize===e.rowSize&&p.equals(this.bits,e.bits)}hashCode(){let t=this.width;return t=31*t+this.width,t=31*t+this.height,t=31*t+this.rowSize,t=31*t+p.hashCode(this.bits),t}toString(t="X ",e="  ",r="\n"){return this.buildToString(t,e,r)}buildToString(t,e,r){let n=new v;for(let i=0,o=this.height;i<o;i++){for(let r=0,o=this.width;r<o;r++)n.append(this.get(r,i)?t:e);n.append(r)}return n.toString()}clone(){return new T(this.width,this.height,this.rowSize,this.bits.slice())}}class R extends a{static getNotFoundInstance(){return new R}}R.kind="NotFoundException";class N extends d{constructor(t){super(t),this.luminances=N.EMPTY,this.buckets=new Int32Array(N.LUMINANCE_BUCKETS)}getBlackRow(t,e){const r=this.getLuminanceSource(),n=r.getWidth();null==e||e.getSize()<n?e=new _(n):e.clear(),this.initArrays(n);const i=r.getRow(t,this.luminances),o=this.buckets;for(let t=0;t<n;t++)o[(255&i[t])>>N.LUMINANCE_SHIFT]++;const s=N.estimateBlackPoint(o);if(n<3)for(let t=0;t<n;t++)(255&i[t])<s&&e.set(t);else{let t=255&i[0],r=255&i[1];for(let o=1;o<n-1;o++){const n=255&i[o+1];(4*r-t-n)/2<s&&e.set(o),t=r,r=n}}return e}getBlackMatrix(){const t=this.getLuminanceSource(),e=t.getWidth(),r=t.getHeight(),n=new T(e,r);this.initArrays(e);const i=this.buckets;for(let n=1;n<5;n++){const o=Math.floor(r*n/5),s=t.getRow(o,this.luminances),a=Math.floor(4*e/5);for(let t=Math.floor(e/5);t<a;t++)i[(255&s[t])>>N.LUMINANCE_SHIFT]++}const o=N.estimateBlackPoint(i),s=t.getMatrix();for(let t=0;t<r;t++){const r=t*e;for(let i=0;i<e;i++)(255&s[r+i])<o&&n.set(i,t)}return n}createBinarizer(t){return new N(t)}initArrays(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));const e=this.buckets;for(let t=0;t<N.LUMINANCE_BUCKETS;t++)e[t]=0}static estimateBlackPoint(t){const e=t.length;let r=0,n=0,i=0;for(let o=0;o<e;o++)t[o]>i&&(n=o,i=t[o]),t[o]>r&&(r=t[o]);let o=0,s=0;for(let r=0;r<e;r++){const e=r-n,i=t[r]*e*e;i>s&&(o=r,s=i)}if(n>o){const t=n;n=o,o=t}if(o-n<=e/16)throw new R;let a=o-1,u=-1;for(let e=o-1;e>n;e--){const i=e-n,s=i*i*(o-e)*(r-t[e]);s>u&&(a=e,u=s)}return a<<N.LUMINANCE_SHIFT}}N.LUMINANCE_BITS=5,N.LUMINANCE_SHIFT=8-N.LUMINANCE_BITS,N.LUMINANCE_BUCKETS=1<<N.LUMINANCE_BITS,N.EMPTY=Uint8ClampedArray.from([0]);class O extends N{constructor(t){super(t),this.matrix=null}getBlackMatrix(){if(null!==this.matrix)return this.matrix;const t=this.getLuminanceSource(),e=t.getWidth(),r=t.getHeight();if(e>=O.MINIMUM_DIMENSION&&r>=O.MINIMUM_DIMENSION){const n=t.getMatrix();let i=e>>O.BLOCK_SIZE_POWER;0!=(e&O.BLOCK_SIZE_MASK)&&i++;let o=r>>O.BLOCK_SIZE_POWER;0!=(r&O.BLOCK_SIZE_MASK)&&o++;const s=O.calculateBlackPoints(n,i,o,e,r),a=new T(e,r);O.calculateThresholdForBlock(n,i,o,e,r,s,a),this.matrix=a}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(t){return new O(t)}static calculateThresholdForBlock(t,e,r,n,i,o,s){const a=i-O.BLOCK_SIZE,u=n-O.BLOCK_SIZE;for(let i=0;i<r;i++){let l=i<<O.BLOCK_SIZE_POWER;l>a&&(l=a);const h=O.cap(i,2,r-3);for(let r=0;r<e;r++){let i=r<<O.BLOCK_SIZE_POWER;i>u&&(i=u);const a=O.cap(r,2,e-3);let c=0;for(let t=-2;t<=2;t++){const e=o[h+t];c+=e[a-2]+e[a-1]+e[a]+e[a+1]+e[a+2]}const d=c/25;O.thresholdBlock(t,i,l,d,n,s)}}}static cap(t,e,r){return t<e?e:t>r?r:t}static thresholdBlock(t,e,r,n,i,o){for(let s=0,a=r*i+e;s<O.BLOCK_SIZE;s++,a+=i)for(let i=0;i<O.BLOCK_SIZE;i++)(255&t[a+i])<=n&&o.set(e+i,r+s)}static calculateBlackPoints(t,e,r,n,i){const o=i-O.BLOCK_SIZE,s=n-O.BLOCK_SIZE,a=new Array(r);for(let i=0;i<r;i++){a[i]=new Int32Array(e);let r=i<<O.BLOCK_SIZE_POWER;r>o&&(r=o);for(let o=0;o<e;o++){let e=o<<O.BLOCK_SIZE_POWER;e>s&&(e=s);let u=0,l=255,h=0;for(let i=0,o=r*n+e;i<O.BLOCK_SIZE;i++,o+=n){for(let e=0;e<O.BLOCK_SIZE;e++){const r=255&t[o+e];u+=r,r<l&&(l=r),r>h&&(h=r)}if(h-l>O.MIN_DYNAMIC_RANGE)for(i++,o+=n;i<O.BLOCK_SIZE;i++,o+=n)for(let e=0;e<O.BLOCK_SIZE;e++)u+=255&t[o+e]}let c=u>>2*O.BLOCK_SIZE_POWER;if(h-l<=O.MIN_DYNAMIC_RANGE&&(c=l/2,i>0&&o>0)){const t=(a[i-1][o]+2*a[i][o-1]+a[i-1][o-1])/4;l<t&&(c=t)}a[i][o]=c}}return a}}O.BLOCK_SIZE_POWER=3,O.BLOCK_SIZE=1<<O.BLOCK_SIZE_POWER,O.BLOCK_SIZE_MASK=O.BLOCK_SIZE-1,O.MINIMUM_DIMENSION=5*O.BLOCK_SIZE,O.MIN_DYNAMIC_RANGE=24;class D{constructor(t,e){this.width=t,this.height=e}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(t,e,r,n){throw new I("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new I("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new I("This luminance source does not support rotation by 45 degrees.")}toString(){const t=new Uint8ClampedArray(this.width);let e=new v;for(let r=0;r<this.height;r++){const n=this.getRow(r,t);for(let t=0;t<this.width;t++){const r=255&n[t];let i;i=r<64?"#":r<128?"+":r<192?".":" ",e.append(i)}e.append("\n")}return e.toString()}}class M extends D{constructor(t){super(t.getWidth(),t.getHeight()),this.delegate=t}getRow(t,e){const r=this.delegate.getRow(t,e),n=this.getWidth();for(let t=0;t<n;t++)r[t]=255-(255&r[t]);return r}getMatrix(){const t=this.delegate.getMatrix(),e=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(e);for(let n=0;n<e;n++)r[n]=255-(255&t[n]);return r}isCropSupported(){return this.delegate.isCropSupported()}crop(t,e,r,n){return new M(this.delegate.crop(t,e,r,n))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new M(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new M(this.delegate.rotateCounterClockwise45())}}class B extends D{constructor(t){super(t.width,t.height),this.canvas=t,this.tempCanvasElement=null,this.buffer=B.makeBufferFromCanvasImageData(t)}static makeBufferFromCanvasImageData(t){const e=t.getContext("2d").getImageData(0,0,t.width,t.height);return B.toGrayscaleBuffer(e.data,t.width,t.height)}static toGrayscaleBuffer(t,e,r){const n=new Uint8ClampedArray(e*r);for(let e=0,r=0,i=t.length;e<i;e+=4,r++){let i;i=0===t[e+3]?255:306*t[e]+601*t[e+1]+117*t[e+2]+512>>10,n[r]=i}return n}getRow(t,e){if(t<0||t>=this.getHeight())throw new l("Requested row is outside the image: "+t);const r=this.getWidth(),n=t*r;return null===e?e=this.buffer.slice(n,n+r):(e.length<r&&(e=new Uint8ClampedArray(r)),e.set(this.buffer.slice(n,n+r))),e}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(t,e,r,n){return super.crop(t,e,r,n),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(null===this.tempCanvasElement){const t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement}rotate(t){const e=this.getTempCanvasElement(),r=e.getContext("2d"),n=t*B.DEGREE_TO_RADIANS,i=this.canvas.width,o=this.canvas.height,s=Math.ceil(Math.abs(Math.cos(n))*i+Math.abs(Math.sin(n))*o),a=Math.ceil(Math.abs(Math.sin(n))*i+Math.abs(Math.cos(n))*o);return e.width=s,e.height=a,r.translate(s/2,a/2),r.rotate(n),r.drawImage(this.canvas,i/-2,o/-2),this.buffer=B.makeBufferFromCanvasImageData(e),this}invert(){return new M(this)}}B.DEGREE_TO_RADIANS=Math.PI/180;class P{constructor(t,e,r){this.deviceId=t,this.label=e,this.kind="videoinput",this.groupId=r||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var k,L=(globalThis||fr||self||window?(globalThis||fr||self||window||void 0).__awaiter:void 0)||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))};class x{constructor(t,e=500,r){this.reader=t,this.timeBetweenScansMillis=e,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return"undefined"!=typeof navigator}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(t){this._timeBetweenDecodingAttempts=t<0?0:t}set hints(t){this._hints=t||null}get hints(){return this._hints}listVideoInputDevices(){return L(this,void 0,void 0,(function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const t=yield navigator.mediaDevices.enumerateDevices(),e=[];for(const r of t){const t="video"===r.kind?"videoinput":r.kind;if("videoinput"!==t)continue;const n={deviceId:r.deviceId||r.id,label:r.label||`Video device ${e.length+1}`,kind:t,groupId:r.groupId};e.push(n)}return e}))}getVideoInputDevices(){return L(this,void 0,void 0,(function*(){return(yield this.listVideoInputDevices()).map((t=>new P(t.deviceId,t.label)))}))}findDeviceById(t){return L(this,void 0,void 0,(function*(){const e=yield this.listVideoInputDevices();return e?e.find((e=>e.deviceId===t)):null}))}decodeFromInputVideoDevice(t,e){return L(this,void 0,void 0,(function*(){return yield this.decodeOnceFromVideoDevice(t,e)}))}decodeOnceFromVideoDevice(t,e){return L(this,void 0,void 0,(function*(){let r;this.reset(),r=t?{deviceId:{exact:t}}:{facingMode:"environment"};const n={video:r};return yield this.decodeOnceFromConstraints(n,e)}))}decodeOnceFromConstraints(t,e){return L(this,void 0,void 0,(function*(){const r=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeOnceFromStream(r,e)}))}decodeOnceFromStream(t,e){return L(this,void 0,void 0,(function*(){this.reset();const r=yield this.attachStreamToVideo(t,e);return yield this.decodeOnce(r)}))}decodeFromInputVideoDeviceContinuously(t,e,r){return L(this,void 0,void 0,(function*(){return yield this.decodeFromVideoDevice(t,e,r)}))}decodeFromVideoDevice(t,e,r){return L(this,void 0,void 0,(function*(){let n;n=t?{deviceId:{exact:t}}:{facingMode:"environment"};const i={video:n};return yield this.decodeFromConstraints(i,e,r)}))}decodeFromConstraints(t,e,r){return L(this,void 0,void 0,(function*(){const n=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeFromStream(n,e,r)}))}decodeFromStream(t,e,r){return L(this,void 0,void 0,(function*(){this.reset();const n=yield this.attachStreamToVideo(t,e);return yield this.decodeContinuously(n,r)}))}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(t,e){return L(this,void 0,void 0,(function*(){const r=this.prepareVideoElement(e);return this.addVideoSource(r,t),this.videoElement=r,this.stream=t,yield this.playVideoOnLoadAsync(r),r}))}playVideoOnLoadAsync(t){return new Promise(((e,r)=>this.playVideoOnLoad(t,(()=>e()))))}playVideoOnLoad(t,e){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(t),t.addEventListener("ended",this.videoEndedListener),t.addEventListener("canplay",this.videoCanPlayListener),t.addEventListener("playing",e),this.tryPlayVideo(t)}isVideoPlaying(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>2}tryPlayVideo(t){return L(this,void 0,void 0,(function*(){if(this.isVideoPlaying(t))console.warn("Trying to play video that is already playing.");else try{yield t.play()}catch(t){console.warn("It was not possible to play the video.")}}))}getMediaElement(t,e){const r=document.getElementById(t);if(!r)throw new u(`element with id '${t}' not found`);if(r.nodeName.toLowerCase()!==e.toLowerCase())throw new u(`element with id '${t}' must be an ${e} element`);return r}decodeFromImage(t,e){if(!t&&!e)throw new u("either imageElement with a src set or an url must be provided");return e&&!t?this.decodeFromImageUrl(e):this.decodeFromImageElement(t)}decodeFromVideo(t,e){if(!t&&!e)throw new u("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrl(e):this.decodeFromVideoElement(t)}decodeFromVideoContinuously(t,e,r){if(void 0===t&&void 0===e)throw new u("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrlContinuously(e,r):this.decodeFromVideoElementContinuously(t,r)}decodeFromImageElement(t){if(!t)throw new u("An image element must be provided.");this.reset();const e=this.prepareImageElement(t);let r;return this.imageElement=e,r=this.isImageLoaded(e)?this.decodeOnce(e,!1,!0):this._decodeOnLoadImage(e),r}decodeFromVideoElement(t){const e=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideo(e)}decodeFromVideoElementContinuously(t,e){const r=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideoContinuously(r,e)}_decodeFromVideoElementSetup(t){if(!t)throw new u("A video element must be provided.");this.reset();const e=this.prepareVideoElement(t);return this.videoElement=e,e}decodeFromImageUrl(t){if(!t)throw new u("An URL must be provided.");this.reset();const e=this.prepareImageElement();this.imageElement=e;const r=this._decodeOnLoadImage(e);return e.src=t,r}decodeFromVideoUrl(t){if(!t)throw new u("An URL must be provided.");this.reset();const e=this.prepareVideoElement(),r=this.decodeFromVideoElement(e);return e.src=t,r}decodeFromVideoUrlContinuously(t,e){if(!t)throw new u("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),n=this.decodeFromVideoElementContinuously(r,e);return r.src=t,n}_decodeOnLoadImage(t){return new Promise(((e,r)=>{this.imageLoadedListener=()=>this.decodeOnce(t,!1,!0).then(e,r),t.addEventListener("load",this.imageLoadedListener)}))}_decodeOnLoadVideo(t){return L(this,void 0,void 0,(function*(){return yield this.playVideoOnLoadAsync(t),yield this.decodeOnce(t)}))}_decodeOnLoadVideoContinuously(t,e){return L(this,void 0,void 0,(function*(){yield this.playVideoOnLoadAsync(t),this.decodeContinuously(t,e)}))}isImageLoaded(t){return!!t.complete&&0!==t.naturalWidth}prepareImageElement(t){let e;return void 0===t&&(e=document.createElement("img"),e.width=200,e.height=200),"string"==typeof t&&(e=this.getMediaElement(t,"img")),t instanceof HTMLImageElement&&(e=t),e}prepareVideoElement(t){let e;return t||"undefined"==typeof document||(e=document.createElement("video"),e.width=200,e.height=200),"string"==typeof t&&(e=this.getMediaElement(t,"video")),t instanceof HTMLVideoElement&&(e=t),e.setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e}decodeOnce(t,e=!0,r=!0){this._stopAsyncDecode=!1;const n=(i,o)=>{if(this._stopAsyncDecode)return o(new R("Video stream has ended before any code could be detected.")),void(this._stopAsyncDecode=void 0);try{i(this.decode(t))}catch(t){const s=(t instanceof c||t instanceof E)&&r;if(e&&t instanceof R||s)return setTimeout(n,this._timeBetweenDecodingAttempts,i,o);o(t)}};return new Promise(((t,e)=>n(t,e)))}decodeContinuously(t,e){this._stopContinuousDecode=!1;const r=()=>{if(this._stopContinuousDecode)this._stopContinuousDecode=void 0;else try{const n=this.decode(t);e(n,null),setTimeout(r,this.timeBetweenScansMillis)}catch(t){e(null,t);const n=t instanceof R;(t instanceof c||t instanceof E||n)&&setTimeout(r,this._timeBetweenDecodingAttempts)}};r()}decode(t){const e=this.createBinaryBitmap(t);return this.decodeBitmap(e)}createBinaryBitmap(t){const e=this.getCaptureCanvasContext(t);this.drawImageOnCanvas(e,t);const r=this.getCaptureCanvas(t),n=new B(r),i=new O(n);return new h(i)}getCaptureCanvasContext(t){if(!this.captureCanvasContext){const e=this.getCaptureCanvas(t).getContext("2d");this.captureCanvasContext=e}return this.captureCanvasContext}getCaptureCanvas(t){if(!this.captureCanvas){const e=this.createCaptureCanvas(t);this.captureCanvas=e}return this.captureCanvas}drawImageOnCanvas(t,e){t.drawImage(e,0,0)}decodeBitmap(t){return this.reader.decode(t,this._hints)}createCaptureCanvas(t){if("undefined"==typeof document)return this._destroyCaptureCanvas(),null;const e=document.createElement("canvas");let r,n;return void 0!==t&&(t instanceof HTMLVideoElement?(r=t.videoWidth,n=t.videoHeight):t instanceof HTMLImageElement&&(r=t.naturalWidth||t.width,n=t.naturalHeight||t.height)),e.style.width=r+"px",e.style.height=n+"px",e.width=r,e.height=n,e}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach((t=>t.stop())),this.stream=void 0),!1===this._stopAsyncDecode&&this.stopAsyncDecode(),!1===this._stopContinuousDecode&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(void 0!==this.videoEndedListener&&this.videoElement.removeEventListener("ended",this.videoEndedListener),void 0!==this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),void 0!==this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(t,e){try{t.srcObject=e}catch(r){t.src=URL.createObjectURL(e)}}cleanVideoSource(t){try{t.srcObject=null}catch(e){t.src=""}this.videoElement.removeAttribute("src")}}class F{constructor(t,e,r=(null==e?0:8*e.length),n,i,o=f.currentTimeMillis()){this.text=t,this.rawBytes=e,this.numBits=r,this.resultPoints=n,this.format=i,this.timestamp=o,this.text=t,this.rawBytes=e,this.numBits=null==r?null==e?0:8*e.length:r,this.resultPoints=n,this.format=i,this.resultMetadata=null,this.timestamp=null==o?f.currentTimeMillis():o}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(t,e){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(t,e)}putAllMetadata(t){null!==t&&(null===this.resultMetadata?this.resultMetadata=t:this.resultMetadata=new Map(t))}addResultPoints(t){const e=this.resultPoints;if(null===e)this.resultPoints=t;else if(null!==t&&t.length>0){const r=new Array(e.length+t.length);f.arraycopy(e,0,r,0,e.length),f.arraycopy(t,0,r,e.length,t.length),this.resultPoints=r}}getTimestamp(){return this.timestamp}toString(){return this.text}}!function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"}(k||(k={}));var U,V=k;!function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"}(U||(U={}));var H,z,G,X,W,Y,K=U;class Z{constructor(t,e,r,n,i=-1,o=-1){this.rawBytes=t,this.text=e,this.byteSegments=r,this.ecLevel=n,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=o,this.numBits=null==t?0:8*t.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(t){this.numBits=t}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(t){this.errorsCorrected=t}getErasures(){return this.erasures}setErasures(t){this.erasures=t}getOther(){return this.other}setOther(t){this.other=t}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class j{exp(t){return this.expTable[t]}log(t){if(0===t)throw new l;return this.logTable[t]}static addOrSubtract(t,e){return t^e}}class q{constructor(t,e){if(0===e.length)throw new l;this.field=t;const r=e.length;if(r>1&&0===e[0]){let t=1;for(;t<r&&0===e[t];)t++;t===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-t),f.arraycopy(e,t,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(0===t)return this.getCoefficient(0);const e=this.coefficients;let r;if(1===t){r=0;for(let t=0,n=e.length;t!==n;t++){const n=e[t];r=j.addOrSubtract(r,n)}return r}r=e[0];const n=e.length,i=this.field;for(let o=1;o<n;o++)r=j.addOrSubtract(i.multiply(t,r),e[o]);return r}addOrSubtract(t){if(!this.field.equals(t.field))throw new l("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;let e=this.coefficients,r=t.coefficients;if(e.length>r.length){const t=e;e=r,r=t}let n=new Int32Array(r.length);const i=r.length-e.length;f.arraycopy(r,0,n,0,i);for(let t=i;t<r.length;t++)n[t]=j.addOrSubtract(e[t-i],r[t]);return new q(this.field,n)}multiply(t){if(!this.field.equals(t.field))throw new l("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();const e=this.coefficients,r=e.length,n=t.coefficients,i=n.length,o=new Int32Array(r+i-1),s=this.field;for(let t=0;t<r;t++){const r=e[t];for(let e=0;e<i;e++)o[t+e]=j.addOrSubtract(o[t+e],s.multiply(r,n[e]))}return new q(s,o)}multiplyScalar(t){if(0===t)return this.field.getZero();if(1===t)return this;const e=this.coefficients.length,r=this.field,n=new Int32Array(e),i=this.coefficients;for(let o=0;o<e;o++)n[o]=r.multiply(i[o],t);return new q(r,n)}multiplyByMonomial(t,e){if(t<0)throw new l;if(0===e)return this.field.getZero();const r=this.coefficients,n=r.length,i=new Int32Array(n+t),o=this.field;for(let t=0;t<n;t++)i[t]=o.multiply(r[t],e);return new q(o,i)}divide(t){if(!this.field.equals(t.field))throw new l("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new l("Divide by 0");const e=this.field;let r=e.getZero(),n=this;const i=t.getCoefficient(t.getDegree()),o=e.inverse(i);for(;n.getDegree()>=t.getDegree()&&!n.isZero();){const i=n.getDegree()-t.getDegree(),s=e.multiply(n.getCoefficient(n.getDegree()),o),a=t.multiplyByMonomial(i,s),u=e.buildMonomial(i,s);r=r.addOrSubtract(u),n=n.addOrSubtract(a)}return[r,n]}toString(){let t="";for(let e=this.getDegree();e>=0;e--){let r=this.getCoefficient(e);if(0!==r){if(r<0?(t+=" - ",r=-r):t.length>0&&(t+=" + "),0===e||1!==r){const e=this.field.log(r);0===e?t+="1":1===e?t+="a":(t+="a^",t+=e)}0!==e&&(1===e?t+="x":(t+="x^",t+=e))}}return t}}class Q extends a{}Q.kind="ArithmeticException";class J extends j{constructor(t,e,r){super(),this.primitive=t,this.size=e,this.generatorBase=r;const n=new Int32Array(e);let i=1;for(let r=0;r<e;r++)n[r]=i,i*=2,i>=e&&(i^=t,i&=e-1);this.expTable=n;const o=new Int32Array(e);for(let t=0;t<e-1;t++)o[n[t]]=t;this.logTable=o,this.zero=new q(this,Int32Array.from([0])),this.one=new q(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,e){if(t<0)throw new l;if(0===e)return this.zero;const r=new Int32Array(t+1);return r[0]=e,new q(this,r)}inverse(t){if(0===t)throw new Q;return this.expTable[this.size-this.logTable[t]-1]}multiply(t,e){return 0===t||0===e?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+m.toHexString(this.primitive)+","+this.size+")"}equals(t){return t===this}}J.AZTEC_DATA_12=new J(4201,4096,1),J.AZTEC_DATA_10=new J(1033,1024,1),J.AZTEC_DATA_6=new J(67,64,1),J.AZTEC_PARAM=new J(19,16,1),J.QR_CODE_FIELD_256=new J(285,256,0),J.DATA_MATRIX_FIELD_256=new J(301,256,1),J.AZTEC_DATA_8=J.DATA_MATRIX_FIELD_256,J.MAXICODE_FIELD_64=J.AZTEC_DATA_6;class $ extends a{}$.kind="ReedSolomonException";class tt extends a{}tt.kind="IllegalStateException";class et{constructor(t){this.field=t}decode(t,e){const r=this.field,n=new q(r,t),i=new Int32Array(e);let o=!0;for(let t=0;t<e;t++){const e=n.evaluateAt(r.exp(t+r.getGeneratorBase()));i[i.length-1-t]=e,0!==e&&(o=!1)}if(o)return;const s=new q(r,i),a=this.runEuclideanAlgorithm(r.buildMonomial(e,1),s,e),u=a[0],l=a[1],h=this.findErrorLocations(u),c=this.findErrorMagnitudes(l,h);for(let e=0;e<h.length;e++){const n=t.length-1-r.log(h[e]);if(n<0)throw new $("Bad error location");t[n]=J.addOrSubtract(t[n],c[e])}}runEuclideanAlgorithm(t,e,r){if(t.getDegree()<e.getDegree()){const r=t;t=e,e=r}const n=this.field;let i=t,o=e,s=n.getZero(),a=n.getOne();for(;o.getDegree()>=(r/2|0);){let t=i,e=s;if(i=o,s=a,i.isZero())throw new $("r_{i-1} was zero");o=t;let r=n.getZero();const u=i.getCoefficient(i.getDegree()),l=n.inverse(u);for(;o.getDegree()>=i.getDegree()&&!o.isZero();){const t=o.getDegree()-i.getDegree(),e=n.multiply(o.getCoefficient(o.getDegree()),l);r=r.addOrSubtract(n.buildMonomial(t,e)),o=o.addOrSubtract(i.multiplyByMonomial(t,e))}if(a=r.multiply(s).addOrSubtract(e),o.getDegree()>=i.getDegree())throw new tt("Division algorithm failed to reduce polynomial?")}const u=a.getCoefficient(0);if(0===u)throw new $("sigmaTilde(0) was zero");const l=n.inverse(u);return[a.multiplyScalar(l),o.multiplyScalar(l)]}findErrorLocations(t){const e=t.getDegree();if(1===e)return Int32Array.from([t.getCoefficient(1)]);const r=new Int32Array(e);let n=0;const i=this.field;for(let o=1;o<i.getSize()&&n<e;o++)0===t.evaluateAt(o)&&(r[n]=i.inverse(o),n++);if(n!==e)throw new $("Error locator degree does not match number of roots");return r}findErrorMagnitudes(t,e){const r=e.length,n=new Int32Array(r),i=this.field;for(let o=0;o<r;o++){const s=i.inverse(e[o]);let a=1;for(let t=0;t<r;t++)if(o!==t){const r=i.multiply(e[t],s),n=0==(1&r)?1|r:-2&r;a=i.multiply(a,n)}n[o]=i.multiply(t.evaluateAt(s),i.inverse(a)),0!==i.getGeneratorBase()&&(n[o]=i.multiply(n[o],s))}return n}}!function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"}(H||(H={}));class rt{decode(t){this.ddata=t;let e=t.getBits(),r=this.extractBits(e),n=this.correctBits(r),i=rt.convertBoolArrayToByteArray(n),o=rt.getEncodedData(n),s=new Z(i,o,null,null);return s.setNumBits(n.length),s}static highLevelDecode(t){return this.getEncodedData(t)}static getEncodedData(t){let e=t.length,r=H.UPPER,n=H.UPPER,i="",o=0;for(;o<e;)if(n===H.BINARY){if(e-o<5)break;let s=rt.readCode(t,o,5);if(o+=5,0===s){if(e-o<11)break;s=rt.readCode(t,o,11)+31,o+=11}for(let r=0;r<s;r++){if(e-o<8){o=e;break}const r=rt.readCode(t,o,8);i+=S.castAsNonUtf8Char(r),o+=8}n=r}else{let s=n===H.DIGIT?4:5;if(e-o<s)break;let a=rt.readCode(t,o,s);o+=s;let u=rt.getCharacter(n,a);u.startsWith("CTRL_")?(r=n,n=rt.getTable(u.charAt(5)),"L"===u.charAt(6)&&(r=n)):(i+=u,n=r)}return i}static getTable(t){switch(t){case"L":return H.LOWER;case"P":return H.PUNCT;case"M":return H.MIXED;case"D":return H.DIGIT;case"B":return H.BINARY;case"U":default:return H.UPPER}}static getCharacter(t,e){switch(t){case H.UPPER:return rt.UPPER_TABLE[e];case H.LOWER:return rt.LOWER_TABLE[e];case H.MIXED:return rt.MIXED_TABLE[e];case H.PUNCT:return rt.PUNCT_TABLE[e];case H.DIGIT:return rt.DIGIT_TABLE[e];default:throw new tt("Bad table")}}correctBits(t){let e,r;this.ddata.getNbLayers()<=2?(r=6,e=J.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,e=J.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,e=J.AZTEC_DATA_10):(r=12,e=J.AZTEC_DATA_12);let n=this.ddata.getNbDatablocks(),i=t.length/r;if(i<n)throw new E;let o=t.length%r,s=new Int32Array(i);for(let e=0;e<i;e++,o+=r)s[e]=rt.readCode(t,o,r);try{new et(e).decode(s,i-n)}catch(t){throw new E(t)}let a=(1<<r)-1,u=0;for(let t=0;t<n;t++){let e=s[t];if(0===e||e===a)throw new E;1!==e&&e!==a-1||u++}let l=new Array(n*r-u),h=0;for(let t=0;t<n;t++){let e=s[t];if(1===e||e===a-1)l.fill(e>1,h,h+r-1),h+=r-1;else for(let t=r-1;t>=0;--t)l[h++]=0!=(e&1<<t)}return l}extractBits(t){let e=this.ddata.isCompact(),r=this.ddata.getNbLayers(),n=(e?11:14)+4*r,i=new Int32Array(n),o=new Array(this.totalBitsInLayer(r,e));if(e)for(let t=0;t<i.length;t++)i[t]=t;else{let t=n+1+2*m.truncDivision(m.truncDivision(n,2)-1,15),e=n/2,r=m.truncDivision(t,2);for(let t=0;t<e;t++){let n=t+m.truncDivision(t,15);i[e-t-1]=r-n-1,i[e+t]=r+n+1}}for(let s=0,a=0;s<r;s++){let u=4*(r-s)+(e?9:12),l=2*s,h=n-1-l;for(let e=0;e<u;e++){let r=2*e;for(let n=0;n<2;n++)o[a+r+n]=t.get(i[l+n],i[l+e]),o[a+2*u+r+n]=t.get(i[l+e],i[h-n]),o[a+4*u+r+n]=t.get(i[h-n],i[h-e]),o[a+6*u+r+n]=t.get(i[h-e],i[l+n])}a+=8*u}return o}static readCode(t,e,r){let n=0;for(let i=e;i<e+r;i++)n<<=1,t[i]&&(n|=1);return n}static readByte(t,e){let r=t.length-e;return r>=8?rt.readCode(t,e,8):rt.readCode(t,e,r)<<8-r}static convertBoolArrayToByteArray(t){let e=new Uint8Array((t.length+7)/8);for(let r=0;r<e.length;r++)e[r]=rt.readByte(t,8*r);return e}totalBitsInLayer(t,e){return((e?88:112)+16*t)*t}}rt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],rt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],rt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","\t","\n","\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],rt.PUNCT_TABLE=["","\r","\r\n",". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],rt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class nt{constructor(){}static round(t){return NaN===t?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0}static distance(t,e,r,n){const i=t-r,o=e-n;return Math.sqrt(i*i+o*o)}static sum(t){let e=0;for(let r=0,n=t.length;r!==n;r++)e+=t[r];return e}}class it{static floatToIntBits(t){return t}}it.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ot{constructor(t,e){this.x=t,this.y=e}getX(){return this.x}getY(){return this.y}equals(t){if(t instanceof ot){const e=t;return this.x===e.x&&this.y===e.y}return!1}hashCode(){return 31*it.floatToIntBits(this.x)+it.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(t){const e=this.distance(t[0],t[1]),r=this.distance(t[1],t[2]),n=this.distance(t[0],t[2]);let i,o,s;if(r>=e&&r>=n?(o=t[0],i=t[1],s=t[2]):n>=r&&n>=e?(o=t[1],i=t[0],s=t[2]):(o=t[2],i=t[0],s=t[1]),this.crossProductZ(i,o,s)<0){const t=i;i=s,s=t}t[0]=i,t[1]=o,t[2]=s}static distance(t,e){return nt.distance(t.x,t.y,e.x,e.y)}static crossProductZ(t,e,r){const n=e.x,i=e.y;return(r.x-n)*(t.y-i)-(r.y-i)*(t.x-n)}}class st{constructor(t,e){this.bits=t,this.points=e}getBits(){return this.bits}getPoints(){return this.points}}class at extends st{constructor(t,e,r,n,i){super(t,e),this.compact=r,this.nbDatablocks=n,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class ut{constructor(t,e,r,n){this.image=t,this.height=t.getHeight(),this.width=t.getWidth(),null==e&&(e=ut.INIT_SIZE),null==r&&(r=t.getWidth()/2|0),null==n&&(n=t.getHeight()/2|0);const i=e/2|0;if(this.leftInit=r-i,this.rightInit=r+i,this.upInit=n-i,this.downInit=n+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new R}detect(){let t=this.leftInit,e=this.rightInit,r=this.upInit,n=this.downInit,i=!1,o=!0,s=!1,a=!1,u=!1,l=!1,h=!1;const c=this.width,d=this.height;for(;o;){o=!1;let f=!0;for(;(f||!a)&&e<c;)f=this.containsBlackPoint(r,n,e,!1),f?(e++,o=!0,a=!0):a||e++;if(e>=c){i=!0;break}let g=!0;for(;(g||!u)&&n<d;)g=this.containsBlackPoint(t,e,n,!0),g?(n++,o=!0,u=!0):u||n++;if(n>=d){i=!0;break}let w=!0;for(;(w||!l)&&t>=0;)w=this.containsBlackPoint(r,n,t,!1),w?(t--,o=!0,l=!0):l||t--;if(t<0){i=!0;break}let p=!0;for(;(p||!h)&&r>=0;)p=this.containsBlackPoint(t,e,r,!0),p?(r--,o=!0,h=!0):h||r--;if(r<0){i=!0;break}o&&(s=!0)}if(!i&&s){const i=e-t;let o=null;for(let e=1;null===o&&e<i;e++)o=this.getBlackPointOnSegment(t,n-e,t+e,n);if(null==o)throw new R;let s=null;for(let e=1;null===s&&e<i;e++)s=this.getBlackPointOnSegment(t,r+e,t+e,r);if(null==s)throw new R;let a=null;for(let t=1;null===a&&t<i;t++)a=this.getBlackPointOnSegment(e,r+t,e-t,r);if(null==a)throw new R;let u=null;for(let t=1;null===u&&t<i;t++)u=this.getBlackPointOnSegment(e,n-t,e-t,n);if(null==u)throw new R;return this.centerEdges(u,o,a,s)}throw new R}getBlackPointOnSegment(t,e,r,n){const i=nt.round(nt.distance(t,e,r,n)),o=(r-t)/i,s=(n-e)/i,a=this.image;for(let r=0;r<i;r++){const n=nt.round(t+r*o),i=nt.round(e+r*s);if(a.get(n,i))return new ot(n,i)}return null}centerEdges(t,e,r,n){const i=t.getX(),o=t.getY(),s=e.getX(),a=e.getY(),u=r.getX(),l=r.getY(),h=n.getX(),c=n.getY(),d=ut.CORR;return i<this.width/2?[new ot(h-d,c+d),new ot(s+d,a+d),new ot(u-d,l-d),new ot(i+d,o-d)]:[new ot(h+d,c+d),new ot(s+d,a-d),new ot(u-d,l+d),new ot(i-d,o-d)]}containsBlackPoint(t,e,r,n){const i=this.image;if(n){for(let n=t;n<=e;n++)if(i.get(n,r))return!0}else for(let n=t;n<=e;n++)if(i.get(r,n))return!0;return!1}}ut.INIT_SIZE=10,ut.CORR=1;class lt{static checkAndNudgePoints(t,e){const r=t.getWidth(),n=t.getHeight();let i=!0;for(let t=0;t<e.length&&i;t+=2){const o=Math.floor(e[t]),s=Math.floor(e[t+1]);if(o<-1||o>r||s<-1||s>n)throw new R;i=!1,-1===o?(e[t]=0,i=!0):o===r&&(e[t]=r-1,i=!0),-1===s?(e[t+1]=0,i=!0):s===n&&(e[t+1]=n-1,i=!0)}i=!0;for(let t=e.length-2;t>=0&&i;t-=2){const o=Math.floor(e[t]),s=Math.floor(e[t+1]);if(o<-1||o>r||s<-1||s>n)throw new R;i=!1,-1===o?(e[t]=0,i=!0):o===r&&(e[t]=r-1,i=!0),-1===s?(e[t+1]=0,i=!0):s===n&&(e[t+1]=n-1,i=!0)}}}class ht{constructor(t,e,r,n,i,o,s,a,u){this.a11=t,this.a21=e,this.a31=r,this.a12=n,this.a22=i,this.a32=o,this.a13=s,this.a23=a,this.a33=u}static quadrilateralToQuadrilateral(t,e,r,n,i,o,s,a,u,l,h,c,d,f,g,w){const p=ht.quadrilateralToSquare(t,e,r,n,i,o,s,a);return ht.squareToQuadrilateral(u,l,h,c,d,f,g,w).times(p)}transformPoints(t){const e=t.length,r=this.a11,n=this.a12,i=this.a13,o=this.a21,s=this.a22,a=this.a23,u=this.a31,l=this.a32,h=this.a33;for(let c=0;c<e;c+=2){const e=t[c],d=t[c+1],f=i*e+a*d+h;t[c]=(r*e+o*d+u)/f,t[c+1]=(n*e+s*d+l)/f}}transformPointsWithValues(t,e){const r=this.a11,n=this.a12,i=this.a13,o=this.a21,s=this.a22,a=this.a23,u=this.a31,l=this.a32,h=this.a33,c=t.length;for(let d=0;d<c;d++){const c=t[d],f=e[d],g=i*c+a*f+h;t[d]=(r*c+o*f+u)/g,e[d]=(n*c+s*f+l)/g}}static squareToQuadrilateral(t,e,r,n,i,o,s,a){const u=t-r+i-s,l=e-n+o-a;if(0===u&&0===l)return new ht(r-t,i-r,t,n-e,o-n,e,0,0,1);{const h=r-i,c=s-i,d=n-o,f=a-o,g=h*f-c*d,w=(u*f-c*l)/g,p=(h*l-u*d)/g;return new ht(r-t+w*r,s-t+p*s,t,n-e+w*n,a-e+p*a,e,w,p,1)}}static quadrilateralToSquare(t,e,r,n,i,o,s,a){return ht.squareToQuadrilateral(t,e,r,n,i,o,s,a).buildAdjoint()}buildAdjoint(){return new ht(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(t){return new ht(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)}}class ct extends lt{sampleGrid(t,e,r,n,i,o,s,a,u,l,h,c,d,f,g,w,p,m,_){const A=ht.quadrilateralToQuadrilateral(n,i,o,s,a,u,l,h,c,d,f,g,w,p,m,_);return this.sampleGridWithTransform(t,e,r,A)}sampleGridWithTransform(t,e,r,n){if(e<=0||r<=0)throw new R;const i=new T(e,r),o=new Float32Array(2*e);for(let e=0;e<r;e++){const r=o.length,s=e+.5;for(let t=0;t<r;t+=2)o[t]=t/2+.5,o[t+1]=s;n.transformPoints(o),lt.checkAndNudgePoints(t,o);try{for(let n=0;n<r;n+=2)t.get(Math.floor(o[n]),Math.floor(o[n+1]))&&i.set(n/2,e)}catch(t){throw new R}}return i}}class dt{static setGridSampler(t){dt.gridSampler=t}static getInstance(){return dt.gridSampler}}dt.gridSampler=new ct;class ft{constructor(t,e){this.x=t,this.y=e}toResultPoint(){return new ot(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class gt{constructor(t){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=t}detect(){return this.detectMirror(!1)}detectMirror(t){let e=this.getMatrixCenter(),r=this.getBullsEyeCorners(e);if(t){let t=r[0];r[0]=r[2],r[2]=t}this.extractParameters(r);let n=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),i=this.getMatrixCornerPoints(r);return new at(n,i,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(t){if(!(this.isValidPoint(t[0])&&this.isValidPoint(t[1])&&this.isValidPoint(t[2])&&this.isValidPoint(t[3])))throw new R;let e=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(t[0],t[1],e),this.sampleLine(t[1],t[2],e),this.sampleLine(t[2],t[3],e),this.sampleLine(t[3],t[0],e)]);this.shift=this.getRotation(r,e);let n=0;for(let t=0;t<4;t++){let e=r[(this.shift+t)%4];this.compact?(n<<=7,n+=e>>1&127):(n<<=10,n+=(e>>2&992)+(e>>1&31))}let i=this.getCorrectedParameterData(n,this.compact);this.compact?(this.nbLayers=1+(i>>6),this.nbDataBlocks=1+(63&i)):(this.nbLayers=1+(i>>11),this.nbDataBlocks=1+(2047&i))}getRotation(t,e){let r=0;t.forEach(((t,n,i)=>{r=(t>>e-2<<1)+(1&t)+(r<<3)})),r=((1&r)<<11)+(r>>1);for(let t=0;t<4;t++)if(m.bitCount(r^this.EXPECTED_CORNER_BITS[t])<=2)return t;throw new R}getCorrectedParameterData(t,e){let r,n;e?(r=7,n=2):(r=10,n=4);let i=r-n,o=new Int32Array(r);for(let e=r-1;e>=0;--e)o[e]=15&t,t>>=4;try{new et(J.AZTEC_PARAM).decode(o,i)}catch(t){throw new R}let s=0;for(let t=0;t<n;t++)s=(s<<4)+o[t];return s}getBullsEyeCorners(t){let e=t,r=t,n=t,i=t,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let t=this.getFirstDifferent(e,o,1,-1),s=this.getFirstDifferent(r,o,1,1),a=this.getFirstDifferent(n,o,-1,1),u=this.getFirstDifferent(i,o,-1,-1);if(this.nbCenterLayers>2){let r=this.distancePoint(u,t)*this.nbCenterLayers/(this.distancePoint(i,e)*(this.nbCenterLayers+2));if(r<.75||r>1.25||!this.isWhiteOrBlackRectangle(t,s,a,u))break}e=t,r=s,n=a,i=u,o=!o}if(5!==this.nbCenterLayers&&7!==this.nbCenterLayers)throw new R;this.compact=5===this.nbCenterLayers;let s=new ot(e.getX()+.5,e.getY()-.5),a=new ot(r.getX()+.5,r.getY()+.5),u=new ot(n.getX()-.5,n.getY()+.5),l=new ot(i.getX()-.5,i.getY()-.5);return this.expandSquare([s,a,u,l],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let t,e,r,n;try{let i=new ut(this.image).detect();t=i[0],e=i[1],r=i[2],n=i[3]}catch(i){let o=this.image.getWidth()/2,s=this.image.getHeight()/2;t=this.getFirstDifferent(new ft(o+7,s-7),!1,1,-1).toResultPoint(),e=this.getFirstDifferent(new ft(o+7,s+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new ft(o-7,s+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new ft(o-7,s-7),!1,-1,-1).toResultPoint()}let i=nt.round((t.getX()+n.getX()+e.getX()+r.getX())/4),o=nt.round((t.getY()+n.getY()+e.getY()+r.getY())/4);try{let s=new ut(this.image,15,i,o).detect();t=s[0],e=s[1],r=s[2],n=s[3]}catch(s){t=this.getFirstDifferent(new ft(i+7,o-7),!1,1,-1).toResultPoint(),e=this.getFirstDifferent(new ft(i+7,o+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new ft(i-7,o+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new ft(i-7,o-7),!1,-1,-1).toResultPoint()}return i=nt.round((t.getX()+n.getX()+e.getX()+r.getX())/4),o=nt.round((t.getY()+n.getY()+e.getY()+r.getY())/4),new ft(i,o)}getMatrixCornerPoints(t){return this.expandSquare(t,2*this.nbCenterLayers,this.getDimension())}sampleGrid(t,e,r,n,i){let o=dt.getInstance(),s=this.getDimension(),a=s/2-this.nbCenterLayers,u=s/2+this.nbCenterLayers;return o.sampleGrid(t,s,s,a,a,u,a,u,u,a,u,e.getX(),e.getY(),r.getX(),r.getY(),n.getX(),n.getY(),i.getX(),i.getY())}sampleLine(t,e,r){let n=0,i=this.distanceResultPoint(t,e),o=i/r,s=t.getX(),a=t.getY(),u=o*(e.getX()-t.getX())/i,l=o*(e.getY()-t.getY())/i;for(let t=0;t<r;t++)this.image.get(nt.round(s+t*u),nt.round(a+t*l))&&(n|=1<<r-t-1);return n}isWhiteOrBlackRectangle(t,e,r,n){let i=3;t=new ft(t.getX()-i,t.getY()+i),e=new ft(e.getX()-i,e.getY()-i),r=new ft(r.getX()+i,r.getY()-i),n=new ft(n.getX()+i,n.getY()+i);let o=this.getColor(n,t);if(0===o)return!1;let s=this.getColor(t,e);return s===o&&(s=this.getColor(e,r),s===o&&(s=this.getColor(r,n),s===o))}getColor(t,e){let r=this.distancePoint(t,e),n=(e.getX()-t.getX())/r,i=(e.getY()-t.getY())/r,o=0,s=t.getX(),a=t.getY(),u=this.image.get(t.getX(),t.getY()),l=Math.ceil(r);for(let t=0;t<l;t++)s+=n,a+=i,this.image.get(nt.round(s),nt.round(a))!==u&&o++;let h=o/r;return h>.1&&h<.9?0:h<=.1===u?1:-1}getFirstDifferent(t,e,r,n){let i=t.getX()+r,o=t.getY()+n;for(;this.isValid(i,o)&&this.image.get(i,o)===e;)i+=r,o+=n;for(i-=r,o-=n;this.isValid(i,o)&&this.image.get(i,o)===e;)i+=r;for(i-=r;this.isValid(i,o)&&this.image.get(i,o)===e;)o+=n;return o-=n,new ft(i,o)}expandSquare(t,e,r){let n=r/(2*e),i=t[0].getX()-t[2].getX(),o=t[0].getY()-t[2].getY(),s=(t[0].getX()+t[2].getX())/2,a=(t[0].getY()+t[2].getY())/2,u=new ot(s+n*i,a+n*o),l=new ot(s-n*i,a-n*o);return i=t[1].getX()-t[3].getX(),o=t[1].getY()-t[3].getY(),s=(t[1].getX()+t[3].getX())/2,a=(t[1].getY()+t[3].getY())/2,[u,new ot(s+n*i,a+n*o),l,new ot(s-n*i,a-n*o)]}isValid(t,e){return t>=0&&t<this.image.getWidth()&&e>0&&e<this.image.getHeight()}isValidPoint(t){let e=nt.round(t.getX()),r=nt.round(t.getY());return this.isValid(e,r)}distancePoint(t,e){return nt.distance(t.getX(),t.getY(),e.getX(),e.getY())}distanceResultPoint(t,e){return nt.distance(t.getX(),t.getY(),e.getX(),e.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(m.truncDivision(this.nbLayers-4,8)+1)+15}}class wt{decode(t,e=null){let r=null,n=new gt(t.getBlackMatrix()),i=null,o=null;try{let t=n.detectMirror(!1);i=t.getPoints(),this.reportFoundResultPoints(e,i),o=(new rt).decode(t)}catch(t){r=t}if(null==o)try{let t=n.detectMirror(!0);i=t.getPoints(),this.reportFoundResultPoints(e,i),o=(new rt).decode(t)}catch(t){if(null!=r)throw r;throw t}let s=new F(o.getText(),o.getRawBytes(),o.getNumBits(),i,V.AZTEC,f.currentTimeMillis()),a=o.getByteSegments();null!=a&&s.putMetadata(K.BYTE_SEGMENTS,a);let u=o.getECLevel();return null!=u&&s.putMetadata(K.ERROR_CORRECTION_LEVEL,u),s}reportFoundResultPoints(t,e){if(null!=t){let r=t.get(y.NEED_RESULT_POINT_CALLBACK);null!=r&&e.forEach(((t,e,n)=>{r.foundPossibleResultPoint(t)}))}}reset(){}}class pt extends x{constructor(t=500){super(new wt,t)}}class mt{decode(t,e){try{return this.doDecode(t,e)}catch(r){if(e&&!0===e.get(y.TRY_HARDER)&&t.isRotateSupported()){const r=t.rotateCounterClockwise(),n=this.doDecode(r,e),i=n.getResultMetadata();let o=270;null!==i&&!0===i.get(K.ORIENTATION)&&(o+=i.get(K.ORIENTATION)%360),n.putMetadata(K.ORIENTATION,o);const s=n.getResultPoints();if(null!==s){const t=r.getHeight();for(let e=0;e<s.length;e++)s[e]=new ot(t-s[e].getY()-1,s[e].getX())}return n}throw new R}}reset(){}doDecode(t,e){const r=t.getWidth(),n=t.getHeight();let i=new _(r);const o=e&&!0===e.get(y.TRY_HARDER),s=Math.max(1,n>>(o?8:5));let a;a=o?n:15;const u=Math.trunc(n/2);for(let o=0;o<a;o++){const a=Math.trunc((o+1)/2),l=u+s*(0==(1&o)?a:-a);if(l<0||l>=n)break;try{i=t.getBlackRow(l,i)}catch(t){continue}for(let t=0;t<2;t++){if(1===t&&(i.reverse(),e&&!0===e.get(y.NEED_RESULT_POINT_CALLBACK))){const t=new Map;e.forEach(((e,r)=>t.set(r,e))),t.delete(y.NEED_RESULT_POINT_CALLBACK),e=t}try{const n=this.decodeRow(l,i,e);if(1===t){n.putMetadata(K.ORIENTATION,180);const t=n.getResultPoints();null!==t&&(t[0]=new ot(r-t[0].getX()-1,t[0].getY()),t[1]=new ot(r-t[1].getX()-1,t[1].getY()))}return n}catch(t){}}}throw new R}static recordPattern(t,e,r){const n=r.length;for(let t=0;t<n;t++)r[t]=0;const i=t.getSize();if(e>=i)throw new R;let o=!t.get(e),s=0,a=e;for(;a<i;){if(t.get(a)!==o)r[s]++;else{if(++s===n)break;r[s]=1,o=!o}a++}if(s!==n&&(s!==n-1||a!==i))throw new R}static recordPatternInReverse(t,e,r){let n=r.length,i=t.get(e);for(;e>0&&n>=0;)t.get(--e)!==i&&(n--,i=!i);if(n>=0)throw new R;mt.recordPattern(t,e+1,r)}static patternMatchVariance(t,e,r){const n=t.length;let i=0,o=0;for(let r=0;r<n;r++)i+=t[r],o+=e[r];if(i<o)return Number.POSITIVE_INFINITY;const s=i/o;r*=s;let a=0;for(let i=0;i<n;i++){const n=t[i],o=e[i]*s,u=n>o?n-o:o-n;if(u>r)return Number.POSITIVE_INFINITY;a+=u}return a/i}}class _t extends mt{static findStartPattern(t){const e=t.getSize(),r=t.getNextSet(0);let n=0,i=Int32Array.from([0,0,0,0,0,0]),o=r,s=!1;const a=6;for(let u=r;u<e;u++)if(t.get(u)!==s)i[n]++;else{if(n===a-1){let e=_t.MAX_AVG_VARIANCE,r=-1;for(let t=_t.CODE_START_A;t<=_t.CODE_START_C;t++){const n=mt.patternMatchVariance(i,_t.CODE_PATTERNS[t],_t.MAX_INDIVIDUAL_VARIANCE);n<e&&(e=n,r=t)}if(r>=0&&t.isRange(Math.max(0,o-(u-o)/2),o,!1))return Int32Array.from([o,u,r]);o+=i[0]+i[1],i=i.slice(2,i.length-1),i[n-1]=0,i[n]=0,n--}else n++;i[n]=1,s=!s}throw new R}static decodeCode(t,e,r){mt.recordPattern(t,r,e);let n=_t.MAX_AVG_VARIANCE,i=-1;for(let t=0;t<_t.CODE_PATTERNS.length;t++){const r=_t.CODE_PATTERNS[t],o=this.patternMatchVariance(e,r,_t.MAX_INDIVIDUAL_VARIANCE);o<n&&(n=o,i=t)}if(i>=0)return i;throw new R}decodeRow(t,e,r){const n=r&&!0===r.get(y.ASSUME_GS1),i=_t.findStartPattern(e),o=i[2];let s=0;const a=new Uint8Array(20);let u;switch(a[s++]=o,o){case _t.CODE_START_A:u=_t.CODE_CODE_A;break;case _t.CODE_START_B:u=_t.CODE_CODE_B;break;case _t.CODE_START_C:u=_t.CODE_CODE_C;break;default:throw new E}let l=!1,h=!1,d="",f=i[0],g=i[1];const w=Int32Array.from([0,0,0,0,0,0]);let p=0,m=0,_=o,A=0,C=!0,I=!1,b=!1;for(;!l;){const t=h;switch(h=!1,p=m,m=_t.decodeCode(e,w,g),a[s++]=m,m!==_t.CODE_STOP&&(C=!0),m!==_t.CODE_STOP&&(A++,_+=A*m),f=g,g+=w.reduce(((t,e)=>t+e),0),m){case _t.CODE_START_A:case _t.CODE_START_B:case _t.CODE_START_C:throw new E}switch(u){case _t.CODE_CODE_A:if(m<64)d+=b===I?String.fromCharCode(" ".charCodeAt(0)+m):String.fromCharCode(" ".charCodeAt(0)+m+128),b=!1;else if(m<96)d+=b===I?String.fromCharCode(m-64):String.fromCharCode(m+64),b=!1;else switch(m!==_t.CODE_STOP&&(C=!1),m){case _t.CODE_FNC_1:n&&(0===d.length?d+="]C1":d+=String.fromCharCode(29));break;case _t.CODE_FNC_2:case _t.CODE_FNC_3:break;case _t.CODE_FNC_4_A:!I&&b?(I=!0,b=!1):I&&b?(I=!1,b=!1):b=!0;break;case _t.CODE_SHIFT:h=!0,u=_t.CODE_CODE_B;break;case _t.CODE_CODE_B:u=_t.CODE_CODE_B;break;case _t.CODE_CODE_C:u=_t.CODE_CODE_C;break;case _t.CODE_STOP:l=!0}break;case _t.CODE_CODE_B:if(m<96)d+=b===I?String.fromCharCode(" ".charCodeAt(0)+m):String.fromCharCode(" ".charCodeAt(0)+m+128),b=!1;else switch(m!==_t.CODE_STOP&&(C=!1),m){case _t.CODE_FNC_1:n&&(0===d.length?d+="]C1":d+=String.fromCharCode(29));break;case _t.CODE_FNC_2:case _t.CODE_FNC_3:break;case _t.CODE_FNC_4_B:!I&&b?(I=!0,b=!1):I&&b?(I=!1,b=!1):b=!0;break;case _t.CODE_SHIFT:h=!0,u=_t.CODE_CODE_A;break;case _t.CODE_CODE_A:u=_t.CODE_CODE_A;break;case _t.CODE_CODE_C:u=_t.CODE_CODE_C;break;case _t.CODE_STOP:l=!0}break;case _t.CODE_CODE_C:if(m<100)m<10&&(d+="0"),d+=m;else switch(m!==_t.CODE_STOP&&(C=!1),m){case _t.CODE_FNC_1:n&&(0===d.length?d+="]C1":d+=String.fromCharCode(29));break;case _t.CODE_CODE_A:u=_t.CODE_CODE_A;break;case _t.CODE_CODE_B:u=_t.CODE_CODE_B;break;case _t.CODE_STOP:l=!0}}t&&(u=u===_t.CODE_CODE_A?_t.CODE_CODE_B:_t.CODE_CODE_A)}const S=g-f;if(g=e.getNextUnset(g),!e.isRange(g,Math.min(e.getSize(),g+(g-f)/2),!1))throw new R;if(_-=A*p,_%103!==p)throw new c;const v=d.length;if(0===v)throw new R;v>0&&C&&(d=u===_t.CODE_CODE_C?d.substring(0,v-2):d.substring(0,v-1));const T=(i[1]+i[0])/2,N=f+S/2,O=a.length,D=new Uint8Array(O);for(let t=0;t<O;t++)D[t]=a[t];const M=[new ot(T,t),new ot(N,t)];return new F(d,D,0,M,V.CODE_128,(new Date).getTime())}}_t.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],_t.MAX_AVG_VARIANCE=.25,_t.MAX_INDIVIDUAL_VARIANCE=.7,_t.CODE_SHIFT=98,_t.CODE_CODE_C=99,_t.CODE_CODE_B=100,_t.CODE_CODE_A=101,_t.CODE_FNC_1=102,_t.CODE_FNC_2=97,_t.CODE_FNC_3=96,_t.CODE_FNC_4_A=101,_t.CODE_FNC_4_B=100,_t.CODE_START_A=103,_t.CODE_START_B=104,_t.CODE_START_C=105,_t.CODE_STOP=106;class At extends mt{constructor(t=!1,e=!1){super(),this.usingCheckDigit=t,this.extendedMode=e,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(t,e,r){let n=this.counters;n.fill(0),this.decodeRowResult="";let i,o,s=At.findAsteriskPattern(e,n),a=e.getNextSet(s[1]),u=e.getSize();do{At.recordPattern(e,a,n);let t=At.toNarrowWidePattern(n);if(t<0)throw new R;i=At.patternToChar(t),this.decodeRowResult+=i,o=a;for(let t of n)a+=t;a=e.getNextSet(a)}while("*"!==i);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let l,h=0;for(let t of n)h+=t;if(a!==u&&2*(a-o-h)<h)throw new R;if(this.usingCheckDigit){let t=this.decodeRowResult.length-1,e=0;for(let r=0;r<t;r++)e+=At.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(r));if(this.decodeRowResult.charAt(t)!==At.ALPHABET_STRING.charAt(e%43))throw new c;this.decodeRowResult=this.decodeRowResult.substring(0,t)}if(0===this.decodeRowResult.length)throw new R;l=this.extendedMode?At.decodeExtended(this.decodeRowResult):this.decodeRowResult;let d=(s[1]+s[0])/2,f=o+h/2;return new F(l,null,0,[new ot(d,t),new ot(f,t)],V.CODE_39,(new Date).getTime())}static findAsteriskPattern(t,e){let r=t.getSize(),n=t.getNextSet(0),i=0,o=n,s=!1,a=e.length;for(let u=n;u<r;u++)if(t.get(u)!==s)e[i]++;else{if(i===a-1){if(this.toNarrowWidePattern(e)===At.ASTERISK_ENCODING&&t.isRange(Math.max(0,o-Math.floor((u-o)/2)),o,!1))return[o,u];o+=e[0]+e[1],e.copyWithin(0,2,2+i-1),e[i-1]=0,e[i]=0,i--}else i++;e[i]=1,s=!s}throw new R}static toNarrowWidePattern(t){let e,r=t.length,n=0;do{let i=2147483647;for(let e of t)e<i&&e>n&&(i=e);n=i,e=0;let o=0,s=0;for(let i=0;i<r;i++){let a=t[i];a>n&&(s|=1<<r-1-i,e++,o+=a)}if(3===e){for(let i=0;i<r&&e>0;i++){let r=t[i];if(r>n&&(e--,2*r>=o))return-1}return s}}while(e>3);return-1}static patternToChar(t){for(let e=0;e<At.CHARACTER_ENCODINGS.length;e++)if(At.CHARACTER_ENCODINGS[e]===t)return At.ALPHABET_STRING.charAt(e);if(t===At.ASTERISK_ENCODING)return"*";throw new R}static decodeExtended(t){let e=t.length,r="";for(let n=0;n<e;n++){let e=t.charAt(n);if("+"===e||"$"===e||"%"===e||"/"===e){let i=t.charAt(n+1),o="\0";switch(e){case"+":if(!(i>="A"&&i<="Z"))throw new E;o=String.fromCharCode(i.charCodeAt(0)+32);break;case"$":if(!(i>="A"&&i<="Z"))throw new E;o=String.fromCharCode(i.charCodeAt(0)-64);break;case"%":if(i>="A"&&i<="E")o=String.fromCharCode(i.charCodeAt(0)-38);else if(i>="F"&&i<="J")o=String.fromCharCode(i.charCodeAt(0)-11);else if(i>="K"&&i<="O")o=String.fromCharCode(i.charCodeAt(0)+16);else if(i>="P"&&i<="T")o=String.fromCharCode(i.charCodeAt(0)+43);else if("U"===i)o="\0";else if("V"===i)o="@";else if("W"===i)o="`";else{if("X"!==i&&"Y"!==i&&"Z"!==i)throw new E;o=""}break;case"/":if(i>="A"&&i<="O")o=String.fromCharCode(i.charCodeAt(0)-32);else{if("Z"!==i)throw new E;o=":"}}r+=o,n++}else r+=e}return r}}At.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",At.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],At.ASTERISK_ENCODING=148;class yt extends mt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(t,e,r){let n=this.decodeStart(e),i=this.decodeEnd(e),o=new v;yt.decodeMiddle(e,n[1],i[0],o);let s=o.toString(),a=null;null!=r&&(a=r.get(y.ALLOWED_LENGTHS)),null==a&&(a=yt.DEFAULT_ALLOWED_LENGTHS);let u=s.length,l=!1,h=0;for(let t of a){if(u===t){l=!0;break}t>h&&(h=t)}if(!l&&u>h&&(l=!0),!l)throw new E;const c=[new ot(n[1],t),new ot(i[0],t)];return new F(s,null,0,c,V.ITF,(new Date).getTime())}static decodeMiddle(t,e,r,n){let i=new Int32Array(10),o=new Int32Array(5),s=new Int32Array(5);for(i.fill(0),o.fill(0),s.fill(0);e<r;){mt.recordPattern(t,e,i);for(let t=0;t<5;t++){let e=2*t;o[t]=i[e],s[t]=i[e+1]}let r=yt.decodeDigit(o);n.append(r.toString()),r=this.decodeDigit(s),n.append(r.toString()),i.forEach((function(t){e+=t}))}}decodeStart(t){let e=yt.skipWhiteSpace(t),r=yt.findGuardPattern(t,e,yt.START_PATTERN);return this.narrowLineWidth=(r[1]-r[0])/4,this.validateQuietZone(t,r[0]),r}validateQuietZone(t,e){let r=10*this.narrowLineWidth;r=r<e?r:e;for(let n=e-1;r>0&&n>=0&&!t.get(n);n--)r--;if(0!==r)throw new R}static skipWhiteSpace(t){const e=t.getSize(),r=t.getNextSet(0);if(r===e)throw new R;return r}decodeEnd(t){t.reverse();try{let e,r=yt.skipWhiteSpace(t);try{e=yt.findGuardPattern(t,r,yt.END_PATTERN_REVERSED[0])}catch(n){n instanceof R&&(e=yt.findGuardPattern(t,r,yt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(t,e[0]);let n=e[0];return e[0]=t.getSize()-e[1],e[1]=t.getSize()-n,e}finally{t.reverse()}}static findGuardPattern(t,e,r){let n=r.length,i=new Int32Array(n),o=t.getSize(),s=!1,a=0,u=e;i.fill(0);for(let l=e;l<o;l++)if(t.get(l)!==s)i[a]++;else{if(a===n-1){if(mt.patternMatchVariance(i,r,yt.MAX_INDIVIDUAL_VARIANCE)<yt.MAX_AVG_VARIANCE)return[u,l];u+=i[0]+i[1],f.arraycopy(i,2,i,0,a-1),i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,s=!s}throw new R}static decodeDigit(t){let e=yt.MAX_AVG_VARIANCE,r=-1,n=yt.PATTERNS.length;for(let i=0;i<n;i++){let n=yt.PATTERNS[i],o=mt.patternMatchVariance(t,n,yt.MAX_INDIVIDUAL_VARIANCE);o<e?(e=o,r=i):o===e&&(r=-1)}if(r>=0)return r%10;throw new R}}yt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],yt.MAX_AVG_VARIANCE=.38,yt.MAX_INDIVIDUAL_VARIANCE=.5,yt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],yt.START_PATTERN=Int32Array.from([1,1,1,1]),yt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class Et extends mt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(t){let e,r=!1,n=0,i=Int32Array.from([0,0,0]);for(;!r;){i=Int32Array.from([0,0,0]),e=Et.findGuardPattern(t,n,!1,this.START_END_PATTERN,i);let o=e[0];n=e[1];let s=o-(n-o);s>=0&&(r=t.isRange(s,o,!1))}return e}static checkChecksum(t){return Et.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let e=t.length;if(0===e)return!1;let r=parseInt(t.charAt(e-1),10);return Et.getStandardUPCEANChecksum(t.substring(0,e-1))===r}static getStandardUPCEANChecksum(t){let e=t.length,r=0;for(let n=e-1;n>=0;n-=2){let e=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(e<0||e>9)throw new E;r+=e}r*=3;for(let n=e-2;n>=0;n-=2){let e=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(e<0||e>9)throw new E;r+=e}return(1e3-r)%10}static decodeEnd(t,e){return Et.findGuardPattern(t,e,!1,Et.START_END_PATTERN,new Int32Array(Et.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(t,e,r,n){return this.findGuardPattern(t,e,r,n,new Int32Array(n.length))}static findGuardPattern(t,e,r,n,i){let o=t.getSize(),s=0,a=e=r?t.getNextUnset(e):t.getNextSet(e),u=n.length,l=r;for(let r=e;r<o;r++)if(t.get(r)!==l)i[s]++;else{if(s===u-1){if(mt.patternMatchVariance(i,n,Et.MAX_INDIVIDUAL_VARIANCE)<Et.MAX_AVG_VARIANCE)return Int32Array.from([a,r]);a+=i[0]+i[1];let t=i.slice(2,i.length-1);for(let e=0;e<s-1;e++)i[e]=t[e];i[s-1]=0,i[s]=0,s--}else s++;i[s]=1,l=!l}throw new R}static decodeDigit(t,e,r,n){this.recordPattern(t,r,e);let i=this.MAX_AVG_VARIANCE,o=-1,s=n.length;for(let t=0;t<s;t++){let r=n[t],s=mt.patternMatchVariance(e,r,Et.MAX_INDIVIDUAL_VARIANCE);s<i&&(i=s,o=t)}if(o>=0)return o;throw new R}}Et.MAX_AVG_VARIANCE=.48,Et.MAX_INDIVIDUAL_VARIANCE=.7,Et.START_END_PATTERN=Int32Array.from([1,1,1]),Et.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),Et.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Et.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class Ct{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(t,e,r){let n=this.decodeRowStringBuffer,i=this.decodeMiddle(e,r,n),o=n.toString(),s=Ct.parseExtensionString(o),a=[new ot((r[0]+r[1])/2,t),new ot(i,t)],u=new F(o,null,0,a,V.UPC_EAN_EXTENSION,(new Date).getTime());return null!=s&&u.putAllMetadata(s),u}decodeMiddle(t,e,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=t.getSize(),o=e[1],s=0;for(let e=0;e<5&&o<i;e++){let i=Et.decodeDigit(t,n,o,Et.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+i%10);for(let t of n)o+=t;i>=10&&(s|=1<<4-e),4!==e&&(o=t.getNextSet(o),o=t.getNextUnset(o))}if(5!==r.length)throw new R;let a=this.determineCheckDigit(s);if(Ct.extensionChecksum(r.toString())!==a)throw new R;return o}static extensionChecksum(t){let e=t.length,r=0;for(let n=e-2;n>=0;n-=2)r+=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);r*=3;for(let n=e-1;n>=0;n-=2)r+=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);return r*=3,r%10}determineCheckDigit(t){for(let e=0;e<10;e++)if(t===this.CHECK_DIGIT_ENCODINGS[e])return e;throw new R}static parseExtensionString(t){if(5!==t.length)return null;let e=Ct.parseExtension5String(t);return null==e?null:new Map([[K.SUGGESTED_PRICE,e]])}static parseExtension5String(t){let e;switch(t.charAt(0)){case"0":e="£";break;case"5":e="$";break;case"9":switch(t){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}e="";break;default:e=""}let r=parseInt(t.substring(1)),n=r%100;return e+(r/100).toString()+"."+(n<10?"0"+n:n.toString())}}class It{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(t,e,r){let n=this.decodeRowStringBuffer,i=this.decodeMiddle(e,r,n),o=n.toString(),s=It.parseExtensionString(o),a=[new ot((r[0]+r[1])/2,t),new ot(i,t)],u=new F(o,null,0,a,V.UPC_EAN_EXTENSION,(new Date).getTime());return null!=s&&u.putAllMetadata(s),u}decodeMiddle(t,e,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=t.getSize(),o=e[1],s=0;for(let e=0;e<2&&o<i;e++){let i=Et.decodeDigit(t,n,o,Et.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+i%10);for(let t of n)o+=t;i>=10&&(s|=1<<1-e),1!==e&&(o=t.getNextSet(o),o=t.getNextUnset(o))}if(2!==r.length)throw new R;if(parseInt(r.toString())%4!==s)throw new R;return o}static parseExtensionString(t){return 2!==t.length?null:new Map([[K.ISSUE_NUMBER,parseInt(t)]])}}class bt{static decodeRow(t,e,r){let n=Et.findGuardPattern(e,r,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new Ct).decodeRow(t,e,n)}catch(r){return(new It).decodeRow(t,e,n)}}}bt.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class St extends Et{constructor(){super(),this.decodeRowStringBuffer="",St.L_AND_G_PATTERNS=St.L_PATTERNS.map((t=>Int32Array.from(t)));for(let t=10;t<20;t++){let e=St.L_PATTERNS[t-10],r=new Int32Array(e.length);for(let t=0;t<e.length;t++)r[t]=e[e.length-t-1];St.L_AND_G_PATTERNS[t]=r}}decodeRow(t,e,r){let n=St.findStartGuardPattern(e),i=null==r?null:r.get(y.NEED_RESULT_POINT_CALLBACK);if(null!=i){const e=new ot((n[0]+n[1])/2,t);i.foundPossibleResultPoint(e)}let o=this.decodeMiddle(e,n,this.decodeRowStringBuffer),s=o.rowOffset,a=o.resultString;if(null!=i){const e=new ot(s,t);i.foundPossibleResultPoint(e)}let u=St.decodeEnd(e,s);if(null!=i){const e=new ot((u[0]+u[1])/2,t);i.foundPossibleResultPoint(e)}let l=u[1],h=l+(l-u[0]);if(h>=e.getSize()||!e.isRange(l,h,!1))throw new R;let d=a.toString();if(d.length<8)throw new E;if(!St.checkChecksum(d))throw new c;let f=(n[1]+n[0])/2,g=(u[1]+u[0])/2,w=this.getBarcodeFormat(),p=[new ot(f,t),new ot(g,t)],m=new F(d,null,0,p,w,(new Date).getTime()),_=0;try{let r=bt.decodeRow(t,e,u[1]);m.putMetadata(K.UPC_EAN_EXTENSION,r.getText()),m.putAllMetadata(r.getResultMetadata()),m.addResultPoints(r.getResultPoints()),_=r.getText().length}catch(t){}let A=null==r?null:r.get(y.ALLOWED_EAN_EXTENSIONS);if(null!=A){let t=!1;for(let e in A)if(_.toString()===e){t=!0;break}if(!t)throw new R}return w===V.EAN_13||V.UPC_A,m}static checkChecksum(t){return St.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let e=t.length;if(0===e)return!1;let r=parseInt(t.charAt(e-1),10);return St.getStandardUPCEANChecksum(t.substring(0,e-1))===r}static getStandardUPCEANChecksum(t){let e=t.length,r=0;for(let n=e-1;n>=0;n-=2){let e=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(e<0||e>9)throw new E;r+=e}r*=3;for(let n=e-2;n>=0;n-=2){let e=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(e<0||e>9)throw new E;r+=e}return(1e3-r)%10}static decodeEnd(t,e){return St.findGuardPattern(t,e,!1,St.START_END_PATTERN,new Int32Array(St.START_END_PATTERN.length).fill(0))}}class vt extends St{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(t,e,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=t.getSize(),o=e[1],s=0;for(let e=0;e<6&&o<i;e++){let i=St.decodeDigit(t,n,o,St.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+i%10);for(let t of n)o+=t;i>=10&&(s|=1<<5-e)}r=vt.determineFirstDigit(r,s),o=St.findGuardPattern(t,o,!0,St.MIDDLE_PATTERN,new Int32Array(St.MIDDLE_PATTERN.length).fill(0))[1];for(let e=0;e<6&&o<i;e++){let e=St.decodeDigit(t,n,o,St.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+e);for(let t of n)o+=t}return{rowOffset:o,resultString:r}}getBarcodeFormat(){return V.EAN_13}static determineFirstDigit(t,e){for(let r=0;r<10;r++)if(e===this.FIRST_DIGIT_ENCODINGS[r])return t=String.fromCharCode("0".charCodeAt(0)+r)+t;throw new R}}vt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Tt extends St{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(t,e,r){const n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=t.getSize(),o=e[1];for(let e=0;e<4&&o<i;e++){let e=St.decodeDigit(t,n,o,St.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+e);for(let t of n)o+=t}o=St.findGuardPattern(t,o,!0,St.MIDDLE_PATTERN,new Int32Array(St.MIDDLE_PATTERN.length).fill(0))[1];for(let e=0;e<4&&o<i;e++){let e=St.decodeDigit(t,n,o,St.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+e);for(let t of n)o+=t}return{rowOffset:o,resultString:r}}getBarcodeFormat(){return V.EAN_8}}class Rt extends St{constructor(){super(...arguments),this.ean13Reader=new vt}getBarcodeFormat(){return V.UPC_A}decode(t,e){return this.maybeReturnResult(this.ean13Reader.decode(t))}decodeRow(t,e,r){return this.maybeReturnResult(this.ean13Reader.decodeRow(t,e,r))}decodeMiddle(t,e,r){return this.ean13Reader.decodeMiddle(t,e,r)}maybeReturnResult(t){let e=t.getText();if("0"===e.charAt(0)){let r=new F(e.substring(1),null,null,t.getResultPoints(),V.UPC_A);return null!=t.getResultMetadata()&&r.putAllMetadata(t.getResultMetadata()),r}throw new R}reset(){this.ean13Reader.reset()}}class Nt extends St{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(t,e,r){const n=this.decodeMiddleCounters.map((t=>t));n[0]=0,n[1]=0,n[2]=0,n[3]=0;const i=t.getSize();let o=e[1],s=0;for(let e=0;e<6&&o<i;e++){const i=Nt.decodeDigit(t,n,o,Nt.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+i%10);for(let t of n)o+=t;i>=10&&(s|=1<<5-e)}return Nt.determineNumSysAndCheckDigit(new v(r),s),o}decodeEnd(t,e){return Nt.findGuardPatternWithoutCounters(t,e,!0,Nt.MIDDLE_END_PATTERN)}checkChecksum(t){return St.checkChecksum(Nt.convertUPCEtoUPCA(t))}static determineNumSysAndCheckDigit(t,e){for(let r=0;r<=1;r++)for(let n=0;n<10;n++)if(e===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[r][n])return t.insert(0,"0"+r),void t.append("0"+n);throw R.getNotFoundInstance()}getBarcodeFormat(){return V.UPC_E}static convertUPCEtoUPCA(t){const e=t.slice(1,7).split("").map((t=>t.charCodeAt(0))),r=new v;r.append(t.charAt(0));let n=e[5];switch(n){case 0:case 1:case 2:r.appendChars(e,0,2),r.append(n),r.append("0000"),r.appendChars(e,2,3);break;case 3:r.appendChars(e,0,3),r.append("00000"),r.appendChars(e,3,2);break;case 4:r.appendChars(e,0,4),r.append("00000"),r.append(e[4]);break;default:r.appendChars(e,0,5),r.append("0000"),r.append(n)}return t.length>=8&&r.append(t.charAt(7)),r.toString()}}Nt.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),Nt.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,1])];class Ot extends mt{constructor(t){super();let e=null==t?null:t.get(y.POSSIBLE_FORMATS),r=[];null!=e&&(e.indexOf(V.EAN_13)>-1?r.push(new vt):e.indexOf(V.UPC_A)>-1&&r.push(new Rt),e.indexOf(V.EAN_8)>-1&&r.push(new Tt),e.indexOf(V.UPC_E)>-1&&r.push(new Nt)),0===r.length&&(r.push(new vt),r.push(new Tt),r.push(new Nt)),this.readers=r}decodeRow(t,e,r){for(let n of this.readers)try{const i=n.decodeRow(t,e,r),o=i.getBarcodeFormat()===V.EAN_13&&"0"===i.getText().charAt(0),s=null==r?null:r.get(y.POSSIBLE_FORMATS),a=null==s||s.includes(V.UPC_A);if(o&&a){const t=i.getRawBytes(),e=new F(i.getText().substring(1),t,t.length,i.getResultPoints(),V.UPC_A);return e.putAllMetadata(i.getResultMetadata()),e}return i}catch(t){}throw new R}reset(){for(let t of this.readers)t.reset()}}class Dt extends mt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(t,e){for(let r=0;r<e.length;r++)if(mt.patternMatchVariance(t,e[r],Dt.MAX_INDIVIDUAL_VARIANCE)<Dt.MAX_AVG_VARIANCE)return r;throw new R}static count(t){return nt.sum(new Int32Array(t))}static increment(t,e){let r=0,n=e[0];for(let i=1;i<t.length;i++)e[i]>n&&(n=e[i],r=i);t[r]++}static decrement(t,e){let r=0,n=e[0];for(let i=1;i<t.length;i++)e[i]<n&&(n=e[i],r=i);t[r]--}static isFinderPattern(t){let e=t[0]+t[1],r=e/(e+t[2]+t[3]);if(r>=Dt.MIN_FINDER_PATTERN_RATIO&&r<=Dt.MAX_FINDER_PATTERN_RATIO){let e=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;for(let n of t)n>r&&(r=n),n<e&&(e=n);return r<10*e}return!1}}Dt.MAX_AVG_VARIANCE=.2,Dt.MAX_INDIVIDUAL_VARIANCE=.45,Dt.MIN_FINDER_PATTERN_RATIO=9.5/12,Dt.MAX_FINDER_PATTERN_RATIO=12.5/14;class Mt{constructor(t,e){this.value=t,this.checksumPortion=e}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(t){if(!(t instanceof Mt))return!1;const e=t;return this.value===e.value&&this.checksumPortion===e.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Bt{constructor(t,e,r,n,i){this.value=t,this.startEnd=e,this.value=t,this.startEnd=e,this.resultPoints=new Array,this.resultPoints.push(new ot(r,i)),this.resultPoints.push(new ot(n,i))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(t){if(!(t instanceof Bt))return!1;const e=t;return this.value===e.value}hashCode(){return this.value}}class Pt{constructor(){}static getRSSvalue(t,e,r){let n=0;for(let e of t)n+=e;let i=0,o=0,s=t.length;for(let a=0;a<s-1;a++){let u;for(u=1,o|=1<<a;u<t[a];u++,o&=~(1<<a)){let t=Pt.combins(n-u-1,s-a-2);if(r&&0===o&&n-u-(s-a-1)>=s-a-1&&(t-=Pt.combins(n-u-(s-a),s-a-2)),s-a-1>1){let r=0;for(let t=n-u-(s-a-2);t>e;t--)r+=Pt.combins(n-u-t-1,s-a-3);t-=r*(s-1-a)}else n-u>e&&t--;i+=t}n-=u}return i}static combins(t,e){let r,n;t-e>e?(n=e,r=t-e):(n=t-e,r=e);let i=1,o=1;for(let e=t;e>r;e--)i*=e,o<=n&&(i/=o,o++);for(;o<=n;)i/=o,o++;return i}}class kt{static buildBitArray(t){let e=2*t.length-1;null==t[t.length-1].getRightChar()&&(e-=1);let r=new _(12*e),n=0,i=t[0].getRightChar().getValue();for(let t=11;t>=0;--t)0!=(i&1<<t)&&r.set(n),n++;for(let e=1;e<t.length;++e){let i=t[e],o=i.getLeftChar().getValue();for(let t=11;t>=0;--t)0!=(o&1<<t)&&r.set(n),n++;if(null!=i.getRightChar()){let t=i.getRightChar().getValue();for(let e=11;e>=0;--e)0!=(t&1<<e)&&r.set(n),n++}}return r}}class Lt{constructor(t,e){e?this.decodedInformation=null:(this.finished=t,this.decodedInformation=e)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class xt{constructor(t){this.newPosition=t}getNewPosition(){return this.newPosition}}class Ft extends xt{constructor(t,e){super(t),this.value=e}getValue(){return this.value}isFNC1(){return this.value===Ft.FNC1}}Ft.FNC1="$";class Ut extends xt{constructor(t,e,r){super(t),r?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=e}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Vt extends xt{constructor(t,e,r){if(super(t),e<0||e>10||r<0||r>10)throw new E;this.firstDigit=e,this.secondDigit=r}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return 10*this.firstDigit+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===Vt.FNC1}isSecondDigitFNC1(){return this.secondDigit===Vt.FNC1}isAnyFNC1(){return this.firstDigit===Vt.FNC1||this.secondDigit===Vt.FNC1}}Vt.FNC1=10;class Ht{constructor(){}static parseFieldsInGeneralPurpose(t){if(!t)return null;if(t.length<2)throw new R;let e=t.substring(0,2);for(let r of Ht.TWO_DIGIT_DATA_LENGTH)if(r[0]===e)return r[1]===Ht.VARIABLE_LENGTH?Ht.processVariableAI(2,r[2],t):Ht.processFixedAI(2,r[1],t);if(t.length<3)throw new R;let r=t.substring(0,3);for(let e of Ht.THREE_DIGIT_DATA_LENGTH)if(e[0]===r)return e[1]===Ht.VARIABLE_LENGTH?Ht.processVariableAI(3,e[2],t):Ht.processFixedAI(3,e[1],t);for(let e of Ht.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(e[0]===r)return e[1]===Ht.VARIABLE_LENGTH?Ht.processVariableAI(4,e[2],t):Ht.processFixedAI(4,e[1],t);if(t.length<4)throw new R;let n=t.substring(0,4);for(let e of Ht.FOUR_DIGIT_DATA_LENGTH)if(e[0]===n)return e[1]===Ht.VARIABLE_LENGTH?Ht.processVariableAI(4,e[2],t):Ht.processFixedAI(4,e[1],t);throw new R}static processFixedAI(t,e,r){if(r.length<t)throw new R;let n=r.substring(0,t);if(r.length<t+e)throw new R;let i=r.substring(t,t+e),o=r.substring(t+e),s="("+n+")"+i,a=Ht.parseFieldsInGeneralPurpose(o);return null==a?s:s+a}static processVariableAI(t,e,r){let n,i=r.substring(0,t);n=r.length<t+e?r.length:t+e;let o=r.substring(t,n),s=r.substring(n),a="("+i+")"+o,u=Ht.parseFieldsInGeneralPurpose(s);return null==u?a:a+u}}Ht.VARIABLE_LENGTH=[],Ht.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Ht.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Ht.VARIABLE_LENGTH,20],["22",Ht.VARIABLE_LENGTH,29],["30",Ht.VARIABLE_LENGTH,8],["37",Ht.VARIABLE_LENGTH,8],["90",Ht.VARIABLE_LENGTH,30],["91",Ht.VARIABLE_LENGTH,30],["92",Ht.VARIABLE_LENGTH,30],["93",Ht.VARIABLE_LENGTH,30],["94",Ht.VARIABLE_LENGTH,30],["95",Ht.VARIABLE_LENGTH,30],["96",Ht.VARIABLE_LENGTH,30],["97",Ht.VARIABLE_LENGTH,3],["98",Ht.VARIABLE_LENGTH,30],["99",Ht.VARIABLE_LENGTH,30]],Ht.THREE_DIGIT_DATA_LENGTH=[["240",Ht.VARIABLE_LENGTH,30],["241",Ht.VARIABLE_LENGTH,30],["242",Ht.VARIABLE_LENGTH,6],["250",Ht.VARIABLE_LENGTH,30],["251",Ht.VARIABLE_LENGTH,30],["253",Ht.VARIABLE_LENGTH,17],["254",Ht.VARIABLE_LENGTH,20],["400",Ht.VARIABLE_LENGTH,30],["401",Ht.VARIABLE_LENGTH,30],["402",17],["403",Ht.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Ht.VARIABLE_LENGTH,20],["421",Ht.VARIABLE_LENGTH,15],["422",3],["423",Ht.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Ht.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Ht.VARIABLE_LENGTH,15],["391",Ht.VARIABLE_LENGTH,18],["392",Ht.VARIABLE_LENGTH,15],["393",Ht.VARIABLE_LENGTH,18],["703",Ht.VARIABLE_LENGTH,30]],Ht.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Ht.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Ht.VARIABLE_LENGTH,20],["8003",Ht.VARIABLE_LENGTH,30],["8004",Ht.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Ht.VARIABLE_LENGTH,30],["8008",Ht.VARIABLE_LENGTH,12],["8018",18],["8020",Ht.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Ht.VARIABLE_LENGTH,70],["8200",Ht.VARIABLE_LENGTH,70]];class zt{constructor(t){this.buffer=new v,this.information=t}decodeAllCodes(t,e){let r=e,n=null;for(;;){let e=this.decodeGeneralPurposeField(r,n),i=Ht.parseFieldsInGeneralPurpose(e.getNewString());if(null!=i&&t.append(i),n=e.isRemaining()?""+e.getRemainingValue():null,r===e.getNewPosition())break;r=e.getNewPosition()}return t.toString()}isStillNumeric(t){if(t+7>this.information.getSize())return t+4<=this.information.getSize();for(let e=t;e<t+3;++e)if(this.information.get(e))return!0;return this.information.get(t+3)}decodeNumeric(t){if(t+7>this.information.getSize()){let e=this.extractNumericValueFromBitArray(t,4);return new Vt(this.information.getSize(),0===e?Vt.FNC1:e-1,Vt.FNC1)}let e=this.extractNumericValueFromBitArray(t,7);return new Vt(t+7,(e-8)/11,(e-8)%11)}extractNumericValueFromBitArray(t,e){return zt.extractNumericValueFromBitArray(this.information,t,e)}static extractNumericValueFromBitArray(t,e,r){let n=0;for(let i=0;i<r;++i)t.get(e+i)&&(n|=1<<r-i-1);return n}decodeGeneralPurposeField(t,e){this.buffer.setLengthToZero(),null!=e&&this.buffer.append(e),this.current.setPosition(t);let r=this.parseBlocks();return null!=r&&r.isRemaining()?new Ut(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new Ut(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let t,e;do{let r=this.current.getPosition();if(this.current.isAlpha()?(e=this.parseAlphaBlock(),t=e.isFinished()):this.current.isIsoIec646()?(e=this.parseIsoIec646Block(),t=e.isFinished()):(e=this.parseNumericBlock(),t=e.isFinished()),r===this.current.getPosition()&&!t)break}while(!t);return e.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let t=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFirstDigitFNC1()){let e;return e=t.isSecondDigitFNC1()?new Ut(this.current.getPosition(),this.buffer.toString()):new Ut(this.current.getPosition(),this.buffer.toString(),t.getSecondDigit()),new Lt(!0,e)}if(this.buffer.append(t.getFirstDigit()),t.isSecondDigitFNC1()){let t=new Ut(this.current.getPosition(),this.buffer.toString());return new Lt(!0,t)}this.buffer.append(t.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Lt(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let t=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let t=new Ut(this.current.getPosition(),this.buffer.toString());return new Lt(!0,t)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Lt(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let t=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let t=new Ut(this.current.getPosition(),this.buffer.toString());return new Lt(!0,t)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Lt(!1)}isStillIsoIec646(t){if(t+5>this.information.getSize())return!1;let e=this.extractNumericValueFromBitArray(t,5);if(e>=5&&e<16)return!0;if(t+7>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,7);if(r>=64&&r<116)return!0;if(t+8>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(t,8);return n>=232&&n<253}decodeIsoIec646(t){let e=this.extractNumericValueFromBitArray(t,5);if(15===e)return new Ft(t+5,Ft.FNC1);if(e>=5&&e<15)return new Ft(t+5,"0"+(e-5));let r,n=this.extractNumericValueFromBitArray(t,7);if(n>=64&&n<90)return new Ft(t+7,""+(n+1));if(n>=90&&n<116)return new Ft(t+7,""+(n+7));switch(this.extractNumericValueFromBitArray(t,8)){case 232:r="!";break;case 233:r='"';break;case 234:r="%";break;case 235:r="&";break;case 236:r="'";break;case 237:r="(";break;case 238:r=")";break;case 239:r="*";break;case 240:r="+";break;case 241:r=",";break;case 242:r="-";break;case 243:r=".";break;case 244:r="/";break;case 245:r=":";break;case 246:r=";";break;case 247:r="<";break;case 248:r="=";break;case 249:r=">";break;case 250:r="?";break;case 251:r="_";break;case 252:r=" ";break;default:throw new E}return new Ft(t+8,r)}isStillAlpha(t){if(t+5>this.information.getSize())return!1;let e=this.extractNumericValueFromBitArray(t,5);if(e>=5&&e<16)return!0;if(t+6>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,6);return r>=16&&r<63}decodeAlphanumeric(t){let e=this.extractNumericValueFromBitArray(t,5);if(15===e)return new Ft(t+5,Ft.FNC1);if(e>=5&&e<15)return new Ft(t+5,"0"+(e-5));let r,n=this.extractNumericValueFromBitArray(t,6);if(n>=32&&n<58)return new Ft(t+6,""+(n+33));switch(n){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new tt("Decoding invalid alphanumeric value: "+n)}return new Ft(t+6,r)}isAlphaTo646ToAlphaLatch(t){if(t+1>this.information.getSize())return!1;for(let e=0;e<5&&e+t<this.information.getSize();++e)if(2===e){if(!this.information.get(t+2))return!1}else if(this.information.get(t+e))return!1;return!0}isAlphaOr646ToNumericLatch(t){if(t+3>this.information.getSize())return!1;for(let e=t;e<t+3;++e)if(this.information.get(e))return!1;return!0}isNumericToAlphaNumericLatch(t){if(t+1>this.information.getSize())return!1;for(let e=0;e<4&&e+t<this.information.getSize();++e)if(this.information.get(t+e))return!1;return!0}}class Gt{constructor(t){this.information=t,this.generalDecoder=new zt(t)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Xt extends Gt{constructor(t){super(t)}encodeCompressedGtin(t,e){t.append("(01)");let r=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,e,r)}encodeCompressedGtinWithoutAI(t,e,r){for(let r=0;r<4;++r){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(e+10*r,10);n/100==0&&t.append("0"),n/10==0&&t.append("0"),t.append(n)}Xt.appendCheckDigit(t,r)}static appendCheckDigit(t,e){let r=0;for(let n=0;n<13;n++){let i=t.charAt(n+e).charCodeAt(0)-"0".charCodeAt(0);r+=0==(1&n)?3*i:i}r=10-r%10,10===r&&(r=0),t.append(r)}}Xt.GTIN_SIZE=40;class Wt extends Xt{constructor(t){super(t)}parseInformation(){let t=new v;t.append("(01)");let e=t.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(Wt.HEADER_SIZE,4);return t.append(r),this.encodeCompressedGtinWithoutAI(t,Wt.HEADER_SIZE+4,e),this.getGeneralDecoder().decodeAllCodes(t,Wt.HEADER_SIZE+44)}}Wt.HEADER_SIZE=4;class Yt extends Gt{constructor(t){super(t)}parseInformation(){let t=new v;return this.getGeneralDecoder().decodeAllCodes(t,Yt.HEADER_SIZE)}}Yt.HEADER_SIZE=5;class Kt extends Xt{constructor(t){super(t)}encodeCompressedWeight(t,e,r){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(e,r);this.addWeightCode(t,n);let i=this.checkWeight(n),o=1e5;for(let e=0;e<5;++e)i/o==0&&t.append("0"),o/=10;t.append(i)}}class Zt extends Kt{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()!=Zt.HEADER_SIZE+Kt.GTIN_SIZE+Zt.WEIGHT_SIZE)throw new R;let t=new v;return this.encodeCompressedGtin(t,Zt.HEADER_SIZE),this.encodeCompressedWeight(t,Zt.HEADER_SIZE+Kt.GTIN_SIZE,Zt.WEIGHT_SIZE),t.toString()}}Zt.HEADER_SIZE=5,Zt.WEIGHT_SIZE=15;class jt extends Zt{constructor(t){super(t)}addWeightCode(t,e){t.append("(3103)")}checkWeight(t){return t}}class qt extends Zt{constructor(t){super(t)}addWeightCode(t,e){e<1e4?t.append("(3202)"):t.append("(3203)")}checkWeight(t){return t<1e4?t:t-1e4}}class Qt extends Xt{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()<Qt.HEADER_SIZE+Xt.GTIN_SIZE)throw new R;let t=new v;this.encodeCompressedGtin(t,Qt.HEADER_SIZE);let e=this.getGeneralDecoder().extractNumericValueFromBitArray(Qt.HEADER_SIZE+Xt.GTIN_SIZE,Qt.LAST_DIGIT_SIZE);t.append("(392"),t.append(e),t.append(")");let r=this.getGeneralDecoder().decodeGeneralPurposeField(Qt.HEADER_SIZE+Xt.GTIN_SIZE+Qt.LAST_DIGIT_SIZE,null);return t.append(r.getNewString()),t.toString()}}Qt.HEADER_SIZE=8,Qt.LAST_DIGIT_SIZE=2;class Jt extends Xt{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()<Jt.HEADER_SIZE+Xt.GTIN_SIZE)throw new R;let t=new v;this.encodeCompressedGtin(t,Jt.HEADER_SIZE);let e=this.getGeneralDecoder().extractNumericValueFromBitArray(Jt.HEADER_SIZE+Xt.GTIN_SIZE,Jt.LAST_DIGIT_SIZE);t.append("(393"),t.append(e),t.append(")");let r=this.getGeneralDecoder().extractNumericValueFromBitArray(Jt.HEADER_SIZE+Xt.GTIN_SIZE+Jt.LAST_DIGIT_SIZE,Jt.FIRST_THREE_DIGITS_SIZE);r/100==0&&t.append("0"),r/10==0&&t.append("0"),t.append(r);let n=this.getGeneralDecoder().decodeGeneralPurposeField(Jt.HEADER_SIZE+Xt.GTIN_SIZE+Jt.LAST_DIGIT_SIZE+Jt.FIRST_THREE_DIGITS_SIZE,null);return t.append(n.getNewString()),t.toString()}}Jt.HEADER_SIZE=8,Jt.LAST_DIGIT_SIZE=2,Jt.FIRST_THREE_DIGITS_SIZE=10;class $t extends Kt{constructor(t,e,r){super(t),this.dateCode=r,this.firstAIdigits=e}parseInformation(){if(this.getInformation().getSize()!=$t.HEADER_SIZE+$t.GTIN_SIZE+$t.WEIGHT_SIZE+$t.DATE_SIZE)throw new R;let t=new v;return this.encodeCompressedGtin(t,$t.HEADER_SIZE),this.encodeCompressedWeight(t,$t.HEADER_SIZE+$t.GTIN_SIZE,$t.WEIGHT_SIZE),this.encodeCompressedDate(t,$t.HEADER_SIZE+$t.GTIN_SIZE+$t.WEIGHT_SIZE),t.toString()}encodeCompressedDate(t,e){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(e,$t.DATE_SIZE);if(38400==r)return;t.append("("),t.append(this.dateCode),t.append(")");let n=r%32;r/=32;let i=r%12+1;r/=12;let o=r;o/10==0&&t.append("0"),t.append(o),i/10==0&&t.append("0"),t.append(i),n/10==0&&t.append("0"),t.append(n)}addWeightCode(t,e){t.append("("),t.append(this.firstAIdigits),t.append(e/1e5),t.append(")")}checkWeight(t){return t%1e5}}function te(t){try{if(t.get(1))return new Wt(t);if(!t.get(2))return new Yt(t);switch(zt.extractNumericValueFromBitArray(t,1,4)){case 4:return new jt(t);case 5:return new qt(t)}switch(zt.extractNumericValueFromBitArray(t,1,5)){case 12:return new Qt(t);case 13:return new Jt(t)}switch(zt.extractNumericValueFromBitArray(t,1,7)){case 56:return new $t(t,"310","11");case 57:return new $t(t,"320","11");case 58:return new $t(t,"310","13");case 59:return new $t(t,"320","13");case 60:return new $t(t,"310","15");case 61:return new $t(t,"320","15");case 62:return new $t(t,"310","17");case 63:return new $t(t,"320","17")}}catch(e){throw console.log(e),new tt("unknown decoder: "+t)}}$t.HEADER_SIZE=8,$t.WEIGHT_SIZE=20,$t.DATE_SIZE=16;class ee{constructor(t,e,r,n){this.leftchar=t,this.rightchar=e,this.finderpattern=r,this.maybeLast=n}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return null==this.rightchar}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(null==this.finderpattern?"null":this.finderpattern.getValue())+" ]"}static equals(t,e){return t instanceof ee&&ee.equalsOrNull(t.leftchar,e.leftchar)&&ee.equalsOrNull(t.rightchar,e.rightchar)&&ee.equalsOrNull(t.finderpattern,e.finderpattern)}static equalsOrNull(t,e){return null===t?null===e:ee.equals(t,e)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class re{constructor(t,e,r){this.pairs=t,this.rowNumber=e,this.wasReversed=r}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(t){return this.checkEqualitity(this,t)}toString(){return"{ "+this.pairs+" }"}equals(t,e){return t instanceof re&&this.checkEqualitity(t,e)&&t.wasReversed===e.wasReversed}checkEqualitity(t,e){if(!t||!e)return;let r;return t.forEach(((t,n)=>{e.forEach((e=>{t.getLeftChar().getValue()===e.getLeftChar().getValue()&&t.getRightChar().getValue()===e.getRightChar().getValue()&&t.getFinderPatter().getValue()===e.getFinderPatter().getValue()&&(r=!0)}))})),r}}class ne extends Dt{constructor(){super(...arguments),this.pairs=new Array(ne.MAX_PAIRS),this.rows=new Array,this.startEnd=[2]}decodeRow(t,e,r){this.pairs.length=0,this.startFromEven=!1;try{return ne.constructResult(this.decodeRow2pairs(t,e))}catch(t){console.log(t)}return this.pairs.length=0,this.startFromEven=!0,ne.constructResult(this.decodeRow2pairs(t,e))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(t,e){let r,n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(e,this.pairs,t))}catch(t){if(t instanceof R){if(!this.pairs.length)throw new R;n=!0}}if(this.checkChecksum())return this.pairs;if(r=!!this.rows.length,this.storeRow(t,!1),r){let t=this.checkRowsBoolean(!1);if(null!=t)return t;if(t=this.checkRowsBoolean(!0),null!=t)return t}throw new R}checkRowsBoolean(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());let e=null;try{e=this.checkRows(new Array,0)}catch(t){console.log(t)}return t&&(this.rows=this.rows.reverse()),e}checkRows(t,e){for(let r=e;r<this.rows.length;r++){let e=this.rows[r];this.pairs.length=0;for(let e of t)this.pairs.push(e.getPairs());if(this.pairs.push(e.getPairs()),!ne.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let n=new Array(t);n.push(e);try{return this.checkRows(n,r+1)}catch(t){console.log(t)}}throw new R}static isValidSequence(t){for(let e of ne.FINDER_PATTERN_SEQUENCES){if(t.length>e.length)continue;let r=!0;for(let n=0;n<t.length;n++)if(t[n].getFinderPattern().getValue()!=e[n]){r=!1;break}if(r)return!0}return!1}storeRow(t,e){let r=0,n=!1,i=!1;for(;r<this.rows.length;){let e=this.rows[r];if(e.getRowNumber()>t){i=e.isEquivalent(this.pairs);break}n=e.isEquivalent(this.pairs),r++}i||n||ne.isPartialRow(this.pairs,this.rows)||(this.rows.push(r,new re(this.pairs,t,e)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(t,e){for(let r of e)if(r.getPairs().length!==t.length)for(let e of r.getPairs())for(let r of t)if(ee.equals(e,r))break}static isPartialRow(t,e){for(let r of e){let e=!0;for(let n of t){let t=!1;for(let e of r.getPairs())if(n.equals(e)){t=!0;break}if(!t){e=!1;break}}if(e)return!0}return!1}getRows(){return this.rows}static constructResult(t){let e=te(kt.buildBitArray(t)).parseInformation(),r=t[0].getFinderPattern().getResultPoints(),n=t[t.length-1].getFinderPattern().getResultPoints(),i=[r[0],r[1],n[0],n[1]];return new F(e,null,null,i,V.RSS_EXPANDED,null)}checkChecksum(){let t=this.pairs.get(0),e=t.getLeftChar(),r=t.getRightChar();if(null==r)return!1;let n=r.getChecksumPortion(),i=2;for(let t=1;t<this.pairs.size();++t){let e=this.pairs.get(t);n+=e.getLeftChar().getChecksumPortion(),i++;let r=e.getRightChar();null!=r&&(n+=r.getChecksumPortion(),i++)}return n%=211,211*(i-4)+n==e.getValue()}static getNextSecondBar(t,e){let r;return t.get(e)?(r=t.getNextUnset(e),r=t.getNextSet(r)):(r=t.getNextSet(e),r=t.getNextUnset(r)),r}retrieveNextPair(t,e,r){let n,i=e.length%2==0;this.startFromEven&&(i=!i);let o=!0,s=-1;do{this.findNextPair(t,e,s),n=this.parseFoundFinderPattern(t,r,i),null==n?s=ne.getNextSecondBar(t,this.startEnd[0]):o=!1}while(o);let a,u=this.decodeDataCharacter(t,n,i,!0);if(!this.isEmptyPair(e)&&e[e.length-1].mustBeLast())throw new R;try{a=this.decodeDataCharacter(t,n,i,!1)}catch(t){a=null,console.log(t)}return new ee(u,a,n,!0)}isEmptyPair(t){return 0===t.length}findNextPair(t,e,r){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i,o=t.getSize();i=r>=0?r:this.isEmptyPair(e)?0:e[e.length-1].getFinderPattern().getStartEnd()[1];let s=e.length%2!=0;this.startFromEven&&(s=!s);let a=!1;for(;i<o&&(a=!t.get(i),a);)i++;let u=0,l=i;for(let e=i;e<o;e++)if(t.get(e)!=a)n[u]++;else{if(3==u){if(s&&ne.reverseCounters(n),ne.isFinderPattern(n))return this.startEnd[0]=l,void(this.startEnd[1]=e);s&&ne.reverseCounters(n),l+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,u--}else u++;n[u]=1,a=!a}throw new R}static reverseCounters(t){let e=t.length;for(let r=0;r<e/2;++r){let n=t[r];t[r]=t[e-r-1],t[e-r-1]=n}}parseFoundFinderPattern(t,e,r){let n,i,o;if(r){let e=this.startEnd[0]-1;for(;e>=0&&!t.get(e);)e--;e++,n=this.startEnd[0]-e,i=e,o=this.startEnd[1]}else i=this.startEnd[0],o=t.getNextUnset(this.startEnd[1]+1),n=o-this.startEnd[1];let s,a=this.getDecodeFinderCounters();f.arraycopy(a,0,a,1,a.length-1),a[0]=n;try{s=this.parseFinderValue(a,ne.FINDER_PATTERNS)}catch(t){return null}return new Bt(s,[i,o],i,o,e)}decodeDataCharacter(t,e,r,n){let i=this.getDataCharacterCounters();for(let t=0;t<i.length;t++)i[t]=0;if(n)ne.recordPatternInReverse(t,e.getStartEnd()[0],i);else{ne.recordPattern(t,e.getStartEnd()[1],i);for(let t=0,e=i.length-1;t<e;t++,e--){let r=i[t];i[t]=i[e],i[e]=r}}let o=17,s=nt.sum(new Int32Array(i))/o,a=(e.getStartEnd()[1]-e.getStartEnd()[0])/15;if(Math.abs(s-a)/a>.3)throw new R;let u=this.getOddCounts(),l=this.getEvenCounts(),h=this.getOddRoundingErrors(),c=this.getEvenRoundingErrors();for(let t=0;t<i.length;t++){let e=1*i[t]/s,r=e+.5;if(r<1){if(e<.3)throw new R;r=1}else if(r>8){if(e>8.7)throw new R;r=8}let n=t/2;0==(1&t)?(u[n]=r,h[n]=e-r):(l[n]=r,c[n]=e-r)}this.adjustOddEvenCounts(o);let d=4*e.getValue()+(r?0:2)+(n?0:1)-1,f=0,g=0;for(let t=u.length-1;t>=0;t--){if(ne.isNotA1left(e,r,n)){let e=ne.WEIGHTS[d][2*t];g+=u[t]*e}f+=u[t]}let w=0;for(let t=l.length-1;t>=0;t--)if(ne.isNotA1left(e,r,n)){let e=ne.WEIGHTS[d][2*t+1];w+=l[t]*e}let p=g+w;if(0!=(1&f)||f>13||f<4)throw new R;let m=(13-f)/2,_=ne.SYMBOL_WIDEST[m],A=9-_,y=Pt.getRSSvalue(u,_,!0),E=Pt.getRSSvalue(l,A,!1),C=ne.EVEN_TOTAL_SUBSET[m],I=ne.GSUM[m];return new Mt(y*C+E+I,p)}static isNotA1left(t,e,r){return!(0==t.getValue()&&e&&r)}adjustOddEvenCounts(t){let e=nt.sum(new Int32Array(this.getOddCounts())),r=nt.sum(new Int32Array(this.getEvenCounts())),n=!1,i=!1;e>13?i=!0:e<4&&(n=!0);let o=!1,s=!1;r>13?s=!0:r<4&&(o=!0);let a=e+r-t,u=1==(1&e),l=0==(1&r);if(1==a)if(u){if(l)throw new R;i=!0}else{if(!l)throw new R;s=!0}else if(-1==a)if(u){if(l)throw new R;n=!0}else{if(!l)throw new R;o=!0}else{if(0!=a)throw new R;if(u){if(!l)throw new R;e<r?(n=!0,s=!0):(i=!0,o=!0)}else if(l)throw new R}if(n){if(i)throw new R;ne.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&ne.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(s)throw new R;ne.increment(this.getEvenCounts(),this.getOddRoundingErrors())}s&&ne.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}ne.SYMBOL_WIDEST=[7,5,4,3,1],ne.EVEN_TOTAL_SUBSET=[4,20,52,104,204],ne.GSUM=[0,348,1388,2948,3988],ne.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],ne.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],ne.FINDER_PAT_A=0,ne.FINDER_PAT_B=1,ne.FINDER_PAT_C=2,ne.FINDER_PAT_D=3,ne.FINDER_PAT_E=4,ne.FINDER_PAT_F=5,ne.FINDER_PATTERN_SEQUENCES=[[ne.FINDER_PAT_A,ne.FINDER_PAT_A],[ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B],[ne.FINDER_PAT_A,ne.FINDER_PAT_C,ne.FINDER_PAT_B,ne.FINDER_PAT_D],[ne.FINDER_PAT_A,ne.FINDER_PAT_E,ne.FINDER_PAT_B,ne.FINDER_PAT_D,ne.FINDER_PAT_C],[ne.FINDER_PAT_A,ne.FINDER_PAT_E,ne.FINDER_PAT_B,ne.FINDER_PAT_D,ne.FINDER_PAT_D,ne.FINDER_PAT_F],[ne.FINDER_PAT_A,ne.FINDER_PAT_E,ne.FINDER_PAT_B,ne.FINDER_PAT_D,ne.FINDER_PAT_E,ne.FINDER_PAT_F,ne.FINDER_PAT_F],[ne.FINDER_PAT_A,ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B,ne.FINDER_PAT_C,ne.FINDER_PAT_C,ne.FINDER_PAT_D,ne.FINDER_PAT_D],[ne.FINDER_PAT_A,ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B,ne.FINDER_PAT_C,ne.FINDER_PAT_C,ne.FINDER_PAT_D,ne.FINDER_PAT_E,ne.FINDER_PAT_E],[ne.FINDER_PAT_A,ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B,ne.FINDER_PAT_C,ne.FINDER_PAT_C,ne.FINDER_PAT_D,ne.FINDER_PAT_E,ne.FINDER_PAT_F,ne.FINDER_PAT_F],[ne.FINDER_PAT_A,ne.FINDER_PAT_A,ne.FINDER_PAT_B,ne.FINDER_PAT_B,ne.FINDER_PAT_C,ne.FINDER_PAT_D,ne.FINDER_PAT_D,ne.FINDER_PAT_E,ne.FINDER_PAT_E,ne.FINDER_PAT_F,ne.FINDER_PAT_F]],ne.MAX_PAIRS=11;class ie extends Mt{constructor(t,e,r){super(t,e),this.count=0,this.finderPattern=r}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class oe extends Dt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(t,e,r){const n=this.decodePair(e,!1,t,r);oe.addOrTally(this.possibleLeftPairs,n),e.reverse();let i=this.decodePair(e,!0,t,r);oe.addOrTally(this.possibleRightPairs,i),e.reverse();for(let t of this.possibleLeftPairs)if(t.getCount()>1)for(let e of this.possibleRightPairs)if(e.getCount()>1&&oe.checkChecksum(t,e))return oe.constructResult(t,e);throw new R}static addOrTally(t,e){if(null==e)return;let r=!1;for(let n of t)if(n.getValue()===e.getValue()){n.incrementCount(),r=!0;break}r||t.push(e)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(t,e){let r=4537077*t.getValue()+e.getValue(),n=new String(r).toString(),i=new v;for(let t=13-n.length;t>0;t--)i.append("0");i.append(n);let o=0;for(let t=0;t<13;t++){let e=i.charAt(t).charCodeAt(0)-"0".charCodeAt(0);o+=0==(1&t)?3*e:e}o=10-o%10,10===o&&(o=0),i.append(o.toString());let s=t.getFinderPattern().getResultPoints(),a=e.getFinderPattern().getResultPoints();return new F(i.toString(),null,0,[s[0],s[1],a[0],a[1]],V.RSS_14,(new Date).getTime())}static checkChecksum(t,e){let r=(t.getChecksumPortion()+16*e.getChecksumPortion())%79,n=9*t.getFinderPattern().getValue()+e.getFinderPattern().getValue();return n>72&&n--,n>8&&n--,r===n}decodePair(t,e,r,n){try{let i=this.findFinderPattern(t,e),o=this.parseFoundFinderPattern(t,r,e,i),s=null==n?null:n.get(y.NEED_RESULT_POINT_CALLBACK);if(null!=s){let n=(i[0]+i[1])/2;e&&(n=t.getSize()-1-n),s.foundPossibleResultPoint(new ot(n,r))}let a=this.decodeDataCharacter(t,o,!0),u=this.decodeDataCharacter(t,o,!1);return new ie(1597*a.getValue()+u.getValue(),a.getChecksumPortion()+4*u.getChecksumPortion(),o)}catch(t){return null}}decodeDataCharacter(t,e,r){let n=this.getDataCharacterCounters();for(let t=0;t<n.length;t++)n[t]=0;if(r)mt.recordPatternInReverse(t,e.getStartEnd()[0],n);else{mt.recordPattern(t,e.getStartEnd()[1]+1,n);for(let t=0,e=n.length-1;t<e;t++,e--){let r=n[t];n[t]=n[e],n[e]=r}}let i=r?16:15,o=nt.sum(new Int32Array(n))/i,s=this.getOddCounts(),a=this.getEvenCounts(),u=this.getOddRoundingErrors(),l=this.getEvenRoundingErrors();for(let t=0;t<n.length;t++){let e=n[t]/o,r=Math.floor(e+.5);r<1?r=1:r>8&&(r=8);let i=Math.floor(t/2);0==(1&t)?(s[i]=r,u[i]=e-r):(a[i]=r,l[i]=e-r)}this.adjustOddEvenCounts(r,i);let h=0,c=0;for(let t=s.length-1;t>=0;t--)c*=9,c+=s[t],h+=s[t];let d=0,f=0;for(let t=a.length-1;t>=0;t--)d*=9,d+=a[t],f+=a[t];let g=c+3*d;if(r){if(0!=(1&h)||h>12||h<4)throw new R;let t=(12-h)/2,e=oe.OUTSIDE_ODD_WIDEST[t],r=9-e,n=Pt.getRSSvalue(s,e,!1),i=Pt.getRSSvalue(a,r,!0),o=oe.OUTSIDE_EVEN_TOTAL_SUBSET[t],u=oe.OUTSIDE_GSUM[t];return new Mt(n*o+i+u,g)}{if(0!=(1&f)||f>10||f<4)throw new R;let t=(10-f)/2,e=oe.INSIDE_ODD_WIDEST[t],r=9-e,n=Pt.getRSSvalue(s,e,!0),i=Pt.getRSSvalue(a,r,!1),o=oe.INSIDE_ODD_TOTAL_SUBSET[t],u=oe.INSIDE_GSUM[t];return new Mt(i*o+n+u,g)}}findFinderPattern(t,e){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let n=t.getSize(),i=!1,o=0;for(;o<n&&(i=!t.get(o),e!==i);)o++;let s=0,a=o;for(let e=o;e<n;e++)if(t.get(e)!==i)r[s]++;else{if(3===s){if(Dt.isFinderPattern(r))return[a,e];a+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,s--}else s++;r[s]=1,i=!i}throw new R}parseFoundFinderPattern(t,e,r,n){let i=t.get(n[0]),o=n[0]-1;for(;o>=0&&i!==t.get(o);)o--;o++;const s=n[0]-o,a=this.getDecodeFinderCounters(),u=new Int32Array(a.length);f.arraycopy(a,0,u,1,a.length-1),u[0]=s;const l=this.parseFinderValue(u,oe.FINDER_PATTERNS);let h=o,c=n[1];return r&&(h=t.getSize()-1-h,c=t.getSize()-1-c),new Bt(l,[o,n[1]],h,c,e)}adjustOddEvenCounts(t,e){let r=nt.sum(new Int32Array(this.getOddCounts())),n=nt.sum(new Int32Array(this.getEvenCounts())),i=!1,o=!1,s=!1,a=!1;t?(r>12?o=!0:r<4&&(i=!0),n>12?a=!0:n<4&&(s=!0)):(r>11?o=!0:r<5&&(i=!0),n>10?a=!0:n<4&&(s=!0));let u=r+n-e,l=(1&r)==(t?1:0),h=1==(1&n);if(1===u)if(l){if(h)throw new R;o=!0}else{if(!h)throw new R;a=!0}else if(-1===u)if(l){if(h)throw new R;i=!0}else{if(!h)throw new R;s=!0}else{if(0!==u)throw new R;if(l){if(!h)throw new R;r<n?(i=!0,a=!0):(o=!0,s=!0)}else if(h)throw new R}if(i){if(o)throw new R;Dt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&Dt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(a)throw new R;Dt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}a&&Dt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}oe.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],oe.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],oe.OUTSIDE_GSUM=[0,161,961,2015,2715],oe.INSIDE_GSUM=[0,336,1036,1516],oe.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],oe.INSIDE_ODD_WIDEST=[2,4,6,8],oe.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class se extends mt{constructor(t){super(),this.readers=[];const e=t?t.get(y.POSSIBLE_FORMATS):null,r=t&&void 0!==t.get(y.ASSUME_CODE_39_CHECK_DIGIT);e&&((e.includes(V.EAN_13)||e.includes(V.UPC_A)||e.includes(V.EAN_8)||e.includes(V.UPC_E))&&this.readers.push(new Ot(t)),e.includes(V.CODE_39)&&this.readers.push(new At(r)),e.includes(V.CODE_128)&&this.readers.push(new _t),e.includes(V.ITF)&&this.readers.push(new yt),e.includes(V.RSS_14)&&this.readers.push(new oe),e.includes(V.RSS_EXPANDED)&&this.readers.push(new ne)),0===this.readers.length&&(this.readers.push(new Ot(t)),this.readers.push(new At),this.readers.push(new Ot(t)),this.readers.push(new _t),this.readers.push(new yt),this.readers.push(new oe),this.readers.push(new ne))}decodeRow(t,e,r){for(let n=0;n<this.readers.length;n++)try{return this.readers[n].decodeRow(t,e,r)}catch(t){}throw new R}reset(){this.readers.forEach((t=>t.reset()))}}class ae extends x{constructor(t=500,e){super(new se(e),t,e)}}class ue{constructor(t,e,r){this.ecCodewords=t,this.ecBlocks=[e],r&&this.ecBlocks.push(r)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class le{constructor(t,e){this.count=t,this.dataCodewords=e}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class he{constructor(t,e,r,n,i,o){this.versionNumber=t,this.symbolSizeRows=e,this.symbolSizeColumns=r,this.dataRegionSizeRows=n,this.dataRegionSizeColumns=i,this.ecBlocks=o;let s=0;const a=o.getECCodewords(),u=o.getECBlocks();for(let t of u)s+=t.getCount()*(t.getDataCodewords()+a);this.totalCodewords=s}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(t,e){if(0!=(1&t)||0!=(1&e))throw new E;for(let r of he.VERSIONS)if(r.symbolSizeRows===t&&r.symbolSizeColumns===e)return r;throw new E}toString(){return""+this.versionNumber}static buildVersions(){return[new he(1,10,10,8,8,new ue(5,new le(1,3))),new he(2,12,12,10,10,new ue(7,new le(1,5))),new he(3,14,14,12,12,new ue(10,new le(1,8))),new he(4,16,16,14,14,new ue(12,new le(1,12))),new he(5,18,18,16,16,new ue(14,new le(1,18))),new he(6,20,20,18,18,new ue(18,new le(1,22))),new he(7,22,22,20,20,new ue(20,new le(1,30))),new he(8,24,24,22,22,new ue(24,new le(1,36))),new he(9,26,26,24,24,new ue(28,new le(1,44))),new he(10,32,32,14,14,new ue(36,new le(1,62))),new he(11,36,36,16,16,new ue(42,new le(1,86))),new he(12,40,40,18,18,new ue(48,new le(1,114))),new he(13,44,44,20,20,new ue(56,new le(1,144))),new he(14,48,48,22,22,new ue(68,new le(1,174))),new he(15,52,52,24,24,new ue(42,new le(2,102))),new he(16,64,64,14,14,new ue(56,new le(2,140))),new he(17,72,72,16,16,new ue(36,new le(4,92))),new he(18,80,80,18,18,new ue(48,new le(4,114))),new he(19,88,88,20,20,new ue(56,new le(4,144))),new he(20,96,96,22,22,new ue(68,new le(4,174))),new he(21,104,104,24,24,new ue(56,new le(6,136))),new he(22,120,120,18,18,new ue(68,new le(6,175))),new he(23,132,132,20,20,new ue(62,new le(8,163))),new he(24,144,144,22,22,new ue(62,new le(8,156),new le(2,155))),new he(25,8,18,6,16,new ue(7,new le(1,5))),new he(26,8,32,6,14,new ue(11,new le(1,10))),new he(27,12,26,10,24,new ue(14,new le(1,16))),new he(28,12,36,10,16,new ue(18,new le(1,22))),new he(29,16,36,14,16,new ue(24,new le(1,32))),new he(30,16,48,14,22,new ue(28,new le(1,49)))]}}he.VERSIONS=he.buildVersions();class ce{constructor(t){const e=t.getHeight();if(e<8||e>144||0!=(1&e))throw new E;this.version=ce.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new T(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(t){const e=t.getHeight(),r=t.getWidth();return he.getVersionForDimensions(e,r)}readCodewords(){const t=new Int8Array(this.version.getTotalCodewords());let e=0,r=4,n=0;const i=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth();let s=!1,a=!1,u=!1,l=!1;do{if(r!==i||0!==n||s)if(r!==i-2||0!==n||0==(3&o)||a)if(r!==i+4||2!==n||0!=(7&o)||u)if(r!==i-2||0!==n||4!=(7&o)||l){do{r<i&&n>=0&&!this.readMappingMatrix.get(n,r)&&(t[e++]=255&this.readUtah(r,n,i,o)),r-=2,n+=2}while(r>=0&&n<o);r+=1,n+=3;do{r>=0&&n<o&&!this.readMappingMatrix.get(n,r)&&(t[e++]=255&this.readUtah(r,n,i,o)),r+=2,n-=2}while(r<i&&n>=0);r+=3,n+=1}else t[e++]=255&this.readCorner4(i,o),r-=2,n+=2,l=!0;else t[e++]=255&this.readCorner3(i,o),r-=2,n+=2,u=!0;else t[e++]=255&this.readCorner2(i,o),r-=2,n+=2,a=!0;else t[e++]=255&this.readCorner1(i,o),r-=2,n+=2,s=!0}while(r<i||n<o);if(e!==this.version.getTotalCodewords())throw new E;return t}readModule(t,e,r,n){return t<0&&(t+=r,e+=4-(r+4&7)),e<0&&(e+=n,t+=4-(n+4&7)),this.readMappingMatrix.set(e,t),this.mappingBitMatrix.get(e,t)}readUtah(t,e,r,n){let i=0;return this.readModule(t-2,e-2,r,n)&&(i|=1),i<<=1,this.readModule(t-2,e-1,r,n)&&(i|=1),i<<=1,this.readModule(t-1,e-2,r,n)&&(i|=1),i<<=1,this.readModule(t-1,e-1,r,n)&&(i|=1),i<<=1,this.readModule(t-1,e,r,n)&&(i|=1),i<<=1,this.readModule(t,e-2,r,n)&&(i|=1),i<<=1,this.readModule(t,e-1,r,n)&&(i|=1),i<<=1,this.readModule(t,e,r,n)&&(i|=1),i}readCorner1(t,e){let r=0;return this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,1,t,e)&&(r|=1),r<<=1,this.readModule(t-1,2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(2,e-1,t,e)&&(r|=1),r<<=1,this.readModule(3,e-1,t,e)&&(r|=1),r}readCorner2(t,e){let r=0;return this.readModule(t-3,0,t,e)&&(r|=1),r<<=1,this.readModule(t-2,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(0,e-4,t,e)&&(r|=1),r<<=1,this.readModule(0,e-3,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r}readCorner3(t,e){let r=0;return this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(0,e-3,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-3,t,e)&&(r|=1),r<<=1,this.readModule(1,e-2,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r}readCorner4(t,e){let r=0;return this.readModule(t-3,0,t,e)&&(r|=1),r<<=1,this.readModule(t-2,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(2,e-1,t,e)&&(r|=1),r<<=1,this.readModule(3,e-1,t,e)&&(r|=1),r}extractDataRegion(t){const e=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(t.getHeight()!==e)throw new l("Dimension of bitMatrix must match the version size");const n=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),o=e/n|0,s=r/i|0,a=new T(s*i,o*n);for(let e=0;e<o;++e){const r=e*n;for(let o=0;o<s;++o){const s=o*i;for(let u=0;u<n;++u){const l=e*(n+2)+1+u,h=r+u;for(let e=0;e<i;++e){const r=o*(i+2)+1+e;if(t.get(r,l)){const t=s+e;a.set(t,h)}}}}}return a}}class de{constructor(t,e){this.numDataCodewords=t,this.codewords=e}static getDataBlocks(t,e){const r=e.getECBlocks();let n=0;const i=r.getECBlocks();for(let t of i)n+=t.getCount();const o=new Array(n);let s=0;for(let t of i)for(let e=0;e<t.getCount();e++){const e=t.getDataCodewords(),n=r.getECCodewords()+e;o[s++]=new de(e,new Uint8Array(n))}const a=o[0].codewords.length-r.getECCodewords(),u=a-1;let h=0;for(let e=0;e<u;e++)for(let r=0;r<s;r++)o[r].codewords[e]=t[h++];const c=24===e.getVersionNumber(),d=c?8:s;for(let e=0;e<d;e++)o[e].codewords[a-1]=t[h++];const f=o[0].codewords.length;for(let e=a;e<f;e++)for(let r=0;r<s;r++){const n=c?(r+8)%s:r,i=c&&n>7?e-1:e;o[n].codewords[i]=t[h++]}if(h!==t.length)throw new l;return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class fe{constructor(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(t){if(t<1||t>32||t>this.available())throw new l(""+t);let e=0,r=this.bitOffset,n=this.byteOffset;const i=this.bytes;if(r>0){const o=8-r,s=t<o?t:o,a=o-s,u=255>>8-s<<a;e=(i[n]&u)>>a,t-=s,r+=s,8===r&&(r=0,n++)}if(t>0){for(;t>=8;)e=e<<8|255&i[n],n++,t-=8;if(t>0){const o=8-t,s=255>>o<<o;e=e<<t|(i[n]&s)>>o,r+=t}}return this.bitOffset=r,this.byteOffset=n,e}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}!function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"}(z||(z={}));class ge{static decode(t){const e=new fe(t),r=new v,n=new v,i=new Array;let o=z.ASCII_ENCODE;do{if(o===z.ASCII_ENCODE)o=this.decodeAsciiSegment(e,r,n);else{switch(o){case z.C40_ENCODE:this.decodeC40Segment(e,r);break;case z.TEXT_ENCODE:this.decodeTextSegment(e,r);break;case z.ANSIX12_ENCODE:this.decodeAnsiX12Segment(e,r);break;case z.EDIFACT_ENCODE:this.decodeEdifactSegment(e,r);break;case z.BASE256_ENCODE:this.decodeBase256Segment(e,r,i);break;default:throw new E}o=z.ASCII_ENCODE}}while(o!==z.PAD_ENCODE&&e.available()>0);return n.length()>0&&r.append(n.toString()),new Z(t,r.toString(),0===i.length?null:i,null)}static decodeAsciiSegment(t,e,r){let n=!1;do{let i=t.readBits(8);if(0===i)throw new E;if(i<=128)return n&&(i+=128),e.append(String.fromCharCode(i-1)),z.ASCII_ENCODE;if(129===i)return z.PAD_ENCODE;if(i<=229){const t=i-130;t<10&&e.append("0"),e.append(""+t)}else switch(i){case 230:return z.C40_ENCODE;case 231:return z.BASE256_ENCODE;case 232:e.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:n=!0;break;case 236:e.append("[)>05"),r.insert(0,"");break;case 237:e.append("[)>06"),r.insert(0,"");break;case 238:return z.ANSIX12_ENCODE;case 239:return z.TEXT_ENCODE;case 240:return z.EDIFACT_ENCODE;case 241:break;default:if(254!==i||0!==t.available())throw new E}}while(t.available()>0);return z.ASCII_ENCODE}static decodeC40Segment(t,e){let r=!1;const n=[];let i=0;do{if(8===t.available())return;const o=t.readBits(8);if(254===o)return;this.parseTwoBytes(o,t.readBits(8),n);for(let t=0;t<3;t++){const o=n[t];switch(i){case 0:if(o<3)i=o+1;else{if(!(o<this.C40_BASIC_SET_CHARS.length))throw new E;{const t=this.C40_BASIC_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t)}}break;case 1:r?(e.append(String.fromCharCode(o+128)),r=!1):e.append(String.fromCharCode(o)),i=0;break;case 2:if(o<this.C40_SHIFT2_SET_CHARS.length){const t=this.C40_SHIFT2_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t)}else switch(o){case 27:e.append(String.fromCharCode(29));break;case 30:r=!0;break;default:throw new E}i=0;break;case 3:r?(e.append(String.fromCharCode(o+224)),r=!1):e.append(String.fromCharCode(o+96)),i=0;break;default:throw new E}}}while(t.available()>0)}static decodeTextSegment(t,e){let r=!1,n=[],i=0;do{if(8===t.available())return;const o=t.readBits(8);if(254===o)return;this.parseTwoBytes(o,t.readBits(8),n);for(let t=0;t<3;t++){const o=n[t];switch(i){case 0:if(o<3)i=o+1;else{if(!(o<this.TEXT_BASIC_SET_CHARS.length))throw new E;{const t=this.TEXT_BASIC_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t)}}break;case 1:r?(e.append(String.fromCharCode(o+128)),r=!1):e.append(String.fromCharCode(o)),i=0;break;case 2:if(o<this.TEXT_SHIFT2_SET_CHARS.length){const t=this.TEXT_SHIFT2_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t)}else switch(o){case 27:e.append(String.fromCharCode(29));break;case 30:r=!0;break;default:throw new E}i=0;break;case 3:if(!(o<this.TEXT_SHIFT3_SET_CHARS.length))throw new E;{const t=this.TEXT_SHIFT3_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t),i=0}break;default:throw new E}}}while(t.available()>0)}static decodeAnsiX12Segment(t,e){const r=[];do{if(8===t.available())return;const n=t.readBits(8);if(254===n)return;this.parseTwoBytes(n,t.readBits(8),r);for(let t=0;t<3;t++){const n=r[t];switch(n){case 0:e.append("\r");break;case 1:e.append("*");break;case 2:e.append(">");break;case 3:e.append(" ");break;default:if(n<14)e.append(String.fromCharCode(n+44));else{if(!(n<40))throw new E;e.append(String.fromCharCode(n+51))}}}}while(t.available()>0)}static parseTwoBytes(t,e,r){let n=(t<<8)+e-1,i=Math.floor(n/1600);r[0]=i,n-=1600*i,i=Math.floor(n/40),r[1]=i,r[2]=n-40*i}static decodeEdifactSegment(t,e){do{if(t.available()<=16)return;for(let r=0;r<4;r++){let r=t.readBits(6);if(31===r){const e=8-t.getBitOffset();return void(8!==e&&t.readBits(e))}0==(32&r)&&(r|=64),e.append(String.fromCharCode(r))}}while(t.available()>0)}static decodeBase256Segment(t,e,r){let n=1+t.getByteOffset();const i=this.unrandomize255State(t.readBits(8),n++);let o;if(o=0===i?t.available()/8|0:i<250?i:250*(i-249)+this.unrandomize255State(t.readBits(8),n++),o<0)throw new E;const s=new Uint8Array(o);for(let e=0;e<o;e++){if(t.available()<8)throw new E;s[e]=this.unrandomize255State(t.readBits(8),n++)}r.push(s);try{e.append(b.decode(s,S.ISO88591))}catch(t){throw new tt("Platform does not support required encoding: "+t.message)}}static unrandomize255State(t,e){const r=t-(149*e%255+1);return r>=0?r:r+256}}ge.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],ge.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],ge.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],ge.TEXT_SHIFT2_SET_CHARS=ge.C40_SHIFT2_SET_CHARS,ge.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class we{constructor(){this.rsDecoder=new et(J.DATA_MATRIX_FIELD_256)}decode(t){const e=new ce(t),r=e.getVersion(),n=e.readCodewords(),i=de.getDataBlocks(n,r);let o=0;for(let t of i)o+=t.getNumDataCodewords();const s=new Uint8Array(o),a=i.length;for(let t=0;t<a;t++){const e=i[t],r=e.getCodewords(),n=e.getNumDataCodewords();this.correctErrors(r,n);for(let e=0;e<n;e++)s[e*a+t]=r[e]}return ge.decode(s)}correctErrors(t,e){const r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-e)}catch(t){throw new c}for(let n=0;n<e;n++)t[n]=r[n]}}class pe{constructor(t){this.image=t,this.rectangleDetector=new ut(this.image)}detect(){const t=this.rectangleDetector.detect();let e=this.detectSolid1(t);if(e=this.detectSolid2(e),e[3]=this.correctTopRight(e),!e[3])throw new R;e=this.shiftToModuleCenter(e);const r=e[0],n=e[1],i=e[2],o=e[3];let s=this.transitionsBetween(r,o)+1,a=this.transitionsBetween(i,o)+1;1==(1&s)&&(s+=1),1==(1&a)&&(a+=1),4*s<7*a&&4*a<7*s&&(s=a=Math.max(s,a));let u=pe.sampleGrid(this.image,r,n,i,o,s,a);return new st(u,[r,n,i,o])}static shiftPoint(t,e,r){let n=(e.getX()-t.getX())/(r+1),i=(e.getY()-t.getY())/(r+1);return new ot(t.getX()+n,t.getY()+i)}static moveAway(t,e,r){let n=t.getX(),i=t.getY();return n<e?n-=1:n+=1,i<r?i-=1:i+=1,new ot(n,i)}detectSolid1(t){let e=t[0],r=t[1],n=t[3],i=t[2],o=this.transitionsBetween(e,r),s=this.transitionsBetween(r,n),a=this.transitionsBetween(n,i),u=this.transitionsBetween(i,e),l=o,h=[i,e,r,n];return l>s&&(l=s,h[0]=e,h[1]=r,h[2]=n,h[3]=i),l>a&&(l=a,h[0]=r,h[1]=n,h[2]=i,h[3]=e),l>u&&(h[0]=n,h[1]=i,h[2]=e,h[3]=r),h}detectSolid2(t){let e=t[0],r=t[1],n=t[2],i=t[3],o=this.transitionsBetween(e,i),s=pe.shiftPoint(r,n,4*(o+1)),a=pe.shiftPoint(n,r,4*(o+1));return this.transitionsBetween(s,e)<this.transitionsBetween(a,i)?(t[0]=e,t[1]=r,t[2]=n,t[3]=i):(t[0]=r,t[1]=n,t[2]=i,t[3]=e),t}correctTopRight(t){let e=t[0],r=t[1],n=t[2],i=t[3],o=this.transitionsBetween(e,i),s=this.transitionsBetween(r,i),a=pe.shiftPoint(e,r,4*(s+1)),u=pe.shiftPoint(n,r,4*(o+1));o=this.transitionsBetween(a,i),s=this.transitionsBetween(u,i);let l=new ot(i.getX()+(n.getX()-r.getX())/(o+1),i.getY()+(n.getY()-r.getY())/(o+1)),h=new ot(i.getX()+(e.getX()-r.getX())/(s+1),i.getY()+(e.getY()-r.getY())/(s+1));return this.isValid(l)?this.isValid(h)?this.transitionsBetween(a,l)+this.transitionsBetween(u,l)>this.transitionsBetween(a,h)+this.transitionsBetween(u,h)?l:h:l:this.isValid(h)?h:null}shiftToModuleCenter(t){let e=t[0],r=t[1],n=t[2],i=t[3],o=this.transitionsBetween(e,i)+1,s=this.transitionsBetween(n,i)+1,a=pe.shiftPoint(e,r,4*s),u=pe.shiftPoint(n,r,4*o);o=this.transitionsBetween(a,i)+1,s=this.transitionsBetween(u,i)+1,1==(1&o)&&(o+=1),1==(1&s)&&(s+=1);let l,h,c=(e.getX()+r.getX()+n.getX()+i.getX())/4,d=(e.getY()+r.getY()+n.getY()+i.getY())/4;return e=pe.moveAway(e,c,d),r=pe.moveAway(r,c,d),n=pe.moveAway(n,c,d),i=pe.moveAway(i,c,d),a=pe.shiftPoint(e,r,4*s),a=pe.shiftPoint(a,i,4*o),l=pe.shiftPoint(r,e,4*s),l=pe.shiftPoint(l,n,4*o),u=pe.shiftPoint(n,i,4*s),u=pe.shiftPoint(u,r,4*o),h=pe.shiftPoint(i,n,4*s),h=pe.shiftPoint(h,e,4*o),[a,l,u,h]}isValid(t){return t.getX()>=0&&t.getX()<this.image.getWidth()&&t.getY()>0&&t.getY()<this.image.getHeight()}static sampleGrid(t,e,r,n,i,o,s){return dt.getInstance().sampleGrid(t,o,s,.5,.5,o-.5,.5,o-.5,s-.5,.5,s-.5,e.getX(),e.getY(),i.getX(),i.getY(),n.getX(),n.getY(),r.getX(),r.getY())}transitionsBetween(t,e){let r=Math.trunc(t.getX()),n=Math.trunc(t.getY()),i=Math.trunc(e.getX()),o=Math.trunc(e.getY()),s=Math.abs(o-n)>Math.abs(i-r);if(s){let t=r;r=n,n=t,t=i,i=o,o=t}let a=Math.abs(i-r),u=Math.abs(o-n),l=-a/2,h=n<o?1:-1,c=r<i?1:-1,d=0,f=this.image.get(s?n:r,s?r:n);for(let t=r,e=n;t!==i;t+=c){let r=this.image.get(s?e:t,s?t:e);if(r!==f&&(d++,f=r),l+=u,l>0){if(e===o)break;e+=h,l-=a}}return d}}class me{constructor(){this.decoder=new we}decode(t,e=null){let r,n;if(null!=e&&e.has(y.PURE_BARCODE)){const e=me.extractPureBits(t.getBlackMatrix());r=this.decoder.decode(e),n=me.NO_POINTS}else{const e=new pe(t.getBlackMatrix()).detect();r=this.decoder.decode(e.getBits()),n=e.getPoints()}const i=r.getRawBytes(),o=new F(r.getText(),i,8*i.length,n,V.DATA_MATRIX,f.currentTimeMillis()),s=r.getByteSegments();null!=s&&o.putMetadata(K.BYTE_SEGMENTS,s);const a=r.getECLevel();return null!=a&&o.putMetadata(K.ERROR_CORRECTION_LEVEL,a),o}reset(){}static extractPureBits(t){const e=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(null==e||null==r)throw new R;const n=this.moduleSize(e,t);let i=e[1];const o=r[1];let s=e[0];const a=(r[0]-s+1)/n,u=(o-i+1)/n;if(a<=0||u<=0)throw new R;const l=n/2;i+=l,s+=l;const h=new T(a,u);for(let e=0;e<u;e++){const r=i+e*n;for(let i=0;i<a;i++)t.get(s+i*n,r)&&h.set(i,e)}return h}static moduleSize(t,e){const r=e.getWidth();let n=t[0];const i=t[1];for(;n<r&&e.get(n,i);)n++;if(n===r)throw new R;const o=n-t[0];if(0===o)throw new R;return o}}me.NO_POINTS=[];class _e extends x{constructor(t=500){super(new me,t)}}!function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"}(G||(G={}));class Ae{constructor(t,e,r){this.value=t,this.stringValue=e,this.bits=r,Ae.FOR_BITS.set(r,this),Ae.FOR_VALUE.set(t,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(t){switch(t){case"L":return Ae.L;case"M":return Ae.M;case"Q":return Ae.Q;case"H":return Ae.H;default:throw new u(t+"not available")}}toString(){return this.stringValue}equals(t){if(!(t instanceof Ae))return!1;const e=t;return this.value===e.value}static forBits(t){if(t<0||t>=Ae.FOR_BITS.size)throw new l;return Ae.FOR_BITS.get(t)}}Ae.FOR_BITS=new Map,Ae.FOR_VALUE=new Map,Ae.L=new Ae(G.L,"L",1),Ae.M=new Ae(G.M,"M",0),Ae.Q=new Ae(G.Q,"Q",3),Ae.H=new Ae(G.H,"H",2);class ye{constructor(t){this.errorCorrectionLevel=Ae.forBits(t>>3&3),this.dataMask=7&t}static numBitsDiffering(t,e){return m.bitCount(t^e)}static decodeFormatInformation(t,e){const r=ye.doDecodeFormatInformation(t,e);return null!==r?r:ye.doDecodeFormatInformation(t^ye.FORMAT_INFO_MASK_QR,e^ye.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(t,e){let r=Number.MAX_SAFE_INTEGER,n=0;for(const i of ye.FORMAT_INFO_DECODE_LOOKUP){const o=i[0];if(o===t||o===e)return new ye(i[1]);let s=ye.numBitsDiffering(t,o);s<r&&(n=i[1],r=s),t!==e&&(s=ye.numBitsDiffering(e,o),s<r&&(n=i[1],r=s))}return r<=3?new ye(n):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(t){if(!(t instanceof ye))return!1;const e=t;return this.errorCorrectionLevel===e.errorCorrectionLevel&&this.dataMask===e.dataMask}}ye.FORMAT_INFO_MASK_QR=21522,ye.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class Ee{constructor(t,...e){this.ecCodewordsPerBlock=t,this.ecBlocks=e}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let t=0;const e=this.ecBlocks;for(const r of e)t+=r.getCount();return t}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Ce{constructor(t,e){this.count=t,this.dataCodewords=e}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ie{constructor(t,e,...r){this.versionNumber=t,this.alignmentPatternCenters=e,this.ecBlocks=r;let n=0;const i=r[0].getECCodewordsPerBlock(),o=r[0].getECBlocks();for(const t of o)n+=t.getCount()*(t.getDataCodewords()+i);this.totalCodewords=n}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(t){return this.ecBlocks[t.getValue()]}static getProvisionalVersionForDimension(t){if(t%4!=1)throw new E;try{return this.getVersionForNumber((t-17)/4)}catch(t){throw new E}}static getVersionForNumber(t){if(t<1||t>40)throw new l;return Ie.VERSIONS[t-1]}static decodeVersionInformation(t){let e=Number.MAX_SAFE_INTEGER,r=0;for(let n=0;n<Ie.VERSION_DECODE_INFO.length;n++){const i=Ie.VERSION_DECODE_INFO[n];if(i===t)return Ie.getVersionForNumber(n+7);const o=ye.numBitsDiffering(t,i);o<e&&(r=n+7,e=o)}return e<=3?Ie.getVersionForNumber(r):null}buildFunctionPattern(){const t=this.getDimensionForVersion(),e=new T(t);e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8);const r=this.alignmentPatternCenters.length;for(let t=0;t<r;t++){const n=this.alignmentPatternCenters[t]-2;for(let i=0;i<r;i++)0===t&&(0===i||i===r-1)||t===r-1&&0===i||e.setRegion(this.alignmentPatternCenters[i]-2,n,5,5)}return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),this.versionNumber>6&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e}toString(){return""+this.versionNumber}}Ie.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Ie.VERSIONS=[new Ie(1,new Int32Array(0),new Ee(7,new Ce(1,19)),new Ee(10,new Ce(1,16)),new Ee(13,new Ce(1,13)),new Ee(17,new Ce(1,9))),new Ie(2,Int32Array.from([6,18]),new Ee(10,new Ce(1,34)),new Ee(16,new Ce(1,28)),new Ee(22,new Ce(1,22)),new Ee(28,new Ce(1,16))),new Ie(3,Int32Array.from([6,22]),new Ee(15,new Ce(1,55)),new Ee(26,new Ce(1,44)),new Ee(18,new Ce(2,17)),new Ee(22,new Ce(2,13))),new Ie(4,Int32Array.from([6,26]),new Ee(20,new Ce(1,80)),new Ee(18,new Ce(2,32)),new Ee(26,new Ce(2,24)),new Ee(16,new Ce(4,9))),new Ie(5,Int32Array.from([6,30]),new Ee(26,new Ce(1,108)),new Ee(24,new Ce(2,43)),new Ee(18,new Ce(2,15),new Ce(2,16)),new Ee(22,new Ce(2,11),new Ce(2,12))),new Ie(6,Int32Array.from([6,34]),new Ee(18,new Ce(2,68)),new Ee(16,new Ce(4,27)),new Ee(24,new Ce(4,19)),new Ee(28,new Ce(4,15))),new Ie(7,Int32Array.from([6,22,38]),new Ee(20,new Ce(2,78)),new Ee(18,new Ce(4,31)),new Ee(18,new Ce(2,14),new Ce(4,15)),new Ee(26,new Ce(4,13),new Ce(1,14))),new Ie(8,Int32Array.from([6,24,42]),new Ee(24,new Ce(2,97)),new Ee(22,new Ce(2,38),new Ce(2,39)),new Ee(22,new Ce(4,18),new Ce(2,19)),new Ee(26,new Ce(4,14),new Ce(2,15))),new Ie(9,Int32Array.from([6,26,46]),new Ee(30,new Ce(2,116)),new Ee(22,new Ce(3,36),new Ce(2,37)),new Ee(20,new Ce(4,16),new Ce(4,17)),new Ee(24,new Ce(4,12),new Ce(4,13))),new Ie(10,Int32Array.from([6,28,50]),new Ee(18,new Ce(2,68),new Ce(2,69)),new Ee(26,new Ce(4,43),new Ce(1,44)),new Ee(24,new Ce(6,19),new Ce(2,20)),new Ee(28,new Ce(6,15),new Ce(2,16))),new Ie(11,Int32Array.from([6,30,54]),new Ee(20,new Ce(4,81)),new Ee(30,new Ce(1,50),new Ce(4,51)),new Ee(28,new Ce(4,22),new Ce(4,23)),new Ee(24,new Ce(3,12),new Ce(8,13))),new Ie(12,Int32Array.from([6,32,58]),new Ee(24,new Ce(2,92),new Ce(2,93)),new Ee(22,new Ce(6,36),new Ce(2,37)),new Ee(26,new Ce(4,20),new Ce(6,21)),new Ee(28,new Ce(7,14),new Ce(4,15))),new Ie(13,Int32Array.from([6,34,62]),new Ee(26,new Ce(4,107)),new Ee(22,new Ce(8,37),new Ce(1,38)),new Ee(24,new Ce(8,20),new Ce(4,21)),new Ee(22,new Ce(12,11),new Ce(4,12))),new Ie(14,Int32Array.from([6,26,46,66]),new Ee(30,new Ce(3,115),new Ce(1,116)),new Ee(24,new Ce(4,40),new Ce(5,41)),new Ee(20,new Ce(11,16),new Ce(5,17)),new Ee(24,new Ce(11,12),new Ce(5,13))),new Ie(15,Int32Array.from([6,26,48,70]),new Ee(22,new Ce(5,87),new Ce(1,88)),new Ee(24,new Ce(5,41),new Ce(5,42)),new Ee(30,new Ce(5,24),new Ce(7,25)),new Ee(24,new Ce(11,12),new Ce(7,13))),new Ie(16,Int32Array.from([6,26,50,74]),new Ee(24,new Ce(5,98),new Ce(1,99)),new Ee(28,new Ce(7,45),new Ce(3,46)),new Ee(24,new Ce(15,19),new Ce(2,20)),new Ee(30,new Ce(3,15),new Ce(13,16))),new Ie(17,Int32Array.from([6,30,54,78]),new Ee(28,new Ce(1,107),new Ce(5,108)),new Ee(28,new Ce(10,46),new Ce(1,47)),new Ee(28,new Ce(1,22),new Ce(15,23)),new Ee(28,new Ce(2,14),new Ce(17,15))),new Ie(18,Int32Array.from([6,30,56,82]),new Ee(30,new Ce(5,120),new Ce(1,121)),new Ee(26,new Ce(9,43),new Ce(4,44)),new Ee(28,new Ce(17,22),new Ce(1,23)),new Ee(28,new Ce(2,14),new Ce(19,15))),new Ie(19,Int32Array.from([6,30,58,86]),new Ee(28,new Ce(3,113),new Ce(4,114)),new Ee(26,new Ce(3,44),new Ce(11,45)),new Ee(26,new Ce(17,21),new Ce(4,22)),new Ee(26,new Ce(9,13),new Ce(16,14))),new Ie(20,Int32Array.from([6,34,62,90]),new Ee(28,new Ce(3,107),new Ce(5,108)),new Ee(26,new Ce(3,41),new Ce(13,42)),new Ee(30,new Ce(15,24),new Ce(5,25)),new Ee(28,new Ce(15,15),new Ce(10,16))),new Ie(21,Int32Array.from([6,28,50,72,94]),new Ee(28,new Ce(4,116),new Ce(4,117)),new Ee(26,new Ce(17,42)),new Ee(28,new Ce(17,22),new Ce(6,23)),new Ee(30,new Ce(19,16),new Ce(6,17))),new Ie(22,Int32Array.from([6,26,50,74,98]),new Ee(28,new Ce(2,111),new Ce(7,112)),new Ee(28,new Ce(17,46)),new Ee(30,new Ce(7,24),new Ce(16,25)),new Ee(24,new Ce(34,13))),new Ie(23,Int32Array.from([6,30,54,78,102]),new Ee(30,new Ce(4,121),new Ce(5,122)),new Ee(28,new Ce(4,47),new Ce(14,48)),new Ee(30,new Ce(11,24),new Ce(14,25)),new Ee(30,new Ce(16,15),new Ce(14,16))),new Ie(24,Int32Array.from([6,28,54,80,106]),new Ee(30,new Ce(6,117),new Ce(4,118)),new Ee(28,new Ce(6,45),new Ce(14,46)),new Ee(30,new Ce(11,24),new Ce(16,25)),new Ee(30,new Ce(30,16),new Ce(2,17))),new Ie(25,Int32Array.from([6,32,58,84,110]),new Ee(26,new Ce(8,106),new Ce(4,107)),new Ee(28,new Ce(8,47),new Ce(13,48)),new Ee(30,new Ce(7,24),new Ce(22,25)),new Ee(30,new Ce(22,15),new Ce(13,16))),new Ie(26,Int32Array.from([6,30,58,86,114]),new Ee(28,new Ce(10,114),new Ce(2,115)),new Ee(28,new Ce(19,46),new Ce(4,47)),new Ee(28,new Ce(28,22),new Ce(6,23)),new Ee(30,new Ce(33,16),new Ce(4,17))),new Ie(27,Int32Array.from([6,34,62,90,118]),new Ee(30,new Ce(8,122),new Ce(4,123)),new Ee(28,new Ce(22,45),new Ce(3,46)),new Ee(30,new Ce(8,23),new Ce(26,24)),new Ee(30,new Ce(12,15),new Ce(28,16))),new Ie(28,Int32Array.from([6,26,50,74,98,122]),new Ee(30,new Ce(3,117),new Ce(10,118)),new Ee(28,new Ce(3,45),new Ce(23,46)),new Ee(30,new Ce(4,24),new Ce(31,25)),new Ee(30,new Ce(11,15),new Ce(31,16))),new Ie(29,Int32Array.from([6,30,54,78,102,126]),new Ee(30,new Ce(7,116),new Ce(7,117)),new Ee(28,new Ce(21,45),new Ce(7,46)),new Ee(30,new Ce(1,23),new Ce(37,24)),new Ee(30,new Ce(19,15),new Ce(26,16))),new Ie(30,Int32Array.from([6,26,52,78,104,130]),new Ee(30,new Ce(5,115),new Ce(10,116)),new Ee(28,new Ce(19,47),new Ce(10,48)),new Ee(30,new Ce(15,24),new Ce(25,25)),new Ee(30,new Ce(23,15),new Ce(25,16))),new Ie(31,Int32Array.from([6,30,56,82,108,134]),new Ee(30,new Ce(13,115),new Ce(3,116)),new Ee(28,new Ce(2,46),new Ce(29,47)),new Ee(30,new Ce(42,24),new Ce(1,25)),new Ee(30,new Ce(23,15),new Ce(28,16))),new Ie(32,Int32Array.from([6,34,60,86,112,138]),new Ee(30,new Ce(17,115)),new Ee(28,new Ce(10,46),new Ce(23,47)),new Ee(30,new Ce(10,24),new Ce(35,25)),new Ee(30,new Ce(19,15),new Ce(35,16))),new Ie(33,Int32Array.from([6,30,58,86,114,142]),new Ee(30,new Ce(17,115),new Ce(1,116)),new Ee(28,new Ce(14,46),new Ce(21,47)),new Ee(30,new Ce(29,24),new Ce(19,25)),new Ee(30,new Ce(11,15),new Ce(46,16))),new Ie(34,Int32Array.from([6,34,62,90,118,146]),new Ee(30,new Ce(13,115),new Ce(6,116)),new Ee(28,new Ce(14,46),new Ce(23,47)),new Ee(30,new Ce(44,24),new Ce(7,25)),new Ee(30,new Ce(59,16),new Ce(1,17))),new Ie(35,Int32Array.from([6,30,54,78,102,126,150]),new Ee(30,new Ce(12,121),new Ce(7,122)),new Ee(28,new Ce(12,47),new Ce(26,48)),new Ee(30,new Ce(39,24),new Ce(14,25)),new Ee(30,new Ce(22,15),new Ce(41,16))),new Ie(36,Int32Array.from([6,24,50,76,102,128,154]),new Ee(30,new Ce(6,121),new Ce(14,122)),new Ee(28,new Ce(6,47),new Ce(34,48)),new Ee(30,new Ce(46,24),new Ce(10,25)),new Ee(30,new Ce(2,15),new Ce(64,16))),new Ie(37,Int32Array.from([6,28,54,80,106,132,158]),new Ee(30,new Ce(17,122),new Ce(4,123)),new Ee(28,new Ce(29,46),new Ce(14,47)),new Ee(30,new Ce(49,24),new Ce(10,25)),new Ee(30,new Ce(24,15),new Ce(46,16))),new Ie(38,Int32Array.from([6,32,58,84,110,136,162]),new Ee(30,new Ce(4,122),new Ce(18,123)),new Ee(28,new Ce(13,46),new Ce(32,47)),new Ee(30,new Ce(48,24),new Ce(14,25)),new Ee(30,new Ce(42,15),new Ce(32,16))),new Ie(39,Int32Array.from([6,26,54,82,110,138,166]),new Ee(30,new Ce(20,117),new Ce(4,118)),new Ee(28,new Ce(40,47),new Ce(7,48)),new Ee(30,new Ce(43,24),new Ce(22,25)),new Ee(30,new Ce(10,15),new Ce(67,16))),new Ie(40,Int32Array.from([6,30,58,86,114,142,170]),new Ee(30,new Ce(19,118),new Ce(6,119)),new Ee(28,new Ce(18,47),new Ce(31,48)),new Ee(30,new Ce(34,24),new Ce(34,25)),new Ee(30,new Ce(20,15),new Ce(61,16)))],function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"}(X||(X={}));class be{constructor(t,e){this.value=t,this.isMasked=e}unmaskBitMatrix(t,e){for(let r=0;r<e;r++)for(let n=0;n<e;n++)this.isMasked(r,n)&&t.flip(n,r)}}be.values=new Map([[X.DATA_MASK_000,new be(X.DATA_MASK_000,((t,e)=>0==(t+e&1)))],[X.DATA_MASK_001,new be(X.DATA_MASK_001,((t,e)=>0==(1&t)))],[X.DATA_MASK_010,new be(X.DATA_MASK_010,((t,e)=>e%3==0))],[X.DATA_MASK_011,new be(X.DATA_MASK_011,((t,e)=>(t+e)%3==0))],[X.DATA_MASK_100,new be(X.DATA_MASK_100,((t,e)=>0==(Math.floor(t/2)+Math.floor(e/3)&1)))],[X.DATA_MASK_101,new be(X.DATA_MASK_101,((t,e)=>t*e%6==0))],[X.DATA_MASK_110,new be(X.DATA_MASK_110,((t,e)=>t*e%6<3))],[X.DATA_MASK_111,new be(X.DATA_MASK_111,((t,e)=>0==(t+e+t*e%3&1)))]]);class Se{constructor(t){const e=t.getHeight();if(e<21||1!=(3&e))throw new E;this.bitMatrix=t}readFormatInformation(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;let t=0;for(let e=0;e<6;e++)t=this.copyBit(e,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(let e=5;e>=0;e--)t=this.copyBit(8,e,t);const e=this.bitMatrix.getHeight();let r=0;const n=e-7;for(let t=e-1;t>=n;t--)r=this.copyBit(8,t,r);for(let t=e-8;t<e;t++)r=this.copyBit(t,8,r);if(this.parsedFormatInfo=ye.decodeFormatInformation(t,r),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new E}readVersion(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;const t=this.bitMatrix.getHeight(),e=Math.floor((t-17)/4);if(e<=6)return Ie.getVersionForNumber(e);let r=0;const n=t-11;for(let e=5;e>=0;e--)for(let i=t-9;i>=n;i--)r=this.copyBit(i,e,r);let i=Ie.decodeVersionInformation(r);if(null!==i&&i.getDimensionForVersion()===t)return this.parsedVersion=i,i;r=0;for(let e=5;e>=0;e--)for(let i=t-9;i>=n;i--)r=this.copyBit(e,i,r);if(i=Ie.decodeVersionInformation(r),null!==i&&i.getDimensionForVersion()===t)return this.parsedVersion=i,i;throw new E}copyBit(t,e,r){return(this.isMirror?this.bitMatrix.get(e,t):this.bitMatrix.get(t,e))?r<<1|1:r<<1}readCodewords(){const t=this.readFormatInformation(),e=this.readVersion(),r=be.values.get(t.getDataMask()),n=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,n);const i=e.buildFunctionPattern();let o=!0;const s=new Uint8Array(e.getTotalCodewords());let a=0,u=0,l=0;for(let t=n-1;t>0;t-=2){6===t&&t--;for(let e=0;e<n;e++){const r=o?n-1-e:e;for(let e=0;e<2;e++)i.get(t-e,r)||(l++,u<<=1,this.bitMatrix.get(t-e,r)&&(u|=1),8===l&&(s[a++]=u,l=0,u=0))}o=!o}if(a!==e.getTotalCodewords())throw new E;return s}remask(){if(null===this.parsedFormatInfo)return;const t=be.values[this.parsedFormatInfo.getDataMask()],e=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,e)}setMirror(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t}mirror(){const t=this.bitMatrix;for(let e=0,r=t.getWidth();e<r;e++)for(let r=e+1,n=t.getHeight();r<n;r++)t.get(e,r)!==t.get(r,e)&&(t.flip(r,e),t.flip(e,r))}}class ve{constructor(t,e){this.numDataCodewords=t,this.codewords=e}static getDataBlocks(t,e,r){if(t.length!==e.getTotalCodewords())throw new l;const n=e.getECBlocksForLevel(r);let i=0;const o=n.getECBlocks();for(const t of o)i+=t.getCount();const s=new Array(i);let a=0;for(const t of o)for(let e=0;e<t.getCount();e++){const e=t.getDataCodewords(),r=n.getECCodewordsPerBlock()+e;s[a++]=new ve(e,new Uint8Array(r))}const u=s[0].codewords.length;let h=s.length-1;for(;h>=0&&s[h].codewords.length!==u;)h--;h++;const c=u-n.getECCodewordsPerBlock();let d=0;for(let e=0;e<c;e++)for(let r=0;r<a;r++)s[r].codewords[e]=t[d++];for(let e=h;e<a;e++)s[e].codewords[c]=t[d++];const f=s[0].codewords.length;for(let e=c;e<f;e++)for(let r=0;r<a;r++){const n=r<h?e:e+1;s[r].codewords[n]=t[d++]}return s}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}!function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"}(W||(W={}));class Te{constructor(t,e,r,n){this.value=t,this.stringValue=e,this.characterCountBitsForVersions=r,this.bits=n,Te.FOR_BITS.set(n,this),Te.FOR_VALUE.set(t,this)}static forBits(t){const e=Te.FOR_BITS.get(t);if(void 0===e)throw new l;return e}getCharacterCountBits(t){const e=t.getVersionNumber();let r;return r=e<=9?0:e<=26?1:2,this.characterCountBitsForVersions[r]}getValue(){return this.value}getBits(){return this.bits}equals(t){if(!(t instanceof Te))return!1;const e=t;return this.value===e.value}toString(){return this.stringValue}}Te.FOR_BITS=new Map,Te.FOR_VALUE=new Map,Te.TERMINATOR=new Te(W.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),Te.NUMERIC=new Te(W.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),Te.ALPHANUMERIC=new Te(W.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),Te.STRUCTURED_APPEND=new Te(W.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),Te.BYTE=new Te(W.BYTE,"BYTE",Int32Array.from([8,16,16]),4),Te.ECI=new Te(W.ECI,"ECI",Int32Array.from([0,0,0]),7),Te.KANJI=new Te(W.KANJI,"KANJI",Int32Array.from([8,10,12]),8),Te.FNC1_FIRST_POSITION=new Te(W.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),Te.FNC1_SECOND_POSITION=new Te(W.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),Te.HANZI=new Te(W.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class Re{static decode(t,e,r,n){const i=new fe(t);let o=new v;const s=new Array;let a=-1,u=-1;try{let t,r=null,l=!1;do{if(i.available()<4)t=Te.TERMINATOR;else{const e=i.readBits(4);t=Te.forBits(e)}switch(t){case Te.TERMINATOR:break;case Te.FNC1_FIRST_POSITION:case Te.FNC1_SECOND_POSITION:l=!0;break;case Te.STRUCTURED_APPEND:if(i.available()<16)throw new E;a=i.readBits(8),u=i.readBits(8);break;case Te.ECI:const h=Re.parseECIValue(i);if(r=C.getCharacterSetECIByValue(h),null===r)throw new E;break;case Te.HANZI:const c=i.readBits(4),d=i.readBits(t.getCharacterCountBits(e));c===Re.GB2312_SUBSET&&Re.decodeHanziSegment(i,o,d);break;default:const f=i.readBits(t.getCharacterCountBits(e));switch(t){case Te.NUMERIC:Re.decodeNumericSegment(i,o,f);break;case Te.ALPHANUMERIC:Re.decodeAlphanumericSegment(i,o,f,l);break;case Te.BYTE:Re.decodeByteSegment(i,o,f,r,s,n);break;case Te.KANJI:Re.decodeKanjiSegment(i,o,f);break;default:throw new E}}}while(t!==Te.TERMINATOR)}catch(t){throw new E}return new Z(t,o.toString(),0===s.length?null:s,null===r?null:r.toString(),a,u)}static decodeHanziSegment(t,e,r){if(13*r>t.available())throw new E;const n=new Uint8Array(2*r);let i=0;for(;r>0;){const e=t.readBits(13);let o=e/96<<8&4294967295|e%96;o+=o<959?41377:42657,n[i]=o>>8&255,n[i+1]=255&o,i+=2,r--}try{e.append(b.decode(n,S.GB2312))}catch(t){throw new E(t)}}static decodeKanjiSegment(t,e,r){if(13*r>t.available())throw new E;const n=new Uint8Array(2*r);let i=0;for(;r>0;){const e=t.readBits(13);let o=e/192<<8&4294967295|e%192;o+=o<7936?33088:49472,n[i]=o>>8,n[i+1]=o,i+=2,r--}try{e.append(b.decode(n,S.SHIFT_JIS))}catch(t){throw new E(t)}}static decodeByteSegment(t,e,r,n,i,o){if(8*r>t.available())throw new E;const s=new Uint8Array(r);for(let e=0;e<r;e++)s[e]=t.readBits(8);let a;a=null===n?S.guessEncoding(s,o):n.getName();try{e.append(b.decode(s,a))}catch(t){throw new E(t)}i.push(s)}static toAlphaNumericChar(t){if(t>=Re.ALPHANUMERIC_CHARS.length)throw new E;return Re.ALPHANUMERIC_CHARS[t]}static decodeAlphanumericSegment(t,e,r,n){const i=e.length();for(;r>1;){if(t.available()<11)throw new E;const n=t.readBits(11);e.append(Re.toAlphaNumericChar(Math.floor(n/45))),e.append(Re.toAlphaNumericChar(n%45)),r-=2}if(1===r){if(t.available()<6)throw new E;e.append(Re.toAlphaNumericChar(t.readBits(6)))}if(n)for(let t=i;t<e.length();t++)"%"===e.charAt(t)&&(t<e.length()-1&&"%"===e.charAt(t+1)?e.deleteCharAt(t+1):e.setCharAt(t,String.fromCharCode(29)))}static decodeNumericSegment(t,e,r){for(;r>=3;){if(t.available()<10)throw new E;const n=t.readBits(10);if(n>=1e3)throw new E;e.append(Re.toAlphaNumericChar(Math.floor(n/100))),e.append(Re.toAlphaNumericChar(Math.floor(n/10)%10)),e.append(Re.toAlphaNumericChar(n%10)),r-=3}if(2===r){if(t.available()<7)throw new E;const r=t.readBits(7);if(r>=100)throw new E;e.append(Re.toAlphaNumericChar(Math.floor(r/10))),e.append(Re.toAlphaNumericChar(r%10))}else if(1===r){if(t.available()<4)throw new E;const r=t.readBits(4);if(r>=10)throw new E;e.append(Re.toAlphaNumericChar(r))}}static parseECIValue(t){const e=t.readBits(8);if(0==(128&e))return 127&e;if(128==(192&e))return(63&e)<<8&4294967295|t.readBits(8);if(192==(224&e))return(31&e)<<16&4294967295|t.readBits(16);throw new E}}Re.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",Re.GB2312_SUBSET=1;class Ne{constructor(t){this.mirrored=t}isMirrored(){return this.mirrored}applyMirroredCorrection(t){if(!this.mirrored||null===t||t.length<3)return;const e=t[0];t[0]=t[2],t[2]=e}}class Oe{constructor(){this.rsDecoder=new et(J.QR_CODE_FIELD_256)}decodeBooleanArray(t,e){return this.decodeBitMatrix(T.parseFromBooleanArray(t),e)}decodeBitMatrix(t,e){const r=new Se(t);let n=null;try{return this.decodeBitMatrixParser(r,e)}catch(t){n=t}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();const t=this.decodeBitMatrixParser(r,e);return t.setOther(new Ne(!0)),t}catch(t){if(null!==n)throw n;throw t}}decodeBitMatrixParser(t,e){const r=t.readVersion(),n=t.readFormatInformation().getErrorCorrectionLevel(),i=t.readCodewords(),o=ve.getDataBlocks(i,r,n);let s=0;for(const t of o)s+=t.getNumDataCodewords();const a=new Uint8Array(s);let u=0;for(const t of o){const e=t.getCodewords(),r=t.getNumDataCodewords();this.correctErrors(e,r);for(let t=0;t<r;t++)a[u++]=e[t]}return Re.decode(a,r,n,e)}correctErrors(t,e){const r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-e)}catch(t){throw new c}for(let n=0;n<e;n++)t[n]=r[n]}}class De extends ot{constructor(t,e,r){super(t,e),this.estimatedModuleSize=r}aboutEquals(t,e,r){if(Math.abs(e-this.getY())<=t&&Math.abs(r-this.getX())<=t){const e=Math.abs(t-this.estimatedModuleSize);return e<=1||e<=this.estimatedModuleSize}return!1}combineEstimate(t,e,r){const n=(this.getX()+e)/2,i=(this.getY()+t)/2,o=(this.estimatedModuleSize+r)/2;return new De(n,i,o)}}class Me{constructor(t,e,r,n,i,o,s){this.image=t,this.startX=e,this.startY=r,this.width=n,this.height=i,this.moduleSize=o,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const t=this.startX,e=this.height,r=t+this.width,n=this.startY+e/2,i=new Int32Array(3),o=this.image;for(let s=0;s<e;s++){const e=n+(0==(1&s)?Math.floor((s+1)/2):-Math.floor((s+1)/2));i[0]=0,i[1]=0,i[2]=0;let a=t;for(;a<r&&!o.get(a,e);)a++;let u=0;for(;a<r;){if(o.get(a,e))if(1===u)i[1]++;else if(2===u){if(this.foundPatternCross(i)){const t=this.handlePossibleCenter(i,e,a);if(null!==t)return t}i[0]=i[2],i[1]=1,i[2]=0,u=1}else i[++u]++;else 1===u&&u++,i[u]++;a++}if(this.foundPatternCross(i)){const t=this.handlePossibleCenter(i,e,r);if(null!==t)return t}}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new R}static centerFromEnd(t,e){return e-t[2]-t[1]/2}foundPatternCross(t){const e=this.moduleSize,r=e/2;for(let n=0;n<3;n++)if(Math.abs(e-t[n])>=r)return!1;return!0}crossCheckVertical(t,e,r,n){const i=this.image,o=i.getHeight(),s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;let a=t;for(;a>=0&&i.get(e,a)&&s[1]<=r;)s[1]++,a--;if(a<0||s[1]>r)return NaN;for(;a>=0&&!i.get(e,a)&&s[0]<=r;)s[0]++,a--;if(s[0]>r)return NaN;for(a=t+1;a<o&&i.get(e,a)&&s[1]<=r;)s[1]++,a++;if(a===o||s[1]>r)return NaN;for(;a<o&&!i.get(e,a)&&s[2]<=r;)s[2]++,a++;if(s[2]>r)return NaN;const u=s[0]+s[1]+s[2];return 5*Math.abs(u-n)>=2*n?NaN:this.foundPatternCross(s)?Me.centerFromEnd(s,a):NaN}handlePossibleCenter(t,e,r){const n=t[0]+t[1]+t[2],i=Me.centerFromEnd(t,r),o=this.crossCheckVertical(e,i,2*t[1],n);if(!isNaN(o)){const e=(t[0]+t[1]+t[2])/3;for(const t of this.possibleCenters)if(t.aboutEquals(e,o,i))return t.combineEstimate(o,i,e);const r=new De(i,o,e);this.possibleCenters.push(r),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(r)}return null}}class Be extends ot{constructor(t,e,r,n){super(t,e),this.estimatedModuleSize=r,this.count=n,void 0===n&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(t,e,r){if(Math.abs(e-this.getY())<=t&&Math.abs(r-this.getX())<=t){const e=Math.abs(t-this.estimatedModuleSize);return e<=1||e<=this.estimatedModuleSize}return!1}combineEstimate(t,e,r){const n=this.count+1,i=(this.count*this.getX()+e)/n,o=(this.count*this.getY()+t)/n,s=(this.count*this.estimatedModuleSize+r)/n;return new Be(i,o,s,n)}}class Pe{constructor(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class ke{constructor(t,e){this.image=t,this.resultPointCallback=e,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=e}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(t){const e=null!=t&&void 0!==t.get(y.TRY_HARDER),r=null!=t&&void 0!==t.get(y.PURE_BARCODE),n=this.image,i=n.getHeight(),o=n.getWidth();let s=Math.floor(3*i/(4*ke.MAX_MODULES));(s<ke.MIN_SKIP||e)&&(s=ke.MIN_SKIP);let a=!1;const u=new Int32Array(5);for(let t=s-1;t<i&&!a;t+=s){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;let e=0;for(let i=0;i<o;i++)if(n.get(i,t))1==(1&e)&&e++,u[e]++;else if(0==(1&e))if(4===e)if(ke.foundPatternCross(u)){if(!0!==this.handlePossibleCenter(u,t,i,r)){u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,e=3;continue}if(s=2,!0===this.hasSkipped)a=this.haveMultiplyConfirmedCenters();else{const e=this.findRowSkip();e>u[2]&&(t+=e-u[2]-s,i=o-1)}e=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,e=3;else u[++e]++;else u[e]++;ke.foundPatternCross(u)&&!0===this.handlePossibleCenter(u,t,o,r)&&(s=u[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}const l=this.selectBestPatterns();return ot.orderBestPatterns(l),new Pe(l)}static centerFromEnd(t,e){return e-t[4]-t[3]-t[2]/2}static foundPatternCross(t){let e=0;for(let r=0;r<5;r++){const n=t[r];if(0===n)return!1;e+=n}if(e<7)return!1;const r=e/7,n=r/2;return Math.abs(r-t[0])<n&&Math.abs(r-t[1])<n&&Math.abs(3*r-t[2])<3*n&&Math.abs(r-t[3])<n&&Math.abs(r-t[4])<n}getCrossCheckStateCount(){const t=this.crossCheckStateCount;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t}crossCheckDiagonal(t,e,r,n){const i=this.getCrossCheckStateCount();let o=0;const s=this.image;for(;t>=o&&e>=o&&s.get(e-o,t-o);)i[2]++,o++;if(t<o||e<o)return!1;for(;t>=o&&e>=o&&!s.get(e-o,t-o)&&i[1]<=r;)i[1]++,o++;if(t<o||e<o||i[1]>r)return!1;for(;t>=o&&e>=o&&s.get(e-o,t-o)&&i[0]<=r;)i[0]++,o++;if(i[0]>r)return!1;const a=s.getHeight(),u=s.getWidth();for(o=1;t+o<a&&e+o<u&&s.get(e+o,t+o);)i[2]++,o++;if(t+o>=a||e+o>=u)return!1;for(;t+o<a&&e+o<u&&!s.get(e+o,t+o)&&i[3]<r;)i[3]++,o++;if(t+o>=a||e+o>=u||i[3]>=r)return!1;for(;t+o<a&&e+o<u&&s.get(e+o,t+o)&&i[4]<r;)i[4]++,o++;if(i[4]>=r)return!1;const l=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(l-n)<2*n&&ke.foundPatternCross(i)}crossCheckVertical(t,e,r,n){const i=this.image,o=i.getHeight(),s=this.getCrossCheckStateCount();let a=t;for(;a>=0&&i.get(e,a);)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(e,a)&&s[1]<=r;)s[1]++,a--;if(a<0||s[1]>r)return NaN;for(;a>=0&&i.get(e,a)&&s[0]<=r;)s[0]++,a--;if(s[0]>r)return NaN;for(a=t+1;a<o&&i.get(e,a);)s[2]++,a++;if(a===o)return NaN;for(;a<o&&!i.get(e,a)&&s[3]<r;)s[3]++,a++;if(a===o||s[3]>=r)return NaN;for(;a<o&&i.get(e,a)&&s[4]<r;)s[4]++,a++;if(s[4]>=r)return NaN;const u=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(u-n)>=2*n?NaN:ke.foundPatternCross(s)?ke.centerFromEnd(s,a):NaN}crossCheckHorizontal(t,e,r,n){const i=this.image,o=i.getWidth(),s=this.getCrossCheckStateCount();let a=t;for(;a>=0&&i.get(a,e);)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(a,e)&&s[1]<=r;)s[1]++,a--;if(a<0||s[1]>r)return NaN;for(;a>=0&&i.get(a,e)&&s[0]<=r;)s[0]++,a--;if(s[0]>r)return NaN;for(a=t+1;a<o&&i.get(a,e);)s[2]++,a++;if(a===o)return NaN;for(;a<o&&!i.get(a,e)&&s[3]<r;)s[3]++,a++;if(a===o||s[3]>=r)return NaN;for(;a<o&&i.get(a,e)&&s[4]<r;)s[4]++,a++;if(s[4]>=r)return NaN;const u=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(u-n)>=n?NaN:ke.foundPatternCross(s)?ke.centerFromEnd(s,a):NaN}handlePossibleCenter(t,e,r,n){const i=t[0]+t[1]+t[2]+t[3]+t[4];let o=ke.centerFromEnd(t,r),s=this.crossCheckVertical(e,Math.floor(o),t[2],i);if(!isNaN(s)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(s),t[2],i),!isNaN(o)&&(!n||this.crossCheckDiagonal(Math.floor(s),Math.floor(o),t[2],i)))){const t=i/7;let e=!1;const r=this.possibleCenters;for(let n=0,i=r.length;n<i;n++){const i=r[n];if(i.aboutEquals(t,s,o)){r[n]=i.combineEstimate(s,o,t),e=!0;break}}if(!e){const e=new Be(o,s,t);r.push(e),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(e)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const e of this.possibleCenters)if(e.getCount()>=ke.CENTER_QUORUM){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-e.getX())-Math.abs(t.getY()-e.getY()))/2);t=e}return 0}haveMultiplyConfirmedCenters(){let t=0,e=0;const r=this.possibleCenters.length;for(const r of this.possibleCenters)r.getCount()>=ke.CENTER_QUORUM&&(t++,e+=r.getEstimatedModuleSize());if(t<3)return!1;const n=e/r;let i=0;for(const t of this.possibleCenters)i+=Math.abs(t.getEstimatedModuleSize()-n);return i<=.05*e}selectBestPatterns(){const t=this.possibleCenters.length;if(t<3)throw new R;const e=this.possibleCenters;let r;if(t>3){let n=0,i=0;for(const t of this.possibleCenters){const e=t.getEstimatedModuleSize();n+=e,i+=e*e}r=n/t;let o=Math.sqrt(i/t-r*r);e.sort(((t,e)=>{const n=Math.abs(e.getEstimatedModuleSize()-r),i=Math.abs(t.getEstimatedModuleSize()-r);return n<i?-1:n>i?1:0}));const s=Math.max(.2*r,o);for(let t=0;t<e.length&&e.length>3;t++){const n=e[t];Math.abs(n.getEstimatedModuleSize()-r)>s&&(e.splice(t,1),t--)}}if(e.length>3){let t=0;for(const r of e)t+=r.getEstimatedModuleSize();r=t/e.length,e.sort(((t,e)=>{if(e.getCount()===t.getCount()){const n=Math.abs(e.getEstimatedModuleSize()-r),i=Math.abs(t.getEstimatedModuleSize()-r);return n<i?1:n>i?-1:0}return e.getCount()-t.getCount()})),e.splice(3)}return[e[0],e[1],e[2]]}}ke.CENTER_QUORUM=2,ke.MIN_SKIP=3,ke.MAX_MODULES=57;class Le{constructor(t){this.image=t}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(t){this.resultPointCallback=null==t?null:t.get(y.NEED_RESULT_POINT_CALLBACK);const e=new ke(this.image,this.resultPointCallback).find(t);return this.processFinderPatternInfo(e)}processFinderPatternInfo(t){const e=t.getTopLeft(),r=t.getTopRight(),n=t.getBottomLeft(),i=this.calculateModuleSize(e,r,n);if(i<1)throw new R("No pattern found in proccess finder.");const o=Le.computeDimension(e,r,n,i),s=Ie.getProvisionalVersionForDimension(o),a=s.getDimensionForVersion()-7;let u=null;if(s.getAlignmentPatternCenters().length>0){const t=r.getX()-e.getX()+n.getX(),o=r.getY()-e.getY()+n.getY(),s=1-3/a,l=Math.floor(e.getX()+s*(t-e.getX())),h=Math.floor(e.getY()+s*(o-e.getY()));for(let t=4;t<=16;t<<=1)try{u=this.findAlignmentInRegion(i,l,h,t);break}catch(t){if(!(t instanceof R))throw t}}const l=Le.createTransform(e,r,n,u,o),h=Le.sampleGrid(this.image,l,o);let c;return c=null===u?[n,e,r]:[n,e,r,u],new st(h,c)}static createTransform(t,e,r,n,i){const o=i-3.5;let s,a,u,l;return null!==n?(s=n.getX(),a=n.getY(),u=o-3,l=u):(s=e.getX()-t.getX()+r.getX(),a=e.getY()-t.getY()+r.getY(),u=o,l=o),ht.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,u,l,3.5,o,t.getX(),t.getY(),e.getX(),e.getY(),s,a,r.getX(),r.getY())}static sampleGrid(t,e,r){return dt.getInstance().sampleGridWithTransform(t,r,r,e)}static computeDimension(t,e,r,n){const i=nt.round(ot.distance(t,e)/n),o=nt.round(ot.distance(t,r)/n);let s=Math.floor((i+o)/2)+7;switch(3&s){case 0:s++;break;case 2:s--;break;case 3:throw new R("Dimensions could be not found.")}return s}calculateModuleSize(t,e,r){return(this.calculateModuleSizeOneWay(t,e)+this.calculateModuleSizeOneWay(t,r))/2}calculateModuleSizeOneWay(t,e){const r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY())),n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(r)?n/7:isNaN(n)?r/7:(r+n)/14}sizeOfBlackWhiteBlackRunBothWays(t,e,r,n){let i=this.sizeOfBlackWhiteBlackRun(t,e,r,n),o=1,s=t-(r-t);s<0?(o=t/(t-s),s=0):s>=this.image.getWidth()&&(o=(this.image.getWidth()-1-t)/(s-t),s=this.image.getWidth()-1);let a=Math.floor(e-(n-e)*o);return o=1,a<0?(o=e/(e-a),a=0):a>=this.image.getHeight()&&(o=(this.image.getHeight()-1-e)/(a-e),a=this.image.getHeight()-1),s=Math.floor(t+(s-t)*o),i+=this.sizeOfBlackWhiteBlackRun(t,e,s,a),i-1}sizeOfBlackWhiteBlackRun(t,e,r,n){const i=Math.abs(n-e)>Math.abs(r-t);if(i){let i=t;t=e,e=i,i=r,r=n,n=i}const o=Math.abs(r-t),s=Math.abs(n-e);let a=-o/2;const u=t<r?1:-1,l=e<n?1:-1;let h=0;const c=r+u;for(let r=t,d=e;r!==c;r+=u){const u=i?d:r,c=i?r:d;if(1===h===this.image.get(u,c)){if(2===h)return nt.distance(r,d,t,e);h++}if(a+=s,a>0){if(d===n)break;d+=l,a-=o}}return 2===h?nt.distance(r+u,n,t,e):NaN}findAlignmentInRegion(t,e,r,n){const i=Math.floor(n*t),o=Math.max(0,e-i),s=Math.min(this.image.getWidth()-1,e+i);if(s-o<3*t)throw new R("Alignment top exceeds estimated module size.");const a=Math.max(0,r-i),u=Math.min(this.image.getHeight()-1,r+i);if(u-a<3*t)throw new R("Alignment bottom exceeds estimated module size.");return new Me(this.image,o,a,s-o,u-a,t,this.resultPointCallback).find()}}class xe{constructor(){this.decoder=new Oe}getDecoder(){return this.decoder}decode(t,e){let r,n;if(null!=e&&void 0!==e.get(y.PURE_BARCODE)){const i=xe.extractPureBits(t.getBlackMatrix());r=this.decoder.decodeBitMatrix(i,e),n=xe.NO_POINTS}else{const i=new Le(t.getBlackMatrix()).detect(e);r=this.decoder.decodeBitMatrix(i.getBits(),e),n=i.getPoints()}r.getOther()instanceof Ne&&r.getOther().applyMirroredCorrection(n);const i=new F(r.getText(),r.getRawBytes(),void 0,n,V.QR_CODE,void 0),o=r.getByteSegments();null!==o&&i.putMetadata(K.BYTE_SEGMENTS,o);const s=r.getECLevel();return null!==s&&i.putMetadata(K.ERROR_CORRECTION_LEVEL,s),r.hasStructuredAppend()&&(i.putMetadata(K.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),i.putMetadata(K.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),i}reset(){}static extractPureBits(t){const e=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(null===e||null===r)throw new R;const n=this.moduleSize(e,t);let i=e[1],o=r[1],s=e[0],a=r[0];if(s>=a||i>=o)throw new R;if(o-i!=a-s&&(a=s+(o-i),a>=t.getWidth()))throw new R;const u=Math.round((a-s+1)/n),l=Math.round((o-i+1)/n);if(u<=0||l<=0)throw new R;if(l!==u)throw new R;const h=Math.floor(n/2);i+=h,s+=h;const c=s+Math.floor((u-1)*n)-a;if(c>0){if(c>h)throw new R;s-=c}const d=i+Math.floor((l-1)*n)-o;if(d>0){if(d>h)throw new R;i-=d}const f=new T(u,l);for(let e=0;e<l;e++){const r=i+Math.floor(e*n);for(let i=0;i<u;i++)t.get(s+Math.floor(i*n),r)&&f.set(i,e)}return f}static moduleSize(t,e){const r=e.getHeight(),n=e.getWidth();let i=t[0],o=t[1],s=!0,a=0;for(;i<n&&o<r;){if(s!==e.get(i,o)){if(5==++a)break;s=!s}i++,o++}if(i===n||o===r)throw new R;return(i-t[0])/7}}xe.NO_POINTS=new Array;class Fe{PDF417Common(){}static getBitCountSum(t){return nt.sum(t)}static toIntArray(t){if(null==t||!t.length)return Fe.EMPTY_INT_ARRAY;const e=new Int32Array(t.length);let r=0;for(const n of t)e[r++]=n;return e}static getCodeword(t){const e=p.binarySearch(Fe.SYMBOL_TABLE,262143&t);return e<0?-1:(Fe.CODEWORD_TABLE[e]-1)%Fe.NUMBER_OF_CODEWORDS}}Fe.NUMBER_OF_CODEWORDS=929,Fe.MAX_CODEWORDS_IN_BARCODE=Fe.NUMBER_OF_CODEWORDS-1,Fe.MIN_ROWS_IN_BARCODE=3,Fe.MAX_ROWS_IN_BARCODE=90,Fe.MODULES_IN_CODEWORD=17,Fe.MODULES_IN_STOP_PATTERN=18,Fe.BARS_IN_MODULE=8,Fe.EMPTY_INT_ARRAY=new Int32Array([]),Fe.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),Fe.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class Ue{constructor(t,e){this.bits=t,this.points=e}getBits(){return this.bits}getPoints(){return this.points}}class Ve{static detectMultiple(t,e,r){let n=t.getBlackMatrix(),i=Ve.detect(r,n);return i.length||(n=n.clone(),n.rotate180(),i=Ve.detect(r,n)),new Ue(n,i)}static detect(t,e){const r=new Array;let n=0,i=0,o=!1;for(;n<e.getHeight();){const s=Ve.findVertices(e,n,i);if(null!=s[0]||null!=s[3]){if(o=!0,r.push(s),!t)break;null!=s[2]?(i=Math.trunc(s[2].getX()),n=Math.trunc(s[2].getY())):(i=Math.trunc(s[4].getX()),n=Math.trunc(s[4].getY()))}else{if(!o)break;o=!1,i=0;for(const t of r)null!=t[1]&&(n=Math.trunc(Math.max(n,t[1].getY()))),null!=t[3]&&(n=Math.max(n,Math.trunc(t[3].getY())));n+=Ve.ROW_STEP}}return r}static findVertices(t,e,r){const n=t.getHeight(),i=t.getWidth(),o=new Array(8);return Ve.copyToResult(o,Ve.findRowsWithPattern(t,n,i,e,r,Ve.START_PATTERN),Ve.INDEXES_START_PATTERN),null!=o[4]&&(r=Math.trunc(o[4].getX()),e=Math.trunc(o[4].getY())),Ve.copyToResult(o,Ve.findRowsWithPattern(t,n,i,e,r,Ve.STOP_PATTERN),Ve.INDEXES_STOP_PATTERN),o}static copyToResult(t,e,r){for(let n=0;n<r.length;n++)t[r[n]]=e[n]}static findRowsWithPattern(t,e,r,n,i,o){const s=new Array(4);let a=!1;const u=new Int32Array(o.length);for(;n<e;n+=Ve.ROW_STEP){let e=Ve.findGuardPattern(t,i,n,r,!1,o,u);if(null!=e){for(;n>0;){const s=Ve.findGuardPattern(t,i,--n,r,!1,o,u);if(null==s){n++;break}e=s}s[0]=new ot(e[0],n),s[1]=new ot(e[1],n),a=!0;break}}let l=n+1;if(a){let n=0,i=Int32Array.from([Math.trunc(s[0].getX()),Math.trunc(s[1].getX())]);for(;l<e;l++){const e=Ve.findGuardPattern(t,i[0],l,r,!1,o,u);if(null!=e&&Math.abs(i[0]-e[0])<Ve.MAX_PATTERN_DRIFT&&Math.abs(i[1]-e[1])<Ve.MAX_PATTERN_DRIFT)i=e,n=0;else{if(n>Ve.SKIPPED_ROW_COUNT_MAX)break;n++}}l-=n+1,s[2]=new ot(i[0],l),s[3]=new ot(i[1],l)}return l-n<Ve.BARCODE_MIN_HEIGHT&&p.fill(s,null),s}static findGuardPattern(t,e,r,n,i,o,s){p.fillWithin(s,0,s.length,0);let a=e,u=0;for(;t.get(a,r)&&a>0&&u++<Ve.MAX_PIXEL_DRIFT;)a--;let l=a,h=0,c=o.length;for(let e=i;l<n;l++)if(t.get(l,r)!==e)s[h]++;else{if(h===c-1){if(Ve.patternMatchVariance(s,o,Ve.MAX_INDIVIDUAL_VARIANCE)<Ve.MAX_AVG_VARIANCE)return new Int32Array([a,l]);a+=s[0]+s[1],f.arraycopy(s,2,s,0,h-1),s[h-1]=0,s[h]=0,h--}else h++;s[h]=1,e=!e}return h===c-1&&Ve.patternMatchVariance(s,o,Ve.MAX_INDIVIDUAL_VARIANCE)<Ve.MAX_AVG_VARIANCE?new Int32Array([a,l-1]):null}static patternMatchVariance(t,e,r){let n=t.length,i=0,o=0;for(let r=0;r<n;r++)i+=t[r],o+=e[r];if(i<o)return 1/0;let s=i/o;r*=s;let a=0;for(let i=0;i<n;i++){let n=t[i],o=e[i]*s,u=n>o?n-o:o-n;if(u>r)return 1/0;a+=u}return a/i}}Ve.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Ve.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Ve.MAX_AVG_VARIANCE=.42,Ve.MAX_INDIVIDUAL_VARIANCE=.8,Ve.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Ve.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Ve.MAX_PIXEL_DRIFT=3,Ve.MAX_PATTERN_DRIFT=5,Ve.SKIPPED_ROW_COUNT_MAX=25,Ve.ROW_STEP=5,Ve.BARCODE_MIN_HEIGHT=10;class He{constructor(t,e){if(0===e.length)throw new l;this.field=t;let r=e.length;if(r>1&&0===e[0]){let t=1;for(;t<r&&0===e[t];)t++;t===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-t),f.arraycopy(e,t,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(0===t)return this.getCoefficient(0);if(1===t){let t=0;for(let e of this.coefficients)t=this.field.add(t,e);return t}let e=this.coefficients[0],r=this.coefficients.length;for(let n=1;n<r;n++)e=this.field.add(this.field.multiply(t,e),this.coefficients[n]);return e}add(t){if(!this.field.equals(t.field))throw new l("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;let e=this.coefficients,r=t.coefficients;if(e.length>r.length){let t=e;e=r,r=t}let n=new Int32Array(r.length),i=r.length-e.length;f.arraycopy(r,0,n,0,i);for(let t=i;t<r.length;t++)n[t]=this.field.add(e[t-i],r[t]);return new He(this.field,n)}subtract(t){if(!this.field.equals(t.field))throw new l("ModulusPolys do not have same ModulusGF field");return t.isZero()?this:this.add(t.negative())}multiply(t){return t instanceof He?this.multiplyOther(t):this.multiplyScalar(t)}multiplyOther(t){if(!this.field.equals(t.field))throw new l("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new He(this.field,new Int32Array([0]));let e=this.coefficients,r=e.length,n=t.coefficients,i=n.length,o=new Int32Array(r+i-1);for(let t=0;t<r;t++){let r=e[t];for(let e=0;e<i;e++)o[t+e]=this.field.add(o[t+e],this.field.multiply(r,n[e]))}return new He(this.field,o)}negative(){let t=this.coefficients.length,e=new Int32Array(t);for(let r=0;r<t;r++)e[r]=this.field.subtract(0,this.coefficients[r]);return new He(this.field,e)}multiplyScalar(t){if(0===t)return new He(this.field,new Int32Array([0]));if(1===t)return this;let e=this.coefficients.length,r=new Int32Array(e);for(let n=0;n<e;n++)r[n]=this.field.multiply(this.coefficients[n],t);return new He(this.field,r)}multiplyByMonomial(t,e){if(t<0)throw new l;if(0===e)return new He(this.field,new Int32Array([0]));let r=this.coefficients.length,n=new Int32Array(r+t);for(let t=0;t<r;t++)n[t]=this.field.multiply(this.coefficients[t],e);return new He(this.field,n)}toString(){let t=new v;for(let e=this.getDegree();e>=0;e--){let r=this.getCoefficient(e);0!==r&&(r<0?(t.append(" - "),r=-r):t.length()>0&&t.append(" + "),0!==e&&1===r||t.append(r),0!==e&&(1===e?t.append("x"):(t.append("x^"),t.append(e))))}return t.toString()}}class ze{add(t,e){return(t+e)%this.modulus}subtract(t,e){return(this.modulus+t-e)%this.modulus}exp(t){return this.expTable[t]}log(t){if(0===t)throw new l;return this.logTable[t]}inverse(t){if(0===t)throw new Q;return this.expTable[this.modulus-this.logTable[t]-1]}multiply(t,e){return 0===t||0===e?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.modulus-1)]}getSize(){return this.modulus}equals(t){return t===this}}class Ge extends ze{constructor(t,e){super(),this.modulus=t,this.expTable=new Int32Array(t),this.logTable=new Int32Array(t);let r=1;for(let n=0;n<t;n++)this.expTable[n]=r,r=r*e%t;for(let e=0;e<t-1;e++)this.logTable[this.expTable[e]]=e;this.zero=new He(this,new Int32Array([0])),this.one=new He(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,e){if(t<0)throw new l;if(0===e)return this.zero;let r=new Int32Array(t+1);return r[0]=e,new He(this,r)}}Ge.PDF417_GF=new Ge(Fe.NUMBER_OF_CODEWORDS,3);class Xe{constructor(){this.field=Ge.PDF417_GF}decode(t,e,r){let n=new He(this.field,t),i=new Int32Array(e),o=!1;for(let t=e;t>0;t--){let r=n.evaluateAt(this.field.exp(t));i[e-t]=r,0!==r&&(o=!0)}if(!o)return 0;let s=this.field.getOne();if(null!=r)for(const e of r){let r=this.field.exp(t.length-1-e),n=new He(this.field,new Int32Array([this.field.subtract(0,r),1]));s=s.multiply(n)}let a=new He(this.field,i),u=this.runEuclideanAlgorithm(this.field.buildMonomial(e,1),a,e),l=u[0],h=u[1],d=this.findErrorLocations(l),f=this.findErrorMagnitudes(h,l,d);for(let e=0;e<d.length;e++){let r=t.length-1-this.field.log(d[e]);if(r<0)throw c.getChecksumInstance();t[r]=this.field.subtract(t[r],f[e])}return d.length}runEuclideanAlgorithm(t,e,r){if(t.getDegree()<e.getDegree()){let r=t;t=e,e=r}let n=t,i=e,o=this.field.getZero(),s=this.field.getOne();for(;i.getDegree()>=Math.round(r/2);){let t=n,e=o;if(n=i,o=s,n.isZero())throw c.getChecksumInstance();i=t;let r=this.field.getZero(),a=n.getCoefficient(n.getDegree()),u=this.field.inverse(a);for(;i.getDegree()>=n.getDegree()&&!i.isZero();){let t=i.getDegree()-n.getDegree(),e=this.field.multiply(i.getCoefficient(i.getDegree()),u);r=r.add(this.field.buildMonomial(t,e)),i=i.subtract(n.multiplyByMonomial(t,e))}s=r.multiply(o).subtract(e).negative()}let a=s.getCoefficient(0);if(0===a)throw c.getChecksumInstance();let u=this.field.inverse(a);return[s.multiply(u),i.multiply(u)]}findErrorLocations(t){let e=t.getDegree(),r=new Int32Array(e),n=0;for(let i=1;i<this.field.getSize()&&n<e;i++)0===t.evaluateAt(i)&&(r[n]=this.field.inverse(i),n++);if(n!==e)throw c.getChecksumInstance();return r}findErrorMagnitudes(t,e,r){let n=e.getDegree(),i=new Int32Array(n);for(let t=1;t<=n;t++)i[n-t]=this.field.multiply(t,e.getCoefficient(t));let o=new He(this.field,i),s=r.length,a=new Int32Array(s);for(let e=0;e<s;e++){let n=this.field.inverse(r[e]),i=this.field.subtract(0,t.evaluateAt(n)),s=this.field.inverse(o.evaluateAt(n));a[e]=this.field.multiply(i,s)}return a}}class We{constructor(t,e,r,n,i){t instanceof We?this.constructor_2(t):this.constructor_1(t,e,r,n,i)}constructor_1(t,e,r,n,i){const o=null==e||null==r,s=null==n||null==i;if(o&&s)throw new R;o?(e=new ot(0,n.getY()),r=new ot(0,i.getY())):s&&(n=new ot(t.getWidth()-1,e.getY()),i=new ot(t.getWidth()-1,r.getY())),this.image=t,this.topLeft=e,this.bottomLeft=r,this.topRight=n,this.bottomRight=i,this.minX=Math.trunc(Math.min(e.getX(),r.getX())),this.maxX=Math.trunc(Math.max(n.getX(),i.getX())),this.minY=Math.trunc(Math.min(e.getY(),n.getY())),this.maxY=Math.trunc(Math.max(r.getY(),i.getY()))}constructor_2(t){this.image=t.image,this.topLeft=t.getTopLeft(),this.bottomLeft=t.getBottomLeft(),this.topRight=t.getTopRight(),this.bottomRight=t.getBottomRight(),this.minX=t.getMinX(),this.maxX=t.getMaxX(),this.minY=t.getMinY(),this.maxY=t.getMaxY()}static merge(t,e){return null==t?e:null==e?t:new We(t.image,t.topLeft,t.bottomLeft,e.topRight,e.bottomRight)}addMissingRows(t,e,r){let n=this.topLeft,i=this.bottomLeft,o=this.topRight,s=this.bottomRight;if(t>0){let e=r?this.topLeft:this.topRight,i=Math.trunc(e.getY()-t);i<0&&(i=0);let s=new ot(e.getX(),i);r?n=s:o=s}if(e>0){let t=r?this.bottomLeft:this.bottomRight,n=Math.trunc(t.getY()+e);n>=this.image.getHeight()&&(n=this.image.getHeight()-1);let o=new ot(t.getX(),n);r?i=o:s=o}return new We(this.image,n,i,o,s)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Ye{constructor(t,e,r,n){this.columnCount=t,this.errorCorrectionLevel=n,this.rowCountUpperPart=e,this.rowCountLowerPart=r,this.rowCount=e+r}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class Ke{constructor(){this.buffer=""}static form(t,e){let r=-1;function n(t,n,i,o,s,a){if("%%"===t)return"%";if(void 0===e[++r])return;t=o?parseInt(o.substr(1)):void 0;let u,l=s?parseInt(s.substr(1)):void 0;switch(a){case"s":u=e[r];break;case"c":u=e[r][0];break;case"f":u=parseFloat(e[r]).toFixed(t);break;case"p":u=parseFloat(e[r]).toPrecision(t);break;case"e":u=parseFloat(e[r]).toExponential(t);break;case"x":u=parseInt(e[r]).toString(l||16);break;case"d":u=parseFloat(parseInt(e[r],l||10).toPrecision(t)).toFixed(0)}u="object"==typeof u?JSON.stringify(u):(+u).toString(l);let h=parseInt(i),c=i&&i[0]+""=="0"?"0":" ";for(;u.length<h;)u=void 0!==n?u+c:c+u;return u}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(i,n)}format(t,...e){this.buffer+=Ke.form(t,e)}toString(){return this.buffer}}class Ze{constructor(t){this.boundingBox=new We(t),this.codewords=new Array(t.getMaxY()-t.getMinY()+1)}getCodewordNearby(t){let e=this.getCodeword(t);if(null!=e)return e;for(let r=1;r<Ze.MAX_NEARBY_DISTANCE;r++){let n=this.imageRowToCodewordIndex(t)-r;if(n>=0&&(e=this.codewords[n],null!=e))return e;if(n=this.imageRowToCodewordIndex(t)+r,n<this.codewords.length&&(e=this.codewords[n],null!=e))return e}return null}imageRowToCodewordIndex(t){return t-this.boundingBox.getMinY()}setCodeword(t,e){this.codewords[this.imageRowToCodewordIndex(t)]=e}getCodeword(t){return this.codewords[this.imageRowToCodewordIndex(t)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const t=new Ke;let e=0;for(const r of this.codewords)null!=r?t.format("%3d: %3d|%3d%n",e++,r.getRowNumber(),r.getValue()):t.format("%3d:    |   %n",e++);return t.toString()}}Ze.MAX_NEARBY_DISTANCE=5;class je{constructor(){this.values=new Map}setValue(t){t=Math.trunc(t);let e=this.values.get(t);null==e&&(e=0),e++,this.values.set(t,e)}getValue(){let t=-1,e=new Array;for(const[r,n]of this.values.entries()){const i={getKey:()=>r,getValue:()=>n};i.getValue()>t?(t=i.getValue(),e=[],e.push(i.getKey())):i.getValue()===t&&e.push(i.getKey())}return Fe.toIntArray(e)}getConfidence(t){return this.values.get(t)}}class qe extends Ze{constructor(t,e){super(t),this._isLeft=e}setRowNumbers(){for(let t of this.getCodewords())null!=t&&t.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(t){let e=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(e,t);let r=this.getBoundingBox(),n=this._isLeft?r.getTopLeft():r.getTopRight(),i=this._isLeft?r.getBottomLeft():r.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.imageRowToCodewordIndex(Math.trunc(i.getY())),a=-1,u=1,l=0;for(let r=o;r<s;r++){if(null==e[r])continue;let n=e[r],i=n.getRowNumber()-a;if(0===i)l++;else if(1===i)u=Math.max(u,l),l=1,a=n.getRowNumber();else if(i<0||n.getRowNumber()>=t.getRowCount()||i>r)e[r]=null;else{let t;t=u>2?(u-2)*i:i;let o=t>=r;for(let n=1;n<=t&&!o;n++)o=null!=e[r-n];o?e[r]=null:(a=n.getRowNumber(),l=1)}}}getRowHeights(){let t=this.getBarcodeMetadata();if(null==t)return null;this.adjustIncompleteIndicatorColumnRowNumbers(t);let e=new Int32Array(t.getRowCount());for(let t of this.getCodewords())if(null!=t){let r=t.getRowNumber();if(r>=e.length)continue;e[r]++}return e}adjustIncompleteIndicatorColumnRowNumbers(t){let e=this.getBoundingBox(),r=this._isLeft?e.getTopLeft():e.getTopRight(),n=this._isLeft?e.getBottomLeft():e.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(r.getY())),o=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.getCodewords(),a=-1;for(let e=i;e<o;e++){if(null==s[e])continue;let r=s[e];r.setRowNumberAsRowIndicatorColumn();let n=r.getRowNumber()-a;0===n||(1===n?a=r.getRowNumber():r.getRowNumber()>=t.getRowCount()?s[e]=null:a=r.getRowNumber())}}getBarcodeMetadata(){let t=this.getCodewords(),e=new je,r=new je,n=new je,i=new je;for(let o of t){if(null==o)continue;o.setRowNumberAsRowIndicatorColumn();let t=o.getValue()%30,s=o.getRowNumber();switch(this._isLeft||(s+=2),s%3){case 0:r.setValue(3*t+1);break;case 1:i.setValue(t/3),n.setValue(t%3);break;case 2:e.setValue(t+1)}}if(0===e.getValue().length||0===r.getValue().length||0===n.getValue().length||0===i.getValue().length||e.getValue()[0]<1||r.getValue()[0]+n.getValue()[0]<Fe.MIN_ROWS_IN_BARCODE||r.getValue()[0]+n.getValue()[0]>Fe.MAX_ROWS_IN_BARCODE)return null;let o=new Ye(e.getValue()[0],r.getValue()[0],n.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(t,o),o}removeIncorrectCodewords(t,e){for(let r=0;r<t.length;r++){let n=t[r];if(null==t[r])continue;let i=n.getValue()%30,o=n.getRowNumber();if(o>e.getRowCount())t[r]=null;else switch(this._isLeft||(o+=2),o%3){case 0:3*i+1!==e.getRowCountUpperPart()&&(t[r]=null);break;case 1:Math.trunc(i/3)===e.getErrorCorrectionLevel()&&i%3===e.getRowCountLowerPart()||(t[r]=null);break;case 2:i+1!==e.getColumnCount()&&(t[r]=null)}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+"\n"+super.toString()}}class Qe{constructor(t,e){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=e,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let t,e=Fe.MAX_CODEWORDS_IN_BARCODE;do{t=e,e=this.adjustRowNumbersAndGetCount()}while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(t){null!=t&&t.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let t=this.adjustRowNumbersByRow();if(0===t)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let e=this.detectionResultColumns[t].getCodewords();for(let r=0;r<e.length;r++)null!=e[r]&&(e[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,e))}return t}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(null==this.detectionResultColumns[0]||null==this.detectionResultColumns[this.barcodeColumnCount+1])return;let t=this.detectionResultColumns[0].getCodewords(),e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<t.length;r++)if(null!=t[r]&&null!=e[r]&&t[r].getRowNumber()===e[r].getRowNumber())for(let e=1;e<=this.barcodeColumnCount;e++){let n=this.detectionResultColumns[e].getCodewords()[r];null!=n&&(n.setRowNumber(t[r].getRowNumber()),n.hasValidRowNumber()||(this.detectionResultColumns[e].getCodewords()[r]=null))}}adjustRowNumbersFromRRI(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;let t=0,e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<e.length;r++){if(null==e[r])continue;let n=e[r].getRowNumber(),i=0;for(let e=this.barcodeColumnCount+1;e>0&&i<this.ADJUST_ROW_NUMBER_SKIP;e--){let o=this.detectionResultColumns[e].getCodewords()[r];null!=o&&(i=Qe.adjustRowNumberIfValid(n,i,o),o.hasValidRowNumber()||t++)}}return t}adjustRowNumbersFromLRI(){if(null==this.detectionResultColumns[0])return 0;let t=0,e=this.detectionResultColumns[0].getCodewords();for(let r=0;r<e.length;r++){if(null==e[r])continue;let n=e[r].getRowNumber(),i=0;for(let e=1;e<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;e++){let o=this.detectionResultColumns[e].getCodewords()[r];null!=o&&(i=Qe.adjustRowNumberIfValid(n,i,o),o.hasValidRowNumber()||t++)}}return t}static adjustRowNumberIfValid(t,e,r){return null==r||r.hasValidRowNumber()||(r.isValidRowNumber(t)?(r.setRowNumber(t),e=0):++e),e}adjustRowNumbers(t,e,r){let n=r[e],i=this.detectionResultColumns[t-1].getCodewords(),o=i;null!=this.detectionResultColumns[t+1]&&(o=this.detectionResultColumns[t+1].getCodewords());let s=new Array(14);s[2]=i[e],s[3]=o[e],e>0&&(s[0]=r[e-1],s[4]=i[e-1],s[5]=o[e-1]),e>1&&(s[8]=r[e-2],s[10]=i[e-2],s[11]=o[e-2]),e<r.length-1&&(s[1]=r[e+1],s[6]=i[e+1],s[7]=o[e+1]),e<r.length-2&&(s[9]=r[e+2],s[12]=i[e+2],s[13]=o[e+2]);for(let t of s)if(Qe.adjustRowNumber(n,t))return}static adjustRowNumber(t,e){return!(null==e||!e.hasValidRowNumber()||e.getBucket()!==t.getBucket()||(t.setRowNumber(e.getRowNumber()),0))}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(t){this.boundingBox=t}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(t,e){this.detectionResultColumns[t]=e}getDetectionResultColumn(t){return this.detectionResultColumns[t]}toString(){let t=this.detectionResultColumns[0];null==t&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]);let e=new Ke;for(let r=0;r<t.getCodewords().length;r++){e.format("CW %3d:",r);for(let t=0;t<this.barcodeColumnCount+2;t++){if(null==this.detectionResultColumns[t]){e.format("    |   ");continue}let n=this.detectionResultColumns[t].getCodewords()[r];null!=n?e.format(" %3d|%3d",n.getRowNumber(),n.getValue()):e.format("    |   ")}e.format("%n")}return e.toString()}}class Je{constructor(t,e,r,n){this.rowNumber=Je.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(t),this.endX=Math.trunc(e),this.bucket=Math.trunc(r),this.value=Math.trunc(n)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(t){return t!==Je.BARCODE_ROW_UNKNOWN&&this.bucket===t%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(t){this.rowNumber=t}toString(){return this.rowNumber+"|"+this.value}}Je.BARCODE_ROW_UNKNOWN=-1;class $e{static initialize(){for(let t=0;t<Fe.SYMBOL_TABLE.length;t++){let e=Fe.SYMBOL_TABLE[t],r=1&e;for(let n=0;n<Fe.BARS_IN_MODULE;n++){let i=0;for(;(1&e)===r;)i+=1,e>>=1;r=1&e,$e.RATIOS_TABLE[t]||($e.RATIOS_TABLE[t]=new Array(Fe.BARS_IN_MODULE)),$e.RATIOS_TABLE[t][Fe.BARS_IN_MODULE-n-1]=Math.fround(i/Fe.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(t){let e=$e.getDecodedCodewordValue($e.sampleBitCounts(t));return-1!==e?e:$e.getClosestDecodedValue(t)}static sampleBitCounts(t){let e=nt.sum(t),r=new Int32Array(Fe.BARS_IN_MODULE),n=0,i=0;for(let o=0;o<Fe.MODULES_IN_CODEWORD;o++){let s=e/(2*Fe.MODULES_IN_CODEWORD)+o*e/Fe.MODULES_IN_CODEWORD;i+t[n]<=s&&(i+=t[n],n++),r[n]++}return r}static getDecodedCodewordValue(t){let e=$e.getBitValue(t);return-1===Fe.getCodeword(e)?-1:e}static getBitValue(t){let e=0;for(let r=0;r<t.length;r++)for(let n=0;n<t[r];n++)e=e<<1|(r%2==0?1:0);return Math.trunc(e)}static getClosestDecodedValue(t){let e=nt.sum(t),r=new Array(Fe.BARS_IN_MODULE);if(e>1)for(let n=0;n<r.length;n++)r[n]=Math.fround(t[n]/e);let n=it.MAX_VALUE,i=-1;this.bSymbolTableReady||$e.initialize();for(let t=0;t<$e.RATIOS_TABLE.length;t++){let e=0,o=$e.RATIOS_TABLE[t];for(let t=0;t<Fe.BARS_IN_MODULE;t++){let i=Math.fround(o[t]-r[t]);if(e+=Math.fround(i*i),e>=n)break}e<n&&(n=e,i=Fe.SYMBOL_TABLE[t])}return i}}$e.bSymbolTableReady=!1,$e.RATIOS_TABLE=new Array(Fe.SYMBOL_TABLE.length).map((t=>new Array(Fe.BARS_IN_MODULE)));class tr{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(t){this.segmentIndex=t}getFileId(){return this.fileId}setFileId(t){this.fileId=t}getOptionalData(){return this.optionalData}setOptionalData(t){this.optionalData=t}isLastSegment(){return this.lastSegment}setLastSegment(t){this.lastSegment=t}getSegmentCount(){return this.segmentCount}setSegmentCount(t){this.segmentCount=t}getSender(){return this.sender||null}setSender(t){this.sender=t}getAddressee(){return this.addressee||null}setAddressee(t){this.addressee=t}getFileName(){return this.fileName}setFileName(t){this.fileName=t}getFileSize(){return this.fileSize}setFileSize(t){this.fileSize=t}getChecksum(){return this.checksum}setChecksum(t){this.checksum=t}getTimestamp(){return this.timestamp}setTimestamp(t){this.timestamp=t}}class er{static parseLong(t,e){return parseInt(t,e)}}class rr extends a{}rr.kind="NullPointerException";class nr{writeBytes(t){this.writeBytesOffset(t,0,t.length)}writeBytesOffset(t,e,r){if(null==t)throw new rr;if(e<0||e>t.length||r<0||e+r>t.length||e+r<0)throw new g;if(0!==r)for(let n=0;n<r;n++)this.write(t[e+n])}flush(){}close(){}}class ir extends a{}class or extends nr{constructor(t=32){if(super(),this.count=0,t<0)throw new l("Negative initial size: "+t);this.buf=new Uint8Array(t)}ensureCapacity(t){t-this.buf.length>0&&this.grow(t)}grow(t){let e=this.buf.length<<1;if(e-t<0&&(e=t),e<0){if(t<0)throw new ir;e=m.MAX_VALUE}this.buf=p.copyOfUint8Array(this.buf,e)}write(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1}writeBytesOffset(t,e,r){if(e<0||e>t.length||r<0||e+r-t.length>0)throw new g;this.ensureCapacity(this.count+r),f.arraycopy(t,e,this.buf,this.count,r),this.count+=r}writeTo(t){t.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return p.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(t){return t?"string"==typeof t?this.toString_string(t):this.toString_number(t):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(t){return new String(this.buf).toString()}toString_number(t){return new String(this.buf).toString()}close(){}}function sr(){if("undefined"!=typeof window)return window.BigInt||null;if(void 0!==fr)return fr.BigInt||null;if("undefined"!=typeof self)return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let ar;function ur(t){if(void 0===ar&&(ar=sr()),null===ar)throw new Error("BigInt is not supported!");return ar(t)}function lr(){let t=[];t[0]=ur(1);let e=ur(900);t[1]=e;for(let r=2;r<16;r++)t[r]=t[r-1]*e;return t}!function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"}(Y||(Y={}));class hr{static decode(t,e){let r=new v(""),n=C.ISO8859_1;r.enableDecoding(n);let i=1,o=t[i++],s=new tr;for(;i<t[0];){switch(o){case hr.TEXT_COMPACTION_MODE_LATCH:i=hr.textCompaction(t,i,r);break;case hr.BYTE_COMPACTION_MODE_LATCH:case hr.BYTE_COMPACTION_MODE_LATCH_6:i=hr.byteCompaction(o,t,n,i,r);break;case hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[i++]);break;case hr.NUMERIC_COMPACTION_MODE_LATCH:i=hr.numericCompaction(t,i,r);break;case hr.ECI_CHARSET:C.getCharacterSetECIByValue(t[i++]);break;case hr.ECI_GENERAL_PURPOSE:i+=2;break;case hr.ECI_USER_DEFINED:i++;break;case hr.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=hr.decodeMacroBlock(t,i,s);break;case hr.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case hr.MACRO_PDF417_TERMINATOR:throw new E;default:i--,i=hr.textCompaction(t,i,r)}if(!(i<t.length))throw E.getFormatInstance();o=t[i++]}if(0===r.length())throw E.getFormatInstance();let a=new Z(null,r.toString(),null,e);return a.setOther(s),a}static decodeMacroBlock(t,e,r){if(e+hr.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw E.getFormatInstance();let n=new Int32Array(hr.NUMBER_OF_SEQUENCE_CODEWORDS);for(let r=0;r<hr.NUMBER_OF_SEQUENCE_CODEWORDS;r++,e++)n[r]=t[e];r.setSegmentIndex(m.parseInt(hr.decodeBase900toBase10(n,hr.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new v;e=hr.textCompaction(t,e,i),r.setFileId(i.toString());let o=-1;for(t[e]===hr.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(o=e+1);e<t[0];)switch(t[e]){case hr.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t[++e]){case hr.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let n=new v;e=hr.textCompaction(t,e+1,n),r.setFileName(n.toString());break;case hr.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let i=new v;e=hr.textCompaction(t,e+1,i),r.setSender(i.toString());break;case hr.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let o=new v;e=hr.textCompaction(t,e+1,o),r.setAddressee(o.toString());break;case hr.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let s=new v;e=hr.numericCompaction(t,e+1,s),r.setSegmentCount(m.parseInt(s.toString()));break;case hr.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let a=new v;e=hr.numericCompaction(t,e+1,a),r.setTimestamp(er.parseLong(a.toString()));break;case hr.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let u=new v;e=hr.numericCompaction(t,e+1,u),r.setChecksum(m.parseInt(u.toString()));break;case hr.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let l=new v;e=hr.numericCompaction(t,e+1,l),r.setFileSize(er.parseLong(l.toString()));break;default:throw E.getFormatInstance()}break;case hr.MACRO_PDF417_TERMINATOR:e++,r.setLastSegment(!0);break;default:throw E.getFormatInstance()}if(-1!==o){let n=e-o;r.isLastSegment()&&n--,r.setOptionalData(p.copyOfRange(t,o,o+n))}return e}static textCompaction(t,e,r){let n=new Int32Array(2*(t[0]-e)),i=new Int32Array(2*(t[0]-e)),o=0,s=!1;for(;e<t[0]&&!s;){let r=t[e++];if(r<hr.TEXT_COMPACTION_MODE_LATCH)n[o]=r/30,n[o+1]=r%30,o+=2;else switch(r){case hr.TEXT_COMPACTION_MODE_LATCH:n[o++]=hr.TEXT_COMPACTION_MODE_LATCH;break;case hr.BYTE_COMPACTION_MODE_LATCH:case hr.BYTE_COMPACTION_MODE_LATCH_6:case hr.NUMERIC_COMPACTION_MODE_LATCH:case hr.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case hr.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case hr.MACRO_PDF417_TERMINATOR:e--,s=!0;break;case hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n[o]=hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,r=t[e++],i[o]=r,o++}}return hr.decodeTextCompaction(n,i,o,r),e}static decodeTextCompaction(t,e,r,n){let i=Y.ALPHA,o=Y.ALPHA,s=0;for(;s<r;){let r=t[s],a="";switch(i){case Y.ALPHA:if(r<26)a=String.fromCharCode(65+r);else switch(r){case 26:a=" ";break;case hr.LL:i=Y.LOWER;break;case hr.ML:i=Y.MIXED;break;case hr.PS:o=i,i=Y.PUNCT_SHIFT;break;case hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case hr.TEXT_COMPACTION_MODE_LATCH:i=Y.ALPHA}break;case Y.LOWER:if(r<26)a=String.fromCharCode(97+r);else switch(r){case 26:a=" ";break;case hr.AS:o=i,i=Y.ALPHA_SHIFT;break;case hr.ML:i=Y.MIXED;break;case hr.PS:o=i,i=Y.PUNCT_SHIFT;break;case hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case hr.TEXT_COMPACTION_MODE_LATCH:i=Y.ALPHA}break;case Y.MIXED:if(r<hr.PL)a=hr.MIXED_CHARS[r];else switch(r){case hr.PL:i=Y.PUNCT;break;case 26:a=" ";break;case hr.LL:i=Y.LOWER;break;case hr.AL:i=Y.ALPHA;break;case hr.PS:o=i,i=Y.PUNCT_SHIFT;break;case hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case hr.TEXT_COMPACTION_MODE_LATCH:i=Y.ALPHA}break;case Y.PUNCT:if(r<hr.PAL)a=hr.PUNCT_CHARS[r];else switch(r){case hr.PAL:i=Y.ALPHA;break;case hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case hr.TEXT_COMPACTION_MODE_LATCH:i=Y.ALPHA}break;case Y.ALPHA_SHIFT:if(i=o,r<26)a=String.fromCharCode(65+r);else switch(r){case 26:a=" ";break;case hr.TEXT_COMPACTION_MODE_LATCH:i=Y.ALPHA}break;case Y.PUNCT_SHIFT:if(i=o,r<hr.PAL)a=hr.PUNCT_CHARS[r];else switch(r){case hr.PAL:i=Y.ALPHA;break;case hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case hr.TEXT_COMPACTION_MODE_LATCH:i=Y.ALPHA}}""!==a&&n.append(a),s++}}static byteCompaction(t,e,r,n,i){let o=new or,s=0,a=0,u=!1;switch(t){case hr.BYTE_COMPACTION_MODE_LATCH:let t=new Int32Array(6),r=e[n++];for(;n<e[0]&&!u;)switch(t[s++]=r,a=900*a+r,r=e[n++],r){case hr.TEXT_COMPACTION_MODE_LATCH:case hr.BYTE_COMPACTION_MODE_LATCH:case hr.NUMERIC_COMPACTION_MODE_LATCH:case hr.BYTE_COMPACTION_MODE_LATCH_6:case hr.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case hr.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case hr.MACRO_PDF417_TERMINATOR:n--,u=!0;break;default:if(s%5==0&&s>0){for(let t=0;t<6;++t)o.write(Number(ur(a)>>ur(8*(5-t))));a=0,s=0}}n===e[0]&&r<hr.TEXT_COMPACTION_MODE_LATCH&&(t[s++]=r);for(let e=0;e<s;e++)o.write(t[e]);break;case hr.BYTE_COMPACTION_MODE_LATCH_6:for(;n<e[0]&&!u;){let t=e[n++];if(t<hr.TEXT_COMPACTION_MODE_LATCH)s++,a=900*a+t;else switch(t){case hr.TEXT_COMPACTION_MODE_LATCH:case hr.BYTE_COMPACTION_MODE_LATCH:case hr.NUMERIC_COMPACTION_MODE_LATCH:case hr.BYTE_COMPACTION_MODE_LATCH_6:case hr.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case hr.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case hr.MACRO_PDF417_TERMINATOR:n--,u=!0}if(s%5==0&&s>0){for(let t=0;t<6;++t)o.write(Number(ur(a)>>ur(8*(5-t))));a=0,s=0}}}return i.append(b.decode(o.toByteArray(),r)),n}static numericCompaction(t,e,r){let n=0,i=!1,o=new Int32Array(hr.MAX_NUMERIC_CODEWORDS);for(;e<t[0]&&!i;){let s=t[e++];if(e===t[0]&&(i=!0),s<hr.TEXT_COMPACTION_MODE_LATCH)o[n]=s,n++;else switch(s){case hr.TEXT_COMPACTION_MODE_LATCH:case hr.BYTE_COMPACTION_MODE_LATCH:case hr.BYTE_COMPACTION_MODE_LATCH_6:case hr.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case hr.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case hr.MACRO_PDF417_TERMINATOR:e--,i=!0}(n%hr.MAX_NUMERIC_CODEWORDS==0||s===hr.NUMERIC_COMPACTION_MODE_LATCH||i)&&n>0&&(r.append(hr.decodeBase900toBase10(o,n)),n=0)}return e}static decodeBase900toBase10(t,e){let r=ur(0);for(let n=0;n<e;n++)r+=hr.EXP900[e-n-1]*ur(t[n]);let n=r.toString();if("1"!==n.charAt(0))throw new E;return n.substring(1)}}hr.TEXT_COMPACTION_MODE_LATCH=900,hr.BYTE_COMPACTION_MODE_LATCH=901,hr.NUMERIC_COMPACTION_MODE_LATCH=902,hr.BYTE_COMPACTION_MODE_LATCH_6=924,hr.ECI_USER_DEFINED=925,hr.ECI_GENERAL_PURPOSE=926,hr.ECI_CHARSET=927,hr.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,hr.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,hr.MACRO_PDF417_TERMINATOR=922,hr.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,hr.MAX_NUMERIC_CODEWORDS=15,hr.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,hr.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,hr.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,hr.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,hr.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,hr.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,hr.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,hr.PL=25,hr.LL=27,hr.AS=27,hr.ML=28,hr.AL=28,hr.PS=29,hr.PAL=29,hr.PUNCT_CHARS=";<>@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'",hr.MIXED_CHARS="0123456789&\r\t,:#-.$/+%*=^",hr.EXP900=sr()?lr():[],hr.NUMBER_OF_SEQUENCE_CODEWORDS=2;class cr{constructor(){}static decode(t,e,r,n,i,o,s){let a,u=new We(t,e,r,n,i),l=null,h=null;for(let r=!0;;r=!1){if(null!=e&&(l=cr.getRowIndicatorColumn(t,u,e,!0,o,s)),null!=n&&(h=cr.getRowIndicatorColumn(t,u,n,!1,o,s)),a=cr.merge(l,h),null==a)throw R.getNotFoundInstance();let i=a.getBoundingBox();if(!r||null==i||!(i.getMinY()<u.getMinY()||i.getMaxY()>u.getMaxY()))break;u=i}a.setBoundingBox(u);let c=a.getBarcodeColumnCount()+1;a.setDetectionResultColumn(0,l),a.setDetectionResultColumn(c,h);let d=null!=l;for(let e=1;e<=c;e++){let r,n=d?e:c-e;if(void 0!==a.getDetectionResultColumn(n))continue;r=0===n||n===c?new qe(u,0===n):new Ze(u),a.setDetectionResultColumn(n,r);let i=-1,l=i;for(let e=u.getMinY();e<=u.getMaxY();e++){if(i=cr.getStartColumn(a,n,e,d),i<0||i>u.getMaxX()){if(-1===l)continue;i=l}let h=cr.detectCodeword(t,u.getMinX(),u.getMaxX(),d,i,e,o,s);null!=h&&(r.setCodeword(e,h),l=i,o=Math.min(o,h.getWidth()),s=Math.max(s,h.getWidth()))}}return cr.createDecoderResult(a)}static merge(t,e){if(null==t&&null==e)return null;let r=cr.getBarcodeMetadata(t,e);if(null==r)return null;let n=We.merge(cr.adjustBoundingBox(t),cr.adjustBoundingBox(e));return new Qe(r,n)}static adjustBoundingBox(t){if(null==t)return null;let e=t.getRowHeights();if(null==e)return null;let r=cr.getMax(e),n=0;for(let t of e)if(n+=r-t,t>0)break;let i=t.getCodewords();for(let t=0;n>0&&null==i[t];t++)n--;let o=0;for(let t=e.length-1;t>=0&&(o+=r-e[t],!(e[t]>0));t--);for(let t=i.length-1;o>0&&null==i[t];t--)o--;return t.getBoundingBox().addMissingRows(n,o,t.isLeft())}static getMax(t){let e=-1;for(let r of t)e=Math.max(e,r);return e}static getBarcodeMetadata(t,e){let r,n;return null==t||null==(r=t.getBarcodeMetadata())?null==e?null:e.getBarcodeMetadata():null==e||null==(n=e.getBarcodeMetadata())?r:r.getColumnCount()!==n.getColumnCount()&&r.getErrorCorrectionLevel()!==n.getErrorCorrectionLevel()&&r.getRowCount()!==n.getRowCount()?null:r}static getRowIndicatorColumn(t,e,r,n,i,o){let s=new qe(e,n);for(let a=0;a<2;a++){let u=0===a?1:-1,l=Math.trunc(Math.trunc(r.getX()));for(let a=Math.trunc(Math.trunc(r.getY()));a<=e.getMaxY()&&a>=e.getMinY();a+=u){let e=cr.detectCodeword(t,0,t.getWidth(),n,l,a,i,o);null!=e&&(s.setCodeword(a,e),l=n?e.getStartX():e.getEndX())}}return s}static adjustCodewordCount(t,e){let r=e[0][1],n=r.getValue(),i=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-cr.getNumberOfECCodeWords(t.getBarcodeECLevel());if(0===n.length){if(i<1||i>Fe.MAX_CODEWORDS_IN_BARCODE)throw R.getNotFoundInstance();r.setValue(i)}else n[0]!==i&&r.setValue(i)}static createDecoderResult(t){let e=cr.createBarcodeMatrix(t);cr.adjustCodewordCount(t,e);let r=new Array,n=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),i=[],o=new Array;for(let s=0;s<t.getBarcodeRowCount();s++)for(let a=0;a<t.getBarcodeColumnCount();a++){let u=e[s][a+1].getValue(),l=s*t.getBarcodeColumnCount()+a;0===u.length?r.push(l):1===u.length?n[l]=u[0]:(o.push(l),i.push(u))}let s=new Array(i.length);for(let t=0;t<s.length;t++)s[t]=i[t];return cr.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),n,Fe.toIntArray(r),Fe.toIntArray(o),s)}static createDecoderResultFromAmbiguousValues(t,e,r,n,i){let o=new Int32Array(n.length),s=100;for(;s-- >0;){for(let t=0;t<o.length;t++)e[n[t]]=i[t][o[t]];try{return cr.decodeCodewords(e,t,r)}catch(t){if(!(t instanceof c))throw t}if(0===o.length)throw c.getChecksumInstance();for(let t=0;t<o.length;t++){if(o[t]<i[t].length-1){o[t]++;break}if(o[t]=0,t===o.length-1)throw c.getChecksumInstance()}}throw c.getChecksumInstance()}static createBarcodeMatrix(t){let e=Array.from({length:t.getBarcodeRowCount()},(()=>new Array(t.getBarcodeColumnCount()+2)));for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)e[t][r]=new je;let r=0;for(let n of t.getDetectionResultColumns()){if(null!=n)for(let t of n.getCodewords())if(null!=t){let n=t.getRowNumber();if(n>=0){if(n>=e.length)continue;e[n][r].setValue(t.getValue())}}r++}return e}static isValidBarcodeColumn(t,e){return e>=0&&e<=t.getBarcodeColumnCount()+1}static getStartColumn(t,e,r,n){let i=n?1:-1,o=null;if(cr.isValidBarcodeColumn(t,e-i)&&(o=t.getDetectionResultColumn(e-i).getCodeword(r)),null!=o)return n?o.getEndX():o.getStartX();if(o=t.getDetectionResultColumn(e).getCodewordNearby(r),null!=o)return n?o.getStartX():o.getEndX();if(cr.isValidBarcodeColumn(t,e-i)&&(o=t.getDetectionResultColumn(e-i).getCodewordNearby(r)),null!=o)return n?o.getEndX():o.getStartX();let s=0;for(;cr.isValidBarcodeColumn(t,e-i);){e-=i;for(let r of t.getDetectionResultColumn(e).getCodewords())if(null!=r)return(n?r.getEndX():r.getStartX())+i*s*(r.getEndX()-r.getStartX());s++}return n?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()}static detectCodeword(t,e,r,n,i,o,s,a){i=cr.adjustCodewordStartColumn(t,e,r,n,i,o);let u,l=cr.getModuleBitCount(t,e,r,n,i,o);if(null==l)return null;let h=nt.sum(l);if(n)u=i+h;else{for(let t=0;t<l.length/2;t++){let e=l[t];l[t]=l[l.length-1-t],l[l.length-1-t]=e}u=i,i=u-h}if(!cr.checkCodewordSkew(h,s,a))return null;let c=$e.getDecodedValue(l),d=Fe.getCodeword(c);return-1===d?null:new Je(i,u,cr.getCodewordBucketNumber(c),d)}static getModuleBitCount(t,e,r,n,i,o){let s=i,a=new Int32Array(8),u=0,l=n?1:-1,h=n;for(;(n?s<r:s>=e)&&u<a.length;)t.get(s,o)===h?(a[u]++,s+=l):(u++,h=!h);return u===a.length||s===(n?r:e)&&u===a.length-1?a:null}static getNumberOfECCodeWords(t){return 2<<t}static adjustCodewordStartColumn(t,e,r,n,i,o){let s=i,a=n?-1:1;for(let u=0;u<2;u++){for(;(n?s>=e:s<r)&&n===t.get(s,o);){if(Math.abs(i-s)>cr.CODEWORD_SKEW_SIZE)return i;s+=a}a=-a,n=!n}return s}static checkCodewordSkew(t,e,r){return e-cr.CODEWORD_SKEW_SIZE<=t&&t<=r+cr.CODEWORD_SKEW_SIZE}static decodeCodewords(t,e,r){if(0===t.length)throw E.getFormatInstance();let n=1<<e+1,i=cr.correctErrors(t,r,n);cr.verifyCodewordCount(t,n);let o=hr.decode(t,""+e);return o.setErrorsCorrected(i),o.setErasures(r.length),o}static correctErrors(t,e,r){if(null!=e&&e.length>r/2+cr.MAX_ERRORS||r<0||r>cr.MAX_EC_CODEWORDS)throw c.getChecksumInstance();return cr.errorCorrection.decode(t,r,e)}static verifyCodewordCount(t,e){if(t.length<4)throw E.getFormatInstance();let r=t[0];if(r>t.length)throw E.getFormatInstance();if(0===r){if(!(e<t.length))throw E.getFormatInstance();t[0]=t.length-e}}static getBitCountForCodeword(t){let e=new Int32Array(8),r=0,n=e.length-1;for(;!((1&t)!==r&&(r=1&t,n--,n<0));)e[n]++,t>>=1;return e}static getCodewordBucketNumber(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)}static getCodewordBucketNumber_number(t){return cr.getCodewordBucketNumber(cr.getBitCountForCodeword(t))}static getCodewordBucketNumber_Int32Array(t){return(t[0]-t[2]+t[4]-t[6]+9)%9}static toString(t){let e=new Ke;for(let r=0;r<t.length;r++){e.format("Row %2d: ",r);for(let n=0;n<t[r].length;n++){let i=t[r][n];0===i.getValue().length?e.format("        ",null):e.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}e.format("%n")}return e.toString()}}cr.CODEWORD_SKEW_SIZE=2,cr.MAX_ERRORS=3,cr.MAX_EC_CODEWORDS=512,cr.errorCorrection=new Xe;class dr{decode(t,e=null){let r=dr.decode(t,e,!1);if(null==r||0===r.length||null==r[0])throw R.getNotFoundInstance();return r[0]}decodeMultiple(t,e=null){try{return dr.decode(t,e,!0)}catch(t){if(t instanceof E||t instanceof c)throw R.getNotFoundInstance();throw t}}static decode(t,e,r){const n=new Array,i=Ve.detectMultiple(t,e,r);for(const t of i.getPoints()){const e=cr.decode(i.getBits(),t[4],t[5],t[6],t[7],dr.getMinCodewordWidth(t),dr.getMaxCodewordWidth(t)),r=new F(e.getText(),e.getRawBytes(),void 0,t,V.PDF_417);r.putMetadata(K.ERROR_CORRECTION_LEVEL,e.getECLevel());const o=e.getOther();null!=o&&r.putMetadata(K.PDF417_EXTRA_METADATA,o),n.push(r)}return n.map((t=>t))}static getMaxWidth(t,e){return null==t||null==e?0:Math.trunc(Math.abs(t.getX()-e.getX()))}static getMinWidth(t,e){return null==t||null==e?m.MAX_VALUE:Math.trunc(Math.abs(t.getX()-e.getX()))}static getMaxCodewordWidth(t){return Math.floor(Math.max(Math.max(dr.getMaxWidth(t[0],t[4]),dr.getMaxWidth(t[6],t[2])*Fe.MODULES_IN_CODEWORD/Fe.MODULES_IN_STOP_PATTERN),Math.max(dr.getMaxWidth(t[1],t[5]),dr.getMaxWidth(t[7],t[3])*Fe.MODULES_IN_CODEWORD/Fe.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(t){return Math.floor(Math.min(Math.min(dr.getMinWidth(t[0],t[4]),dr.getMinWidth(t[6],t[2])*Fe.MODULES_IN_CODEWORD/Fe.MODULES_IN_STOP_PATTERN),Math.min(dr.getMinWidth(t[1],t[5]),dr.getMinWidth(t[7],t[3])*Fe.MODULES_IN_CODEWORD/Fe.MODULES_IN_STOP_PATTERN)))}reset(){}}class gr extends a{}gr.kind="ReaderException";class wr{decode(t,e){return this.setHints(e),this.decodeInternal(t)}decodeWithState(t){return null!==this.readers&&void 0!==this.readers||this.setHints(null),this.decodeInternal(t)}setHints(t){this.hints=t;const e=null!=t&&void 0!==t.get(y.TRY_HARDER),r=null==t?null:t.get(y.POSSIBLE_FORMATS),n=new Array;if(null!=r){const i=r.some((t=>t===V.UPC_A||t===V.UPC_E||t===V.EAN_13||t===V.EAN_8||t===V.CODABAR||t===V.CODE_39||t===V.CODE_93||t===V.CODE_128||t===V.ITF||t===V.RSS_14||t===V.RSS_EXPANDED));i&&!e&&n.push(new se(t)),r.includes(V.QR_CODE)&&n.push(new xe),r.includes(V.DATA_MATRIX)&&n.push(new me),r.includes(V.AZTEC)&&n.push(new wt),r.includes(V.PDF_417)&&n.push(new dr),i&&e&&n.push(new se(t))}0===n.length&&(e||n.push(new se(t)),n.push(new xe),n.push(new me),n.push(new wt),n.push(new dr),e&&n.push(new se(t))),this.readers=n}reset(){if(null!==this.readers)for(const t of this.readers)t.reset()}decodeInternal(t){if(null===this.readers)throw new gr("No readers where selected, nothing can be read.");for(const e of this.readers)try{return e.decode(t,this.hints)}catch(t){if(t instanceof gr)continue}throw new R("No MultiFormat Readers were able to detect the code.")}}class pr extends x{constructor(t=null,e=500){const r=new wr;r.setHints(t),super(r,e)}decodeBitmap(t){return this.reader.decodeWithState(t)}}class mr extends x{constructor(t=500){super(new dr,t)}}class _r extends x{constructor(t=500){super(new xe,t)}}var Ar;!function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.MIN_SIZE=3]="MIN_SIZE",t[t.MAX_SIZE=4]="MAX_SIZE",t[t.MARGIN=5]="MARGIN",t[t.PDF417_COMPACT=6]="PDF417_COMPACT",t[t.PDF417_COMPACTION=7]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=9]="AZTEC_LAYERS",t[t.QR_VERSION=10]="QR_VERSION"}(Ar||(Ar={}));var yr=Ar;class Er{constructor(t){this.field=t,this.cachedGenerators=[],this.cachedGenerators.push(new q(t,Int32Array.from([1])))}buildGenerator(t){const e=this.cachedGenerators;if(t>=e.length){let r=e[e.length-1];const n=this.field;for(let i=e.length;i<=t;i++){const t=r.multiply(new q(n,Int32Array.from([1,n.exp(i-1+n.getGeneratorBase())])));e.push(t),r=t}}return e[t]}encode(t,e){if(0===e)throw new l("No error correction bytes");const r=t.length-e;if(r<=0)throw new l("No data bytes provided");const n=this.buildGenerator(e),i=new Int32Array(r);f.arraycopy(t,0,i,0,r);let o=new q(this.field,i);o=o.multiplyByMonomial(e,1);const s=o.divide(n)[1].getCoefficients(),a=e-s.length;for(let e=0;e<a;e++)t[r+e]=0;f.arraycopy(s,0,t,r+a,s.length)}}class Cr{constructor(){}static applyMaskPenaltyRule1(t){return Cr.applyMaskPenaltyRule1Internal(t,!0)+Cr.applyMaskPenaltyRule1Internal(t,!1)}static applyMaskPenaltyRule2(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i-1;t++){const i=r[t];for(let o=0;o<n-1;o++){const n=i[o];n===i[o+1]&&n===r[t+1][o]&&n===r[t+1][o+1]&&e++}}return Cr.N2*e}static applyMaskPenaltyRule3(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i;t++)for(let o=0;o<n;o++){const s=r[t];o+6<n&&1===s[o]&&0===s[o+1]&&1===s[o+2]&&1===s[o+3]&&1===s[o+4]&&0===s[o+5]&&1===s[o+6]&&(Cr.isWhiteHorizontal(s,o-4,o)||Cr.isWhiteHorizontal(s,o+7,o+11))&&e++,t+6<i&&1===r[t][o]&&0===r[t+1][o]&&1===r[t+2][o]&&1===r[t+3][o]&&1===r[t+4][o]&&0===r[t+5][o]&&1===r[t+6][o]&&(Cr.isWhiteVertical(r,o,t-4,t)||Cr.isWhiteVertical(r,o,t+7,t+11))&&e++}return e*Cr.N3}static isWhiteHorizontal(t,e,r){e=Math.max(e,0),r=Math.min(r,t.length);for(let n=e;n<r;n++)if(1===t[n])return!1;return!0}static isWhiteVertical(t,e,r,n){r=Math.max(r,0),n=Math.min(n,t.length);for(let i=r;i<n;i++)if(1===t[i][e])return!1;return!0}static applyMaskPenaltyRule4(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i;t++){const i=r[t];for(let t=0;t<n;t++)1===i[t]&&e++}const o=t.getHeight()*t.getWidth();return Math.floor(10*Math.abs(2*e-o)/o)*Cr.N4}static getDataMaskBit(t,e,r){let n,i;switch(t){case 0:n=r+e&1;break;case 1:n=1&r;break;case 2:n=e%3;break;case 3:n=(r+e)%3;break;case 4:n=Math.floor(r/2)+Math.floor(e/3)&1;break;case 5:i=r*e,n=(1&i)+i%3;break;case 6:i=r*e,n=(1&i)+i%3&1;break;case 7:i=r*e,n=i%3+(r+e&1)&1;break;default:throw new l("Invalid mask pattern: "+t)}return 0===n}static applyMaskPenaltyRule1Internal(t,e){let r=0;const n=e?t.getHeight():t.getWidth(),i=e?t.getWidth():t.getHeight(),o=t.getArray();for(let t=0;t<n;t++){let n=0,s=-1;for(let a=0;a<i;a++){const i=e?o[t][a]:o[a][t];i===s?n++:(n>=5&&(r+=Cr.N1+(n-5)),n=1,s=i)}n>=5&&(r+=Cr.N1+(n-5))}return r}}Cr.N1=3,Cr.N2=3,Cr.N3=40,Cr.N4=10;class Ir{constructor(t,e){this.width=t,this.height=e;const r=new Array(e);for(let n=0;n!==e;n++)r[n]=new Uint8Array(t);this.bytes=r}getHeight(){return this.height}getWidth(){return this.width}get(t,e){return this.bytes[e][t]}getArray(){return this.bytes}setNumber(t,e,r){this.bytes[e][t]=r}setBoolean(t,e,r){this.bytes[e][t]=r?1:0}clear(t){for(const e of this.bytes)p.fill(e,t)}equals(t){if(!(t instanceof Ir))return!1;const e=t;if(this.width!==e.width)return!1;if(this.height!==e.height)return!1;for(let t=0,r=this.height;t<r;++t){const r=this.bytes[t],n=e.bytes[t];for(let t=0,e=this.width;t<e;++t)if(r[t]!==n[t])return!1}return!0}toString(){const t=new v;for(let e=0,r=this.height;e<r;++e){const r=this.bytes[e];for(let e=0,n=this.width;e<n;++e)switch(r[e]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ")}t.append("\n")}return t.toString()}}class br{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const t=new v;return t.append("<<\n"),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append("\n ecLevel: "),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append("\n version: "),t.append(this.version?this.version.toString():"null"),t.append("\n maskPattern: "),t.append(this.maskPattern.toString()),this.matrix?(t.append("\n matrix:\n"),t.append(this.matrix.toString())):t.append("\n matrix: null\n"),t.append(">>\n"),t.toString()}setMode(t){this.mode=t}setECLevel(t){this.ecLevel=t}setVersion(t){this.version=t}setMaskPattern(t){this.maskPattern=t}setMatrix(t){this.matrix=t}static isValidMaskPattern(t){return t>=0&&t<br.NUM_MASK_PATTERNS}}br.NUM_MASK_PATTERNS=8;class Sr extends a{}Sr.kind="WriterException";class vr{constructor(){}static clearMatrix(t){t.clear(255)}static buildMatrix(t,e,r,n,i){vr.clearMatrix(i),vr.embedBasicPatterns(r,i),vr.embedTypeInfo(e,n,i),vr.maybeEmbedVersionInfo(r,i),vr.embedDataBits(t,n,i)}static embedBasicPatterns(t,e){vr.embedPositionDetectionPatternsAndSeparators(e),vr.embedDarkDotAtLeftBottomCorner(e),vr.maybeEmbedPositionAdjustmentPatterns(t,e),vr.embedTimingPatterns(e)}static embedTypeInfo(t,e,r){const n=new _;vr.makeTypeInfoBits(t,e,n);for(let t=0,e=n.getSize();t<e;++t){const e=n.get(n.getSize()-1-t),i=vr.TYPE_INFO_COORDINATES[t],o=i[0],s=i[1];if(r.setBoolean(o,s,e),t<8){const n=r.getWidth()-t-1,i=8;r.setBoolean(n,i,e)}else{const n=8,i=r.getHeight()-7+(t-8);r.setBoolean(n,i,e)}}}static maybeEmbedVersionInfo(t,e){if(t.getVersionNumber()<7)return;const r=new _;vr.makeVersionInfoBits(t,r);let n=17;for(let t=0;t<6;++t)for(let i=0;i<3;++i){const o=r.get(n);n--,e.setBoolean(t,e.getHeight()-11+i,o),e.setBoolean(e.getHeight()-11+i,t,o)}}static embedDataBits(t,e,r){let n=0,i=-1,o=r.getWidth()-1,s=r.getHeight()-1;for(;o>0;){for(6===o&&(o-=1);s>=0&&s<r.getHeight();){for(let i=0;i<2;++i){const a=o-i;if(!vr.isEmpty(r.get(a,s)))continue;let u;n<t.getSize()?(u=t.get(n),++n):u=!1,255!==e&&Cr.getDataMaskBit(e,a,s)&&(u=!u),r.setBoolean(a,s,u)}s+=i}i=-i,s+=i,o-=2}if(n!==t.getSize())throw new Sr("Not all bits consumed: "+n+"/"+t.getSize())}static findMSBSet(t){return 32-m.numberOfLeadingZeros(t)}static calculateBCHCode(t,e){if(0===e)throw new l("0 polynomial");const r=vr.findMSBSet(e);for(t<<=r-1;vr.findMSBSet(t)>=r;)t^=e<<vr.findMSBSet(t)-r;return t}static makeTypeInfoBits(t,e,r){if(!br.isValidMaskPattern(e))throw new Sr("Invalid mask pattern");const n=t.getBits()<<3|e;r.appendBits(n,5);const i=vr.calculateBCHCode(n,vr.TYPE_INFO_POLY);r.appendBits(i,10);const o=new _;if(o.appendBits(vr.TYPE_INFO_MASK_PATTERN,15),r.xor(o),15!==r.getSize())throw new Sr("should not happen but we got: "+r.getSize())}static makeVersionInfoBits(t,e){e.appendBits(t.getVersionNumber(),6);const r=vr.calculateBCHCode(t.getVersionNumber(),vr.VERSION_INFO_POLY);if(e.appendBits(r,12),18!==e.getSize())throw new Sr("should not happen but we got: "+e.getSize())}static isEmpty(t){return 255===t}static embedTimingPatterns(t){for(let e=8;e<t.getWidth()-8;++e){const r=(e+1)%2;vr.isEmpty(t.get(e,6))&&t.setNumber(e,6,r),vr.isEmpty(t.get(6,e))&&t.setNumber(6,e,r)}}static embedDarkDotAtLeftBottomCorner(t){if(0===t.get(8,t.getHeight()-8))throw new Sr;t.setNumber(8,t.getHeight()-8,1)}static embedHorizontalSeparationPattern(t,e,r){for(let n=0;n<8;++n){if(!vr.isEmpty(r.get(t+n,e)))throw new Sr;r.setNumber(t+n,e,0)}}static embedVerticalSeparationPattern(t,e,r){for(let n=0;n<7;++n){if(!vr.isEmpty(r.get(t,e+n)))throw new Sr;r.setNumber(t,e+n,0)}}static embedPositionAdjustmentPattern(t,e,r){for(let n=0;n<5;++n){const i=vr.POSITION_ADJUSTMENT_PATTERN[n];for(let o=0;o<5;++o)r.setNumber(t+o,e+n,i[o])}}static embedPositionDetectionPattern(t,e,r){for(let n=0;n<7;++n){const i=vr.POSITION_DETECTION_PATTERN[n];for(let o=0;o<7;++o)r.setNumber(t+o,e+n,i[o])}}static embedPositionDetectionPatternsAndSeparators(t){const e=vr.POSITION_DETECTION_PATTERN[0].length;vr.embedPositionDetectionPattern(0,0,t),vr.embedPositionDetectionPattern(t.getWidth()-e,0,t),vr.embedPositionDetectionPattern(0,t.getWidth()-e,t);const r=8;vr.embedHorizontalSeparationPattern(0,r-1,t),vr.embedHorizontalSeparationPattern(t.getWidth()-r,r-1,t),vr.embedHorizontalSeparationPattern(0,t.getWidth()-r,t);const n=7;vr.embedVerticalSeparationPattern(n,0,t),vr.embedVerticalSeparationPattern(t.getHeight()-n-1,0,t),vr.embedVerticalSeparationPattern(n,t.getHeight()-n,t)}static maybeEmbedPositionAdjustmentPatterns(t,e){if(t.getVersionNumber()<2)return;const r=t.getVersionNumber()-1,n=vr.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r];for(let t=0,r=n.length;t!==r;t++){const i=n[t];if(i>=0)for(let t=0;t!==r;t++){const r=n[t];r>=0&&vr.isEmpty(e.get(r,i))&&vr.embedPositionAdjustmentPattern(r-2,i-2,e)}}}}vr.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),vr.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),vr.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),vr.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),vr.VERSION_INFO_POLY=7973,vr.TYPE_INFO_POLY=1335,vr.TYPE_INFO_MASK_PATTERN=21522;class Tr{constructor(t,e){this.dataBytes=t,this.errorCorrectionBytes=e}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Rr{constructor(){}static calculateMaskPenalty(t){return Cr.applyMaskPenaltyRule1(t)+Cr.applyMaskPenaltyRule2(t)+Cr.applyMaskPenaltyRule3(t)+Cr.applyMaskPenaltyRule4(t)}static encode(t,e,r=null){let n=Rr.DEFAULT_BYTE_MODE_ENCODING;const i=null!==r&&void 0!==r.get(yr.CHARACTER_SET);i&&(n=r.get(yr.CHARACTER_SET).toString());const o=this.chooseMode(t,n),s=new _;if(o===Te.BYTE&&(i||Rr.DEFAULT_BYTE_MODE_ENCODING!==n)){const t=C.getCharacterSetECIByName(n);void 0!==t&&this.appendECI(t,s)}this.appendModeInfo(o,s);const a=new _;let u;if(this.appendBytes(t,o,a,n),null!==r&&void 0!==r.get(yr.QR_VERSION)){const t=Number.parseInt(r.get(yr.QR_VERSION).toString(),10);u=Ie.getVersionForNumber(t);const n=this.calculateBitsNeeded(o,s,a,u);if(!this.willFit(n,u,e))throw new Sr("Data too big for requested version")}else u=this.recommendVersion(e,o,s,a);const l=new _;l.appendBitArray(s);const h=o===Te.BYTE?a.getSizeInBytes():t.length;this.appendLengthInfo(h,u,o,l),l.appendBitArray(a);const c=u.getECBlocksForLevel(e),d=u.getTotalCodewords()-c.getTotalECCodewords();this.terminateBits(d,l);const f=this.interleaveWithECBytes(l,u.getTotalCodewords(),d,c.getNumBlocks()),g=new br;g.setECLevel(e),g.setMode(o),g.setVersion(u);const w=u.getDimensionForVersion(),p=new Ir(w,w),m=this.chooseMaskPattern(f,e,u,p);return g.setMaskPattern(m),vr.buildMatrix(f,e,u,m,p),g.setMatrix(p),g}static recommendVersion(t,e,r,n){const i=this.calculateBitsNeeded(e,r,n,Ie.getVersionForNumber(1)),o=this.chooseVersion(i,t),s=this.calculateBitsNeeded(e,r,n,o);return this.chooseVersion(s,t)}static calculateBitsNeeded(t,e,r,n){return e.getSize()+t.getCharacterCountBits(n)+r.getSize()}static getAlphanumericCode(t){return t<Rr.ALPHANUMERIC_TABLE.length?Rr.ALPHANUMERIC_TABLE[t]:-1}static chooseMode(t,e=null){if(C.SJIS.getName()===e&&this.isOnlyDoubleByteKanji(t))return Te.KANJI;let r=!1,n=!1;for(let e=0,i=t.length;e<i;++e){const i=t.charAt(e);if(Rr.isDigit(i))r=!0;else{if(-1===this.getAlphanumericCode(i.charCodeAt(0)))return Te.BYTE;n=!0}}return n?Te.ALPHANUMERIC:r?Te.NUMERIC:Te.BYTE}static isOnlyDoubleByteKanji(t){let e;try{e=b.encode(t,C.SJIS)}catch(t){return!1}const r=e.length;if(r%2!=0)return!1;for(let t=0;t<r;t+=2){const r=255&e[t];if((r<129||r>159)&&(r<224||r>235))return!1}return!0}static chooseMaskPattern(t,e,r,n){let i=Number.MAX_SAFE_INTEGER,o=-1;for(let s=0;s<br.NUM_MASK_PATTERNS;s++){vr.buildMatrix(t,e,r,s,n);let a=this.calculateMaskPenalty(n);a<i&&(i=a,o=s)}return o}static chooseVersion(t,e){for(let r=1;r<=40;r++){const n=Ie.getVersionForNumber(r);if(Rr.willFit(t,n,e))return n}throw new Sr("Data too big")}static willFit(t,e,r){return e.getTotalCodewords()-e.getECBlocksForLevel(r).getTotalECCodewords()>=(t+7)/8}static terminateBits(t,e){const r=8*t;if(e.getSize()>r)throw new Sr("data bits cannot fit in the QR Code"+e.getSize()+" > "+r);for(let t=0;t<4&&e.getSize()<r;++t)e.appendBit(!1);const n=7&e.getSize();if(n>0)for(let t=n;t<8;t++)e.appendBit(!1);const i=t-e.getSizeInBytes();for(let t=0;t<i;++t)e.appendBits(0==(1&t)?236:17,8);if(e.getSize()!==r)throw new Sr("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(t,e,r,n,i,o){if(n>=r)throw new Sr("Block ID too large");const s=t%r,a=r-s,u=Math.floor(t/r),l=u+1,h=Math.floor(e/r),c=h+1,d=u-h,f=l-c;if(d!==f)throw new Sr("EC bytes mismatch");if(r!==a+s)throw new Sr("RS blocks mismatch");if(t!==(h+d)*a+(c+f)*s)throw new Sr("Total bytes mismatch");n<a?(i[0]=h,o[0]=d):(i[0]=c,o[0]=f)}static interleaveWithECBytes(t,e,r,n){if(t.getSizeInBytes()!==r)throw new Sr("Number of bits and data bytes does not match");let i=0,o=0,s=0;const a=new Array;for(let u=0;u<n;++u){const l=new Int32Array(1),h=new Int32Array(1);Rr.getNumDataBytesAndNumECBytesForBlockID(e,r,n,u,l,h);const c=l[0],d=new Uint8Array(c);t.toBytes(8*i,d,0,c);const f=Rr.generateECBytes(d,h[0]);a.push(new Tr(d,f)),o=Math.max(o,c),s=Math.max(s,f.length),i+=l[0]}if(r!==i)throw new Sr("Data bytes does not match offset");const u=new _;for(let t=0;t<o;++t)for(const e of a){const r=e.getDataBytes();t<r.length&&u.appendBits(r[t],8)}for(let t=0;t<s;++t)for(const e of a){const r=e.getErrorCorrectionBytes();t<r.length&&u.appendBits(r[t],8)}if(e!==u.getSizeInBytes())throw new Sr("Interleaving error: "+e+" and "+u.getSizeInBytes()+" differ.");return u}static generateECBytes(t,e){const r=t.length,n=new Int32Array(r+e);for(let e=0;e<r;e++)n[e]=255&t[e];new Er(J.QR_CODE_FIELD_256).encode(n,e);const i=new Uint8Array(e);for(let t=0;t<e;t++)i[t]=n[r+t];return i}static appendModeInfo(t,e){e.appendBits(t.getBits(),4)}static appendLengthInfo(t,e,r,n){const i=r.getCharacterCountBits(e);if(t>=1<<i)throw new Sr(t+" is bigger than "+((1<<i)-1));n.appendBits(t,i)}static appendBytes(t,e,r,n){switch(e){case Te.NUMERIC:Rr.appendNumericBytes(t,r);break;case Te.ALPHANUMERIC:Rr.appendAlphanumericBytes(t,r);break;case Te.BYTE:Rr.append8BitBytes(t,r,n);break;case Te.KANJI:Rr.appendKanjiBytes(t,r);break;default:throw new Sr("Invalid mode: "+e)}}static getDigit(t){return t.charCodeAt(0)-48}static isDigit(t){const e=Rr.getDigit(t);return e>=0&&e<=9}static appendNumericBytes(t,e){const r=t.length;let n=0;for(;n<r;){const i=Rr.getDigit(t.charAt(n));if(n+2<r){const r=Rr.getDigit(t.charAt(n+1)),o=Rr.getDigit(t.charAt(n+2));e.appendBits(100*i+10*r+o,10),n+=3}else if(n+1<r){const r=Rr.getDigit(t.charAt(n+1));e.appendBits(10*i+r,7),n+=2}else e.appendBits(i,4),n++}}static appendAlphanumericBytes(t,e){const r=t.length;let n=0;for(;n<r;){const i=Rr.getAlphanumericCode(t.charCodeAt(n));if(-1===i)throw new Sr;if(n+1<r){const r=Rr.getAlphanumericCode(t.charCodeAt(n+1));if(-1===r)throw new Sr;e.appendBits(45*i+r,11),n+=2}else e.appendBits(i,6),n++}}static append8BitBytes(t,e,r){let n;try{n=b.encode(t,r)}catch(t){throw new Sr(t)}for(let t=0,r=n.length;t!==r;t++){const r=n[t];e.appendBits(r,8)}}static appendKanjiBytes(t,e){let r;try{r=b.encode(t,C.SJIS)}catch(t){throw new Sr(t)}const n=r.length;for(let t=0;t<n;t+=2){const n=(255&r[t])<<8&4294967295|255&r[t+1];let i=-1;if(n>=33088&&n<=40956?i=n-33088:n>=57408&&n<=60351&&(i=n-49472),-1===i)throw new Sr("Invalid byte sequence");const o=192*(i>>8)+(255&i);e.appendBits(o,13)}}static appendECI(t,e){e.appendBits(Te.ECI.getBits(),4),e.appendBits(t.getValue(),8)}}Rr.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Rr.DEFAULT_BYTE_MODE_ENCODING=C.UTF8.getName();class Nr{write(t,e,r,n=null){if(0===t.length)throw new l("Found empty contents");if(e<0||r<0)throw new l("Requested dimensions are too small: "+e+"x"+r);let i=Ae.L,o=Nr.QUIET_ZONE_SIZE;null!==n&&(void 0!==n.get(yr.ERROR_CORRECTION)&&(i=Ae.fromString(n.get(yr.ERROR_CORRECTION).toString())),void 0!==n.get(yr.MARGIN)&&(o=Number.parseInt(n.get(yr.MARGIN).toString(),10)));const s=Rr.encode(t,i,n);return this.renderResult(s,e,r,o)}writeToDom(t,e,r,n,i=null){"string"==typeof t&&(t=document.querySelector(t));const o=this.write(e,r,n,i);t&&t.appendChild(o)}renderResult(t,e,r,n){const i=t.getMatrix();if(null===i)throw new tt;const o=i.getWidth(),s=i.getHeight(),a=o+2*n,u=s+2*n,l=Math.max(e,a),h=Math.max(r,u),c=Math.min(Math.floor(l/a),Math.floor(h/u)),d=Math.floor((l-o*c)/2),f=Math.floor((h-s*c)/2),g=this.createSVGElement(l,h);for(let t=0,e=f;t<s;t++,e+=c)for(let r=0,n=d;r<o;r++,n+=c)if(1===i.get(r,t)){const t=this.createSvgRectElement(n,e,c,c);g.appendChild(t)}return g}createSVGElement(t,e){const r=document.createElementNS(Nr.SVG_NS,"svg");return r.setAttributeNS(null,"height",t.toString()),r.setAttributeNS(null,"width",e.toString()),r}createSvgRectElement(t,e,r,n){const i=document.createElementNS(Nr.SVG_NS,"rect");return i.setAttributeNS(null,"x",t.toString()),i.setAttributeNS(null,"y",e.toString()),i.setAttributeNS(null,"height",r.toString()),i.setAttributeNS(null,"width",n.toString()),i.setAttributeNS(null,"fill","#000000"),i}}Nr.QUIET_ZONE_SIZE=4,Nr.SVG_NS="http://www.w3.org/2000/svg";class Or{encode(t,e,r,n,i){if(0===t.length)throw new l("Found empty contents");if(e!==V.QR_CODE)throw new l("Can only encode QR_CODE, but got "+e);if(r<0||n<0)throw new l(`Requested dimensions are too small: ${r}x${n}`);let o=Ae.L,s=Or.QUIET_ZONE_SIZE;null!==i&&(void 0!==i.get(yr.ERROR_CORRECTION)&&(o=Ae.fromString(i.get(yr.ERROR_CORRECTION).toString())),void 0!==i.get(yr.MARGIN)&&(s=Number.parseInt(i.get(yr.MARGIN).toString(),10)));const a=Rr.encode(t,o,i);return Or.renderResult(a,r,n,s)}static renderResult(t,e,r,n){const i=t.getMatrix();if(null===i)throw new tt;const o=i.getWidth(),s=i.getHeight(),a=o+2*n,u=s+2*n,l=Math.max(e,a),h=Math.max(r,u),c=Math.min(Math.floor(l/a),Math.floor(h/u)),d=Math.floor((l-o*c)/2),f=Math.floor((h-s*c)/2),g=new T(l,h);for(let t=0,e=f;t<s;t++,e+=c)for(let r=0,n=d;r<o;r++,n+=c)1===i.get(r,t)&&g.setRegion(n,e,c,c);return g}}Or.QUIET_ZONE_SIZE=4;class Dr{encode(t,e,r,n,i){let o;switch(e){case V.QR_CODE:o=new Or;break;default:throw new l("No encoder available for format "+e)}return o.encode(t,e,r,n,i)}}class Mr extends D{constructor(t,e,r,n,i,o,s,a){if(super(o,s),this.yuvData=t,this.dataWidth=e,this.dataHeight=r,this.left=n,this.top=i,n+o>e||i+s>r)throw new l("Crop rectangle does not fit within image data.");a&&this.reverseHorizontal(o,s)}getRow(t,e){if(t<0||t>=this.getHeight())throw new l("Requested row is outside the image: "+t);const r=this.getWidth();(null==e||e.length<r)&&(e=new Uint8ClampedArray(r));const n=(t+this.top)*this.dataWidth+this.left;return f.arraycopy(this.yuvData,n,e,0,r),e}getMatrix(){const t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.yuvData;const r=t*e,n=new Uint8ClampedArray(r);let i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return f.arraycopy(this.yuvData,i,n,0,r),n;for(let r=0;r<e;r++){const e=r*t;f.arraycopy(this.yuvData,i,n,e,t),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(t,e,r,n){return new Mr(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+e,r,n,!1)}renderThumbnail(){const t=this.getWidth()/Mr.THUMBNAIL_SCALE_FACTOR,e=this.getHeight()/Mr.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(t*e),n=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let o=0;o<e;o++){const e=o*t;for(let o=0;o<t;o++){const t=255&n[i+o*Mr.THUMBNAIL_SCALE_FACTOR];r[e+o]=4278190080|65793*t}i+=this.dataWidth*Mr.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/Mr.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/Mr.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(t,e){const r=this.yuvData;for(let n=0,i=this.top*this.dataWidth+this.left;n<e;n++,i+=this.dataWidth){const e=i+t/2;for(let n=i,o=i+t-1;n<e;n++,o--){const t=r[n];r[n]=r[o],r[o]=t}}}invert(){return new M(this)}}Mr.THUMBNAIL_SCALE_FACTOR=2;class Br extends D{constructor(t,e,r,n,i,o,s){if(super(e,r),this.dataWidth=n,this.dataHeight=i,this.left=o,this.top=s,4===t.BYTES_PER_ELEMENT){const n=e*r,i=new Uint8ClampedArray(n);for(let e=0;e<n;e++){const r=t[e],n=r>>16&255,o=r>>7&510,s=255&r;i[e]=(n+o+s)/4&255}this.luminances=i}else this.luminances=t;if(void 0===n&&(this.dataWidth=e),void 0===i&&(this.dataHeight=r),void 0===o&&(this.left=0),void 0===s&&(this.top=0),this.left+e>this.dataWidth||this.top+r>this.dataHeight)throw new l("Crop rectangle does not fit within image data.")}getRow(t,e){if(t<0||t>=this.getHeight())throw new l("Requested row is outside the image: "+t);const r=this.getWidth();(null==e||e.length<r)&&(e=new Uint8ClampedArray(r));const n=(t+this.top)*this.dataWidth+this.left;return f.arraycopy(this.luminances,n,e,0,r),e}getMatrix(){const t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.luminances;const r=t*e,n=new Uint8ClampedArray(r);let i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return f.arraycopy(this.luminances,i,n,0,r),n;for(let r=0;r<e;r++){const e=r*t;f.arraycopy(this.luminances,i,n,e,t),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(t,e,r,n){return new Br(this.luminances,r,n,this.dataWidth,this.dataHeight,this.left+t,this.top+e)}invert(){return new M(this)}}class Pr extends C{static forName(t){return this.getCharacterSetECIByName(t)}}class kr{}kr.ISO_8859_1=C.ISO8859_1;class Lr{isCompact(){return this.compact}setCompact(t){this.compact=t}getSize(){return this.size}setSize(t){this.size=t}getLayers(){return this.layers}setLayers(t){this.layers=t}getCodeWords(){return this.codeWords}setCodeWords(t){this.codeWords=t}getMatrix(){return this.matrix}setMatrix(t){this.matrix=t}}class xr{static singletonList(t){return[t]}static min(t,e){return t.sort(e)[0]}}class Fr{constructor(t){this.previous=t}getPrevious(){return this.previous}}class Ur extends Fr{constructor(t,e,r){super(t),this.value=e,this.bitCount=r}appendTo(t,e){t.appendBits(this.value,this.bitCount)}add(t,e){return new Ur(this,t,e)}addBinaryShift(t,e){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Ur(this,t,e)}toString(){let t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+m.toBinaryString(t|1<<this.bitCount).substring(1)+">"}}class Vr extends Ur{constructor(t,e,r){super(t,0,0),this.binaryShiftStart=e,this.binaryShiftByteCount=r}appendTo(t,e){for(let r=0;r<this.binaryShiftByteCount;r++)(0===r||31===r&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):0===r?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(e[this.binaryShiftStart+r],8)}addBinaryShift(t,e){return new Vr(this,t,e)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Hr(t,e,r){return new Vr(t,e,r)}function zr(t,e,r){return new Ur(t,e,r)}const Gr=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Xr=0,Wr=1,Yr=2,Kr=3,Zr=4,jr=new Ur(null,0,0),qr=[Int32Array.from([0,327708,327710,327709,656318]),Int32Array.from([590318,0,327710,327709,656318]),Int32Array.from([262158,590300,0,590301,932798]),Int32Array.from([327709,327708,656318,0,327710]),Int32Array.from([327711,656380,656382,656381,0])];function Qr(t){for(let e of t)p.fill(e,-1);return t[Xr][Zr]=0,t[Wr][Zr]=0,t[Wr][Xr]=28,t[Kr][Zr]=0,t[Yr][Zr]=0,t[Yr][Xr]=15,t}const Jr=Qr(p.createInt32Array(6,6));class $r{constructor(t,e,r,n){this.token=t,this.mode=e,this.binaryShiftByteCount=r,this.bitCount=n}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(t,e){let r=this.bitCount,n=this.token;if(t!==this.mode){let e=qr[this.mode][t];n=zr(n,65535&e,e>>16),r+=e>>16}let i=t===Yr?4:5;return n=zr(n,e,i),new $r(n,t,0,r+i)}shiftAndAppend(t,e){let r=this.token,n=this.mode===Yr?4:5;return r=zr(r,Jr[this.mode][t],n),r=zr(r,e,5),new $r(r,this.mode,0,this.bitCount+n+5)}addBinaryShiftChar(t){let e=this.token,r=this.mode,n=this.bitCount;if(this.mode===Zr||this.mode===Yr){let t=qr[r][Xr];e=zr(e,65535&t,t>>16),n+=t>>16,r=Xr}let i=0===this.binaryShiftByteCount||31===this.binaryShiftByteCount?18:62===this.binaryShiftByteCount?9:8,o=new $r(e,r,this.binaryShiftByteCount+1,n+i);return 2078===o.binaryShiftByteCount&&(o=o.endBinaryShift(t+1)),o}endBinaryShift(t){if(0===this.binaryShiftByteCount)return this;let e=this.token;return e=Hr(e,t-this.binaryShiftByteCount,this.binaryShiftByteCount),new $r(e,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(t){let e=this.bitCount+(qr[this.mode][t.mode]>>16);return this.binaryShiftByteCount<t.binaryShiftByteCount?e+=$r.calculateBinaryShiftCost(t)-$r.calculateBinaryShiftCost(this):this.binaryShiftByteCount>t.binaryShiftByteCount&&t.binaryShiftByteCount>0&&(e+=10),e<=t.bitCount}toBitArray(t){let e=[];for(let r=this.endBinaryShift(t.length).token;null!==r;r=r.getPrevious())e.unshift(r);let r=new _;for(const n of e)n.appendTo(r,t);return r}toString(){return S.format("%s bits=%d bytes=%d",Gr[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(t){return t.binaryShiftByteCount>62?21:t.binaryShiftByteCount>31?20:t.binaryShiftByteCount>0?10:0}}function tn(t){const e=S.getCharCode(" "),r=S.getCharCode("."),n=S.getCharCode(",");t[Xr][e]=1;const i=S.getCharCode("Z"),o=S.getCharCode("A");for(let e=o;e<=i;e++)t[Xr][e]=e-o+2;t[Wr][e]=1;const s=S.getCharCode("z"),a=S.getCharCode("a");for(let e=a;e<=s;e++)t[Wr][e]=e-a+2;t[Yr][e]=1;const u=S.getCharCode("9"),l=S.getCharCode("0");for(let e=l;e<=u;e++)t[Yr][e]=e-l+2;t[Yr][n]=12,t[Yr][r]=13;const h=["\0"," ","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","@","\\","^","_","`","|","~",""];for(let e=0;e<h.length;e++)t[Kr][S.getCharCode(h[e])]=e;const c=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let e=0;e<c.length;e++)S.getCharCode(c[e])>0&&(t[Zr][S.getCharCode(c[e])]=e);return t}$r.INITIAL_STATE=new $r(jr,Xr,0,0);const en=tn(p.createInt32Array(5,256));class rn{constructor(t){this.text=t}encode(){const t=S.getCharCode(" "),e=S.getCharCode("\n");let r=xr.singletonList($r.INITIAL_STATE);for(let n=0;n<this.text.length;n++){let i,o=n+1<this.text.length?this.text[n+1]:0;switch(this.text[n]){case S.getCharCode("\r"):i=o===e?2:0;break;case S.getCharCode("."):i=o===t?3:0;break;case S.getCharCode(","):i=o===t?4:0;break;case S.getCharCode(":"):i=o===t?5:0;break;default:i=0}i>0?(r=rn.updateStateListForPair(r,n,i),n++):r=this.updateStateListForChar(r,n)}return xr.min(r,((t,e)=>t.getBitCount()-e.getBitCount())).toBitArray(this.text)}updateStateListForChar(t,e){const r=[];for(let n of t)this.updateStateForChar(n,e,r);return rn.simplifyStates(r)}updateStateForChar(t,e,r){let n=255&this.text[e],i=en[t.getMode()][n]>0,o=null;for(let s=0;s<=Zr;s++){let a=en[s][n];if(a>0){if(null==o&&(o=t.endBinaryShift(e)),!i||s===t.getMode()||s===Yr){const t=o.latchAndAppend(s,a);r.push(t)}if(!i&&Jr[t.getMode()][s]>=0){const t=o.shiftAndAppend(s,a);r.push(t)}}}if(t.getBinaryShiftByteCount()>0||0===en[t.getMode()][n]){let n=t.addBinaryShiftChar(e);r.push(n)}}static updateStateListForPair(t,e,r){const n=[];for(let i of t)this.updateStateForPair(i,e,r,n);return this.simplifyStates(n)}static updateStateForPair(t,e,r,n){let i=t.endBinaryShift(e);if(n.push(i.latchAndAppend(Zr,r)),t.getMode()!==Zr&&n.push(i.shiftAndAppend(Zr,r)),3===r||4===r){let t=i.latchAndAppend(Yr,16-r).latchAndAppend(Yr,1);n.push(t)}if(t.getBinaryShiftByteCount()>0){let r=t.addBinaryShiftChar(e).addBinaryShiftChar(e+1);n.push(r)}}static simplifyStates(t){let e=[];for(const r of t){let t=!0;for(const n of e){if(n.isBetterThanOrEqualTo(r)){t=!1;break}r.isBetterThanOrEqualTo(n)&&(e=e.filter((t=>t!==n)))}t&&e.push(r)}return e}}class nn{constructor(){}static encodeBytes(t){return nn.encode(t,nn.DEFAULT_EC_PERCENT,nn.DEFAULT_AZTEC_LAYERS)}static encode(t,e,r){let n,i,o,s,a,u=new rn(t).encode(),h=m.truncDivision(u.getSize()*e,100)+11,c=u.getSize()+h;if(r!==nn.DEFAULT_AZTEC_LAYERS){if(n=r<0,i=Math.abs(r),i>(n?nn.MAX_NB_BITS_COMPACT:nn.MAX_NB_BITS))throw new l(S.format("Illegal value %s for layers",r));o=nn.totalBitsInLayer(i,n),s=nn.WORD_SIZE[i];let t=o-o%s;if(a=nn.stuffBits(u,s),a.getSize()+h>t)throw new l("Data to large for user specified layer");if(n&&a.getSize()>64*s)throw new l("Data to large for user specified layer")}else{s=0,a=null;for(let t=0;;t++){if(t>nn.MAX_NB_BITS)throw new l("Data too large for an Aztec code");if(n=t<=3,i=n?t+1:t,o=nn.totalBitsInLayer(i,n),c>o)continue;null!=a&&s===nn.WORD_SIZE[i]||(s=nn.WORD_SIZE[i],a=nn.stuffBits(u,s));let e=o-o%s;if(!(n&&a.getSize()>64*s)&&a.getSize()+h<=e)break}}let d,f=nn.generateCheckWords(a,o,s),g=a.getSize()/s,w=nn.generateModeMessage(n,i,g),p=(n?11:14)+4*i,_=new Int32Array(p);if(n){d=p;for(let t=0;t<_.length;t++)_[t]=t}else{d=p+1+2*m.truncDivision(m.truncDivision(p,2)-1,15);let t=m.truncDivision(p,2),e=m.truncDivision(d,2);for(let r=0;r<t;r++){let n=r+m.truncDivision(r,15);_[t-r-1]=e-n-1,_[t+r]=e+n+1}}let A=new T(d);for(let t=0,e=0;t<i;t++){let r=4*(i-t)+(n?9:12);for(let n=0;n<r;n++){let i=2*n;for(let o=0;o<2;o++)f.get(e+i+o)&&A.set(_[2*t+o],_[2*t+n]),f.get(e+2*r+i+o)&&A.set(_[2*t+n],_[p-1-2*t-o]),f.get(e+4*r+i+o)&&A.set(_[p-1-2*t-o],_[p-1-2*t-n]),f.get(e+6*r+i+o)&&A.set(_[p-1-2*t-n],_[2*t+o])}e+=8*r}if(nn.drawModeMessage(A,n,d,w),n)nn.drawBullsEye(A,m.truncDivision(d,2),5);else{nn.drawBullsEye(A,m.truncDivision(d,2),7);for(let t=0,e=0;t<m.truncDivision(p,2)-1;t+=15,e+=16)for(let t=1&m.truncDivision(d,2);t<d;t+=2)A.set(m.truncDivision(d,2)-e,t),A.set(m.truncDivision(d,2)+e,t),A.set(t,m.truncDivision(d,2)-e),A.set(t,m.truncDivision(d,2)+e)}let y=new Lr;return y.setCompact(n),y.setSize(d),y.setLayers(i),y.setCodeWords(g),y.setMatrix(A),y}static drawBullsEye(t,e,r){for(let n=0;n<r;n+=2)for(let r=e-n;r<=e+n;r++)t.set(r,e-n),t.set(r,e+n),t.set(e-n,r),t.set(e+n,r);t.set(e-r,e-r),t.set(e-r+1,e-r),t.set(e-r,e-r+1),t.set(e+r,e-r),t.set(e+r,e-r+1),t.set(e+r,e+r-1)}static generateModeMessage(t,e,r){let n=new _;return t?(n.appendBits(e-1,2),n.appendBits(r-1,6),n=nn.generateCheckWords(n,28,4)):(n.appendBits(e-1,5),n.appendBits(r-1,11),n=nn.generateCheckWords(n,40,4)),n}static drawModeMessage(t,e,r,n){let i=m.truncDivision(r,2);if(e)for(let e=0;e<7;e++){let r=i-3+e;n.get(e)&&t.set(r,i-5),n.get(e+7)&&t.set(i+5,r),n.get(20-e)&&t.set(r,i+5),n.get(27-e)&&t.set(i-5,r)}else for(let e=0;e<10;e++){let r=i-5+e+m.truncDivision(e,5);n.get(e)&&t.set(r,i-7),n.get(e+10)&&t.set(i+7,r),n.get(29-e)&&t.set(r,i+7),n.get(39-e)&&t.set(i-7,r)}}static generateCheckWords(t,e,r){let n=t.getSize()/r,i=new Er(nn.getGF(r)),o=m.truncDivision(e,r),s=nn.bitsToWords(t,r,o);i.encode(s,o-n);let a=e%r,u=new _;u.appendBits(0,a);for(const t of Array.from(s))u.appendBits(t,r);return u}static bitsToWords(t,e,r){let n,i,o=new Int32Array(r);for(n=0,i=t.getSize()/e;n<i;n++){let r=0;for(let i=0;i<e;i++)r|=t.get(n*e+i)?1<<e-i-1:0;o[n]=r}return o}static getGF(t){switch(t){case 4:return J.AZTEC_PARAM;case 6:return J.AZTEC_DATA_6;case 8:return J.AZTEC_DATA_8;case 10:return J.AZTEC_DATA_10;case 12:return J.AZTEC_DATA_12;default:throw new l("Unsupported word size "+t)}}static stuffBits(t,e){let r=new _,n=t.getSize(),i=(1<<e)-2;for(let o=0;o<n;o+=e){let s=0;for(let r=0;r<e;r++)(o+r>=n||t.get(o+r))&&(s|=1<<e-1-r);(s&i)===i?(r.appendBits(s&i,e),o--):0==(s&i)?(r.appendBits(1|s,e),o--):r.appendBits(s,e)}return r}static totalBitsInLayer(t,e){return((e?88:112)+16*t)*t}}nn.DEFAULT_EC_PERCENT=33,nn.DEFAULT_AZTEC_LAYERS=0,nn.MAX_NB_BITS=32,nn.MAX_NB_BITS_COMPACT=4,nn.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class on{encode(t,e,r,n){return this.encodeWithHints(t,e,r,n,null)}encodeWithHints(t,e,r,n,i){let o=kr.ISO_8859_1,s=nn.DEFAULT_EC_PERCENT,a=nn.DEFAULT_AZTEC_LAYERS;return null!=i&&(i.has(yr.CHARACTER_SET)&&(o=Pr.forName(i.get(yr.CHARACTER_SET).toString())),i.has(yr.ERROR_CORRECTION)&&(s=m.parseInt(i.get(yr.ERROR_CORRECTION).toString())),i.has(yr.AZTEC_LAYERS)&&(a=m.parseInt(i.get(yr.AZTEC_LAYERS).toString()))),on.encodeLayers(t,e,r,n,o,s,a)}static encodeLayers(t,e,r,n,i,o,s){if(e!==V.AZTEC)throw new l("Can only encode AZTEC, but got "+e);let a=nn.encode(S.getBytes(t,i),o,s);return on.renderResult(a,r,n)}static renderResult(t,e,r){let n=t.getMatrix();if(null==n)throw new tt;let i=n.getWidth(),o=n.getHeight(),s=Math.max(e,i),a=Math.max(r,o),u=Math.min(s/i,a/o),l=(s-i*u)/2,h=(a-o*u)/2,c=new T(s,a);for(let t=0,e=h;t<o;t++,e+=u)for(let r=0,o=l;r<i;r++,o+=u)n.get(r,t)&&c.setRegion(o,e,u,u);return c}}t.ArgumentException=u,t.ArithmeticException=Q,t.AztecCode=Lr,t.AztecCodeReader=wt,t.AztecCodeWriter=on,t.AztecDecoder=rt,t.AztecDetector=gt,t.AztecDetectorResult=at,t.AztecEncoder=nn,t.AztecHighLevelEncoder=rn,t.AztecPoint=ft,t.BarcodeFormat=V,t.Binarizer=d,t.BinaryBitmap=h,t.BitArray=_,t.BitMatrix=T,t.BitSource=fe,t.BrowserAztecCodeReader=pt,t.BrowserBarcodeReader=ae,t.BrowserCodeReader=x,t.BrowserDatamatrixCodeReader=_e,t.BrowserMultiFormatReader=pr,t.BrowserPDF417Reader=mr,t.BrowserQRCodeReader=_r,t.BrowserQRCodeSvgWriter=Nr,t.CharacterSetECI=C,t.ChecksumException=c,t.Code128Reader=_t,t.Code39Reader=At,t.DataMatrixDecodedBitStreamParser=ge,t.DataMatrixReader=me,t.DecodeHintType=y,t.DecoderResult=Z,t.DefaultGridSampler=ct,t.DetectorResult=st,t.EAN13Reader=vt,t.EncodeHintType=yr,t.Exception=a,t.FormatException=E,t.GenericGF=J,t.GenericGFPoly=q,t.GlobalHistogramBinarizer=N,t.GridSampler=lt,t.GridSamplerInstance=dt,t.HTMLCanvasElementLuminanceSource=B,t.HybridBinarizer=O,t.ITFReader=yt,t.IllegalArgumentException=l,t.IllegalStateException=tt,t.InvertedLuminanceSource=M,t.LuminanceSource=D,t.MathUtils=nt,t.MultiFormatOneDReader=se,t.MultiFormatReader=wr,t.MultiFormatWriter=Dr,t.NotFoundException=R,t.OneDReader=mt,t.PDF417DecodedBitStreamParser=hr,t.PDF417DecoderErrorCorrection=Xe,t.PDF417Reader=dr,t.PDF417ResultMetadata=tr,t.PerspectiveTransform=ht,t.PlanarYUVLuminanceSource=Mr,t.QRCodeByteMatrix=Ir,t.QRCodeDataMask=be,t.QRCodeDecodedBitStreamParser=Re,t.QRCodeDecoderErrorCorrectionLevel=Ae,t.QRCodeDecoderFormatInformation=ye,t.QRCodeEncoder=Rr,t.QRCodeEncoderQRCode=br,t.QRCodeMaskUtil=Cr,t.QRCodeMatrixUtil=vr,t.QRCodeMode=Te,t.QRCodeReader=xe,t.QRCodeVersion=Ie,t.QRCodeWriter=Or,t.RGBLuminanceSource=Br,t.RSS14Reader=oe,t.RSSExpandedReader=ne,t.ReaderException=gr,t.ReedSolomonDecoder=et,t.ReedSolomonEncoder=Er,t.ReedSolomonException=$,t.Result=F,t.ResultMetadataType=K,t.ResultPoint=ot,t.StringUtils=S,t.UnsupportedOperationException=I,t.VideoInputDevice=P,t.WhiteRectangleDetector=ut,t.WriterException=Sr,t.ZXingArrays=p,t.ZXingCharset=Pr,t.ZXingInteger=m,t.ZXingStandardCharsets=kr,t.ZXingStringBuilder=v,t.ZXingStringEncoding=b,t.ZXingSystem=f,Object.defineProperty(t,"__esModule",{value:!0})}(e)})),xn=(Pn=Ln)&&Pn.__esModule&&Object.prototype.hasOwnProperty.call(Pn,"default")?Pn.default:Pn;const Fn=new Set,Un=new Map,Vn=new Map,Hn=new WeakMap,{document:zn,customElements:Gn,DocumentFragment:Xn,HTMLElement:Wn}=window,Yn=Symbol("isOOMAbstract");class Kn{static proxyGetter(t,e,r){return e in t?"function"==typeof t[e]?(...n)=>{const i=t[e](...n);return i===t?r:i}:t[e]:(...n)=>(t.append(Kn.create(jn,e,...n)),r)}static create(t,...e){const r=e[e.length-1],n="function"==typeof r&&!Un.has(r)?e.pop():null,i=new t(...e);return n&&n(i.dom),i}static factory(t,...e){const r="string"==typeof t||Un.has(t);return Kn.create(r?jn:Zn,t,...e)}static[Symbol.hasInstance](t){return t&&t[Yn]}[Yn]=!0;dom;append(t){return t instanceof Kn?this.dom.append(t.dom):t&&this.dom.append(t),this}oom(...t){const e=Kn.factory(...t);return this.append(e),this}clone(){const t=zn.importNode(this.dom,!0),e=new this.constructor(t);return new Proxy(e,Kn.proxyHandler)}}Kn.proxyHandler={get:Kn.proxyGetter,set:()=>!1};class Zn extends Kn{get html(){let t="";for(const e of this.dom.children)t+=e.outerHTML;return t}constructor(t){super(),t instanceof Xn?this.dom=t:(this.dom=zn.createDocumentFragment(),this.append(t))}}class jn extends Kn{static resolveTagName(t){let e;return e="string"==typeof t&&t[0]===t[0].toUpperCase()?t.replace(/^[A-Z]/,(t=>t.toLowerCase())).replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`)):t,e}static setAttribute(t,e,r){if("options"===e&&Vn.has(t.constructor))Hn.set(t,r);else{const n=typeof r;"function"===n?t[e]=r:(/[A-Z]/.test(e)&&(e=e.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))),"object"===n?t.setAttribute(e,`json::${JSON.stringify(r)}`):t.setAttribute(e,r))}}static getAttribute(t,e){let r;if("options"===e&&Vn.has(t.constructor))r=Hn.get(t,r);else{const n=t[e];"function"==typeof n?r=n:(/[A-Z]/.test(e)&&(e=e.replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`))),r=t.getAttribute(e),r&&r.startsWith("json::")&&(r=JSON.parse(r.replace("json::",""))))}return r}static setAttributes(t,e={},r){if("string"==typeof e)jn.setAttribute(t,e,r);else for(const[r,n]of Object.entries(e))jn.setAttribute(t,r,n)}static resolveArgs(t,e){return"string"==typeof t||t instanceof Kn||t instanceof Xn||t instanceof Wn?[e,t]:[t,e]}get html(){return this.dom.outerHTML}constructor(t,e,r){[e,r]=jn.resolveArgs(e,r),super(),t instanceof Wn?this.dom=t:(Un.has(t)?(t=Un.get(t),Gn.get(t).options=e?e.options:void 0):(t=jn.resolveTagName(t),Fn.has(t)&&(Gn.get(t).options=e?e.options:void 0)),this.dom=zn.createElement(t)),this.setAttributes(e),this.append(r)}setAttributes(t){return jn.setAttributes(this.dom,t),this}}const{HTMLElement:qn,customElements:Qn}=window,Jn=Symbol("observedAttributes"),$n=Symbol("attributeChangedCache"),ti={get:jn.getAttribute,set:(...t)=>(jn.setAttribute(...t),!0)};function ei(t,e){const r=Object.getOwnPropertyNames(t),n=Reflect.getPrototypeOf(t);Object.isPrototypeOf.call(qn,n.constructor)&&ei(n,e);for(const n of r){const{value:r}=Reflect.getOwnPropertyDescriptor(t,n),i="function"==typeof r,o=n.endsWith("Changed"),s=/^[a-z][\w]+$/.test(n);if(i&&o&&s){const t=n.replace(/Changed$/,"").replace(/[A-Z]/g,(t=>`-${t.toLowerCase()}`));e.set(t,n)}}return e.size>0?e:null}function ri(t){class e extends t{static get observedAttributes(){return this[Jn]?[...this[Jn].keys(),...super.observedAttributes||[]]:super.observedAttributes}constructor(){super(e.options||{}),delete e.options}attributeChangedCallback(t,e,r){!function(t,e,r,n){const i=t.constructor[Jn];i&&i.has(e)&&(n&&n.startsWith("json::")&&(n=JSON.parse(n.replace("json::",""))),t.isConnected?t[i.get(e)](r,n):($n in t||(t[$n]=new Set),t[$n].add({name:i.get(e),args:[r,n]})))}(this,t,e,r),super.attributeChangedCallback&&super.attributeChangedCallback(t,e,r)}connectedCallback(){!function(t){const e=t[$n];let r=t.constructor.template,{template:n}=t,i="function"==typeof r&&r.length>0||"function"==typeof n&&n.length>0||null;if(i&&(i=Object.assign({},Hn.get(t),{element:t,attributes:new Proxy(t,ti)})),n instanceof Kn?n=n.clone():"string"!=typeof n&&(r instanceof Kn?r=r.clone():"function"==typeof r&&(r=t.constructor.template(i)),"function"==typeof n?(i&&(i.template=r),n=t.template(i)||r):n=r),n instanceof Kn?(t.innerHTML="",t.append(n.dom)):"string"==typeof n&&(t.innerHTML=n),e instanceof Set){for(const r of e)t[r.name](...r.args),e.delete(r);delete t[$n]}}(this),super.connectedCallback&&super.connectedCallback()}}return e[Jn]=ei(t.prototype,new Map),e}const{customElements:ni}=window,ii=Object.assign(Object.create(null),{append:(...t)=>oi().append(...t),setAttributes:(...t)=>(jn.setAttributes(...t),oi),define:(...t)=>(function(t,e,r){Object.isPrototypeOf.call(qn,t)&&([e,r]=[t,e],t=e.tagName||jn.resolveTagName(e.name));const n=Vn.get(e)||ri(e);Qn.define(t,n,r),Vn.set(n,e),Un.set(e,t),Fn.add(t)}(...t),oi),getDefined:t=>Vn.get(ni.get(t)),oom:(...t)=>oi(...t)}),oi=new Proxy(Kn,{apply:(t,e,r)=>{const n=Kn.factory(...r);return new Proxy(n,Kn.proxyHandler)},get:(t,e)=>ii[e]||((...t)=>{const r=Kn.create(jn,e,...t),n=new Zn(r);return new Proxy(n,Kn.proxyHandler)}),set:()=>!1});var si=function(){return(si=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function ai(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}var ui=Object.keys,li=Array.isArray,hi="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function ci(t,e){return"object"!=typeof e||ui(e).forEach((function(r){t[r]=e[r]})),t}"undefined"==typeof Promise||hi.Promise||(hi.Promise=Promise);var di=Object.getPrototypeOf,fi={}.hasOwnProperty;function gi(t,e){return fi.call(t,e)}function wi(t,e){"function"==typeof e&&(e=e(di(t))),ui(e).forEach((function(r){mi(t,r,e[r])}))}var pi=Object.defineProperty;function mi(t,e,r,n){pi(t,e,ci(r&&gi(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function _i(t){return{from:function(e){return t.prototype=Object.create(e.prototype),mi(t.prototype,"constructor",t),{extend:wi.bind(null,t.prototype)}}}}var Ai=Object.getOwnPropertyDescriptor;function yi(t,e){var r;return Ai(t,e)||(r=di(t))&&yi(r,e)}var Ei=[].slice;function Ci(t,e,r){return Ei.call(t,e,r)}function Ii(t,e){return e(t)}function bi(t){if(!t)throw new Error("Assertion Failed")}function Si(t){hi.setImmediate?setImmediate(t):setTimeout(t,0)}function vi(t,e){return t.reduce((function(t,r,n){var i=e(r,n);return i&&(t[i[0]]=i[1]),t}),{})}function Ti(t,e){if(gi(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var r=[],n=0,i=e.length;n<i;++n){var o=Ti(t,e[n]);r.push(o)}return r}var s=e.indexOf(".");if(-1!==s){var a=t[e.substr(0,s)];return void 0===a?void 0:Ti(a,e.substr(s+1))}}function Ri(t,e,r){if(t&&void 0!==e&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){bi("string"!=typeof r&&"length"in r);for(var n=0,i=e.length;n<i;++n)Ri(t,e[n],r[n])}else{var o=e.indexOf(".");if(-1!==o){var s=e.substr(0,o),a=e.substr(o+1);if(""===a)void 0===r?li(t)&&!isNaN(parseInt(s))?t.splice(s,1):delete t[s]:t[s]=r;else{var u=t[s];u||(u=t[s]={}),Ri(u,a,r)}}else void 0===r?li(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=r}}function Ni(t,e){"string"==typeof e?Ri(t,e,void 0):"length"in e&&[].map.call(e,(function(e){Ri(t,e,void 0)}))}function Oi(t){var e={};for(var r in t)gi(t,r)&&(e[r]=t[r]);return e}var Di=[].concat;function Mi(t){return Di.apply([],t)}var Bi="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(Mi([8,16,32,64].map((function(t){return["Int","Uint","Float"].map((function(e){return e+t+"Array"}))})))).filter((function(t){return hi[t]})),Pi=Bi.map((function(t){return hi[t]})),ki=vi(Bi,(function(t){return[t,!0]}));function Li(t){if(!t||"object"!=typeof t)return t;var e;if(li(t)){e=[];for(var r=0,n=t.length;r<n;++r)e.push(Li(t[r]))}else if(Pi.indexOf(t.constructor)>=0)e=t;else for(var i in e=t.constructor?Object.create(t.constructor.prototype):{},t)gi(t,i)&&(e[i]=Li(t[i]));return e}var xi={}.toString;function Fi(t){return xi.call(t).slice(8,-1)}var Ui=function(t,e){return"Array"===e?""+t.map((function(t){return Ui(t,Fi(t))})):"ArrayBuffer"===e?""+new Uint8Array(t):"Date"===e?t.getTime():ArrayBuffer.isView(t)?""+new Uint8Array(t.buffer):t};function Vi(t,e,r,n){return r=r||{},n=n||"",ui(t).forEach((function(i){if(gi(e,i)){var o=t[i],s=e[i];if("object"==typeof o&&"object"==typeof s&&o&&s){var a=Fi(o),u=Fi(s);a===u?ki[a]?Ui(o,a)!==Ui(s,u)&&(r[n+i]=e[i]):Vi(o,s,r,n+i+"."):r[n+i]=e[i]}else o!==s&&(r[n+i]=e[i])}else r[n+i]=void 0})),ui(e).forEach((function(i){gi(t,i)||(r[n+i]=e[i])})),r}var Hi="undefined"!=typeof Symbol&&Symbol.iterator,zi=Hi?function(t){var e;return null!=t&&(e=t[Hi])&&e.apply(t)}:function(){return null},Gi={};function Xi(t){var e,r,n,i;if(1===arguments.length){if(li(t))return t.slice();if(this===Gi&&"string"==typeof t)return[t];if(i=zi(t)){for(r=[];!(n=i.next()).done;)r.push(n.value);return r}if(null==t)return[t];if("number"==typeof(e=t.length)){for(r=new Array(e);e--;)r[e]=t[e];return r}return[t]}for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}var Wi="undefined"!=typeof Symbol?function(t){return"AsyncFunction"===t[Symbol.toStringTag]}:function(){return!1},Yi="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ki(t,e){Yi=t,Zi=e}var Zi=function(){return!0},ji=!new Error("").stack;function qi(){if(ji)try{throw new Error}catch(t){return t}return new Error}function Qi(t,e){var r=t.stack;return r?(e=e||0,0===r.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),r.split("\n").slice(e).filter(Zi).map((function(t){return"\n"+t})).join("")):""}var Ji=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],$i=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Ji),to={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function eo(t,e){this._e=qi(),this.name=t,this.message=e}function ro(t,e){return t+". Errors: "+Object.keys(e).map((function(t){return e[t].toString()})).filter((function(t,e,r){return r.indexOf(t)===e})).join("\n")}function no(t,e,r,n){this._e=qi(),this.failures=e,this.failedKeys=n,this.successCount=r,this.message=ro(t,e)}function io(t,e){this._e=qi(),this.name="BulkError",this.failures=e,this.message=ro(t,e)}_i(eo).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Qi(this._e,2))}},toString:function(){return this.name+": "+this.message}}),_i(no).from(eo),_i(io).from(eo);var oo=$i.reduce((function(t,e){return t[e]=e+"Error",t}),{}),so=eo,ao=$i.reduce((function(t,e){var r=e+"Error";function n(t,n){this._e=qi(),this.name=r,t?"string"==typeof t?(this.message=t+(n?"\n "+n:""),this.inner=n||null):"object"==typeof t&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=to[e]||r,this.inner=null)}return _i(n).from(so),t[e]=n,t}),{});ao.Syntax=SyntaxError,ao.Type=TypeError,ao.Range=RangeError;var uo=Ji.reduce((function(t,e){return t[e+"Error"]=ao[e],t}),{});var lo=$i.reduce((function(t,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=ao[e]),t}),{});function ho(){}function co(t){return t}function fo(t,e){return null==t||t===co?e:function(r){return e(t(r))}}function go(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function wo(t,e){return t===ho?e:function(){var r=t.apply(this,arguments);void 0!==r&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?go(n,this.onsuccess):n),i&&(this.onerror=this.onerror?go(i,this.onerror):i),void 0!==o?o:r}}function po(t,e){return t===ho?e:function(){t.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?go(r,this.onsuccess):r),n&&(this.onerror=this.onerror?go(n,this.onerror):n)}}function mo(t,e){return t===ho?e:function(r){var n=t.apply(this,arguments);ci(r,n);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?go(i,this.onsuccess):i),o&&(this.onerror=this.onerror?go(o,this.onerror):o),void 0===n?void 0===s?void 0:s:ci(n,s)}}function _o(t,e){return t===ho?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function Ao(t,e){return t===ho?e:function(){var r=t.apply(this,arguments);if(r&&"function"==typeof r.then){for(var n=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return r.then((function(){return e.apply(n,o)}))}return e.apply(this,arguments)}}lo.ModifyError=no,lo.DexieError=eo,lo.BulkError=io;var yo={},Eo="undefined"==typeof Promise?[]:function(){var t=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[t,t.__proto__,t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,e.__proto__,t]}(),Co=Eo[0],Io=Eo[1],bo=Eo[2],So=Io&&Io.then,vo=Co&&Co.constructor,To=!!bo,Ro=!1,No=bo?function(){bo.then(Jo)}:hi.setImmediate?setImmediate.bind(null,Jo):hi.MutationObserver?function(){var t=document.createElement("div");new MutationObserver((function(){Jo(),t=null})).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Jo,0)},Oo=function(t,e){Uo.push([t,e]),Mo&&(No(),Mo=!1)},Do=!0,Mo=!0,Bo=[],Po=[],ko=null,Lo=co,xo={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Cs,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(t){try{Cs(t[0],t[1])}catch(t){}}))}},Fo=xo,Uo=[],Vo=0,Ho=[];function zo(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ho,this._lib=!1;var e=this._PSD=Fo;if(Yi&&(this._stackHolder=qi(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==yo)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Yo(this,this._value))}this._state=null,this._value=null,++e.ref,Wo(this,t)}var Go={get:function(){var t=Fo,e=us;function r(r,n){var i=this,o=!t.global&&(t!==Fo||e!==us),s=o&&!ds(),a=new zo((function(e,a){Zo(i,new Xo(ys(r,t,o,s),ys(n,t,o,s),e,a,t))}));return Yi&&Qo(a,this),a}return r.prototype=yo,r},set:function(t){mi(this,"then",t&&t.prototype===yo?Go:{get:function(){return t},set:Go.set})}};function Xo(t,e,r,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=r,this.reject=n,this.psd=i}function Wo(t,e){try{e((function(e){if(null===t._state){if(e===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&$o();e&&"function"==typeof e.then?Wo(t,(function(t,r){e instanceof zo?e._then(t,r):e.then(t,r)})):(t._state=!0,t._value=e,Ko(t)),r&&ts()}}),Yo.bind(null,t))}catch(e){Yo(t,e)}}function Yo(t,e){if(Po.push(e),null===t._state){var r=t._lib&&$o();e=Lo(e),t._state=!1,t._value=e,Yi&&null!==e&&"object"==typeof e&&!e._promise&&function(t,e,r){try{t.apply(null,r)}catch(t){e&&e(t)}}((function(){var r=yi(e,"stack");e._promise=t,mi(e,"stack",{get:function(){return Ro?r&&(r.get?r.get.apply(e):r.value):t.stack}})})),function(t){Bo.some((function(e){return e._value===t._value}))||Bo.push(t)}(t),Ko(t),r&&ts()}}function Ko(t){var e=t._listeners;t._listeners=[];for(var r=0,n=e.length;r<n;++r)Zo(t,e[r]);var i=t._PSD;--i.ref||i.finalize(),0===Vo&&(++Vo,Oo((function(){0==--Vo&&es()}),[]))}function Zo(t,e){if(null!==t._state){var r=t._state?e.onFulfilled:e.onRejected;if(null===r)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Vo,Oo(jo,[r,t,e])}else t._listeners.push(e)}function jo(t,e,r){try{ko=e;var n,i=e._value;e._state?n=t(i):(Po.length&&(Po=[]),n=t(i),-1===Po.indexOf(i)&&function(t){var e=Bo.length;for(;e;)if(Bo[--e]._value===t._value)return void Bo.splice(e,1)}(e)),r.resolve(n)}catch(t){r.reject(t)}finally{ko=null,0==--Vo&&es(),--r.psd.ref||r.psd.finalize()}}function qo(t,e,r){if(e.length===r)return e;var n="";if(!1===t._state){var i,o,s=t._value;null!=s?(i=s.name||"Error",o=s.message||s,n=Qi(s,0)):(i=s,o=""),e.push(i+(o?": "+o:"")+n)}return Yi&&((n=Qi(t._stackHolder,2))&&-1===e.indexOf(n)&&e.push(n),t._prev&&qo(t._prev,e,r)),e}function Qo(t,e){var r=e?e._numPrev+1:0;r<100&&(t._prev=e,t._numPrev=r)}function Jo(){$o()&&ts()}function $o(){var t=Do;return Do=!1,Mo=!1,t}function ts(){var t,e,r;do{for(;Uo.length>0;)for(t=Uo,Uo=[],r=t.length,e=0;e<r;++e){var n=t[e];n[0].apply(null,n[1])}}while(Uo.length>0);Do=!0,Mo=!0}function es(){var t=Bo;Bo=[],t.forEach((function(t){t._PSD.onunhandled.call(null,t._value,t)}));for(var e=Ho.slice(0),r=e.length;r;)e[--r]()}function rs(t){return new zo(yo,!1,t)}function ns(t,e){var r=Fo;return function(){var n=$o(),i=Fo;try{return ps(r,!0),t.apply(this,arguments)}catch(t){e&&e(t)}finally{ps(i,!1),n&&ts()}}}wi(zo.prototype,{then:Go,_then:function(t,e){Zo(this,new Xo(null,null,t,e,Fo))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=arguments[0],r=arguments[1];return"function"==typeof e?this.then(null,(function(t){return t instanceof e?r(t):rs(t)})):this.then(null,(function(t){return t&&t.name===e?r(t):rs(t)}))},finally:function(t){return this.then((function(e){return t(),e}),(function(e){return t(),rs(e)}))},stack:{get:function(){if(this._stack)return this._stack;try{Ro=!0;var t=qo(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{Ro=!1}}},timeout:function(t,e){var r=this;return t<1/0?new zo((function(n,i){var o=setTimeout((function(){return i(new ao.Timeout(e))}),t);r.then(n,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&mi(zo.prototype,Symbol.toStringTag,"Dexie.Promise"),xo.env=ms(),wi(zo,{all:function(){var t=Xi.apply(null,arguments).map(fs);return new zo((function(e,r){0===t.length&&e([]);var n=t.length;t.forEach((function(i,o){return zo.resolve(i).then((function(r){t[o]=r,--n||e(t)}),r)}))}))},resolve:function(t){if(t instanceof zo)return t;if(t&&"function"==typeof t.then)return new zo((function(e,r){t.then(e,r)}));var e=new zo(yo,!0,t);return Qo(e,ko),e},reject:rs,race:function(){var t=Xi.apply(null,arguments).map(fs);return new zo((function(e,r){t.map((function(t){return zo.resolve(t).then(e,r)}))}))},PSD:{get:function(){return Fo},set:function(t){return Fo=t}},totalEchoes:{get:function(){return us}},newPSD:hs,usePSD:_s,scheduler:{get:function(){return Oo},set:function(t){Oo=t}},rejectionMapper:{get:function(){return Lo},set:function(t){Lo=t}},follow:function(t,e){return new zo((function(r,n){return hs((function(e,r){var n=Fo;n.unhandleds=[],n.onunhandled=r,n.finalize=go((function(){var t=this;!function(t){function e(){t(),Ho.splice(Ho.indexOf(e),1)}Ho.push(e),++Vo,Oo((function(){0==--Vo&&es()}),[])}((function(){0===t.unhandleds.length?e():r(t.unhandleds[0])}))}),n.finalize),t()}),e,r,n)}))}}),vo&&(vo.allSettled&&mi(zo,"allSettled",(function(){var t=Xi.apply(null,arguments).map(fs);return new zo((function(e){0===t.length&&e([]);var r=t.length,n=new Array(r);t.forEach((function(t,i){return zo.resolve(t).then((function(t){return n[i]={status:"fulfilled",value:t}}),(function(t){return n[i]={status:"rejected",reason:t}})).then((function(){return--r||e(n)}))}))}))})),vo.any&&"undefined"!=typeof AggregateError&&mi(zo,"any",(function(){var t=Xi.apply(null,arguments).map(fs);return new zo((function(e,r){0===t.length&&r(new AggregateError([]));var n=t.length,i=new Array(n);t.forEach((function(t,o){return zo.resolve(t).then((function(t){return e(t)}),(function(t){i[o]=t,--n||r(new AggregateError(i))}))}))}))})));var is={awaits:0,echoes:0,id:0},os=0,ss=[],as=0,us=0,ls=0;function hs(t,e,r,n){var i=Fo,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++ls;var s=xo.env;o.env=To?{Promise:zo,PromiseProp:{value:zo,configurable:!0,writable:!0},all:zo.all,race:zo.race,allSettled:zo.allSettled,any:zo.any,resolve:zo.resolve,reject:zo.reject,nthen:Es(s.nthen,o),gthen:Es(s.gthen,o)}:{},e&&ci(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=_s(o,t,r,n);return 0===o.ref&&o.finalize(),a}function cs(){return is.id||(is.id=++os),++is.awaits,is.echoes+=100,is.id}function ds(){return!!is.awaits&&(0==--is.awaits&&(is.id=0),is.echoes=100*is.awaits,!0)}function fs(t){return is.echoes&&t&&t.constructor===vo?(cs(),t.then((function(t){return ds(),t}),(function(t){return ds(),Is(t)}))):t}function gs(t){++us,is.echoes&&0!=--is.echoes||(is.echoes=is.id=0),ss.push(Fo),ps(t,!0)}function ws(){var t=ss[ss.length-1];ss.pop(),ps(t,!1)}function ps(t,e){var r=Fo;if((e?!is.echoes||as++&&t===Fo:!as||--as&&t===Fo)||As(e?gs.bind(null,t):ws),t!==Fo&&(Fo=t,r===xo&&(xo.env=ms()),To)){var n=xo.env.Promise,i=t.env;Io.then=i.nthen,n.prototype.then=i.gthen,(r.global||t.global)&&(Object.defineProperty(hi,"Promise",i.PromiseProp),n.all=i.all,n.race=i.race,n.resolve=i.resolve,n.reject=i.reject,i.allSettled&&(n.allSettled=i.allSettled),i.any&&(n.any=i.any))}}function ms(){var t=hi.Promise;return To?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(hi,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Io.then,gthen:t.prototype.then}:{}}function _s(t,e,r,n,i){var o=Fo;try{return ps(t,!0),e(r,n,i)}finally{ps(o,!1)}}function As(t){So.call(Co,t)}function ys(t,e,r,n){return"function"!=typeof t?t:function(){var i=Fo;r&&cs(),ps(e,!0);try{return t.apply(this,arguments)}finally{ps(i,!1),n&&As(ds)}}}function Es(t,e){return function(r,n){return t.call(this,ys(r,e),ys(n,e))}}-1===(""+So).indexOf("[native code]")&&(cs=ds=ho);function Cs(t,e){var r;try{r=e.onuncatched(t)}catch(t){}if(!1!==r)try{var n,i={promise:e,reason:t};if(hi.document&&document.createEvent?((n=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),ci(n,i)):hi.CustomEvent&&ci(n=new CustomEvent("unhandledrejection",{detail:i}),i),n&&hi.dispatchEvent&&(dispatchEvent(n),!hi.PromiseRejectionEvent&&hi.onunhandledrejection))try{hi.onunhandledrejection(n)}catch(t){}Yi&&n&&!n.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch(t){}}var Is=zo.reject;function bs(t,e,r,n){if(t._state.openComplete||Fo.letThrough){var i=t._createTransaction(e,r,t._dbSchema);try{i.create()}catch(t){return Is(t)}return i._promise(e,(function(t,e){return hs((function(){return Fo.trans=i,n(t,e,i)}))})).then((function(t){return i._completion.then((function(){return t}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Is(new ao.DatabaseClosed);t.open().catch(ho)}return t._state.dbReadyPromise.then((function(){return bs(t,e,r,n)}))}var Ss=String.fromCharCode(65535),vs="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Ts=[],Rs="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Ns=Rs,Os=Rs,Ds=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};function Ms(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var Bs={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ps(t){return function(e){return void 0===Ti(e,t)&&Ni(e=Li(e),t),e}}var ks=function(){function t(){}return t.prototype._trans=function(t,e,r){var n=this._tx||Fo.trans,i=this.name;function o(t,r,n){if(!n.schema[i])throw new ao.NotFound("Table "+i+" not part of transaction");return e(n.idbtrans,n)}var s=$o();try{return n&&n.db===this.db?n===Fo.trans?n._promise(t,o,r):hs((function(){return n._promise(t,o,r)}),{trans:n,transless:Fo.transless||Fo}):bs(this.db,t,[this.name],o)}finally{s&&ts()}},t.prototype.get=function(t,e){var r=this;return t&&t.constructor===Object?this.where(t).first(e):this._trans("readonly",(function(e){return r.core.get({trans:e,key:t}).then((function(t){return r.hook.reading.fire(t)}))})).then(e)},t.prototype.where=function(t){if("string"==typeof t)return new this.db.WhereClause(this,t);if(li(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var e=ui(t);if(1===e.length)return this.where(e[0]).equals(t[e[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter((function(t){return t.compound&&e.every((function(e){return t.keyPath.indexOf(e)>=0}))&&t.keyPath.every((function(t){return e.indexOf(t)>=0}))}))[0];if(r&&this.db._maxKey!==Ss)return this.where(r.name).equals(r.keyPath.map((function(e){return t[e]})));!r&&Yi&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a compound index ["+e.join("+")+"]");var n=this.schema.idxByName,i=this.db._deps.indexedDB;function o(t,e){try{return 0===i.cmp(t,e)}catch(t){return!1}}var s=e.reduce((function(e,r){var i=e[0],s=e[1],a=n[r],u=t[r];return[i||a,i||!a?Ms(s,a&&a.multi?function(t){var e=Ti(t,r);return li(e)&&e.some((function(t){return o(u,t)}))}:function(t){return o(u,Ti(t,r))}):s]}),[null,null]),a=s[0],u=s[1];return a?this.where(a.name).equals(t[a.keyPath]).filter(u):r?this.filter(u):this.where(e).equals("")},t.prototype.filter=function(t){return this.toCollection().and(t)},t.prototype.count=function(t){return this.toCollection().count(t)},t.prototype.offset=function(t){return this.toCollection().offset(t)},t.prototype.limit=function(t){return this.toCollection().limit(t)},t.prototype.each=function(t){return this.toCollection().each(t)},t.prototype.toArray=function(t){return this.toCollection().toArray(t)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,li(t)?"["+t.join("+")+"]":t))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(t){this.schema.mappedClass=t;var e=function(e){if(!e)return e;var r=Object.create(t.prototype);for(var n in e)if(gi(e,n))try{r[n]=e[n]}catch(t){}return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=e,this.hook("reading",e),t},t.prototype.defineClass=function(){return this.mapToClass((function(t){ci(this,t)}))},t.prototype.add=function(t,e){var r=this,n=this.schema.primKey,i=n.auto,o=n.keyPath,s=t;return o&&i&&(s=Ps(o)(t)),this._trans("readwrite",(function(t){return r.core.mutate({trans:t,type:"add",keys:null!=e?[e]:null,values:[s]})})).then((function(t){return t.numFailures?zo.reject(t.failures[0]):t.lastResult})).then((function(e){if(o)try{Ri(t,o,e)}catch(t){}return e}))},t.prototype.update=function(t,e){if("object"!=typeof e||li(e))throw new ao.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||li(t))return this.where(":id").equals(t).modify(e);ui(e).forEach((function(r){Ri(t,r,e[r])}));var r=Ti(t,this.schema.primKey.keyPath);return void 0===r?Is(new ao.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(e)},t.prototype.put=function(t,e){var r=this,n=this.schema.primKey,i=n.auto,o=n.keyPath,s=t;return o&&i&&(s=Ps(o)(t)),this._trans("readwrite",(function(t){return r.core.mutate({trans:t,type:"put",values:[s],keys:null!=e?[e]:null})})).then((function(t){return t.numFailures?zo.reject(t.failures[0]):t.lastResult})).then((function(e){if(o)try{Ri(t,o,e)}catch(t){}return e}))},t.prototype.delete=function(t){var e=this;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"delete",keys:[t]})})).then((function(t){return t.numFailures?zo.reject(t.failures[0]):void 0}))},t.prototype.clear=function(){var t=this;return this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"deleteRange",range:Bs})})).then((function(t){return t.numFailures?zo.reject(t.failures[0]):void 0}))},t.prototype.bulkGet=function(t){var e=this;return this._trans("readonly",(function(r){return e.core.getMany({keys:t,trans:r}).then((function(t){return t.map((function(t){return e.hook.reading.fire(t)}))}))}))},t.prototype.bulkAdd=function(t,e,r){var n=this,i=Array.isArray(e)?e:void 0,o=(r=r||(i?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",(function(e){var r=n.schema.primKey,s=r.auto,a=r.keyPath;if(a&&i)throw new ao.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new ao.InvalidArgument("Arguments objects and keys must have the same length");var u=t.length,l=a&&s?t.map(Ps(a)):t;return n.core.mutate({trans:e,type:"add",keys:i,values:l,wantResults:o}).then((function(t){var e=t.numFailures,r=t.results,i=t.lastResult,s=t.failures;if(0===e)return o?r:i;throw new io(n.name+".bulkAdd(): "+e+" of "+u+" operations failed",Object.keys(s).map((function(t){return s[t]})))}))}))},t.prototype.bulkPut=function(t,e,r){var n=this,i=Array.isArray(e)?e:void 0,o=(r=r||(i?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",(function(e){var r=n.schema.primKey,s=r.auto,a=r.keyPath;if(a&&i)throw new ao.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new ao.InvalidArgument("Arguments objects and keys must have the same length");var u=t.length,l=a&&s?t.map(Ps(a)):t;return n.core.mutate({trans:e,type:"put",keys:i,values:l,wantResults:o}).then((function(t){var e=t.numFailures,r=t.results,i=t.lastResult,s=t.failures;if(0===e)return o?r:i;throw new io(n.name+".bulkPut(): "+e+" of "+u+" operations failed",Object.keys(s).map((function(t){return s[t]})))}))}))},t.prototype.bulkDelete=function(t){var e=this,r=t.length;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"delete",keys:t})})).then((function(t){var n=t.numFailures,i=t.lastResult,o=t.failures;if(0===n)return i;throw new io(e.name+".bulkDelete(): "+n+" of "+r+" operations failed",o)}))},t}();function Ls(t){var e={},r=function(r,n){if(n){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return e[r].subscribe.apply(null,o),t}if("string"==typeof r)return e[r]};r.addEventType=o;for(var n=1,i=arguments.length;n<i;++n)o(arguments[n]);return r;function o(t,n,i){if("object"==typeof t)return s(t);n||(n=_o),i||(i=ho);var o={subscribers:[],fire:i,subscribe:function(t){-1===o.subscribers.indexOf(t)&&(o.subscribers.push(t),o.fire=n(o.fire,t))},unsubscribe:function(t){o.subscribers=o.subscribers.filter((function(e){return e!==t})),o.fire=o.subscribers.reduce(n,i)}};return e[t]=r[t]=o,o}function s(t){ui(t).forEach((function(e){var r=t[e];if(li(r))o(e,t[e][0],t[e][1]);else{if("asap"!==r)throw new ao.InvalidArgument("Invalid event config");var n=o(e,co,(function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];n.subscribers.forEach((function(t){Si((function(){t.apply(null,e)}))}))}))}}))}}function xs(t,e){return _i(e).from({prototype:t}),e}function Fs(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Us(t,e){t.filter=Ms(t.filter,e)}function Vs(t,e,r){var n=t.replayFilter;t.replayFilter=n?function(){return Ms(n(),e())}:e,t.justLimit=r&&!n}function Hs(t,e){if(t.isPrimKey)return e.primaryKey;var r=e.getIndexByKeyPath(t.index);if(!r)throw new ao.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return r}function zs(t,e,r){var n=Hs(t,e.schema);return e.openCursor({trans:r,values:!t.keysOnly,reverse:"prev"===t.dir,unique:!!t.unique,query:{index:n,range:t.range}})}function Gs(t,e,r,n){var i=t.replayFilter?Ms(t.filter,t.replayFilter()):t.filter;if(t.or){var o={},s=function(t,r,n){if(!i||i(r,n,(function(t){return r.stop(t)}),(function(t){return r.fail(t)}))){var s=r.primaryKey,a=""+s;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(s)),gi(o,a)||(o[a]=!0,e(t,r,n))}};return Promise.all([t.or._iterate(s,r),Xs(zs(t,n,r),t.algorithm,s,!t.keysOnly&&t.valueMapper)])}return Xs(zs(t,n,r),Ms(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function Xs(t,e,r,n){var i=ns(n?function(t,e,i){return r(n(t),e,i)}:r);return t.then((function(t){if(t)return t.start((function(){var r=function(){return t.continue()};e&&!e(t,(function(t){return r=t}),(function(e){t.stop(e),r=ho}),(function(e){t.fail(e),r=ho}))||i(t.value,t,(function(t){return r=t})),r()}))}))}var Ws=function(){function t(){}return t.prototype._read=function(t,e){var r=this._ctx;return r.error?r.table._trans(null,Is.bind(null,r.error)):r.table._trans("readonly",t).then(e)},t.prototype._write=function(t){var e=this._ctx;return e.error?e.table._trans(null,Is.bind(null,e.error)):e.table._trans("readwrite",t,"locked")},t.prototype._addAlgorithm=function(t){var e=this._ctx;e.algorithm=Ms(e.algorithm,t)},t.prototype._iterate=function(t,e){return Gs(this._ctx,t,e,this._ctx.table.core)},t.prototype.clone=function(t){var e=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&ci(r,t),e._ctx=r,e},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(t){var e=this._ctx;return this._read((function(r){return Gs(e,t,r,e.table.core)}))},t.prototype.count=function(t){var e=this;return this._read((function(t){var r=e._ctx,n=r.table.core;if(Fs(r,!0))return n.count({trans:t,query:{index:Hs(r,n.schema),range:r.range}}).then((function(t){return Math.min(t,r.limit)}));var i=0;return Gs(r,(function(){return++i,!1}),t,n).then((function(){return i}))})).then(t)},t.prototype.sortBy=function(t,e){var r=t.split(".").reverse(),n=r[0],i=r.length-1;function o(t,e){return e?o(t[r[e]],e-1):t[n]}var s="next"===this._ctx.dir?1:-1;function a(t,e){var r=o(t,i),n=o(e,i);return r<n?-s:r>n?s:0}return this.toArray((function(t){return t.sort(a)})).then(e)},t.prototype.toArray=function(t){var e=this;return this._read((function(t){var r=e._ctx;if("next"===r.dir&&Fs(r,!0)&&r.limit>0){var n=r.valueMapper,i=Hs(r,r.table.core.schema);return r.table.core.query({trans:t,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then((function(t){var e=t.result;return n?e.map(n):e}))}var o=[];return Gs(r,(function(t){return o.push(t)}),t,r.table.core).then((function(){return o}))}),t)},t.prototype.offset=function(t){var e=this._ctx;return t<=0||(e.offset+=t,Fs(e)?Vs(e,(function(){var e=t;return function(t,r){return 0===e||(1===e?(--e,!1):(r((function(){t.advance(e),e=0})),!1))}})):Vs(e,(function(){var e=t;return function(){return--e<0}}))),this},t.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),Vs(this._ctx,(function(){var e=t;return function(t,r,n){return--e<=0&&r(n),e>=0}}),!0),this},t.prototype.until=function(t,e){return Us(this._ctx,(function(r,n,i){return!t(r.value)||(n(i),e)})),this},t.prototype.first=function(t){return this.limit(1).toArray((function(t){return t[0]})).then(t)},t.prototype.last=function(t){return this.reverse().first(t)},t.prototype.filter=function(t){var e,r;return Us(this._ctx,(function(e){return t(e.value)})),e=this._ctx,r=t,e.isMatch=Ms(e.isMatch,r),this},t.prototype.and=function(t){return this.filter(t)},t.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},t.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each((function(e,r){t(r.key,r)}))},t.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},t.prototype.eachPrimaryKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each((function(e,r){t(r.primaryKey,r)}))},t.prototype.keys=function(t){var e=this._ctx;e.keysOnly=!e.isMatch;var r=[];return this.each((function(t,e){r.push(e.key)})).then((function(){return r})).then(t)},t.prototype.primaryKeys=function(t){var e=this._ctx;if("next"===e.dir&&Fs(e,!0)&&e.limit>0)return this._read((function(t){var r=Hs(e,e.table.core.schema);return e.table.core.query({trans:t,values:!1,limit:e.limit,query:{index:r,range:e.range}})})).then((function(t){return t.result})).then(t);e.keysOnly=!e.isMatch;var r=[];return this.each((function(t,e){r.push(e.primaryKey)})).then((function(){return r})).then(t)},t.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},t.prototype.firstKey=function(t){return this.limit(1).keys((function(t){return t[0]})).then(t)},t.prototype.lastKey=function(t){return this.reverse().firstKey(t)},t.prototype.distinct=function(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var r={};return Us(this._ctx,(function(t){var e=t.primaryKey.toString(),n=gi(r,e);return r[e]=!0,!n})),this},t.prototype.modify=function(t){var e=this,r=this._ctx;return this._write((function(n){var i;if("function"==typeof t)i=t;else{var o=ui(t),s=o.length;i=function(e){for(var r=!1,n=0;n<s;++n){var i=o[n],a=t[i];Ti(e,i)!==a&&(Ri(e,i,a),r=!0)}return r}}var a=r.table.core,u=a.schema.primaryKey,l=u.outbound,h=u.extractKey,c="testmode"in La?1:2e3,d=e.db.core.cmp,f=[],g=0,w=[],p=function(t,e){var r=e.failures,n=e.numFailures;g+=t-n;for(var i=0,o=ui(r);i<o.length;i++){var s=o[i];f.push(r[s])}};return e.clone().primaryKeys().then((function(t){var e=function(r){var o=Math.min(c,t.length-r);return a.getMany({trans:n,keys:t.slice(r,r+o)}).then((function(s){for(var u=[],f=[],g=l?[]:null,w=[],m=0;m<o;++m){var _=s[m],A={value:Li(_),primKey:t[r+m]};!1!==i.call(A,A.value,A)&&(null==A.value?w.push(t[r+m]):l||0===d(h(_),h(A.value))?(f.push(A.value),l&&g.push(t[r+m])):(w.push(t[r+m]),u.push(A.value)))}return Promise.resolve(u.length>0&&a.mutate({trans:n,type:"add",values:u}).then((function(t){for(var e in t.failures)w.splice(parseInt(e),1);p(u.length,t)}))).then((function(t){return f.length>0&&a.mutate({trans:n,type:"put",keys:g,values:f}).then((function(t){return p(f.length,t)}))})).then((function(){return w.length>0&&a.mutate({trans:n,type:"delete",keys:w}).then((function(t){return p(w.length,t)}))})).then((function(){return t.length>r+o&&e(r+c)}))}))};return e(0).then((function(){if(f.length>0)throw new no("Error modifying one or more objects",f,g,w);return t.length}))}))}))},t.prototype.delete=function(){var t=this._ctx,e=t.range;return Fs(t)&&(t.isPrimKey&&!Os||3===e.type)?this._write((function(r){var n=t.table.core.schema.primaryKey,i=e;return t.table.core.count({trans:r,query:{index:n,range:i}}).then((function(e){return t.table.core.mutate({trans:r,type:"deleteRange",range:i}).then((function(t){var r=t.failures,n=(t.lastResult,t.results,t.numFailures);if(n)throw new no("Could not delete some values",Object.keys(r).map((function(t){return r[t]})),e-n);return e-n}))}))})):this.modify((function(t,e){return e.value=null}))},t}();function Ys(t,e){return t<e?-1:t===e?0:1}function Ks(t,e){return t>e?-1:t===e?0:1}function Zs(t,e,r){var n=t instanceof ta?new t.Collection(t):t;return n._ctx.error=r?new r(e):new TypeError(e),n}function js(t){return new t.Collection(t,(function(){return $s("")})).limit(0)}function qs(t,e,r,n,i,o){for(var s=Math.min(t.length,n.length),a=-1,u=0;u<s;++u){var l=e[u];if(l!==n[u])return i(t[u],r[u])<0?t.substr(0,u)+r[u]+r.substr(u+1):i(t[u],n[u])<0?t.substr(0,u)+n[u]+r.substr(u+1):a>=0?t.substr(0,a)+e[a]+r.substr(a+1):null;i(t[u],l)<0&&(a=u)}return s<n.length&&"next"===o?t+r.substr(t.length):s<t.length&&"prev"===o?t.substr(0,r.length):a<0?null:t.substr(0,a)+n[a]+r.substr(a+1)}function Qs(t,e,r,n){var i,o,s,a,u,l,h,c=r.length;if(!r.every((function(t){return"string"==typeof t})))return Zs(t,"String expected.");function d(t){i=function(t){return"next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}(t),o=function(t){return"next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}(t),s="next"===t?Ys:Ks;var e=r.map((function(t){return{lower:o(t),upper:i(t)}})).sort((function(t,e){return s(t.lower,e.lower)}));a=e.map((function(t){return t.upper})),u=e.map((function(t){return t.lower})),l=t,h="next"===t?"":n}d("next");var f=new t.Collection(t,(function(){return Js(a[0],u[c-1]+n)}));f._ondirectionchange=function(t){d(t)};var g=0;return f._addAlgorithm((function(t,r,n){var i=t.key;if("string"!=typeof i)return!1;var d=o(i);if(e(d,u,g))return!0;for(var f=null,w=g;w<c;++w){var p=qs(i,d,a[w],u[w],s,l);null===p&&null===f?g=w+1:(null===f||s(f,p)>0)&&(f=p)}return r(null!==f?function(){t.continue(f+h)}:n),!1})),f}function Js(t,e,r,n){return{type:2,lower:t,upper:e,lowerOpen:r,upperOpen:n}}function $s(t){return{type:1,lower:t,upper:t}}var ta=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),t.prototype.between=function(t,e,r,n){r=!1!==r,n=!0===n;try{return this._cmp(t,e)>0||0===this._cmp(t,e)&&(r||n)&&(!r||!n)?js(this):new this.Collection(this,(function(){return Js(t,e,!r,!n)}))}catch(t){return Zs(this,vs)}},t.prototype.equals=function(t){return null==t?Zs(this,vs):new this.Collection(this,(function(){return $s(t)}))},t.prototype.above=function(t){return null==t?Zs(this,vs):new this.Collection(this,(function(){return Js(t,void 0,!0)}))},t.prototype.aboveOrEqual=function(t){return null==t?Zs(this,vs):new this.Collection(this,(function(){return Js(t,void 0,!1)}))},t.prototype.below=function(t){return null==t?Zs(this,vs):new this.Collection(this,(function(){return Js(void 0,t,!1,!0)}))},t.prototype.belowOrEqual=function(t){return null==t?Zs(this,vs):new this.Collection(this,(function(){return Js(void 0,t)}))},t.prototype.startsWith=function(t){return"string"!=typeof t?Zs(this,"String expected."):this.between(t,t+Ss,!0,!0)},t.prototype.startsWithIgnoreCase=function(t){return""===t?this.startsWith(t):Qs(this,(function(t,e){return 0===t.indexOf(e[0])}),[t],Ss)},t.prototype.equalsIgnoreCase=function(t){return Qs(this,(function(t,e){return t===e[0]}),[t],"")},t.prototype.anyOfIgnoreCase=function(){var t=Xi.apply(Gi,arguments);return 0===t.length?js(this):Qs(this,(function(t,e){return-1!==e.indexOf(t)}),t,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var t=Xi.apply(Gi,arguments);return 0===t.length?js(this):Qs(this,(function(t,e){return e.some((function(e){return 0===t.indexOf(e)}))}),t,Ss)},t.prototype.anyOf=function(){var t=this,e=Xi.apply(Gi,arguments),r=this._cmp;try{e.sort(r)}catch(t){return Zs(this,vs)}if(0===e.length)return js(this);var n=new this.Collection(this,(function(){return Js(e[0],e[e.length-1])}));n._ondirectionchange=function(n){r="next"===n?t._ascending:t._descending,e.sort(r)};var i=0;return n._addAlgorithm((function(t,n,o){for(var s=t.key;r(s,e[i])>0;)if(++i===e.length)return n(o),!1;return 0===r(s,e[i])||(n((function(){t.continue(e[i])})),!1)})),n},t.prototype.notEqual=function(t){return this.inAnyRange([[-(1/0),t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var t=Xi.apply(Gi,arguments);if(0===t.length)return new this.Collection(this);try{t.sort(this._ascending)}catch(t){return Zs(this,vs)}var e=t.reduce((function(t,e){return t?t.concat([[t[t.length-1][1],e]]):[[-(1/0),e]]}),null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(t,e){var r=this,n=this._cmp,i=this._ascending,o=this._descending,s=this._min,a=this._max;if(0===t.length)return js(this);if(!t.every((function(t){return void 0!==t[0]&&void 0!==t[1]&&i(t[0],t[1])<=0})))return Zs(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ao.InvalidArgument);var u=!e||!1!==e.includeLowers,l=e&&!0===e.includeUppers;var h,c=i;function d(t,e){return c(t[0],e[0])}try{(h=t.reduce((function(t,e){for(var r=0,i=t.length;r<i;++r){var o=t[r];if(n(e[0],o[1])<0&&n(e[1],o[0])>0){o[0]=s(o[0],e[0]),o[1]=a(o[1],e[1]);break}}return r===i&&t.push(e),t}),[])).sort(d)}catch(t){return Zs(this,vs)}var f=0,g=l?function(t){return i(t,h[f][1])>0}:function(t){return i(t,h[f][1])>=0},w=u?function(t){return o(t,h[f][0])>0}:function(t){return o(t,h[f][0])>=0};var p=g,m=new this.Collection(this,(function(){return Js(h[0][0],h[h.length-1][1],!u,!l)}));return m._ondirectionchange=function(t){"next"===t?(p=g,c=i):(p=w,c=o),h.sort(d)},m._addAlgorithm((function(t,e,n){for(var o=t.key;p(o);)if(++f===h.length)return e(n),!1;return!!function(t){return!g(t)&&!w(t)}(o)||(0===r._cmp(o,h[f][1])||0===r._cmp(o,h[f][0])||e((function(){c===i?t.continue(h[f][0]):t.continue(h[f][1])})),!1)})),m},t.prototype.startsWithAnyOf=function(){var t=Xi.apply(Gi,arguments);return t.every((function(t){return"string"==typeof t}))?0===t.length?js(this):this.inAnyRange(t.map((function(t){return[t,t+Ss]}))):Zs(this,"startsWithAnyOf() only works with strings")},t}();function ea(t){return 1===t.length?t[0]:t}function ra(t){try{return t.only([[]]),[[]]}catch(t){return Ss}}function na(t){return ns((function(e){return ia(e),t(e.target.error),!1}))}function ia(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var oa=function(){function t(){}return t.prototype._lock=function(){return bi(!Fo.global),++this._reculock,1!==this._reculock||Fo.global||(Fo.lockOwnerFor=this),this},t.prototype._unlock=function(){if(bi(!Fo.global),0==--this._reculock)for(Fo.global||(Fo.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{_s(t[1],t[0])}catch(t){}}return this},t.prototype._locked=function(){return this._reculock&&Fo.lockOwnerFor!==this},t.prototype.create=function(t){var e=this;if(!this.mode)return this;var r=this.db.idbdb,n=this.db._state.dbOpenError;if(bi(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new ao.DatabaseClosed(n);case"MissingAPIError":throw new ao.MissingAPI(n.message,n);default:throw new ao.OpenFailed(n)}if(!this.active)throw new ao.TransactionInactive;return bi(null===this._completion._state),(t=this.idbtrans=t||r.transaction(ea(this.storeNames),this.mode)).onerror=ns((function(r){ia(r),e._reject(t.error)})),t.onabort=ns((function(r){ia(r),e.active&&e._reject(new ao.Abort(t.error)),e.active=!1,e.on("abort").fire(r)})),t.oncomplete=ns((function(){e.active=!1,e._resolve()})),this},t.prototype._promise=function(t,e,r){var n=this;if("readwrite"===t&&"readwrite"!==this.mode)return Is(new ao.ReadOnly("Transaction is readonly"));if(!this.active)return Is(new ao.TransactionInactive);if(this._locked())return new zo((function(i,o){n._blockedFuncs.push([function(){n._promise(t,e,r).then(i,o)},Fo])}));if(r)return hs((function(){var t=new zo((function(t,r){n._lock();var i=e(t,r,n);i&&i.then&&i.then(t,r)}));return t.finally((function(){return n._unlock()})),t._lib=!0,t}));var i=new zo((function(t,r){var i=e(t,r,n);i&&i.then&&i.then(t,r)}));return i._lib=!0,i},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(t){var e=this._root(),r=zo.resolve(t);if(e._waitingFor)e._waitingFor=e._waitingFor.then((function(){return r}));else{e._waitingFor=r,e._waitingQueue=[];var n=e.idbtrans.objectStore(e.storeNames[0]);!function t(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(n.get(-1/0).onsuccess=t)}()}var i=e._waitingFor;return new zo((function(t,n){r.then((function(r){return e._waitingQueue.push(ns(t.bind(null,r)))}),(function(t){return e._waitingQueue.push(ns(n.bind(null,t)))})).finally((function(){e._waitingFor===i&&(e._waitingFor=null)}))}))},t.prototype.abort=function(){this.active&&this._reject(new ao.Abort),this.active=!1},t.prototype.table=function(t){var e=this._memoizedTables||(this._memoizedTables={});if(gi(e,t))return e[t];var r=this.schema[t];if(!r)throw new ao.NotFound("Table "+t+" not part of transaction");var n=new this.db.Table(t,r,this);return n.core=this.db.core.table(t),e[t]=n,n},t}();function sa(t,e,r,n,i,o,s){return{name:t,keyPath:e,unique:r,multi:n,auto:i,compound:o,src:(r&&!s?"&":"")+(n?"*":"")+(i?"++":"")+aa(e)}}function aa(t){return"string"==typeof t?t:t?"["+[].join.call(t,"+")+"]":""}function ua(t,e,r){return{name:t,primKey:e,indexes:r,mappedClass:null,idxByName:vi(r,(function(t){return[t.name,t]}))}}function la(t){return null==t?function(){}:"string"==typeof t?function(t){return 1===t.split(".").length?function(e){return e[t]}:function(e){return Ti(e,t)}}(t):function(e){return Ti(e,t)}}function ha(t,e){return"delete"===e.type?e.keys:e.keys||e.values.map(t.extractKey)}function ca(t){return[].slice.call(t)}var da=0;function fa(t){return null==t?":id":"string"==typeof t?t:"["+t.join("+")+"]"}function ga(t,e,r,n){var i=e.cmp.bind(e);function o(t){if(3===t.type)return null;if(4===t.type)throw new Error("Cannot convert never type to IDBKeyRange");var e=t.lower,n=t.upper,i=t.lowerOpen,o=t.upperOpen;return void 0===e?void 0===n?null:r.upperBound(n,!!o):void 0===n?r.lowerBound(e,!!i):r.bound(e,n,!!i,!!o)}var s=function(t,e){var r=ca(t.objectStoreNames);return{schema:{name:t.name,tables:r.map((function(t){return e.objectStore(t)})).map((function(t){var e=t.keyPath,r=t.autoIncrement,n=li(e),i=null==e,o={},s={name:t.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:n,keyPath:e,autoIncrement:r,unique:!0,extractKey:la(e)},indexes:ca(t.indexNames).map((function(e){return t.index(e)})).map((function(t){var e=t.name,r=t.unique,n=t.multiEntry,i=t.keyPath,s={name:e,compound:li(i),keyPath:i,unique:r,multiEntry:n,extractKey:la(i)};return o[fa(i)]=s,s})),getIndexByKeyPath:function(t){return o[fa(t)]}};return o[":id"]=s.primaryKey,null!=e&&(o[fa(e)]=s.primaryKey),s}))},hasGetAll:r.length>0&&"getAll"in e.objectStore(r[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),a=s.schema,u=s.hasGetAll,l=a.tables.map((function(t){return function(t){var e=t.name;return{name:e,schema:t,mutate:function(r){var n=r.trans,i=r.type,s=r.keys,a=r.values,u=r.range,l=r.wantResults;return new Promise((function(r,h){r=ns(r);var c=n.objectStore(e),d=null==c.keyPath,f="put"===i||"add"===i;if(!f&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var g=(s||a||{length:1}).length;if(s&&a&&s.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===g)return r({numFailures:0,failures:{},results:[],lastResult:void 0});var w,p=l&&ai(s||ha(t.primaryKey,{type:i,keys:s,values:a})),m=[],_=0,A=function(t){++_,ia(t),p&&(p[t.target._reqno]=void 0),m[t.target._reqno]=t.target.error},y=function(t){var e=t.target;p[e._reqno]=e.result};if("deleteRange"===i){if(4===u.type)return r({numFailures:_,failures:m,results:p,lastResult:void 0});w=3===u.type?c.clear():c.delete(o(u))}else{var E=f?d?[a,s]:[a,null]:[s,null],C=E[0],I=E[1];if(f)for(var b=0;b<g;++b)(w=I&&void 0!==I[b]?c[i](C[b],I[b]):c[i](C[b]))._reqno=b,p&&void 0===p[b]&&(w.onsuccess=y),w.onerror=A;else for(b=0;b<g;++b)(w=c[i](C[b]))._reqno=b,w.onerror=A}var S=function(t){var e=t.target.result;p&&(p[g-1]=e),r({numFailures:_,failures:m,results:p,lastResult:e})};w.onerror=function(t){A(t),S(t)},w.onsuccess=S}))},getMany:function(t){var r=t.trans,n=t.keys;return new Promise((function(t,i){t=ns(t);for(var o,s=r.objectStore(e),a=n.length,u=new Array(a),l=0,h=0,c=function(e){var r=e.target;u[r._pos]=r.result,++h===l&&t(u)},d=na(i),f=0;f<a;++f)null!=n[f]&&((o=s.get(n[f]))._pos=f,o.onsuccess=c,o.onerror=d,++l);0===l&&t(u)}))},get:function(t){var r=t.trans,n=t.key;return new Promise((function(t,i){t=ns(t);var o=r.objectStore(e).get(n);o.onsuccess=function(e){return t(e.target.result)},o.onerror=na(i)}))},query:function(t){return function(r){return new Promise((function(n,i){n=ns(n);var s=r.trans,a=r.values,u=r.limit,l=r.query,h=u===1/0?void 0:u,c=l.index,d=l.range,f=s.objectStore(e),g=c.isPrimaryKey?f:f.index(c.name),w=o(d);if(0===u)return n({result:[]});if(t){var p=a?g.getAll(w,h):g.getAllKeys(w,h);p.onsuccess=function(t){return n({result:t.target.result})},p.onerror=na(i)}else{var m=0,_=a||!("openKeyCursor"in g)?g.openCursor(w):g.openKeyCursor(w),A=[];_.onsuccess=function(t){var e=_.result;return e?(A.push(a?e.value:e.primaryKey),++m===u?n({result:A}):void e.continue()):n({result:A})},_.onerror=na(i)}}))}}(u),openCursor:function(t){var r=t.trans,n=t.values,i=t.query,s=t.reverse,a=t.unique;return new Promise((function(t,u){t=ns(t);var l=i.index,h=i.range,c=r.objectStore(e),d=l.isPrimaryKey?c:c.index(l.name),f=s?a?"prevunique":"prev":a?"nextunique":"next",g=n||!("openKeyCursor"in d)?d.openCursor(o(h),f):d.openKeyCursor(o(h),f);g.onerror=na(u),g.onsuccess=ns((function(e){var n=g.result;if(n){n.___id=++da,n.done=!1;var i=n.continue.bind(n),o=n.continuePrimaryKey;o&&(o=o.bind(n));var s=n.advance.bind(n),a=function(){throw new Error("Cursor not stopped")};n.trans=r,n.stop=n.continue=n.continuePrimaryKey=n.advance=function(){throw new Error("Cursor not started")},n.fail=ns(u),n.next=function(){var t=this,e=1;return this.start((function(){return e--?t.continue():t.stop()})).then((function(){return t}))},n.start=function(t){var e=new Promise((function(t,e){t=ns(t),g.onerror=na(e),n.fail=e,n.stop=function(e){n.stop=n.continue=n.continuePrimaryKey=n.advance=a,t(e)}})),r=function(){if(g.result)try{t()}catch(t){n.fail(t)}else n.done=!0,n.start=function(){throw new Error("Cursor behind last entry")},n.stop()};return g.onsuccess=ns((function(t){g.onsuccess=r,r()})),n.continue=i,n.continuePrimaryKey=o,n.advance=s,r(),e},t(n)}else t(null)}),u)}))},count:function(t){var r=t.query,n=t.trans,i=r.index,s=r.range;return new Promise((function(t,r){var a=n.objectStore(e),u=i.isPrimaryKey?a:a.index(i.name),l=o(s),h=l?u.count(l):u.count();h.onsuccess=ns((function(e){return t(e.target.result)})),h.onerror=na(r)}))}}}(t)})),h={};return l.forEach((function(t){return h[t.name]=t})),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(t){if(!h[t])throw new Error("Table '"+t+"' not found");return h[t]},cmp:i,MIN_KEY:-1/0,MAX_KEY:ra(r),schema:a}}function wa(t,e,r,n){var i=r.IDBKeyRange;return{dbcore:function(t,e){return e.reduce((function(t,e){var r=e.create;return si(si({},t),r(t))}),t)}(ga(e,r.indexedDB,i,n),t.dbcore)}}function pa(t,e){var r=e.db,n=wa(t._middlewares,r,t._deps,e);t.core=n.dbcore,t.tables.forEach((function(e){var r=e.name;t.core.schema.tables.some((function(t){return t.name===r}))&&(e.core=t.core.table(r),t[r]instanceof t.Table&&(t[r].core=e.core))}))}function ma(t,e,r,n){r.forEach((function(r){var i=n[r];e.forEach((function(e){var n=yi(e,r);(!n||"value"in n&&void 0===n.value)&&(e===t.Transaction.prototype||e instanceof t.Transaction?mi(e,r,{get:function(){return this.table(r)},set:function(t){pi(this,r,{value:t,writable:!0,configurable:!0,enumerable:!0})}}):e[r]=new t.Table(r,i))}))}))}function _a(t,e){e.forEach((function(e){for(var r in e)e[r]instanceof t.Table&&delete e[r]}))}function Aa(t,e){return t._cfg.version-e._cfg.version}function ya(t,e,r,n){var i=t._dbSchema,o=t._createTransaction("readwrite",t._storeNames,i);o.create(r),o._completion.catch(n);var s=o._reject.bind(o),a=Fo.transless||Fo;hs((function(){Fo.trans=o,Fo.transless=a,0===e?(ui(i).forEach((function(t){Ca(r,t,i[t].primKey,i[t].indexes)})),pa(t,r),zo.follow((function(){return t.on.populate.fire(o)})).catch(s)):function(t,e,r,n){var i=[],o=t._versions,s=t._dbSchema=ba(t,t.idbdb,n),a=!1;function u(){return i.length?zo.resolve(i.shift()(r.idbtrans)).then(u):zo.resolve()}return o.filter((function(t){return t._cfg.version>=e})).forEach((function(o){i.push((function(){var i=s,u=o._cfg.dbschema;Sa(t,i,n),Sa(t,u,n),s=t._dbSchema=u;var l=Ea(i,u);l.add.forEach((function(t){Ca(n,t[0],t[1].primKey,t[1].indexes)})),l.change.forEach((function(t){if(t.recreate)throw new ao.Upgrade("Not yet support for changing primary key");var e=n.objectStore(t.name);t.add.forEach((function(t){return Ia(e,t)})),t.change.forEach((function(t){e.deleteIndex(t.name),Ia(e,t)})),t.del.forEach((function(t){return e.deleteIndex(t)}))}));var h=o._cfg.contentUpgrade;if(h&&o._cfg.version>e){pa(t,n),r._memoizedTables={},a=!0;var c=Oi(u);l.del.forEach((function(t){c[t]=i[t]})),_a(t,[t.Transaction.prototype]),ma(t,[t.Transaction.prototype],ui(c),c),r.schema=c;var d,f=Wi(h);f&&cs();var g=zo.follow((function(){if((d=h(r))&&f){var t=ds.bind(null,null);d.then(t,t)}}));return d&&"function"==typeof d.then?zo.resolve(d):g.then((function(){return d}))}})),i.push((function(e){a&&Ns||function(t,e){for(var r=0;r<e.db.objectStoreNames.length;++r){var n=e.db.objectStoreNames[r];null==t[n]&&e.db.deleteObjectStore(n)}}(o._cfg.dbschema,e);_a(t,[t.Transaction.prototype]),ma(t,[t.Transaction.prototype],t._storeNames,t._dbSchema),r.schema=t._dbSchema}))})),u().then((function(){var t,e;e=n,ui(t=s).forEach((function(r){e.db.objectStoreNames.contains(r)||Ca(e,r,t[r].primKey,t[r].indexes)}))}))}(t,e,o,r).catch(s)}))}function Ea(t,e){var r,n={del:[],add:[],change:[]};for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],o=e[r];if(i){var s={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!Rs)s.recreate=!0,n.change.push(s);else{var a=i.idxByName,u=o.idxByName,l=void 0;for(l in a)u[l]||s.del.push(l);for(l in u){var h=a[l],c=u[l];h?h.src!==c.src&&s.change.push(c):s.add.push(c)}(s.del.length>0||s.add.length>0||s.change.length>0)&&n.change.push(s)}}else n.add.push([r,o])}return n}function Ca(t,e,r,n){var i=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach((function(t){return Ia(i,t)})),i}function Ia(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function ba(t,e,r){var n={};return Ci(e.objectStoreNames,0).forEach((function(t){for(var e=r.objectStore(t),i=e.keyPath,o=sa(aa(i),i||"",!1,!1,!!e.autoIncrement,i&&"string"!=typeof i,!0),s=[],a=0;a<e.indexNames.length;++a){var u=e.index(e.indexNames[a]);i=u.keyPath;var l=sa(u.name,i,!!u.unique,!!u.multiEntry,!1,i&&"string"!=typeof i,!1);s.push(l)}n[t]=ua(t,o,s)})),n}function Sa(t,e,r){for(var n=r.db.objectStoreNames,i=0;i<n.length;++i){var o=n[i],s=r.objectStore(o);t._hasGetAll="getAll"in s;for(var a=0;a<s.indexNames.length;++a){var u=s.indexNames[a],l=s.index(u).keyPath,h="string"==typeof l?l:"["+Ci(l).join("+")+"]";if(e[o]){var c=e[o].idxByName[h];c&&(c.name=u,delete e[o].idxByName[h],e[o].idxByName[u]=c)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&hi.WorkerGlobalScope&&hi instanceof hi.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}var va,Ta=function(){function t(){}return t.prototype._parseStoresSpec=function(t,e){ui(t).forEach((function(r){if(null!==t[r]){var n=t[r].split(",").map((function(t,e){var r=(t=t.trim()).replace(/([&*]|\+\+)/g,""),n=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return sa(r,n||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),li(n),0===e)})),i=n.shift();if(i.multi)throw new ao.Schema("Primary key cannot be multi-valued");n.forEach((function(t){if(t.auto)throw new ao.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new ao.Schema("Index must have a name and cannot be an empty string")})),e[r]=ua(r,i,n)}}))},t.prototype.stores=function(t){var e=this.db;this._cfg.storesSource=this._cfg.storesSource?ci(this._cfg.storesSource,t):t;var r=e._versions,n={},i={};return r.forEach((function(t){ci(n,t._cfg.storesSource),i=t._cfg.dbschema={},t._parseStoresSpec(n,i)})),e._dbSchema=i,_a(e,[e._allTables,e,e.Transaction.prototype]),ma(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],ui(i),i),e._storeNames=ui(i),this},t.prototype.upgrade=function(t){return this._cfg.contentUpgrade=t,this},t}();function Ra(t){return hs((function(){return Fo.letThrough=!0,t()}))}function Na(t){var e=t._state,r=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then((function(){return e.dbOpenError?Is(e.dbOpenError):t}));Yi&&(e.openCanceller._stackHolder=qi()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var n=e.dbReadyResolve,i=null;return zo.race([e.openCanceller,new zo((function(n,o){if(!r)throw new ao.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var s=t.name,a=e.autoSchema?r.open(s):r.open(s,Math.round(10*t.verno));if(!a)throw new ao.MissingAPI("IndexedDB API not available");a.onerror=na(o),a.onblocked=ns(t._fireOnBlocked),a.onupgradeneeded=ns((function(n){if(i=a.transaction,e.autoSchema&&!t._options.allowEmptyDB){a.onerror=ia,i.abort(),a.result.close();var u=r.deleteDatabase(s);u.onsuccess=u.onerror=ns((function(){o(new ao.NoSuchDatabase("Database "+s+" doesnt exist"))}))}else{i.onerror=na(o);var l=n.oldVersion>Math.pow(2,62)?0:n.oldVersion;t.idbdb=a.result,ya(t,l/10,i,o)}}),o),a.onsuccess=ns((function(){i=null;var r=t.idbdb=a.result,o=Ci(r.objectStoreNames);if(o.length>0)try{var u=r.transaction(ea(o),"readonly");e.autoSchema?function(t,e,r){t.verno=e.version/10;var n=t._dbSchema=ba(0,e,r);t._storeNames=Ci(e.objectStoreNames,0),ma(t,[t._allTables],ui(n),n)}(t,r,u):(Sa(t,t._dbSchema,u),function(t,e){var r=Ea(ba(0,t.idbdb,e),t._dbSchema);return!(r.add.length||r.change.some((function(t){return t.add.length||t.change.length})))}(t,u)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),pa(t,u)}catch(t){}Ts.push(t),r.onversionchange=ns((function(r){e.vcFired=!0,t.on("versionchange").fire(r)})),va.add(s),n()}),o)}))]).then((function(){return e.onReadyBeingFired=[],zo.resolve(Ra(t.on.ready.fire)).then((function t(){if(e.onReadyBeingFired.length>0){var r=e.onReadyBeingFired.reduce(Ao,ho);return e.onReadyBeingFired=[],zo.resolve(Ra(r)).then(t)}}))})).finally((function(){e.onReadyBeingFired=null})).then((function(){return e.isBeingOpened=!1,t})).catch((function(r){try{i&&i.abort()}catch(t){}return e.isBeingOpened=!1,t.close(),e.dbOpenError=r,Is(e.dbOpenError)})).finally((function(){e.openComplete=!0,n()}))}function Oa(t){var e=function(e){return t.next(e)},r=i(e),n=i((function(e){return t.throw(e)}));function i(t){return function(e){var i=t(e),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(r,n):li(o)?Promise.all(o).then(r,n):r(o)}}return i(e)()}function Da(t,e,r){var n=arguments.length;if(n<2)throw new ao.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var o=Mi(i);return[t,o,r]}function Ma(t,e,r,n,i){return zo.resolve().then((function(){var o=Fo.transless||Fo,s=t._createTransaction(e,r,t._dbSchema,n),a={trans:s,transless:o};n?s.idbtrans=n.idbtrans:s.create();var u,l=Wi(i);l&&cs();var h=zo.follow((function(){if(u=i.call(s,s))if(l){var t=ds.bind(null,null);u.then(t,t)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=Oa(u))}),a);return(u&&"function"==typeof u.then?zo.resolve(u).then((function(t){return s.active?t:Is(new ao.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):h.then((function(){return u}))).then((function(t){return n&&s._resolve(),s._completion.then((function(){return t}))})).catch((function(t){return s._reject(t),Is(t)}))}))}function Ba(t,e,r){for(var n=li(t)?t.slice():[t],i=0;i<r;++i)n.push(e);return n}var Pa={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return si(si({},t),{table:function(e){var r=t.table(e),n=r.schema,i={},o=[];function s(t,e,r){var n=fa(t),a=i[n]=i[n]||[],u=null==t?0:"string"==typeof t?1:t.length,l=e>0,h=si(si({},r),{isVirtual:l,isPrimaryKey:!l&&r.isPrimaryKey,keyTail:e,keyLength:u,extractKey:la(t),unique:!l&&r.unique});(a.push(h),h.isPrimaryKey||o.push(h),u>1)&&s(2===u?t[0]:t.slice(0,u-1),e+1,r);return a.sort((function(t,e){return t.keyTail-e.keyTail})),h}var a=s(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[a];for(var u=0,l=n.indexes;u<l.length;u++){var h=l[u];s(h.keyPath,0,h)}function c(e){var r,n,i=e.query.index;return i.isVirtual?si(si({},e),{query:{index:i,range:(r=e.query.range,n=i.keyTail,{type:1===r.type?2:r.type,lower:Ba(r.lower,r.lowerOpen?t.MAX_KEY:t.MIN_KEY,n),lowerOpen:!0,upper:Ba(r.upper,r.upperOpen?t.MIN_KEY:t.MAX_KEY,n),upperOpen:!0})}}):e}return si(si({},r),{schema:si(si({},n),{primaryKey:a,indexes:o,getIndexByKeyPath:function(t){var e=i[fa(t)];return e&&e[0]}}),count:function(t){return r.count(c(t))},query:function(t){return r.query(c(t))},openCursor:function(e){var n=e.query.index,i=n.keyTail,o=n.isVirtual,s=n.keyLength;if(!o)return r.openCursor(e);return r.openCursor(c(e)).then((function(r){return r&&function(r){return Object.create(r,{continue:{value:function(n){null!=n?r.continue(Ba(n,e.reverse?t.MAX_KEY:t.MIN_KEY,i)):e.unique?r.continue(Ba(r.key,e.reverse?t.MIN_KEY:t.MAX_KEY,i)):r.continue()}},continuePrimaryKey:{value:function(e,n){r.continuePrimaryKey(Ba(e,t.MAX_KEY,i),n)}},key:{get:function(){var t=r.key;return 1===s?t[0]:t.slice(0,s)}},value:{get:function(){return r.value}}})}(r)}))}})}})}},ka={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return si(si({},t),{table:function(e){var r=t.table(e),n=r.schema.primaryKey;return si(si({},r),{mutate:function(t){var i=Fo.trans,o=i.table(e).hook,s=o.deleting,a=o.creating,u=o.updating;switch(t.type){case"add":if(a.fire===ho)break;return i._promise("readwrite",(function(){return l(t)}),!0);case"put":if(a.fire===ho&&u.fire===ho)break;return i._promise("readwrite",(function(){return l(t)}),!0);case"delete":if(s.fire===ho)break;return i._promise("readwrite",(function(){return l(t)}),!0);case"deleteRange":if(s.fire===ho)break;return i._promise("readwrite",(function(){return function(t){return h(t.trans,t.range,1e4)}(t)}),!0)}return r.mutate(t);function l(t){var e=Fo.trans,i=t.keys||ha(n,t);if(!i)throw new Error("Keys missing");return"delete"!==(t="add"===t.type||"put"===t.type?si(si({},t),{keys:i,wantResults:!0}):si({},t)).type&&(t.values=ai(t.values)),t.keys&&(t.keys=ai(t.keys)),function(t,e,r){return"add"===e.type?Promise.resolve(new Array(e.values.length)):t.getMany({trans:e.trans,keys:r})}(r,t,i).then((function(o){var l=i.map((function(r,i){var l=o[i],h={onerror:null,onsuccess:null};if("delete"===t.type)s.fire.call(h,r,l,e);else if("add"===t.type||void 0===l){var c=a.fire.call(h,r,t.values[i],e);null==r&&null!=c&&(r=c,t.keys[i]=r,n.outbound||Ri(t.values[i],n.keyPath,r))}else{var d=Vi(l,t.values[i]),f=u.fire.call(h,d,r,l,e);if(f){var g=t.values[i];Object.keys(f).forEach((function(t){gi(g,t)?g[t]=f[t]:Ri(g,t,f[t])}))}}return h}));return r.mutate(t).then((function(e){for(var r=e.failures,n=e.results,s=e.numFailures,a=e.lastResult,u=0;u<i.length;++u){var h=n?n[u]:i[u],c=l[u];null==h?c.onerror&&c.onerror(r[u]):c.onsuccess&&c.onsuccess("put"===t.type&&o[u]?t.values[u]:h)}return{failures:r,results:n,numFailures:s,lastResult:a}})).catch((function(t){return l.forEach((function(e){return e.onerror&&e.onerror(t)})),Promise.reject(t)}))}))}function h(t,e,i){return r.query({trans:t,values:!1,query:{index:n,range:e},limit:i}).then((function(r){var n=r.result;return l({type:"delete",keys:n,trans:t}).then((function(r){return r.numFailures>0?Promise.reject(r.failures[0]):n.length<i?{failures:[],numFailures:0,lastResult:void 0}:h(t,si(si({},e),{lower:n[n.length-1],lowerOpen:!0}),i)}))}))}}})}})}},La=function(){function t(e,r){var n=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=r=si({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var o=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var s,a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ho,dbReadyPromise:null,cancelOpen:ho,openCanceller:null,autoSchema:!0};a.dbReadyPromise=new zo((function(t){a.dbReadyResolve=t})),a.openCanceller=new zo((function(t,e){a.cancelOpen=e})),this._state=a,this.name=e,this.on=Ls(this,"populate","blocked","versionchange",{ready:[Ao,ho]}),this.on.ready.subscribe=Ii(this.on.ready.subscribe,(function(e){return function(r,i){t.vip((function(){var t=n._state;if(t.openComplete)t.dbOpenError||zo.resolve().then(r),i&&e(r);else if(t.onReadyBeingFired)t.onReadyBeingFired.push(r),i&&e(r);else{e(r);var o=n;i||e((function t(){o.on.ready.unsubscribe(r),o.on.ready.unsubscribe(t)}))}}))}})),this.Collection=(s=this,xs(Ws.prototype,(function(t,e){this.db=s;var r=Bs,n=null;if(e)try{r=e()}catch(t){n=t}var i=t._ctx,o=i.table,a=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:i.or,valueMapper:a!==co?a:null}}))),this.Table=function(t){return xs(ks.prototype,(function(e,r,n){this.db=t,this._tx=n,this.name=e,this.schema=r,this.hook=t._allTables[e]?t._allTables[e].hook:Ls(null,{creating:[wo,ho],reading:[fo,co],updating:[mo,ho],deleting:[po,ho]})}))}(this),this.Transaction=function(t){return xs(oa.prototype,(function(e,r,n,i){var o=this;this.db=t,this.mode=e,this.storeNames=r,this.schema=n,this.idbtrans=null,this.on=Ls(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new zo((function(t,e){o._resolve=t,o._reject=e})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(t){var e=o.active;return o.active=!1,o.on.error.fire(t),o.parent?o.parent._reject(t):e&&o.idbtrans&&o.idbtrans.abort(),Is(t)}))}))}(this),this.Version=function(t){return xs(Ta.prototype,(function(e){this.db=t,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(t){return xs(ta.prototype,(function(e,r,n){this.db=t,this._ctx={table:e,index:":id"===r?null:r,or:n};var i=t._deps.indexedDB;if(!i)throw new ao.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(t,e){return i.cmp(e,t)},this._max=function(t,e){return i.cmp(t,e)>0?t:e},this._min=function(t,e){return i.cmp(t,e)<0?t:e},this._IDBKeyRange=t._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(t){t.newVersion>0?console.warn("Another connection wants to upgrade database '"+n.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+n.name+"'. Closing db now to resume the delete request."),n.close()})),this.on("blocked",(function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+n.name+"') was blocked"):console.warn("Upgrade '"+n.name+"' blocked by other connection holding version "+t.oldVersion/10)})),this._maxKey=ra(r.IDBKeyRange),this._createTransaction=function(t,e,r,i){return new n.Transaction(t,e,r,i)},this._fireOnBlocked=function(t){n.on("blocked").fire(t),Ts.filter((function(t){return t.name===n.name&&t!==n&&!t._state.vcFired})).map((function(e){return e.on("versionchange").fire(t)}))},this.use(Pa),this.use(ka),o.forEach((function(t){return t(n)}))}return t.prototype.version=function(t){if(isNaN(t)||t<.1)throw new ao.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new ao.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=this._versions,r=e.filter((function(e){return e._cfg.version===t}))[0];return r||(r=new this.Version(t),e.push(r),e.sort(Aa),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(t){var e=this;return this._state.openComplete||Fo.letThrough?t():new zo((function(t,r){if(!e._state.isBeingOpened){if(!e._options.autoOpen)return void r(new ao.DatabaseClosed);e.open().catch(ho)}e._state.dbReadyPromise.then(t,r)})).then(t)},t.prototype.use=function(t){var e=t.stack,r=t.create,n=t.level,i=t.name;i&&this.unuse({stack:e,name:i});var o=this._middlewares[e]||(this._middlewares[e]=[]);return o.push({stack:e,create:r,level:null==n?10:n,name:i}),o.sort((function(t,e){return t.level-e.level})),this},t.prototype.unuse=function(t){var e=t.stack,r=t.name,n=t.create;return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((function(t){return n?t.create!==n:!!r&&t.name!==r}))),this},t.prototype.open=function(){return Na(this)},t.prototype.close=function(){var t=Ts.indexOf(this),e=this._state;if(t>=0&&Ts.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(t){}this.idbdb=null}this._options.autoOpen=!1,e.dbOpenError=new ao.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError),e.dbReadyPromise=new zo((function(t){e.dbReadyResolve=t})),e.openCanceller=new zo((function(t,r){e.cancelOpen=r}))},t.prototype.delete=function(){var t=this,e=arguments.length>0,r=this._state;return new zo((function(n,i){var o=function(){t.close();var e=t._deps.indexedDB.deleteDatabase(t.name);e.onsuccess=ns((function(){va.remove(t.name),n()})),e.onerror=na(i),e.onblocked=t._fireOnBlocked};if(e)throw new ao.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()}))},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return null!==this.idbdb},t.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&"DatabaseClosed"===t.name},t.prototype.hasFailed=function(){return null!==this._state.dbOpenError},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var t=this;return ui(this._allTables).map((function(e){return t._allTables[e]}))},enumerable:!0,configurable:!0}),t.prototype.transaction=function(){var t=Da.apply(this,arguments);return this._transaction.apply(this,t)},t.prototype._transaction=function(t,e,r){var n=this,i=Fo.trans;i&&i.db===this&&-1===t.indexOf("!")||(i=null);var o,s,a=-1!==t.indexOf("?");t=t.replace("!","").replace("?","");try{if(s=e.map((function(t){var e=t instanceof n.Table?t.name:t;if("string"!=typeof e)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e})),"r"==t||"readonly"===t)o="readonly";else{if("rw"!=t&&"readwrite"!=t)throw new ao.InvalidArgument("Invalid transaction mode: "+t);o="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===o){if(!a)throw new ao.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&s.forEach((function(t){if(i&&-1===i.storeNames.indexOf(t)){if(!a)throw new ao.SubTransaction("Table "+t+" not included in parent transaction.");i=null}})),a&&i&&!i.active&&(i=null)}}catch(t){return i?i._promise(null,(function(e,r){r(t)})):Is(t)}var u=Ma.bind(null,this,o,s,i,r);return i?i._promise(o,u,"lock"):Fo.trans?_s(Fo.transless,(function(){return n._whenReady(u)})):this._whenReady(u)},t.prototype.table=function(t){if(!gi(this._allTables,t))throw new ao.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},t}(),xa=La;wi(xa,si(si({},lo),{delete:function(t){return new xa(t).delete()},exists:function(t){return new xa(t,{addons:[]}).open().then((function(t){return t.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(t){return va?va.getDatabaseNames().then(t):zo.resolve([])},defineClass:function(){return function(t){ci(this,t)}},ignoreTransaction:function(t){return Fo.trans?_s(Fo.transless,t):t()},vip:Ra,async:function(t){return function(){try{var e=Oa(t.apply(this,arguments));return e&&"function"==typeof e.then?e:zo.resolve(e)}catch(t){return Is(t)}}},spawn:function(t,e,r){try{var n=Oa(t.apply(r,e||[]));return n&&"function"==typeof n.then?n:zo.resolve(n)}catch(t){return Is(t)}},currentTransaction:{get:function(){return Fo.trans||null}},waitFor:function(t,e){var r=zo.resolve("function"==typeof t?xa.ignoreTransaction(t):t).timeout(e||6e4);return Fo.trans?Fo.trans.waitFor(r):r},Promise:zo,debug:{get:function(){return Yi},set:function(t){Ki(t,"dexie"===t?function(){return!0}:Ds)}},derive:_i,extend:ci,props:wi,override:Ii,Events:Ls,getByKeyPath:Ti,setByKeyPath:Ri,delByKeyPath:Ni,shallowClone:Oi,deepClone:Li,getObjectDiff:Vi,asap:Si,minKey:-(1/0),addons:[],connections:Ts,errnames:oo,dependencies:function(){try{return{indexedDB:hi.indexedDB||hi.mozIndexedDB||hi.webkitIndexedDB||hi.msIndexedDB,IDBKeyRange:hi.IDBKeyRange||hi.webkitIDBKeyRange}}catch(t){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.3",version:"3.0.3".split(".").map((function(t){return parseInt(t)})).reduce((function(t,e,r){return t+e/Math.pow(10,2*r)})),default:xa,Dexie:xa})),xa.maxKey=ra(xa.dependencies.IDBKeyRange),function(t){try{va=function(t){var e,r=t&&"function"==typeof t.databases;if(!r){var n=new La("__dbnames",{addons:[]});n.version(1).stores({dbnames:"name"}),e=n.table("dbnames")}return{getDatabaseNames:function(){return r?zo.resolve(t.databases()).then((function(t){return t.map((function(t){return t.name})).filter((function(t){return"__dbnames"!==t}))})):e.toCollection().primaryKeys()},add:function(t){return!r&&"__dbnames"!==t&&e.put({name:t}).catch(ho)},remove:function(t){return!r&&"__dbnames"!==t&&e.delete(t).catch(ho)}}}(t)}catch(t){}}(La.dependencies.indexedDB),zo.rejectionMapper=function(t,e){if(!t||t instanceof eo||t instanceof TypeError||t instanceof SyntaxError||!t.name||!uo[t.name])return t;var r=new uo[t.name](e||t.message,t);return"stack"in t&&mi(r,"stack",{get:function(){return this.inner.stack}}),r},Ki(Yi,Ds);export{La as Dexie,kn as QRCode,xn as ZXing,oi as oom,We as pako};