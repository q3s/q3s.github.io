var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e,r){return t(r={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&r.path)}},r.exports),r.exports}var r=e((function(t,e){var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var r=e.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(t[i]=r[i])}}return t},e.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var i={arraySet:function(t,e,r,n,i){if(e.subarray&&t.subarray)t.set(e.subarray(r,r+n),i);else for(var o=0;o<n;o++)t[i+o]=e[r+o]},flattenChunks:function(t){var e,r,n,i,o,s;for(n=0,e=0,r=t.length;e<r;e++)n+=t[e].length;for(s=new Uint8Array(n),i=0,e=0,r=t.length;e<r;e++)o=t[e],s.set(o,i),i+=o.length;return s}},o={arraySet:function(t,e,r,n,i){for(var o=0;o<n;o++)t[i+o]=e[r+o]},flattenChunks:function(t){return[].concat.apply([],t)}};e.setTyped=function(t){t?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,i)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,o))},e.setTyped(r)}));function n(t){for(var e=t.length;--e>=0;)t[e]=0}var i=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],o=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],a=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);n(u);var l=new Array(60);n(l);var h=new Array(512);n(h);var c=new Array(256);n(c);var d=new Array(29);n(d);var f,g,w,p=new Array(30);function _(t,e,r,n,i){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=t&&t.length}function m(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function E(t){return t<256?h[t]:h[256+(t>>>7)]}function A(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function y(t,e,r){t.bi_valid>16-r?(t.bi_buf|=e<<t.bi_valid&65535,A(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=r-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)}function C(t,e,r){y(t,r[2*e],r[2*e+1])}function b(t,e){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1}function I(t,e,r){var n,i,o=new Array(16),s=0;for(n=1;n<=15;n++)o[n]=s=s+r[n-1]<<1;for(i=0;i<=e;i++){var a=t[2*i+1];0!==a&&(t[2*i]=b(o[a]++,a))}}function v(t){var e;for(e=0;e<286;e++)t.dyn_ltree[2*e]=0;for(e=0;e<30;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function S(t){t.bi_valid>8?A(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function T(t,e,r,n){var i=2*e,o=2*r;return t[i]<t[o]||t[i]===t[o]&&n[e]<=n[r]}function R(t,e,r){for(var n=t.heap[r],i=r<<1;i<=t.heap_len&&(i<t.heap_len&&T(e,t.heap[i+1],t.heap[i],t.depth)&&i++,!T(e,n,t.heap[i],t.depth));)t.heap[r]=t.heap[i],r=i,i<<=1;t.heap[r]=n}function N(t,e,r){var n,s,a,u,l=0;if(0!==t.last_lit)do{n=t.pending_buf[t.d_buf+2*l]<<8|t.pending_buf[t.d_buf+2*l+1],s=t.pending_buf[t.l_buf+l],l++,0===n?C(t,s,e):(C(t,(a=c[s])+256+1,e),0!==(u=i[a])&&y(t,s-=d[a],u),C(t,a=E(--n),r),0!==(u=o[a])&&y(t,n-=p[a],u))}while(l<t.last_lit);C(t,256,e)}function O(t,e){var r,n,i,o=e.dyn_tree,s=e.stat_desc.static_tree,a=e.stat_desc.has_stree,u=e.stat_desc.elems,l=-1;for(t.heap_len=0,t.heap_max=573,r=0;r<u;r++)0!==o[2*r]?(t.heap[++t.heap_len]=l=r,t.depth[r]=0):o[2*r+1]=0;for(;t.heap_len<2;)o[2*(i=t.heap[++t.heap_len]=l<2?++l:0)]=1,t.depth[i]=0,t.opt_len--,a&&(t.static_len-=s[2*i+1]);for(e.max_code=l,r=t.heap_len>>1;r>=1;r--)R(t,o,r);i=u;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],R(t,o,1),n=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=n,o[2*i]=o[2*r]+o[2*n],t.depth[i]=(t.depth[r]>=t.depth[n]?t.depth[r]:t.depth[n])+1,o[2*r+1]=o[2*n+1]=i,t.heap[1]=i++,R(t,o,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,e){var r,n,i,o,s,a,u=e.dyn_tree,l=e.max_code,h=e.stat_desc.static_tree,c=e.stat_desc.has_stree,d=e.stat_desc.extra_bits,f=e.stat_desc.extra_base,g=e.stat_desc.max_length,w=0;for(o=0;o<=15;o++)t.bl_count[o]=0;for(u[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<573;r++)(o=u[2*u[2*(n=t.heap[r])+1]+1]+1)>g&&(o=g,w++),u[2*n+1]=o,n>l||(t.bl_count[o]++,s=0,n>=f&&(s=d[n-f]),a=u[2*n],t.opt_len+=a*(o+s),c&&(t.static_len+=a*(h[2*n+1]+s)));if(0!==w){do{for(o=g-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[g]--,w-=2}while(w>0);for(o=g;0!==o;o--)for(n=t.bl_count[o];0!==n;)(i=t.heap[--r])>l||(u[2*i+1]!==o&&(t.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),n--)}}(t,e),I(o,l,t.bl_count)}function D(t,e,r){var n,i,o=-1,s=e[1],a=0,u=7,l=4;for(0===s&&(u=138,l=3),e[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=e[2*(n+1)+1],++a<u&&i===s||(a<l?t.bl_tree[2*i]+=a:0!==i?(i!==o&&t.bl_tree[2*i]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,o=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4))}function B(t,e,r){var n,i,o=-1,s=e[1],a=0,u=7,l=4;for(0===s&&(u=138,l=3),n=0;n<=r;n++)if(i=s,s=e[2*(n+1)+1],!(++a<u&&i===s)){if(a<l)do{C(t,i,t.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(C(t,i,t.bl_tree),a--),C(t,16,t.bl_tree),y(t,a-3,2)):a<=10?(C(t,17,t.bl_tree),y(t,a-3,3)):(C(t,18,t.bl_tree),y(t,a-11,7));a=0,o=i,0===s?(u=138,l=3):i===s?(u=6,l=3):(u=7,l=4)}}n(p);var M=!1;function P(t,e,n,i){y(t,0+(i?1:0),3),function(t,e,n,i){S(t),i&&(A(t,n),A(t,~n)),r.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n,!0)}var k={_tr_init:function(t){M||(!function(){var t,e,r,n,a,m=new Array(16);for(r=0,n=0;n<28;n++)for(d[n]=r,t=0;t<1<<i[n];t++)c[r++]=n;for(c[r-1]=n,a=0,n=0;n<16;n++)for(p[n]=a,t=0;t<1<<o[n];t++)h[a++]=n;for(a>>=7;n<30;n++)for(p[n]=a<<7,t=0;t<1<<o[n]-7;t++)h[256+a++]=n;for(e=0;e<=15;e++)m[e]=0;for(t=0;t<=143;)u[2*t+1]=8,t++,m[8]++;for(;t<=255;)u[2*t+1]=9,t++,m[9]++;for(;t<=279;)u[2*t+1]=7,t++,m[7]++;for(;t<=287;)u[2*t+1]=8,t++,m[8]++;for(I(u,287,m),t=0;t<30;t++)l[2*t+1]=5,l[2*t]=b(t,5);f=new _(u,i,257,286,15),g=new _(l,o,0,30,15),w=new _(new Array(0),s,0,19,7)}(),M=!0),t.l_desc=new m(t.dyn_ltree,f),t.d_desc=new m(t.dyn_dtree,g),t.bl_desc=new m(t.bl_tree,w),t.bi_buf=0,t.bi_valid=0,v(t)},_tr_stored_block:P,_tr_flush_block:function(t,e,r,n){var i,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),O(t,t.l_desc),O(t,t.d_desc),s=function(t){var e;for(D(t,t.dyn_ltree,t.l_desc.max_code),D(t,t.dyn_dtree,t.d_desc.max_code),O(t,t.bl_desc),e=18;e>=3&&0===t.bl_tree[2*a[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),i=t.opt_len+3+7>>>3,(o=t.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==e?P(t,e,r,n):4===t.strategy||o===i?(y(t,2+(n?1:0),3),N(t,u,l)):(y(t,4+(n?1:0),3),function(t,e,r,n){var i;for(y(t,e-257,5),y(t,r-1,5),y(t,n-4,4),i=0;i<n;i++)y(t,t.bl_tree[2*a[i]+1],3);B(t,t.dyn_ltree,e-1),B(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),N(t,t.dyn_ltree,t.dyn_dtree)),v(t),n&&S(t)},_tr_tally:function(t,e,r){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(c[r]+256+1)]++,t.dyn_dtree[2*E(e)]++),t.last_lit===t.lit_bufsize-1},_tr_align:function(t){y(t,2,3),C(t,256,u),function(t){16===t.bi_valid?(A(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}};var L=function(t,e,r,n){for(var i=65535&t|0,o=t>>>16&65535|0,s=0;0!==r;){r-=s=r>2e3?2e3:r;do{o=o+(i=i+e[n++]|0)|0}while(--s);i%=65521,o%=65521}return i|o<<16|0};var x=function(){for(var t,e=[],r=0;r<256;r++){t=r;for(var n=0;n<8;n++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e}();var F,U=function(t,e,r,n){var i=x,o=n+r;t^=-1;for(var s=n;s<o;s++)t=t>>>8^i[255&(t^e[s])];return-1^t},V={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function H(t,e){return t.msg=V[e],e}function z(t){return(t<<1)-(t>4?9:0)}function G(t){for(var e=t.length;--e>=0;)t[e]=0}function X(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(r.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function W(t,e){k._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,X(t.strm)}function Y(t,e){t.pending_buf[t.pending++]=e}function K(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function Z(t,e,n,i){var o=t.avail_in;return o>i&&(o=i),0===o?0:(t.avail_in-=o,r.arraySet(e,t.input,t.next_in,o,n),1===t.state.wrap?t.adler=L(t.adler,e,o,n):2===t.state.wrap&&(t.adler=U(t.adler,e,o,n)),t.next_in+=o,t.total_in+=o,o)}function j(t,e){var r,n,i=t.max_chain_length,o=t.strstart,s=t.prev_length,a=t.nice_match,u=t.strstart>t.w_size-262?t.strstart-(t.w_size-262):0,l=t.window,h=t.w_mask,c=t.prev,d=t.strstart+258,f=l[o+s-1],g=l[o+s];t.prev_length>=t.good_match&&(i>>=2),a>t.lookahead&&(a=t.lookahead);do{if(l[(r=e)+s]===g&&l[r+s-1]===f&&l[r]===l[o]&&l[++r]===l[o+1]){o+=2,r++;do{}while(l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&l[++o]===l[++r]&&o<d);if(n=258-(d-o),o=d-258,n>s){if(t.match_start=e,s=n,n>=a)break;f=l[o+s-1],g=l[o+s]}}}while((e=c[e&h])>u&&0!=--i);return s<=t.lookahead?s:t.lookahead}function q(t){var e,n,i,o,s,a=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=a+(a-262)){r.arraySet(t.window,t.window,a,a,0),t.match_start-=a,t.strstart-=a,t.block_start-=a,e=n=t.hash_size;do{i=t.head[--e],t.head[e]=i>=a?i-a:0}while(--n);e=n=a;do{i=t.prev[--e],t.prev[e]=i>=a?i-a:0}while(--n);o+=a}if(0===t.strm.avail_in)break;if(n=Z(t.strm,t.window,t.strstart+t.lookahead,o),t.lookahead+=n,t.lookahead+t.insert>=3)for(s=t.strstart-t.insert,t.ins_h=t.window[s],t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[s+3-1])&t.hash_mask,t.prev[s&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=s,s++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<262&&0!==t.strm.avail_in)}function Q(t,e){for(var r,n;;){if(t.lookahead<262){if(q(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-262&&(t.match_length=j(t,r)),t.match_length>=3)if(n=k._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else n=k._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(n&&(W(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(W(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(W(t,!1),0===t.strm.avail_out)?1:2}function J(t,e){for(var r,n,i;;){if(t.lookahead<262){if(q(t),t.lookahead<262&&0===e)return 1;if(0===t.lookahead)break}if(r=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-262&&(t.match_length=j(t,r),t.match_length<=5&&(1===t.strategy||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){i=t.strstart+t.lookahead-3,n=k._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=i&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,n&&(W(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((n=k._tr_tally(t,0,t.window[t.strstart-1]))&&W(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(n=k._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(W(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(W(t,!1),0===t.strm.avail_out)?1:2}function $(t,e,r,n,i){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=n,this.func=i}function tt(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(1146),this.dyn_dtree=new r.Buf16(122),this.bl_tree=new r.Buf16(78),G(this.dyn_ltree),G(this.dyn_dtree),G(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(16),this.heap=new r.Buf16(573),G(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(573),G(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function et(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:113,t.adler=2===e.wrap?0:1,e.last_flush=0,k._tr_init(e),0):H(t,-2)}function rt(t){var e,r=et(t);return 0===r&&((e=t.state).window_size=2*e.w_size,G(e.head),e.max_lazy_match=F[e.level].max_lazy,e.good_match=F[e.level].good_length,e.nice_match=F[e.level].nice_length,e.max_chain_length=F[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0),r}function nt(t,e,n,i,o,s){if(!t)return-2;var a=1;if(-1===e&&(e=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),o<1||o>9||8!==n||i<8||i>15||e<0||e>9||s<0||s>4)return H(t,-2);8===i&&(i=9);var u=new tt;return t.state=u,u.strm=t,u.wrap=a,u.gzhead=null,u.w_bits=i,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+3-1)/3),u.window=new r.Buf8(2*u.w_size),u.head=new r.Buf16(u.hash_size),u.prev=new r.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new r.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=e,u.strategy=s,u.method=n,rt(t)}F=[new $(0,0,0,0,(function(t,e){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(q(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var n=t.block_start+r;if((0===t.strstart||t.strstart>=n)&&(t.lookahead=t.strstart-n,t.strstart=n,W(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-262&&(W(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(W(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(W(t,!1),t.strm.avail_out),1)})),new $(4,4,8,4,Q),new $(4,5,16,8,Q),new $(4,6,32,32,Q),new $(4,4,16,16,J),new $(8,16,32,32,J),new $(8,16,128,128,J),new $(8,32,128,256,J),new $(32,128,258,1024,J),new $(32,258,258,4096,J)];var it={deflateInit:function(t,e){return nt(t,e,8,15,8,0)},deflateInit2:nt,deflateReset:rt,deflateResetKeep:et,deflateSetHeader:function(t,e){return t&&t.state?2!==t.state.wrap?-2:(t.state.gzhead=e,0):-2},deflate:function(t,e){var r,n,i,o;if(!t||!t.state||e>5||e<0)return t?H(t,-2):-2;if(n=t.state,!t.output||!t.input&&0!==t.avail_in||666===n.status&&4!==e)return H(t,0===t.avail_out?-5:-2);if(n.strm=t,r=n.last_flush,n.last_flush=e,42===n.status)if(2===n.wrap)t.adler=0,Y(n,31),Y(n,139),Y(n,8),n.gzhead?(Y(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),Y(n,255&n.gzhead.time),Y(n,n.gzhead.time>>8&255),Y(n,n.gzhead.time>>16&255),Y(n,n.gzhead.time>>24&255),Y(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),Y(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(Y(n,255&n.gzhead.extra.length),Y(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(t.adler=U(t.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(Y(n,0),Y(n,0),Y(n,0),Y(n,0),Y(n,0),Y(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),Y(n,3),n.status=113);else{var s=8+(n.w_bits-8<<4)<<8;s|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(s|=32),s+=31-s%31,n.status=113,K(n,s),0!==n.strstart&&(K(n,t.adler>>>16),K(n,65535&t.adler)),t.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(t.adler=U(t.adler,n.pending_buf,n.pending-i,i)),X(t),i=n.pending,n.pending!==n.pending_buf_size));)Y(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(t.adler=U(t.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=U(t.adler,n.pending_buf,n.pending-i,i)),X(t),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,Y(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(t.adler=U(t.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(t.adler=U(t.adler,n.pending_buf,n.pending-i,i)),X(t),i=n.pending,n.pending===n.pending_buf_size)){o=1;break}o=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,Y(n,o)}while(0!==o);n.gzhead.hcrc&&n.pending>i&&(t.adler=U(t.adler,n.pending_buf,n.pending-i,i)),0===o&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&X(t),n.pending+2<=n.pending_buf_size&&(Y(n,255&t.adler),Y(n,t.adler>>8&255),t.adler=0,n.status=113)):n.status=113),0!==n.pending){if(X(t),0===t.avail_out)return n.last_flush=-1,0}else if(0===t.avail_in&&z(e)<=z(r)&&4!==e)return H(t,-5);if(666===n.status&&0!==t.avail_in)return H(t,-5);if(0!==t.avail_in||0!==n.lookahead||0!==e&&666!==n.status){var a=2===n.strategy?function(t,e){for(var r;;){if(0===t.lookahead&&(q(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,r=k._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(W(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(W(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(W(t,!1),0===t.strm.avail_out)?1:2}(n,e):3===n.strategy?function(t,e){for(var r,n,i,o,s=t.window;;){if(t.lookahead<=258){if(q(t),t.lookahead<=258&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(n=s[i=t.strstart-1])===s[++i]&&n===s[++i]&&n===s[++i]){o=t.strstart+258;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);t.match_length=258-(o-i),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(r=k._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=k._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(W(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(W(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(W(t,!1),0===t.strm.avail_out)?1:2}(n,e):F[n.level].func(n,e);if(3!==a&&4!==a||(n.status=666),1===a||3===a)return 0===t.avail_out&&(n.last_flush=-1),0;if(2===a&&(1===e?k._tr_align(n):5!==e&&(k._tr_stored_block(n,0,0,!1),3===e&&(G(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),X(t),0===t.avail_out))return n.last_flush=-1,0}return 4!==e?0:n.wrap<=0?1:(2===n.wrap?(Y(n,255&t.adler),Y(n,t.adler>>8&255),Y(n,t.adler>>16&255),Y(n,t.adler>>24&255),Y(n,255&t.total_in),Y(n,t.total_in>>8&255),Y(n,t.total_in>>16&255),Y(n,t.total_in>>24&255)):(K(n,t.adler>>>16),K(n,65535&t.adler)),X(t),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)},deflateEnd:function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&113!==e&&666!==e?H(t,-2):(t.state=null,113===e?H(t,-3):0):-2},deflateSetDictionary:function(t,e){var n,i,o,s,a,u,l,h,c=e.length;if(!t||!t.state)return-2;if(2===(s=(n=t.state).wrap)||1===s&&42!==n.status||n.lookahead)return-2;for(1===s&&(t.adler=L(t.adler,e,c,0)),n.wrap=0,c>=n.w_size&&(0===s&&(G(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new r.Buf8(n.w_size),r.arraySet(h,e,c-n.w_size,n.w_size,0),e=h,c=n.w_size),a=t.avail_in,u=t.next_in,l=t.input,t.avail_in=c,t.next_in=0,t.input=e,q(n);n.lookahead>=3;){i=n.strstart,o=n.lookahead-2;do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--o);n.strstart=i,n.lookahead=2,q(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=u,t.input=l,t.avail_in=a,n.wrap=s,0},deflateInfo:"pako deflate (from Nodeca project)"},ot=!0,st=!0;try{String.fromCharCode.apply(null,[0])}catch(t){ot=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){st=!1}for(var at=new r.Buf8(256),ut=0;ut<256;ut++)at[ut]=ut>=252?6:ut>=248?5:ut>=240?4:ut>=224?3:ut>=192?2:1;at[254]=at[254]=1;function lt(t,e){if(e<65534&&(t.subarray&&st||!t.subarray&&ot))return String.fromCharCode.apply(null,r.shrinkBuf(t,e));for(var n="",i=0;i<e;i++)n+=String.fromCharCode(t[i]);return n}var ht=function(t){var e,n,i,o,s,a=t.length,u=0;for(o=0;o<a;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),u+=n<128?1:n<2048?2:n<65536?3:4;for(e=new r.Buf8(u),s=0,o=0;s<u;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<a&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?e[s++]=n:n<2048?(e[s++]=192|n>>>6,e[s++]=128|63&n):n<65536?(e[s++]=224|n>>>12,e[s++]=128|n>>>6&63,e[s++]=128|63&n):(e[s++]=240|n>>>18,e[s++]=128|n>>>12&63,e[s++]=128|n>>>6&63,e[s++]=128|63&n);return e},ct=function(t){return lt(t,t.length)},dt=function(t){for(var e=new r.Buf8(t.length),n=0,i=e.length;n<i;n++)e[n]=t.charCodeAt(n);return e},ft=function(t,e){var r,n,i,o,s=e||t.length,a=new Array(2*s);for(n=0,r=0;r<s;)if((i=t[r++])<128)a[n++]=i;else if((o=at[i])>4)a[n++]=65533,r+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&r<s;)i=i<<6|63&t[r++],o--;o>1?a[n++]=65533:i<65536?a[n++]=i:(i-=65536,a[n++]=55296|i>>10&1023,a[n++]=56320|1023&i)}return lt(a,n)},gt=function(t,e){var r;for((e=e||t.length)>t.length&&(e=t.length),r=e-1;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?e:r+at[t[r]]>e?r:e};var wt=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},pt=Object.prototype.toString;function _t(t){if(!(this instanceof _t))return new _t(t);this.options=r.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wt,this.strm.avail_out=0;var n=it.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(V[n]);if(e.header&&it.deflateSetHeader(this.strm,e.header),e.dictionary){var i;if(i="string"==typeof e.dictionary?ht(e.dictionary):"[object ArrayBuffer]"===pt.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=it.deflateSetDictionary(this.strm,i)))throw new Error(V[n]);this._dict_set=!0}}function mt(t,e){var r=new _t(e);if(r.push(t,!0),r.err)throw r.msg||V[r.err];return r.result}_t.prototype.push=function(t,e){var n,i,o=this.strm,s=this.options.chunkSize;if(this.ended)return!1;i=e===~~e?e:!0===e?4:0,"string"==typeof t?o.input=ht(t):"[object ArrayBuffer]"===pt.call(t)?o.input=new Uint8Array(t):o.input=t,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new r.Buf8(s),o.next_out=0,o.avail_out=s),1!==(n=it.deflate(o,i))&&0!==n)return this.onEnd(n),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(ct(r.shrinkBuf(o.output,o.next_out))):this.onData(r.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==n);return 4===i?(n=it.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==i||(this.onEnd(0),o.avail_out=0,!0)},_t.prototype.onData=function(t){this.chunks.push(t)},_t.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Et={Deflate:_t,deflate:mt,deflateRaw:function(t,e){return(e=e||{}).raw=!0,mt(t,e)},gzip:function(t,e){return(e=e||{}).gzip=!0,mt(t,e)}},At=function(t,e){var r,n,i,o,s,a,u,l,h,c,d,f,g,w,p,_,m,E,A,y,C,b,I,v,S;r=t.state,n=t.next_in,v=t.input,i=n+(t.avail_in-5),o=t.next_out,S=t.output,s=o-(e-t.avail_out),a=o+(t.avail_out-257),u=r.dmax,l=r.wsize,h=r.whave,c=r.wnext,d=r.window,f=r.hold,g=r.bits,w=r.lencode,p=r.distcode,_=(1<<r.lenbits)-1,m=(1<<r.distbits)-1;t:do{g<15&&(f+=v[n++]<<g,g+=8,f+=v[n++]<<g,g+=8),E=w[f&_];e:for(;;){if(f>>>=A=E>>>24,g-=A,0===(A=E>>>16&255))S[o++]=65535&E;else{if(!(16&A)){if(0==(64&A)){E=w[(65535&E)+(f&(1<<A)-1)];continue e}if(32&A){r.mode=12;break t}t.msg="invalid literal/length code",r.mode=30;break t}y=65535&E,(A&=15)&&(g<A&&(f+=v[n++]<<g,g+=8),y+=f&(1<<A)-1,f>>>=A,g-=A),g<15&&(f+=v[n++]<<g,g+=8,f+=v[n++]<<g,g+=8),E=p[f&m];r:for(;;){if(f>>>=A=E>>>24,g-=A,!(16&(A=E>>>16&255))){if(0==(64&A)){E=p[(65535&E)+(f&(1<<A)-1)];continue r}t.msg="invalid distance code",r.mode=30;break t}if(C=65535&E,g<(A&=15)&&(f+=v[n++]<<g,(g+=8)<A&&(f+=v[n++]<<g,g+=8)),(C+=f&(1<<A)-1)>u){t.msg="invalid distance too far back",r.mode=30;break t}if(f>>>=A,g-=A,C>(A=o-s)){if((A=C-A)>h&&r.sane){t.msg="invalid distance too far back",r.mode=30;break t}if(b=0,I=d,0===c){if(b+=l-A,A<y){y-=A;do{S[o++]=d[b++]}while(--A);b=o-C,I=S}}else if(c<A){if(b+=l+c-A,(A-=c)<y){y-=A;do{S[o++]=d[b++]}while(--A);if(b=0,c<y){y-=A=c;do{S[o++]=d[b++]}while(--A);b=o-C,I=S}}}else if(b+=c-A,A<y){y-=A;do{S[o++]=d[b++]}while(--A);b=o-C,I=S}for(;y>2;)S[o++]=I[b++],S[o++]=I[b++],S[o++]=I[b++],y-=3;y&&(S[o++]=I[b++],y>1&&(S[o++]=I[b++]))}else{b=o-C;do{S[o++]=S[b++],S[o++]=S[b++],S[o++]=S[b++],y-=3}while(y>2);y&&(S[o++]=S[b++],y>1&&(S[o++]=S[b++]))}break}}break}}while(n<i&&o<a);n-=y=g>>3,f&=(1<<(g-=y<<3))-1,t.next_in=n,t.next_out=o,t.avail_in=n<i?i-n+5:5-(n-i),t.avail_out=o<a?a-o+257:257-(o-a),r.hold=f,r.bits=g},yt=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Ct=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],bt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],It=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],vt=function(t,e,n,i,o,s,a,u){var l,h,c,d,f,g,w,p,_,m=u.bits,E=0,A=0,y=0,C=0,b=0,I=0,v=0,S=0,T=0,R=0,N=null,O=0,D=new r.Buf16(16),B=new r.Buf16(16),M=null,P=0;for(E=0;E<=15;E++)D[E]=0;for(A=0;A<i;A++)D[e[n+A]]++;for(b=m,C=15;C>=1&&0===D[C];C--);if(b>C&&(b=C),0===C)return o[s++]=20971520,o[s++]=20971520,u.bits=1,0;for(y=1;y<C&&0===D[y];y++);for(b<y&&(b=y),S=1,E=1;E<=15;E++)if(S<<=1,(S-=D[E])<0)return-1;if(S>0&&(0===t||1!==C))return-1;for(B[1]=0,E=1;E<15;E++)B[E+1]=B[E]+D[E];for(A=0;A<i;A++)0!==e[n+A]&&(a[B[e[n+A]]++]=A);if(0===t?(N=M=a,g=19):1===t?(N=yt,O-=257,M=Ct,P-=257,g=256):(N=bt,M=It,g=-1),R=0,A=0,E=y,f=s,I=b,v=0,c=-1,d=(T=1<<b)-1,1===t&&T>852||2===t&&T>592)return 1;for(;;){w=E-v,a[A]<g?(p=0,_=a[A]):a[A]>g?(p=M[P+a[A]],_=N[O+a[A]]):(p=96,_=0),l=1<<E-v,y=h=1<<I;do{o[f+(R>>v)+(h-=l)]=w<<24|p<<16|_|0}while(0!==h);for(l=1<<E-1;R&l;)l>>=1;if(0!==l?(R&=l-1,R+=l):R=0,A++,0==--D[E]){if(E===C)break;E=e[n+a[A]]}if(E>b&&(R&d)!==c){for(0===v&&(v=b),f+=y,S=1<<(I=E-v);I+v<C&&!((S-=D[I+v])<=0);)I++,S<<=1;if(T+=1<<I,1===t&&T>852||2===t&&T>592)return 1;o[c=R&d]=b<<24|I<<16|f-s|0}}return 0!==R&&(o[f+R]=E-v<<24|64<<16|0),u.bits=b,0};function St(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function Tt(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Rt(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new r.Buf32(852),e.distcode=e.distdyn=new r.Buf32(592),e.sane=1,e.back=-1,0):-2}function Nt(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,Rt(t)):-2}function Ot(t,e){var r,n;return t&&t.state?(n=t.state,e<0?(r=0,e=-e):(r=1+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?-2:(null!==n.window&&n.wbits!==e&&(n.window=null),n.wrap=r,n.wbits=e,Nt(t))):-2}function Dt(t,e){var r,n;return t?(n=new Tt,t.state=n,n.window=null,0!==(r=Ot(t,e))&&(t.state=null),r):-2}var Bt,Mt,Pt=!0;function kt(t){if(Pt){var e;for(Bt=new r.Buf32(512),Mt=new r.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(vt(1,t.lens,0,288,Bt,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;vt(2,t.lens,0,32,Mt,0,t.work,{bits:5}),Pt=!1}t.lencode=Bt,t.lenbits=9,t.distcode=Mt,t.distbits=5}function Lt(t,e,n,i){var o,s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new r.Buf8(s.wsize)),i>=s.wsize?(r.arraySet(s.window,e,n-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):((o=s.wsize-s.wnext)>i&&(o=i),r.arraySet(s.window,e,n-i,o,s.wnext),(i-=o)?(r.arraySet(s.window,e,n-i,i,0),s.wnext=i,s.whave=s.wsize):(s.wnext+=o,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=o))),0}var xt={inflateReset:Nt,inflateReset2:Ot,inflateResetKeep:Rt,inflateInit:function(t){return Dt(t,15)},inflateInit2:Dt,inflate:function(t,e){var n,i,o,s,a,u,l,h,c,d,f,g,w,p,_,m,E,A,y,C,b,I,v,S,T=0,R=new r.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return-2;12===(n=t.state).mode&&(n.mode=13),a=t.next_out,o=t.output,l=t.avail_out,s=t.next_in,i=t.input,u=t.avail_in,h=n.hold,c=n.bits,d=u,f=l,I=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;c<16;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(2&n.wrap&&35615===h){n.check=0,R[0]=255&h,R[1]=h>>>8&255,n.check=U(n.check,R,2,0),h=0,c=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",n.mode=30;break}if(8!=(15&h)){t.msg="unknown compression method",n.mode=30;break}if(c-=4,b=8+(15&(h>>>=4)),0===n.wbits)n.wbits=b;else if(b>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<b,t.adler=n.check=1,n.mode=512&h?10:12,h=0,c=0;break;case 2:for(;c<16;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(n.flags=h,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=h>>8&1),512&n.flags&&(R[0]=255&h,R[1]=h>>>8&255,n.check=U(n.check,R,2,0)),h=0,c=0,n.mode=3;case 3:for(;c<32;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}n.head&&(n.head.time=h),512&n.flags&&(R[0]=255&h,R[1]=h>>>8&255,R[2]=h>>>16&255,R[3]=h>>>24&255,n.check=U(n.check,R,4,0)),h=0,c=0,n.mode=4;case 4:for(;c<16;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}n.head&&(n.head.xflags=255&h,n.head.os=h>>8),512&n.flags&&(R[0]=255&h,R[1]=h>>>8&255,n.check=U(n.check,R,2,0)),h=0,c=0,n.mode=5;case 5:if(1024&n.flags){for(;c<16;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}n.length=h,n.head&&(n.head.extra_len=h),512&n.flags&&(R[0]=255&h,R[1]=h>>>8&255,n.check=U(n.check,R,2,0)),h=0,c=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((g=n.length)>u&&(g=u),g&&(n.head&&(b=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),r.arraySet(n.head.extra,i,s,g,b)),512&n.flags&&(n.check=U(n.check,i,g,s)),u-=g,s+=g,n.length-=g),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===u)break t;g=0;do{b=i[s+g++],n.head&&b&&n.length<65536&&(n.head.name+=String.fromCharCode(b))}while(b&&g<u);if(512&n.flags&&(n.check=U(n.check,i,g,s)),u-=g,s+=g,b)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===u)break t;g=0;do{b=i[s+g++],n.head&&b&&n.length<65536&&(n.head.comment+=String.fromCharCode(b))}while(b&&g<u);if(512&n.flags&&(n.check=U(n.check,i,g,s)),u-=g,s+=g,b)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;c<16;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(h!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}h=0,c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;c<32;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}t.adler=n.check=St(h),h=0,c=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,n.hold=h,n.bits=c,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last){h>>>=7&c,c-=7&c,n.mode=27;break}for(;c<3;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}switch(n.last=1&h,c-=1,3&(h>>>=1)){case 0:n.mode=14;break;case 1:if(kt(n),n.mode=20,6===e){h>>>=2,c-=2;break t}break;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}h>>>=2,c-=2;break;case 14:for(h>>>=7&c,c-=7&c;c<32;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if((65535&h)!=(h>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&h,h=0,c=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(g=n.length){if(g>u&&(g=u),g>l&&(g=l),0===g)break t;r.arraySet(o,i,s,g,a),u-=g,s+=g,l-=g,a+=g,n.length-=g;break}n.mode=12;break;case 17:for(;c<14;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(n.nlen=257+(31&h),h>>>=5,c-=5,n.ndist=1+(31&h),h>>>=5,c-=5,n.ncode=4+(15&h),h>>>=4,c-=4,n.nlen>286||n.ndist>30){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;c<3;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}n.lens[N[n.have++]]=7&h,h>>>=3,c-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,v={bits:n.lenbits},I=vt(0,n.lens,0,19,n.lencode,0,n.work,v),n.lenbits=v.bits,I){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;m=(T=n.lencode[h&(1<<n.lenbits)-1])>>>16&255,E=65535&T,!((_=T>>>24)<=c);){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(E<16)h>>>=_,c-=_,n.lens[n.have++]=E;else{if(16===E){for(S=_+2;c<S;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(h>>>=_,c-=_,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}b=n.lens[n.have-1],g=3+(3&h),h>>>=2,c-=2}else if(17===E){for(S=_+3;c<S;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}c-=_,b=0,g=3+(7&(h>>>=_)),h>>>=3,c-=3}else{for(S=_+7;c<S;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}c-=_,b=0,g=11+(127&(h>>>=_)),h>>>=7,c-=7}if(n.have+g>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;g--;)n.lens[n.have++]=b}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,v={bits:n.lenbits},I=vt(1,n.lens,0,n.nlen,n.lencode,0,n.work,v),n.lenbits=v.bits,I){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,v={bits:n.distbits},I=vt(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,v),n.distbits=v.bits,I){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(u>=6&&l>=258){t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,n.hold=h,n.bits=c,At(t,f),a=t.next_out,o=t.output,l=t.avail_out,s=t.next_in,i=t.input,u=t.avail_in,h=n.hold,c=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;m=(T=n.lencode[h&(1<<n.lenbits)-1])>>>16&255,E=65535&T,!((_=T>>>24)<=c);){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(m&&0==(240&m)){for(A=_,y=m,C=E;m=(T=n.lencode[C+((h&(1<<A+y)-1)>>A)])>>>16&255,E=65535&T,!(A+(_=T>>>24)<=c);){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}h>>>=A,c-=A,n.back+=A}if(h>>>=_,c-=_,n.back+=_,n.length=E,0===m){n.mode=26;break}if(32&m){n.back=-1,n.mode=12;break}if(64&m){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&m,n.mode=22;case 22:if(n.extra){for(S=n.extra;c<S;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}n.length+=h&(1<<n.extra)-1,h>>>=n.extra,c-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;m=(T=n.distcode[h&(1<<n.distbits)-1])>>>16&255,E=65535&T,!((_=T>>>24)<=c);){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(0==(240&m)){for(A=_,y=m,C=E;m=(T=n.distcode[C+((h&(1<<A+y)-1)>>A)])>>>16&255,E=65535&T,!(A+(_=T>>>24)<=c);){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}h>>>=A,c-=A,n.back+=A}if(h>>>=_,c-=_,n.back+=_,64&m){t.msg="invalid distance code",n.mode=30;break}n.offset=E,n.extra=15&m,n.mode=24;case 24:if(n.extra){for(S=n.extra;c<S;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}n.offset+=h&(1<<n.extra)-1,h>>>=n.extra,c-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break t;if(g=f-l,n.offset>g){if((g=n.offset-g)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}g>n.wnext?(g-=n.wnext,w=n.wsize-g):w=n.wnext-g,g>n.length&&(g=n.length),p=n.window}else p=o,w=a-n.offset,g=n.length;g>l&&(g=l),l-=g,n.length-=g;do{o[a++]=p[w++]}while(--g);0===n.length&&(n.mode=21);break;case 26:if(0===l)break t;o[a++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;c<32;){if(0===u)break t;u--,h|=i[s++]<<c,c+=8}if(f-=l,t.total_out+=f,n.total+=f,f&&(t.adler=n.check=n.flags?U(n.check,o,f,a-f):L(n.check,o,f,a-f)),f=l,(n.flags?h:St(h))!==n.check){t.msg="incorrect data check",n.mode=30;break}h=0,c=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;c<32;){if(0===u)break t;u--,h+=i[s++]<<c,c+=8}if(h!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}h=0,c=0}n.mode=29;case 29:I=1;break t;case 30:I=-3;break t;case 31:return-4;case 32:default:return-2}return t.next_out=a,t.avail_out=l,t.next_in=s,t.avail_in=u,n.hold=h,n.bits=c,(n.wsize||f!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&Lt(t,t.output,t.next_out,f-t.avail_out),d-=t.avail_in,f-=t.avail_out,t.total_in+=d,t.total_out+=f,n.total+=f,n.wrap&&f&&(t.adler=n.check=n.flags?U(n.check,o,f,t.next_out-f):L(n.check,o,f,t.next_out-f)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===d&&0===f||4===e)&&0===I&&(I=-5),I},inflateEnd:function(t){if(!t||!t.state)return-2;var e=t.state;return e.window&&(e.window=null),t.state=null,0},inflateGetHeader:function(t,e){var r;return t&&t.state?0==(2&(r=t.state).wrap)?-2:(r.head=e,e.done=!1,0):-2},inflateSetDictionary:function(t,e){var r,n=e.length;return t&&t.state?0!==(r=t.state).wrap&&11!==r.mode?-2:11===r.mode&&L(1,e,n,0)!==r.check?-3:Lt(t,e,n,n)?(r.mode=31,-4):(r.havedict=1,0):-2},inflateInfo:"pako inflate (from Nodeca project)"},Ft={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};var Ut=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Vt=Object.prototype.toString;function Ht(t){if(!(this instanceof Ht))return new Ht(t);this.options=r.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new wt,this.strm.avail_out=0;var n=xt.inflateInit2(this.strm,e.windowBits);if(n!==Ft.Z_OK)throw new Error(V[n]);if(this.header=new Ut,xt.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"==typeof e.dictionary?e.dictionary=ht(e.dictionary):"[object ArrayBuffer]"===Vt.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(n=xt.inflateSetDictionary(this.strm,e.dictionary))!==Ft.Z_OK))throw new Error(V[n])}function zt(t,e){var r=new Ht(e);if(r.push(t,!0),r.err)throw r.msg||V[r.err];return r.result}Ht.prototype.push=function(t,e){var n,i,o,s,a,u=this.strm,l=this.options.chunkSize,h=this.options.dictionary,c=!1;if(this.ended)return!1;i=e===~~e?e:!0===e?Ft.Z_FINISH:Ft.Z_NO_FLUSH,"string"==typeof t?u.input=dt(t):"[object ArrayBuffer]"===Vt.call(t)?u.input=new Uint8Array(t):u.input=t,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new r.Buf8(l),u.next_out=0,u.avail_out=l),(n=xt.inflate(u,Ft.Z_NO_FLUSH))===Ft.Z_NEED_DICT&&h&&(n=xt.inflateSetDictionary(this.strm,h)),n===Ft.Z_BUF_ERROR&&!0===c&&(n=Ft.Z_OK,c=!1),n!==Ft.Z_STREAM_END&&n!==Ft.Z_OK)return this.onEnd(n),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&n!==Ft.Z_STREAM_END&&(0!==u.avail_in||i!==Ft.Z_FINISH&&i!==Ft.Z_SYNC_FLUSH)||("string"===this.options.to?(o=gt(u.output,u.next_out),s=u.next_out-o,a=ft(u.output,o),u.next_out=s,u.avail_out=l-s,s&&r.arraySet(u.output,u.output,o,s,0),this.onData(a)):this.onData(r.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(c=!0)}while((u.avail_in>0||0===u.avail_out)&&n!==Ft.Z_STREAM_END);return n===Ft.Z_STREAM_END&&(i=Ft.Z_FINISH),i===Ft.Z_FINISH?(n=xt.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===Ft.Z_OK):i!==Ft.Z_SYNC_FLUSH||(this.onEnd(Ft.Z_OK),u.avail_out=0,!0)},Ht.prototype.onData=function(t){this.chunks.push(t)},Ht.prototype.onEnd=function(t){t===Ft.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=r.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Gt={Inflate:Ht,inflate:zt,inflateRaw:function(t,e){return(e=e||{}).raw=!0,zt(t,e)},ungzip:zt},Xt={};(0,r.assign)(Xt,Et,Gt,Ft);var Wt=Xt,Yt=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then},Kt={}.toString,Zt=Array.isArray||function(t){return"[object Array]"==Kt.call(t)};qt.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}();var jt=qt.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function qt(t,e,r){return qt.TYPED_ARRAY_SUPPORT||this instanceof qt?"number"==typeof t?$t(this,t):function(t,e,r,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return function(t,e,r,n){if(r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");var i;i=void 0===r&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,r):new Uint8Array(e,r,n);qt.TYPED_ARRAY_SUPPORT?i.__proto__=qt.prototype:i=te(t,i);return i}(t,e,r,n);if("string"==typeof e)return function(t,e){var r=0|re(e),n=Jt(t,r),i=n.write(e);i!==r&&(n=n.slice(0,i));return n}(t,e);return function(t,e){if(qt.isBuffer(e)){var r=0|Qt(e.length),n=Jt(t,r);return 0===n.length||e.copy(n,0,0,r),n}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?Jt(t,0):te(t,e);if("Buffer"===e.type&&Array.isArray(e.data))return te(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}(this,t,e,r):new qt(t,e,r)}function Qt(t){if(t>=jt)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+jt.toString(16)+" bytes");return 0|t}function Jt(t,e){var r;return qt.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(e)).__proto__=qt.prototype:(null===(r=t)&&(r=new qt(e)),r.length=e),r}function $t(t,e){var r=Jt(t,e<0?0:0|Qt(e));if(!qt.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)r[n]=0;return r}function te(t,e){for(var r=e.length<0?0:0|Qt(e.length),n=Jt(t,r),i=0;i<r;i+=1)n[i]=255&e[i];return n}function ee(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function re(t){return qt.isBuffer(t)?t.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)?t.byteLength:("string"!=typeof t&&(t=""+t),0===t.length?0:ee(t).length)}qt.TYPED_ARRAY_SUPPORT&&(qt.prototype.__proto__=Uint8Array.prototype,qt.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&qt[Symbol.species]===qt&&Object.defineProperty(qt,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),qt.prototype.write=function(t,e,r){void 0===e||void 0===r&&"string"==typeof e?(r=this.length,e=0):isFinite(e)&&(e|=0,isFinite(r)?r|=0:r=void 0);var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return function(t,e,r,n){return function(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}(ee(e,t.length-r),t,r,n)}(this,t,e,r)},qt.prototype.slice=function(t,e){var r,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),qt.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=qt.prototype;else{var i=e-t;r=new qt(i,void 0);for(var o=0;o<i;++o)r[o]=this[o+t]}return r},qt.prototype.copy=function(t,e,r,n){if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i,o=n-r;if(this===t&&r<e&&e<n)for(i=o-1;i>=0;--i)t[i+e]=this[i+r];else if(o<1e3||!qt.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},qt.prototype.fill=function(t,e,r){if("string"==typeof t){if("string"==typeof e?(e=0,r=this.length):"string"==typeof r&&(r=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var o=qt.isBuffer(t)?t:new qt(t),s=o.length;for(i=0;i<r-e;++i)this[i+e]=o[i%s]}return this},qt.concat=function(t,e){if(!Zt(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return Jt(null,0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=$t(null,e),i=0;for(r=0;r<t.length;++r){var o=t[r];if(!qt.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i),i+=o.length}return n},qt.byteLength=re,qt.prototype._isBuffer=!0,qt.isBuffer=function(t){return!(null==t||!t._isBuffer)};var ne,ie=function(t){var e=new qt(t);return e.fill(0),e},oe=function(t){return new qt(t)},se=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],ae=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},ue=function(t){return se[t]},le=function(t){for(var e=0;0!==t;)e++,t>>>=1;return e},he=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');ne=t},ce=function(){return void 0!==ne},de=function(t){return ne(t)},fe=e((function(t,e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(t){return r}}}));function ge(){this.buffer=[],this.length=0}ge.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var r=0;r<e;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}};var we=ge;function pe(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=ie(t*t),this.reservedBit=ie(t*t)}pe.prototype.set=function(t,e,r,n){var i=t*this.size+e;this.data[i]=r,n&&(this.reservedBit[i]=!0)},pe.prototype.get=function(t,e){return this.data[t*this.size+e]},pe.prototype.xor=function(t,e,r){this.data[t*this.size+e]^=r},pe.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]};var _e=pe,me=e((function(t,e){var r=ae;e.getRowColCoords=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,n=r(t),i=145===n?26:2*Math.ceil((n-13)/(2*e-2)),o=[n-7],s=1;s<e-1;s++)o[s]=o[s-1]-i;return o.push(6),o.reverse()},e.getPositions=function(t){for(var r=[],n=e.getRowColCoords(t),i=n.length,o=0;o<i;o++)for(var s=0;s<i;s++)0===o&&0===s||0===o&&s===i-1||o===i-1&&0===s||r.push([n[o],n[s]]);return r}})),Ee=ae,Ae=function(t){var e=Ee(t);return[[0,0],[e-7,0],[0,e-7]]},ye=e((function(t,e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var r=3,n=3,i=40,o=10;function s(t,r,n){switch(t){case e.Patterns.PATTERN000:return(r+n)%2==0;case e.Patterns.PATTERN001:return r%2==0;case e.Patterns.PATTERN010:return n%3==0;case e.Patterns.PATTERN011:return(r+n)%3==0;case e.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(n/3))%2==0;case e.Patterns.PATTERN101:return r*n%2+r*n%3==0;case e.Patterns.PATTERN110:return(r*n%2+r*n%3)%2==0;case e.Patterns.PATTERN111:return(r*n%3+(r+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){for(var e=t.size,n=0,i=0,o=0,s=null,a=null,u=0;u<e;u++){i=o=0,s=a=null;for(var l=0;l<e;l++){var h=t.get(u,l);h===s?i++:(i>=5&&(n+=r+(i-5)),s=h,i=1),(h=t.get(l,u))===a?o++:(o>=5&&(n+=r+(o-5)),a=h,o=1)}i>=5&&(n+=r+(i-5)),o>=5&&(n+=r+(o-5))}return n},e.getPenaltyN2=function(t){for(var e=t.size,r=0,i=0;i<e-1;i++)for(var o=0;o<e-1;o++){var s=t.get(i,o)+t.get(i,o+1)+t.get(i+1,o)+t.get(i+1,o+1);4!==s&&0!==s||r++}return r*n},e.getPenaltyN3=function(t){for(var e=t.size,r=0,n=0,o=0,s=0;s<e;s++){n=o=0;for(var a=0;a<e;a++)n=n<<1&2047|t.get(s,a),a>=10&&(1488===n||93===n)&&r++,o=o<<1&2047|t.get(a,s),a>=10&&(1488===o||93===o)&&r++}return r*i},e.getPenaltyN4=function(t){for(var e=0,r=t.data.length,n=0;n<r;n++)e+=t.data[n];return Math.abs(Math.ceil(100*e/r/5)-10)*o},e.applyMask=function(t,e){for(var r=e.size,n=0;n<r;n++)for(var i=0;i<r;i++)e.isReserved(i,n)||e.xor(i,n,s(t,i,n))},e.getBestMask=function(t,r){for(var n=Object.keys(e.Patterns).length,i=0,o=1/0,s=0;s<n;s++){r(s),e.applyMask(s,t);var a=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(s,t),a<o&&(o=a,i=s)}return i}})),Ce=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],be=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],Ie=function(t,e){switch(e){case fe.L:return Ce[4*(t-1)+0];case fe.M:return Ce[4*(t-1)+1];case fe.Q:return Ce[4*(t-1)+2];case fe.H:return Ce[4*(t-1)+3];default:return}},ve=function(t,e){switch(e){case fe.L:return be[4*(t-1)+0];case fe.M:return be[4*(t-1)+1];case fe.Q:return be[4*(t-1)+2];case fe.H:return be[4*(t-1)+3];default:return}},Se=ie(512),Te=ie(256);!function(){for(var t=1,e=0;e<255;e++)Se[e]=t,Te[t]=e,256&(t<<=1)&&(t^=285);for(e=255;e<512;e++)Se[e]=Se[e-255]}();for(var Re=function(t){return Se[t]},Ne=function(t,e){return 0===t||0===e?0:Se[Te[t]+Te[e]]},Oe=e((function(t,e){e.mul=function(t,e){for(var r=ie(t.length+e.length-1),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)r[n+i]^=Ne(t[n],e[i]);return r},e.mod=function(t,e){for(var r=oe(t);r.length-e.length>=0;){for(var n=r[0],i=0;i<e.length;i++)r[i]^=Ne(e[i],n);for(var o=0;o<r.length&&0===r[o];)o++;r=r.slice(o)}return r},e.generateECPolynomial=function(t){for(var r=oe([1]),n=0;n<t;n++)r=e.mul(r,[1,Re(n)]);return r}})),De=function(t){var e=Ve(t),r=e[0],n=e[1];return 3*(r+n)/4-n},Be=function(t){var e,r,n=Ve(t),i=n[0],o=n[1],s=new Le(function(t,e,r){return 3*(e+r)/4-r}(0,i,o)),a=0,u=o>0?i-4:i;for(r=0;r<u;r+=4)e=ke[t.charCodeAt(r)]<<18|ke[t.charCodeAt(r+1)]<<12|ke[t.charCodeAt(r+2)]<<6|ke[t.charCodeAt(r+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===o&&(e=ke[t.charCodeAt(r)]<<2|ke[t.charCodeAt(r+1)]>>4,s[a++]=255&e);1===o&&(e=ke[t.charCodeAt(r)]<<10|ke[t.charCodeAt(r+1)]<<4|ke[t.charCodeAt(r+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},Me=function(t){for(var e,r=t.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(He(t,s,s+o>a?a:s+o));1===n?(e=t[r-1],i.push(Pe[e>>2]+Pe[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],i.push(Pe[e>>10]+Pe[e>>4&63]+Pe[e<<2&63]+"="));return i.join("")},Pe=[],ke=[],Le="undefined"!=typeof Uint8Array?Uint8Array:Array,xe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Fe=0,Ue=xe.length;Fe<Ue;++Fe)Pe[Fe]=xe[Fe],ke[xe.charCodeAt(Fe)]=Fe;function Ve(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function He(t,e,r){for(var n,i,o=[],s=e;s<r;s+=3)n=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),o.push(Pe[(i=n)>>18&63]+Pe[i>>12&63]+Pe[i>>6&63]+Pe[63&i]);return o.join("")}ke["-".charCodeAt(0)]=62,ke["_".charCodeAt(0)]=63;var ze={byteLength:De,toByteArray:Be,fromByteArray:Me},Ge=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,l=u>>1,h=-7,c=r?i-1:0,d=r?-1:1,f=t[e+c];for(c+=d,o=f&(1<<-h)-1,f>>=-h,h+=a;h>0;o=256*o+t[e+c],c+=d,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[e+c],c+=d,h-=8);if(0===o)o=1-l;else{if(o===u)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,n),o-=l}return(f?-1:1)*s*Math.pow(2,o-n)},Xe=function(t,e,r,n,i,o){var s,a,u,l=8*o-i-1,h=(1<<l)-1,c=h>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=n?0:o-1,g=n?1:-1,w=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+c>=1?d/u:d*Math.pow(2,1-c))*u>=2&&(s++,u/=2),s+c>=h?(a=0,s=h):s+c>=1?(a=(e*u-1)*Math.pow(2,i),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[r+f]=255&a,f+=g,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[r+f]=255&s,f+=g,s/=256,l-=8);t[r+f-g]|=128*w},We=e((function(t,e){var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=function(t){+t!=t&&(t=0);return o.alloc(+t)},e.INSPECT_MAX_BYTES=50;var n=2147483647;function i(t){if(t>n)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,o.prototype),e}function o(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return u(t)}return s(t,e,r)}function s(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!o.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|d(t,e),n=i(r),s=n.write(t,e);s!==r&&(n=n.slice(0,s));return n}(t,e);if(ArrayBuffer.isView(t))return l(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(U(t,ArrayBuffer)||t&&U(t.buffer,ArrayBuffer))return h(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(U(t,SharedArrayBuffer)||t&&U(t.buffer,SharedArrayBuffer)))return h(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(null!=n&&n!==t)return o.from(n,e,r);var s=function(t){if(o.isBuffer(t)){var e=0|c(t.length),r=i(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||V(t.length)?i(0):l(t);if("Buffer"===t.type&&Array.isArray(t.data))return l(t.data)}(t);if(s)return s;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return o.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function a(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function u(t){return a(t),i(t<0?0:0|c(t))}function l(t){for(var e=t.length<0?0:0|c(t.length),r=i(e),n=0;n<e;n+=1)r[n]=255&t[n];return r}function h(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,o.prototype),n}function c(t){if(t>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|t}function d(t,e){if(o.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||U(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return x(t).length;default:if(i)return n?-1:L(t).length;e=(""+e).toLowerCase(),i=!0}}function f(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,r);case"utf8":case"utf-8":return I(this,e,r);case"ascii":return S(this,e,r);case"latin1":case"binary":return T(this,e,r);case"base64":return b(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function g(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function w(t,e,r,n,i){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),V(r=+r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof e&&(e=o.from(e,n)),o.isBuffer(e))return 0===e.length?-1:p(t,e,r,n,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):p(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function p(t,e,r,n,i){var o,s=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,r/=2}function l(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){var h=-1;for(o=r;o<a;o++)if(l(t,o)===l(e,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===u)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(r+u>a&&(r=a-u),o=r;o>=0;o--){for(var c=!0,d=0;d<u;d++)if(l(t,o+d)!==l(e,d)){c=!1;break}if(c)return o}return-1}function _(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=e.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(2*s,2),16);if(V(a))return s;t[r+s]=a}return s}function m(t,e,r,n){return F(L(e,t.length-r),t,r,n)}function E(t,e,r,n){return F(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function A(t,e,r,n){return E(t,e,r,n)}function y(t,e,r,n){return F(x(e),t,r,n)}function C(t,e,r,n){return F(function(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)n=(r=t.charCodeAt(s))>>8,i=r%256,o.push(i),o.push(n);return o}(e,t.length-r),t,r,n)}function b(t,e,r){return 0===e&&r===t.length?ze.fromByteArray(t):ze.fromByteArray(t.slice(e,r))}function I(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o,s,a,u,l=t[i],h=null,c=l>239?4:l>223?3:l>191?2:1;if(i+c<=r)switch(c){case 1:l<128&&(h=l);break;case 2:128==(192&(o=t[i+1]))&&(u=(31&l)<<6|63&o)>127&&(h=u);break;case 3:o=t[i+1],s=t[i+2],128==(192&o)&&128==(192&s)&&(u=(15&l)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:o=t[i+1],s=t[i+2],a=t[i+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(u=(15&l)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&u<1114112&&(h=u)}null===h?(h=65533,c=1):h>65535&&(h-=65536,n.push(h>>>10&1023|55296),h=56320|1023&h),n.push(h),i+=c}return function(t){var e=t.length;if(e<=v)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=v));return r}(n)}e.kMaxLength=n,o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),o.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(t,e,r){return s(t,e,r)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(t,e,r){return function(t,e,r){return a(t),t<=0?i(t):void 0!==e?"string"==typeof r?i(t).fill(e,r):i(t).fill(e):i(t)}(t,e,r)},o.allocUnsafe=function(t){return u(t)},o.allocUnsafeSlow=function(t){return u(t)},o.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==o.prototype},o.compare=function(t,e){if(U(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),U(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(t)||!o.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,i=0,s=Math.min(r,n);i<s;++i)if(t[i]!==e[i]){r=t[i],n=e[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return o.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=o.allocUnsafe(e),i=0;for(r=0;r<t.length;++r){var s=t[r];if(U(s,Uint8Array)&&(s=o.from(s)),!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},o.byteLength=d,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},o.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},o.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},o.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?I(this,0,t):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(t){if(!o.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===o.compare(this,t)},o.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(t,e,r,n,i){if(U(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),e<0||r>t.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&e>=r)return 0;if(n>=i)return-1;if(e>=r)return 1;if(this===t)return 0;for(var s=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(e>>>=0),u=Math.min(s,a),l=this.slice(n,i),h=t.slice(e,r),c=0;c<u;++c)if(l[c]!==h[c]){s=l[c],a=h[c];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},o.prototype.indexOf=function(t,e,r){return w(this,t,e,r,!0)},o.prototype.lastIndexOf=function(t,e,r){return w(this,t,e,r,!1)},o.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-e;if((void 0===r||r>i)&&(r=i),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return _(this,t,e,r);case"utf8":case"utf-8":return m(this,t,e,r);case"ascii":return E(this,t,e,r);case"latin1":case"binary":return A(this,t,e,r);case"base64":return y(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var v=4096;function S(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(127&t[i]);return n}function T(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function R(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=H[t[o]];return i}function N(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function O(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,r,n,i,s){if(!o.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<s)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function B(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function M(t,e,r,n,i){return e=+e,r>>>=0,i||B(t,0,r,4),Xe(t,e,r,n,23,4),r+4}function P(t,e,r,n,i){return e=+e,r>>>=0,i||B(t,0,r,8),Xe(t,e,r,n,52,8),r+8}o.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,o.prototype),n},o.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},o.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},o.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},o.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},o.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},o.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},o.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},o.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},o.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||O(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*e)),o},o.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},o.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},o.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},o.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),Ge(this,t,!0,23,4)},o.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),Ge(this,t,!1,23,4)},o.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),Ge(this,t,!0,52,8)},o.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),Ge(this,t,!1,52,8)},o.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||D(this,t,e,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},o.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||D(this,t,e,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},o.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,1,255,0),this[e]=255&t,e+1},o.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},o.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);D(this,t,e,r,i-1,-i)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},o.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var i=Math.pow(2,8*r-1);D(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},o.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},o.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},o.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},o.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},o.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},o.prototype.writeFloatLE=function(t,e,r){return M(this,t,e,!0,r)},o.prototype.writeFloatBE=function(t,e,r){return M(this,t,e,!1,r)},o.prototype.writeDoubleLE=function(t,e,r){return P(this,t,e,!0,r)},o.prototype.writeDoubleBE=function(t,e,r){return P(this,t,e,!1,r)},o.prototype.copy=function(t,e,r,n){if(!o.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var i=n-r;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,n);else if(this===t&&r<e&&e<n)for(var s=i-1;s>=0;--s)t[s+e]=this[s+r];else Uint8Array.prototype.set.call(t,this.subarray(r,n),e);return i},o.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var i=t.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(t=i)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(s=e;s<r;++s)this[s]=t;else{var a=o.isBuffer(t)?t:o.from(t,n),u=a.length;if(0===u)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=a[s%u]}return this};var k=/[^+/0-9A-Za-z-_]/g;function L(t,e){var r;e=e||1/0;for(var n=t.length,i=null,o=[],s=0;s<n;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function x(t){return ze.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(k,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function F(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function U(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function V(t){return t!=t}var H=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()})).Buffer;function Ye(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}Ye.prototype.initialize=function(t){this.degree=t,this.genPoly=Oe.generateECPolynomial(this.degree)},Ye.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");var e=ie(this.degree),r=We.concat([t,e],t.length+this.degree),n=Oe.mod(r,this.genPoly),i=this.degree-n.length;if(i>0){var o=ie(this.degree);return n.copy(o,i),o}return n};var Ke=Ye,Ze=function(t){return!isNaN(t)&&t>=1&&t<=40},je="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",qe="(?:(?![A-Z0-9 $%*+\\-./:]|"+(je=je.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+",Qe=new RegExp(je,"g"),Je=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),$e=new RegExp(qe,"g"),tr=new RegExp("[0-9]+","g"),er=new RegExp("[A-Z $%*+\\-./:]+","g"),rr=new RegExp("^"+je+"$"),nr=new RegExp("^[0-9]+$"),ir=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),or={KANJI:Qe,BYTE_KANJI:Je,BYTE:$e,NUMERIC:tr,ALPHANUMERIC:er,testKanji:function(t){return rr.test(t)},testNumeric:function(t){return nr.test(t)},testAlphanumeric:function(t){return ir.test(t)}},sr=e((function(t,e){e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!Ze(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return or.testNumeric(t)?e.NUMERIC:or.testAlphanumeric(t)?e.ALPHANUMERIC:or.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,r){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(t){return r}}})),ar=e((function(t,e){var r=le(7973);function n(t,e){return sr.getCharCountIndicator(t,e)+4}function i(t,e){var r=0;return t.forEach((function(t){var i=n(t.mode,e);r+=i+t.getBitsLength()})),r}e.from=function(t,e){return Ze(t)?parseInt(t,10):e},e.getCapacity=function(t,e,r){if(!Ze(t))throw new Error("Invalid QR Code version");void 0===r&&(r=sr.BYTE);var i=8*(ue(t)-ve(t,e));if(r===sr.MIXED)return i;var o=i-n(r,t);switch(r){case sr.NUMERIC:return Math.floor(o/10*3);case sr.ALPHANUMERIC:return Math.floor(o/11*2);case sr.KANJI:return Math.floor(o/13);case sr.BYTE:default:return Math.floor(o/8)}},e.getBestVersionForData=function(t,r){var n,o=fe.from(r,fe.M);if(Zt(t)){if(t.length>1)return function(t,r){for(var n=1;n<=40;n++)if(i(t,n)<=e.getCapacity(n,r,sr.MIXED))return n}(t,o);if(0===t.length)return 1;n=t[0]}else n=t;return function(t,r,n){for(var i=1;i<=40;i++)if(r<=e.getCapacity(i,n,t))return i}(n.mode,n.getLength(),o)},e.getEncodedBits=function(t){if(!Ze(t)||t<7)throw new Error("Invalid QR Code version");for(var e=t<<12;le(e)-r>=0;)e^=7973<<le(e)-r;return t<<12|e}})),ur=le(1335),lr=function(t,e){for(var r=t.bit<<3|e,n=r<<10;le(n)-ur>=0;)n^=1335<<le(n)-ur;return 21522^(r<<10|n)};function hr(t){this.mode=sr.NUMERIC,this.data=t.toString()}hr.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},hr.prototype.getLength=function(){return this.data.length},hr.prototype.getBitsLength=function(){return hr.getBitsLength(this.data.length)},hr.prototype.write=function(t){var e,r,n;for(e=0;e+3<=this.data.length;e+=3)r=this.data.substr(e,3),n=parseInt(r,10),t.put(n,10);var i=this.data.length-e;i>0&&(r=this.data.substr(e),n=parseInt(r,10),t.put(n,3*i+1))};var cr=hr,dr=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function fr(t){this.mode=sr.ALPHANUMERIC,this.data=t}fr.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},fr.prototype.getLength=function(){return this.data.length},fr.prototype.getBitsLength=function(){return fr.getBitsLength(this.data.length)},fr.prototype.write=function(t){var e;for(e=0;e+2<=this.data.length;e+=2){var r=45*dr.indexOf(this.data[e]);r+=dr.indexOf(this.data[e+1]),t.put(r,11)}this.data.length%2&&t.put(dr.indexOf(this.data[e]),6)};var gr=fr;function wr(t){this.mode=sr.BYTE,this.data=oe(t)}wr.getBitsLength=function(t){return 8*t},wr.prototype.getLength=function(){return this.data.length},wr.prototype.getBitsLength=function(){return wr.getBitsLength(this.data.length)},wr.prototype.write=function(t){for(var e=0,r=this.data.length;e<r;e++)t.put(this.data[e],8)};var pr=wr;function _r(t){this.mode=sr.KANJI,this.data=t}_r.getBitsLength=function(t){return 13*t},_r.prototype.getLength=function(){return this.data.length},_r.prototype.getBitsLength=function(){return _r.getBitsLength(this.data.length)},_r.prototype.write=function(t){var e;for(e=0;e<this.data.length;e++){var r=de(this.data[e]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13)}};var mr=_r,Er=e((function(t){var e={single_source_shortest_paths:function(t,r,n){var i={},o={};o[r]=0;var s,a,u,l,h,c,d,f=e.PriorityQueue.make();for(f.push(r,0);!f.empty();)for(u in a=(s=f.pop()).value,l=s.cost,h=t[a]||{})h.hasOwnProperty(u)&&(c=l+h[u],d=o[u],(void 0===o[u]||d>c)&&(o[u]=c,f.push(u,c),i[u]=a));if(void 0!==n&&void 0===o[n]){var g=["Could not find a path from ",r," to ",n,"."].join("");throw new Error(g)}return i},extract_shortest_path_from_predecessor_list:function(t,e){for(var r=[],n=e;n;)r.push(n),t[n],n=t[n];return r.reverse(),r},find_path:function(t,r,n){var i=e.single_source_shortest_paths(t,r,n);return e.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(t){var r,n=e.PriorityQueue,i={};for(r in t=t||{},n)n.hasOwnProperty(r)&&(i[r]=n[r]);return i.queue=[],i.sorter=t.sorter||n.default_sorter,i},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){var r={value:t,cost:e};this.queue.push(r),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=e})),Ar=e((function(t,e){function r(t){return unescape(encodeURIComponent(t)).length}function n(t,e,r){for(var n,i=[];null!==(n=t.exec(r));)i.push({data:n[0],index:n.index,mode:e,length:n[0].length});return i}function i(t){var e,r,i=n(or.NUMERIC,sr.NUMERIC,t),o=n(or.ALPHANUMERIC,sr.ALPHANUMERIC,t);return ce()?(e=n(or.BYTE,sr.BYTE,t),r=n(or.KANJI,sr.KANJI,t)):(e=n(or.BYTE_KANJI,sr.BYTE,t),r=[]),i.concat(o,e,r).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function o(t,e){switch(e){case sr.NUMERIC:return cr.getBitsLength(t);case sr.ALPHANUMERIC:return gr.getBitsLength(t);case sr.KANJI:return mr.getBitsLength(t);case sr.BYTE:return pr.getBitsLength(t)}}function s(t,e){var r,n=sr.getBestModeForData(t);if((r=sr.from(e,n))!==sr.BYTE&&r.bit<n.bit)throw new Error('"'+t+'" cannot be encoded with mode '+sr.toString(r)+".\n Suggested mode is: "+sr.toString(n));switch(r!==sr.KANJI||ce()||(r=sr.BYTE),r){case sr.NUMERIC:return new cr(t);case sr.ALPHANUMERIC:return new gr(t);case sr.KANJI:return new mr(t);case sr.BYTE:return new pr(t)}}e.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(s(e,null)):e.data&&t.push(s(e.data,e.mode)),t}),[])},e.fromString=function(t,n){for(var s=function(t,e){for(var r={},n={start:{}},i=["start"],s=0;s<t.length;s++){for(var a=t[s],u=[],l=0;l<a.length;l++){var h=a[l],c=""+s+l;u.push(c),r[c]={node:h,lastCount:0},n[c]={};for(var d=0;d<i.length;d++){var f=i[d];r[f]&&r[f].node.mode===h.mode?(n[f][c]=o(r[f].lastCount+h.length,h.mode)-o(r[f].lastCount,h.mode),r[f].lastCount+=h.length):(r[f]&&(r[f].lastCount=h.length),n[f][c]=o(h.length,h.mode)+4+sr.getCharCountIndicator(h.mode,e))}}i=u}for(d=0;d<i.length;d++)n[i[d]].end=0;return{map:n,table:r}}(function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];switch(i.mode){case sr.NUMERIC:e.push([i,{data:i.data,mode:sr.ALPHANUMERIC,length:i.length},{data:i.data,mode:sr.BYTE,length:i.length}]);break;case sr.ALPHANUMERIC:e.push([i,{data:i.data,mode:sr.BYTE,length:i.length}]);break;case sr.KANJI:e.push([i,{data:i.data,mode:sr.BYTE,length:r(i.data)}]);break;case sr.BYTE:e.push([{data:i.data,mode:sr.BYTE,length:r(i.data)}])}}return e}(i(t,ce())),n),a=Er.find_path(s.map,"start","end"),u=[],l=1;l<a.length-1;l++)u.push(s.table[a[l]].node);return e.fromArray(function(t){return t.reduce((function(t,e){var r=t.length-1>=0?t[t.length-1]:null;return r&&r.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[])}(u))},e.rawSplit=function(t){return e.fromArray(i(t,ce()))}}));function yr(t,e,r){var n,i,o=t.size,s=lr(e,r);for(n=0;n<15;n++)i=1==(s>>n&1),n<6?t.set(n,8,i,!0):n<8?t.set(n+1,8,i,!0):t.set(o-15+n,8,i,!0),n<8?t.set(8,o-n-1,i,!0):n<9?t.set(8,15-n-1+1,i,!0):t.set(8,15-n-1,i,!0);t.set(o-8,8,1,!0)}function Cr(t,e,r){var n=new we;r.forEach((function(e){n.put(e.mode.bit,4),n.put(e.getLength(),sr.getCharCountIndicator(e.mode,t)),e.write(n)}));var i=8*(ue(t)-ve(t,e));for(n.getLengthInBits()+4<=i&&n.put(0,4);n.getLengthInBits()%8!=0;)n.putBit(0);for(var o=(i-n.getLengthInBits())/8,s=0;s<o;s++)n.put(s%2?17:236,8);return function(t,e,r){for(var n=ue(e),i=ve(e,r),o=n-i,s=Ie(e,r),a=s-n%s,u=Math.floor(n/s),l=Math.floor(o/s),h=l+1,c=u-l,d=new Ke(c),f=0,g=new Array(s),w=new Array(s),p=0,_=oe(t.buffer),m=0;m<s;m++){var E=m<a?l:h;g[m]=_.slice(f,f+E),w[m]=d.encode(g[m]),f+=E,p=Math.max(p,E)}var A,y,C=ie(n),b=0;for(A=0;A<p;A++)for(y=0;y<s;y++)A<g[y].length&&(C[b++]=g[y][A]);for(A=0;A<c;A++)for(y=0;y<s;y++)C[b++]=w[y][A];return C}(n,t,e)}function br(t,e,r,n){var i;if(Zt(t))i=Ar.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");var o=e;if(!o){var s=Ar.rawSplit(t);o=ar.getBestVersionForData(s,r)}i=Ar.fromString(t,o||40)}var a=ar.getBestVersionForData(i,r);if(!a)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<a)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+a+".\n")}else e=a;var u=Cr(e,r,i),l=ae(e),h=new _e(l);return function(t,e){for(var r=t.size,n=Ae(e),i=0;i<n.length;i++)for(var o=n[i][0],s=n[i][1],a=-1;a<=7;a++)if(!(o+a<=-1||r<=o+a))for(var u=-1;u<=7;u++)s+u<=-1||r<=s+u||(a>=0&&a<=6&&(0===u||6===u)||u>=0&&u<=6&&(0===a||6===a)||a>=2&&a<=4&&u>=2&&u<=4?t.set(o+a,s+u,!0,!0):t.set(o+a,s+u,!1,!0))}(h,e),function(t){for(var e=t.size,r=8;r<e-8;r++){var n=r%2==0;t.set(r,6,n,!0),t.set(6,r,n,!0)}}(h),function(t,e){for(var r=me.getPositions(e),n=0;n<r.length;n++)for(var i=r[n][0],o=r[n][1],s=-2;s<=2;s++)for(var a=-2;a<=2;a++)-2===s||2===s||-2===a||2===a||0===s&&0===a?t.set(i+s,o+a,!0,!0):t.set(i+s,o+a,!1,!0)}(h,e),yr(h,r,0),e>=7&&function(t,e){for(var r,n,i,o=t.size,s=ar.getEncodedBits(e),a=0;a<18;a++)r=Math.floor(a/3),n=a%3+o-8-3,i=1==(s>>a&1),t.set(r,n,i,!0),t.set(n,r,i,!0)}(h,e),function(t,e){for(var r=t.size,n=-1,i=r-1,o=7,s=0,a=r-1;a>0;a-=2)for(6===a&&a--;;){for(var u=0;u<2;u++)if(!t.isReserved(i,a-u)){var l=!1;s<e.length&&(l=1==(e[s]>>>o&1)),t.set(i,a-u,l),-1==--o&&(s++,o=7)}if((i+=n)<0||r<=i){i-=n,n=-n;break}}}(h,u),isNaN(n)&&(n=ye.getBestMask(h,yr.bind(null,h,r))),ye.applyMask(n,h),yr(h,r,n),{modules:h,version:e,errorCorrectionLevel:r,maskPattern:n,segments:i}}var Ir=function(t,e){if(void 0===t||""===t)throw new Error("No input text");var r,n,i=fe.M;return void 0!==e&&(i=fe.from(e.errorCorrectionLevel,fe.M),r=ar.from(e.version),n=ye.from(e.maskPattern),e.toSJISFunc&&he(e.toSJISFunc)),br(t,r,i,n)},vr=e((function(t,e){function r(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");var r=parseInt(e.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});var e=void 0===t.margin||null===t.margin||t.margin<0?4:t.margin,n=t.width&&t.width>=21?t.width:void 0,i=t.scale||4;return{width:n,scale:n?4:i,margin:e,color:{dark:r(t.color.dark||"#000000ff"),light:r(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,r){var n=e.getScale(t,r);return Math.floor((t+2*r.margin)*n)},e.qrToImageData=function(t,r,n){for(var i=r.modules.size,o=r.modules.data,s=e.getScale(i,n),a=Math.floor((i+2*n.margin)*s),u=n.margin*s,l=[n.color.light,n.color.dark],h=0;h<a;h++)for(var c=0;c<a;c++){var d=4*(h*a+c),f=n.color.light;if(h>=u&&c>=u&&h<a-u&&c<a-u)f=l[o[Math.floor((h-u)/s)*i+Math.floor((c-u)/s)]?1:0];t[d++]=f.r,t[d++]=f.g,t[d++]=f.b,t[d]=f.a}}})),Sr=e((function(t,e){e.render=function(t,e,r){var n=r,i=e;void 0!==n||e&&e.getContext||(n=e,e=void 0),e||(i=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),n=vr.getOptions(n);var o=vr.getImageWidth(t.modules.size,n),s=i.getContext("2d"),a=s.createImageData(o,o);return vr.qrToImageData(a.data,t,n),function(t,e,r){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=r,e.width=r,e.style.height=r+"px",e.style.width=r+"px"}(s,i,o),s.putImageData(a,0,0),i},e.renderToDataURL=function(t,r,n){var i=n;void 0!==i||r&&r.getContext||(i=r,r=void 0),i||(i={});var o=e.render(t,r,i),s=i.type||"image/png",a=i.rendererOpts||{};return o.toDataURL(s,a.quality)}}));function Tr(t,e){var r=t.a/255,n=e+'="'+t.hex+'"';return r<1?n+" "+e+'-opacity="'+r.toFixed(2).slice(1)+'"':n}function Rr(t,e,r){var n=t+e;return void 0!==r&&(n+=" "+r),n}var Nr=function(t,e,r){var n=vr.getOptions(e),i=t.modules.size,o=t.modules.data,s=i+2*n.margin,a=n.color.light.a?"<path "+Tr(n.color.light,"fill")+' d="M0 0h'+s+"v"+s+'H0z"/>':"",u="<path "+Tr(n.color.dark,"stroke")+' d="'+function(t,e,r){for(var n="",i=0,o=!1,s=0,a=0;a<t.length;a++){var u=Math.floor(a%e),l=Math.floor(a/e);u||o||(o=!0),t[a]?(s++,a>0&&u>0&&t[a-1]||(n+=o?Rr("M",u+r,.5+l+r):Rr("m",i,0),i=0,o=!1),u+1<e&&t[a+1]||(n+=Rr("h",s),s=0)):i++}return n}(o,i,n.margin)+'"/>',l='viewBox="0 0 '+s+" "+s+'"',h='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+l+' shape-rendering="crispEdges">'+a+u+"</svg>\n";return"function"==typeof r&&r(null,h),h};function Or(t,e,r,n,i){var o=[].slice.call(arguments,1),s=o.length,a="function"==typeof o[s-1];if(!a&&!Yt())throw new Error("Callback required as last argument");if(!a){if(s<1)throw new Error("Too few arguments provided");return 1===s?(r=e,e=n=void 0):2!==s||e.getContext||(n=r,r=e,e=void 0),new Promise((function(i,o){try{var s=Ir(r,n);i(t(s,e,n))}catch(t){o(t)}}))}if(s<2)throw new Error("Too few arguments provided");2===s?(i=r,r=e,e=n=void 0):3===s&&(e.getContext&&void 0===i?(i=n,n=void 0):(i=n,n=r,r=e,e=void 0));try{var u=Ir(r,n);i(null,t(u,e,n))}catch(t){i(t)}}var Dr,Br={create:Ir,toCanvas:Or.bind(null,Sr.render),toDataURL:Or.bind(null,Sr.renderToDataURL),toString:Or.bind(null,(function(t,e,r){return Nr(t,r)}))},Mr=e((function(e,r){!function(e){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};function n(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t,e){var r=Object.setPrototypeOf;r?r(t,e):t.__proto__=e}function o(t,e){void 0===e&&(e=t.constructor);var r=Error.captureStackTrace;r&&r(t,e)}var s,a=function(t){function e(e){var r=this.constructor,n=t.call(this,e)||this;return Object.defineProperty(n,"name",{value:r.name,enumerable:!1}),i(n,r.prototype),o(n),n}return n(e,t),e}(Error);class u extends a{constructor(t){super(t),this.message=t}}class l extends u{}class h extends u{}class c{constructor(t){if(this.binarizer=t,null===t)throw new h("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(t,e){return this.binarizer.getBlackRow(t,e)}getBlackMatrix(){return null!==this.matrix&&void 0!==this.matrix||(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(t,e,r,n){const i=this.binarizer.getLuminanceSource().crop(t,e,r,n);return new c(this.binarizer.createBinarizer(i))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const t=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new c(this.binarizer.createBinarizer(t))}rotateCounterClockwise45(){const t=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new c(this.binarizer.createBinarizer(t))}toString(){try{return this.getBlackMatrix().toString()}catch(t){return""}}}class d extends u{static getChecksumInstance(){return new d}}class f{constructor(t){this.source=t}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class g{static arraycopy(t,e,r,n,i){for(;i--;)r[n++]=t[e++]}static currentTimeMillis(){return Date.now()}}class w{static numberOfTrailingZeros(t){let e;if(0===t)return 32;let r=31;return e=t<<16,0!==e&&(r-=16,t=e),e=t<<8,0!==e&&(r-=8,t=e),e=t<<4,0!==e&&(r-=4,t=e),e=t<<2,0!==e&&(r-=2,t=e),r-(t<<1>>>31)}static numberOfLeadingZeros(t){if(0===t)return 32;let e=1;return t>>>16==0&&(e+=16,t<<=16),t>>>24==0&&(e+=8,t<<=8),t>>>28==0&&(e+=4,t<<=4),t>>>30==0&&(e+=2,t<<=2),e-=t>>>31,e}static toHexString(t){return t.toString(16)}static toBinaryString(t){return String(parseInt(String(t),2))}static bitCount(t){return t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135,t+=t>>>8,63&(t+=t>>>16)}static truncDivision(t,e){return Math.trunc(t/e)}static parseInt(t,e){return parseInt(t,e)}}w.MIN_VALUE_32_BITS=-2147483648,w.MAX_VALUE=Number.MAX_SAFE_INTEGER;class p extends u{}class _ extends p{constructor(t,e){super(e),this.index=t,this.message=e}}class m{static fill(t,e){for(let r=0,n=t.length;r<n;r++)t[r]=e}static fillWithin(t,e,r,n){m.rangeCheck(t.length,e,r);for(let i=e;i<r;i++)t[i]=n}static rangeCheck(t,e,r){if(e>r)throw new h("fromIndex("+e+") > toIndex("+r+")");if(e<0)throw new _(e);if(r>t)throw new _(r)}static asList(...t){return t}static create(t,e,r){return Array.from({length:t}).map((t=>Array.from({length:e}).fill(r)))}static createInt32Array(t,e,r){return Array.from({length:t}).map((t=>Int32Array.from({length:e}).fill(r)))}static equals(t,e){if(!t)return!1;if(!e)return!1;if(!t.length)return!1;if(!e.length)return!1;if(t.length!==e.length)return!1;for(let r=0,n=t.length;r<n;r++)if(t[r]!==e[r])return!1;return!0}static hashCode(t){if(null===t)return 0;let e=1;for(const r of t)e=31*e+r;return e}static fillUint8Array(t,e){for(let r=0;r!==t.length;r++)t[r]=e}static copyOf(t,e){return t.slice(0,e)}static copyOfUint8Array(t,e){if(t.length<=e){const r=new Uint8Array(e);return r.set(t),r}return t.slice(0,e)}static copyOfRange(t,e,r){const n=r-e,i=new Int32Array(n);return g.arraycopy(t,e,i,0,n),i}static binarySearch(t,e,r){void 0===r&&(r=m.numberComparator);let n=0,i=t.length-1;for(;n<=i;){const o=i+n>>1,s=r(e,t[o]);if(s>0)n=o+1;else{if(!(s<0))return o;i=o-1}}return-n-1}static numberComparator(t,e){return t-e}}class E{constructor(t,e){void 0===t?(this.size=0,this.bits=new Int32Array(1)):(this.size=t,this.bits=null==e?E.makeArray(t):e)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(t){if(t>32*this.bits.length){const e=E.makeArray(t);g.arraycopy(this.bits,0,e,0,this.bits.length),this.bits=e}}get(t){return 0!=(this.bits[Math.floor(t/32)]&1<<(31&t))}set(t){this.bits[Math.floor(t/32)]|=1<<(31&t)}flip(t){this.bits[Math.floor(t/32)]^=1<<(31&t)}getNextSet(t){const e=this.size;if(t>=e)return e;const r=this.bits;let n=Math.floor(t/32),i=r[n];i&=~((1<<(31&t))-1);const o=r.length;for(;0===i;){if(++n===o)return e;i=r[n]}const s=32*n+w.numberOfTrailingZeros(i);return s>e?e:s}getNextUnset(t){const e=this.size;if(t>=e)return e;const r=this.bits;let n=Math.floor(t/32),i=~r[n];i&=~((1<<(31&t))-1);const o=r.length;for(;0===i;){if(++n===o)return e;i=~r[n]}const s=32*n+w.numberOfTrailingZeros(i);return s>e?e:s}setBulk(t,e){this.bits[Math.floor(t/32)]=e}setRange(t,e){if(e<t||t<0||e>this.size)throw new h;if(e===t)return;e--;const r=Math.floor(t/32),n=Math.floor(e/32),i=this.bits;for(let o=r;o<=n;o++){const s=(2<<(o<n?31:31&e))-(1<<(o>r?0:31&t));i[o]|=s}}clear(){const t=this.bits.length,e=this.bits;for(let r=0;r<t;r++)e[r]=0}isRange(t,e,r){if(e<t||t<0||e>this.size)throw new h;if(e===t)return!0;e--;const n=Math.floor(t/32),i=Math.floor(e/32),o=this.bits;for(let s=n;s<=i;s++){const a=(2<<(s<i?31:31&e))-(1<<(s>n?0:31&t))&4294967295;if((o[s]&a)!==(r?a:0))return!1}return!0}appendBit(t){this.ensureCapacity(this.size+1),t&&(this.bits[Math.floor(this.size/32)]|=1<<(31&this.size)),this.size++}appendBits(t,e){if(e<0||e>32)throw new h("Num bits must be between 0 and 32");this.ensureCapacity(this.size+e),this.appendBit;for(let r=e;r>0;r--)this.appendBit(1==(t>>r-1&1))}appendBitArray(t){const e=t.size;this.ensureCapacity(this.size+e),this.appendBit;for(let r=0;r<e;r++)this.appendBit(t.get(r))}xor(t){if(this.size!==t.size)throw new h("Sizes don't match");const e=this.bits;for(let r=0,n=e.length;r<n;r++)e[r]^=t.bits[r]}toBytes(t,e,r,n){for(let i=0;i<n;i++){let n=0;for(let e=0;e<8;e++)this.get(t)&&(n|=1<<7-e),t++;e[r+i]=n}}getBitArray(){return this.bits}reverse(){const t=new Int32Array(this.bits.length),e=Math.floor((this.size-1)/32),r=e+1,n=this.bits;for(let i=0;i<r;i++){let r=n[i];r=r>>1&1431655765|(1431655765&r)<<1,r=r>>2&858993459|(858993459&r)<<2,r=r>>4&252645135|(252645135&r)<<4,r=r>>8&16711935|(16711935&r)<<8,r=r>>16&65535|(65535&r)<<16,t[e-i]=r}if(this.size!==32*r){const e=32*r-this.size;let n=t[0]>>>e;for(let i=1;i<r;i++){const r=t[i];n|=r<<32-e,t[i-1]=n,n=r>>>e}t[r-1]=n}this.bits=t}static makeArray(t){return new Int32Array(Math.floor((t+31)/32))}equals(t){if(!(t instanceof E))return!1;const e=t;return this.size===e.size&&m.equals(this.bits,e.bits)}hashCode(){return 31*this.size+m.hashCode(this.bits)}toString(){let t="";for(let e=0,r=this.size;e<r;e++)0==(7&e)&&(t+=" "),t+=this.get(e)?"X":".";return t}clone(){return new E(this.size,this.bits.slice())}}!function(t){t[t.OTHER=0]="OTHER",t[t.PURE_BARCODE=1]="PURE_BARCODE",t[t.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",t[t.TRY_HARDER=3]="TRY_HARDER",t[t.CHARACTER_SET=4]="CHARACTER_SET",t[t.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",t[t.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",t[t.ASSUME_GS1=7]="ASSUME_GS1",t[t.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",t[t.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",t[t.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"}(s||(s={}));var A,y=s;class C extends u{static getFormatInstance(){return new C}}!function(t){t[t.Cp437=0]="Cp437",t[t.ISO8859_1=1]="ISO8859_1",t[t.ISO8859_2=2]="ISO8859_2",t[t.ISO8859_3=3]="ISO8859_3",t[t.ISO8859_4=4]="ISO8859_4",t[t.ISO8859_5=5]="ISO8859_5",t[t.ISO8859_6=6]="ISO8859_6",t[t.ISO8859_7=7]="ISO8859_7",t[t.ISO8859_8=8]="ISO8859_8",t[t.ISO8859_9=9]="ISO8859_9",t[t.ISO8859_10=10]="ISO8859_10",t[t.ISO8859_11=11]="ISO8859_11",t[t.ISO8859_13=12]="ISO8859_13",t[t.ISO8859_14=13]="ISO8859_14",t[t.ISO8859_15=14]="ISO8859_15",t[t.ISO8859_16=15]="ISO8859_16",t[t.SJIS=16]="SJIS",t[t.Cp1250=17]="Cp1250",t[t.Cp1251=18]="Cp1251",t[t.Cp1252=19]="Cp1252",t[t.Cp1256=20]="Cp1256",t[t.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",t[t.UTF8=22]="UTF8",t[t.ASCII=23]="ASCII",t[t.Big5=24]="Big5",t[t.GB18030=25]="GB18030",t[t.EUC_KR=26]="EUC_KR"}(A||(A={}));class b{constructor(t,e,r,...n){this.valueIdentifier=t,this.name=r,this.values="number"==typeof e?Int32Array.from([e]):e,this.otherEncodingNames=n,b.VALUE_IDENTIFIER_TO_ECI.set(t,this),b.NAME_TO_ECI.set(r,this);const i=this.values;for(let t=0,e=i.length;t!==e;t++){const e=i[t];b.VALUES_TO_ECI.set(e,this)}for(const t of n)b.NAME_TO_ECI.set(t,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(t){if(t<0||t>=900)throw new C("incorect value");const e=b.VALUES_TO_ECI.get(t);if(void 0===e)throw new C("incorect value");return e}static getCharacterSetECIByName(t){const e=b.NAME_TO_ECI.get(t);if(void 0===e)throw new C("incorect value");return e}equals(t){if(!(t instanceof b))return!1;const e=t;return this.getName()===e.getName()}}b.VALUE_IDENTIFIER_TO_ECI=new Map,b.VALUES_TO_ECI=new Map,b.NAME_TO_ECI=new Map,b.Cp437=new b(A.Cp437,Int32Array.from([0,2]),"Cp437"),b.ISO8859_1=new b(A.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),b.ISO8859_2=new b(A.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),b.ISO8859_3=new b(A.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),b.ISO8859_4=new b(A.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),b.ISO8859_5=new b(A.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),b.ISO8859_6=new b(A.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),b.ISO8859_7=new b(A.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),b.ISO8859_8=new b(A.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),b.ISO8859_9=new b(A.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),b.ISO8859_10=new b(A.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),b.ISO8859_11=new b(A.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),b.ISO8859_13=new b(A.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),b.ISO8859_14=new b(A.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),b.ISO8859_15=new b(A.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),b.ISO8859_16=new b(A.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),b.SJIS=new b(A.SJIS,20,"SJIS","Shift_JIS"),b.Cp1250=new b(A.Cp1250,21,"Cp1250","windows-1250"),b.Cp1251=new b(A.Cp1251,22,"Cp1251","windows-1251"),b.Cp1252=new b(A.Cp1252,23,"Cp1252","windows-1252"),b.Cp1256=new b(A.Cp1256,24,"Cp1256","windows-1256"),b.UnicodeBigUnmarked=new b(A.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),b.UTF8=new b(A.UTF8,26,"UTF8","UTF-8"),b.ASCII=new b(A.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),b.Big5=new b(A.Big5,28,"Big5"),b.GB18030=new b(A.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),b.EUC_KR=new b(A.EUC_KR,30,"EUC_KR","EUC-KR");class I extends u{}class v{static decode(t,e){const r=this.encodingName(e);return this.customDecoder?this.customDecoder(t,r):"undefined"==typeof TextDecoder||this.shouldDecodeOnFallback(r)?this.decodeFallback(t,r):new TextDecoder(r).decode(t)}static shouldDecodeOnFallback(t){return!v.isBrowser()&&"ISO-8859-1"===t}static encode(t,e){const r=this.encodingName(e);return this.customEncoder?this.customEncoder(t,r):"undefined"==typeof TextEncoder?this.encodeFallback(t):(new TextEncoder).encode(t)}static isBrowser(){return"undefined"!=typeof window&&"[object Window]"==={}.toString.call(window)}static encodingName(t){return"string"==typeof t?t:t.getName()}static encodingCharacterSet(t){return t instanceof b?t:b.getCharacterSetECIByName(t)}static decodeFallback(t,e){const r=this.encodingCharacterSet(e);if(v.isDecodeFallbackSupported(r)){let e="";for(let r=0,n=t.length;r<n;r++){let n=t[r].toString(16);n.length<2&&(n="0"+n),e+="%"+n}return decodeURIComponent(e)}if(r.equals(b.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(t.buffer));throw new I(`Encoding ${this.encodingName(e)} not supported by fallback.`)}static isDecodeFallbackSupported(t){return t.equals(b.UTF8)||t.equals(b.ISO8859_1)||t.equals(b.ASCII)}static encodeFallback(t){const e=btoa(unescape(encodeURIComponent(t))).split(""),r=[];for(let t=0;t<e.length;t++)r.push(e[t].charCodeAt(0));return new Uint8Array(r)}}class S{static castAsNonUtf8Char(t,e=null){const r=e?e.getName():this.ISO88591;return v.decode(new Uint8Array([t]),r)}static guessEncoding(t,e){if(null!=e&&void 0!==e.get(y.CHARACTER_SET))return e.get(y.CHARACTER_SET).toString();const r=t.length;let n=!0,i=!0,o=!0,s=0,a=0,u=0,l=0,h=0,c=0,d=0,f=0,g=0,w=0,p=0;const _=t.length>3&&239===t[0]&&187===t[1]&&191===t[2];for(let e=0;e<r&&(n||i||o);e++){const r=255&t[e];o&&(s>0?0==(128&r)?o=!1:s--:0!=(128&r)&&(0==(64&r)?o=!1:(s++,0==(32&r)?a++:(s++,0==(16&r)?u++:(s++,0==(8&r)?l++:o=!1))))),n&&(r>127&&r<160?n=!1:r>159&&(r<192||215===r||247===r)&&p++),i&&(h>0?r<64||127===r||r>252?i=!1:h--:128===r||160===r||r>239?i=!1:r>160&&r<224?(c++,f=0,d++,d>g&&(g=d)):r>127?(h++,d=0,f++,f>w&&(w=f)):(d=0,f=0))}return o&&s>0&&(o=!1),i&&h>0&&(i=!1),o&&(_||a+u+l>0)?S.UTF8:i&&(S.ASSUME_SHIFT_JIS||g>=3||w>=3)?S.SHIFT_JIS:n&&i?2===g&&2===c||10*p>=r?S.SHIFT_JIS:S.ISO88591:n?S.ISO88591:i?S.SHIFT_JIS:o?S.UTF8:S.PLATFORM_DEFAULT_ENCODING}static format(t,...e){let r=-1;function n(t,n,i,o,s,a){if("%%"===t)return"%";if(void 0===e[++r])return;t=o?parseInt(o.substr(1)):void 0;let u,l=s?parseInt(s.substr(1)):void 0;switch(a){case"s":u=e[r];break;case"c":u=e[r][0];break;case"f":u=parseFloat(e[r]).toFixed(t);break;case"p":u=parseFloat(e[r]).toPrecision(t);break;case"e":u=parseFloat(e[r]).toExponential(t);break;case"x":u=parseInt(e[r]).toString(l||16);break;case"d":u=parseFloat(parseInt(e[r],l||10).toPrecision(t)).toFixed(0)}u="object"==typeof u?JSON.stringify(u):(+u).toString(l);let h=parseInt(i),c=i&&i[0]+""=="0"?"0":" ";for(;u.length<h;)u=void 0!==n?u+c:c+u;return u}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(i,n)}static getBytes(t,e){return v.encode(t,e)}static getCharCode(t,e=0){return t.charCodeAt(e)}static getCharAt(t){return String.fromCharCode(t)}}S.SHIFT_JIS=b.SJIS.getName(),S.GB2312="GB2312",S.ISO88591=b.ISO8859_1.getName(),S.EUC_JP="EUC_JP",S.UTF8=b.UTF8.getName(),S.PLATFORM_DEFAULT_ENCODING=S.UTF8,S.ASSUME_SHIFT_JIS=!1;class T{constructor(t=""){this.value=t}enableDecoding(t){return this.encoding=t,this}append(t){return"string"==typeof t?this.value+=t.toString():this.encoding?this.value+=S.castAsNonUtf8Char(t,this.encoding):this.value+=String.fromCharCode(t),this}length(){return this.value.length}charAt(t){return this.value.charAt(t)}deleteCharAt(t){this.value=this.value.substr(0,t)+this.value.substring(t+1)}setCharAt(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+1)}substring(t,e){return this.value.substring(t,e)}setLengthToZero(){this.value=""}toString(){return this.value}insert(t,e){this.value=this.value.substr(0,t)+e+this.value.substr(t+e.length)}}class R{constructor(t,e,r,n){if(this.width=t,this.height=e,this.rowSize=r,this.bits=n,null==e&&(e=t),this.height=e,t<1||e<1)throw new h("Both dimensions must be greater than 0");null==r&&(r=Math.floor((t+31)/32)),this.rowSize=r,null==n&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(t){const e=t.length,r=t[0].length,n=new R(r,e);for(let i=0;i<e;i++){const e=t[i];for(let t=0;t<r;t++)e[t]&&n.set(t,i)}return n}static parseFromString(t,e,r){if(null===t)throw new h("stringRepresentation cannot be null");const n=new Array(t.length);let i=0,o=0,s=-1,a=0,u=0;for(;u<t.length;)if("\n"===t.charAt(u)||"\r"===t.charAt(u)){if(i>o){if(-1===s)s=i-o;else if(i-o!==s)throw new h("row lengths do not match");o=i,a++}u++}else if(t.substring(u,u+e.length)===e)u+=e.length,n[i]=!0,i++;else{if(t.substring(u,u+r.length)!==r)throw new h("illegal character encountered: "+t.substring(u));u+=r.length,n[i]=!1,i++}if(i>o){if(-1===s)s=i-o;else if(i-o!==s)throw new h("row lengths do not match");a++}const l=new R(s,a);for(let t=0;t<i;t++)n[t]&&l.set(Math.floor(t%s),Math.floor(t/s));return l}get(t,e){const r=e*this.rowSize+Math.floor(t/32);return 0!=(this.bits[r]>>>(31&t)&1)}set(t,e){const r=e*this.rowSize+Math.floor(t/32);this.bits[r]|=1<<(31&t)&4294967295}unset(t,e){const r=e*this.rowSize+Math.floor(t/32);this.bits[r]&=~(1<<(31&t)&4294967295)}flip(t,e){const r=e*this.rowSize+Math.floor(t/32);this.bits[r]^=1<<(31&t)&4294967295}xor(t){if(this.width!==t.getWidth()||this.height!==t.getHeight()||this.rowSize!==t.getRowSize())throw new h("input matrix dimensions do not match");const e=new E(Math.floor(this.width/32)+1),r=this.rowSize,n=this.bits;for(let i=0,o=this.height;i<o;i++){const o=i*r,s=t.getRow(i,e).getBitArray();for(let t=0;t<r;t++)n[o+t]^=s[t]}}clear(){const t=this.bits,e=t.length;for(let r=0;r<e;r++)t[r]=0}setRegion(t,e,r,n){if(e<0||t<0)throw new h("Left and top must be nonnegative");if(n<1||r<1)throw new h("Height and width must be at least 1");const i=t+r,o=e+n;if(o>this.height||i>this.width)throw new h("The region must fit inside the matrix");const s=this.rowSize,a=this.bits;for(let r=e;r<o;r++){const e=r*s;for(let r=t;r<i;r++)a[e+Math.floor(r/32)]|=1<<(31&r)&4294967295}}getRow(t,e){null==e||e.getSize()<this.width?e=new E(this.width):e.clear();const r=this.rowSize,n=this.bits,i=t*r;for(let t=0;t<r;t++)e.setBulk(32*t,n[i+t]);return e}setRow(t,e){g.arraycopy(e.getBitArray(),0,this.bits,t*this.rowSize,this.rowSize)}rotate180(){const t=this.getWidth(),e=this.getHeight();let r=new E(t),n=new E(t);for(let t=0,i=Math.floor((e+1)/2);t<i;t++)r=this.getRow(t,r),n=this.getRow(e-1-t,n),r.reverse(),n.reverse(),this.setRow(t,n),this.setRow(e-1-t,r)}getEnclosingRectangle(){const t=this.width,e=this.height,r=this.rowSize,n=this.bits;let i=t,o=e,s=-1,a=-1;for(let t=0;t<e;t++)for(let e=0;e<r;e++){const u=n[t*r+e];if(0!==u){if(t<o&&(o=t),t>a&&(a=t),32*e<i){let t=0;for(;0==(u<<31-t&4294967295);)t++;32*e+t<i&&(i=32*e+t)}if(32*e+31>s){let t=31;for(;u>>>t==0;)t--;32*e+t>s&&(s=32*e+t)}}}return s<i||a<o?null:Int32Array.from([i,o,s-i+1,a-o+1])}getTopLeftOnBit(){const t=this.rowSize,e=this.bits;let r=0;for(;r<e.length&&0===e[r];)r++;if(r===e.length)return null;const n=r/t;let i=r%t*32;const o=e[r];let s=0;for(;0==(o<<31-s&4294967295);)s++;return i+=s,Int32Array.from([i,n])}getBottomRightOnBit(){const t=this.rowSize,e=this.bits;let r=e.length-1;for(;r>=0&&0===e[r];)r--;if(r<0)return null;const n=Math.floor(r/t);let i=32*Math.floor(r%t);const o=e[r];let s=31;for(;o>>>s==0;)s--;return i+=s,Int32Array.from([i,n])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(t){if(!(t instanceof R))return!1;const e=t;return this.width===e.width&&this.height===e.height&&this.rowSize===e.rowSize&&m.equals(this.bits,e.bits)}hashCode(){let t=this.width;return t=31*t+this.width,t=31*t+this.height,t=31*t+this.rowSize,t=31*t+m.hashCode(this.bits),t}toString(t="X ",e="  ",r="\n"){return this.buildToString(t,e,r)}buildToString(t,e,r){let n=new T;for(let i=0,o=this.height;i<o;i++){for(let r=0,o=this.width;r<o;r++)n.append(this.get(r,i)?t:e);n.append(r)}return n.toString()}clone(){return new R(this.width,this.height,this.rowSize,this.bits.slice())}}class N extends u{static getNotFoundInstance(){return new N}}class O extends f{constructor(t){super(t),this.luminances=O.EMPTY,this.buckets=new Int32Array(O.LUMINANCE_BUCKETS)}getBlackRow(t,e){const r=this.getLuminanceSource(),n=r.getWidth();null==e||e.getSize()<n?e=new E(n):e.clear(),this.initArrays(n);const i=r.getRow(t,this.luminances),o=this.buckets;for(let t=0;t<n;t++)o[(255&i[t])>>O.LUMINANCE_SHIFT]++;const s=O.estimateBlackPoint(o);if(n<3)for(let t=0;t<n;t++)(255&i[t])<s&&e.set(t);else{let t=255&i[0],r=255&i[1];for(let o=1;o<n-1;o++){const n=255&i[o+1];(4*r-t-n)/2<s&&e.set(o),t=r,r=n}}return e}getBlackMatrix(){const t=this.getLuminanceSource(),e=t.getWidth(),r=t.getHeight(),n=new R(e,r);this.initArrays(e);const i=this.buckets;for(let n=1;n<5;n++){const o=Math.floor(r*n/5),s=t.getRow(o,this.luminances),a=Math.floor(4*e/5);for(let t=Math.floor(e/5);t<a;t++)i[(255&s[t])>>O.LUMINANCE_SHIFT]++}const o=O.estimateBlackPoint(i),s=t.getMatrix();for(let t=0;t<r;t++){const r=t*e;for(let i=0;i<e;i++)(255&s[r+i])<o&&n.set(i,t)}return n}createBinarizer(t){return new O(t)}initArrays(t){this.luminances.length<t&&(this.luminances=new Uint8ClampedArray(t));const e=this.buckets;for(let t=0;t<O.LUMINANCE_BUCKETS;t++)e[t]=0}static estimateBlackPoint(t){const e=t.length;let r=0,n=0,i=0;for(let o=0;o<e;o++)t[o]>i&&(n=o,i=t[o]),t[o]>r&&(r=t[o]);let o=0,s=0;for(let r=0;r<e;r++){const e=r-n,i=t[r]*e*e;i>s&&(o=r,s=i)}if(n>o){const t=n;n=o,o=t}if(o-n<=e/16)throw new N;let a=o-1,u=-1;for(let e=o-1;e>n;e--){const i=e-n,s=i*i*(o-e)*(r-t[e]);s>u&&(a=e,u=s)}return a<<O.LUMINANCE_SHIFT}}O.LUMINANCE_BITS=5,O.LUMINANCE_SHIFT=8-O.LUMINANCE_BITS,O.LUMINANCE_BUCKETS=1<<O.LUMINANCE_BITS,O.EMPTY=Uint8ClampedArray.from([0]);class D extends O{constructor(t){super(t),this.matrix=null}getBlackMatrix(){if(null!==this.matrix)return this.matrix;const t=this.getLuminanceSource(),e=t.getWidth(),r=t.getHeight();if(e>=D.MINIMUM_DIMENSION&&r>=D.MINIMUM_DIMENSION){const n=t.getMatrix();let i=e>>D.BLOCK_SIZE_POWER;0!=(e&D.BLOCK_SIZE_MASK)&&i++;let o=r>>D.BLOCK_SIZE_POWER;0!=(r&D.BLOCK_SIZE_MASK)&&o++;const s=D.calculateBlackPoints(n,i,o,e,r),a=new R(e,r);D.calculateThresholdForBlock(n,i,o,e,r,s,a),this.matrix=a}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(t){return new D(t)}static calculateThresholdForBlock(t,e,r,n,i,o,s){const a=i-D.BLOCK_SIZE,u=n-D.BLOCK_SIZE;for(let i=0;i<r;i++){let l=i<<D.BLOCK_SIZE_POWER;l>a&&(l=a);const h=D.cap(i,2,r-3);for(let r=0;r<e;r++){let i=r<<D.BLOCK_SIZE_POWER;i>u&&(i=u);const a=D.cap(r,2,e-3);let c=0;for(let t=-2;t<=2;t++){const e=o[h+t];c+=e[a-2]+e[a-1]+e[a]+e[a+1]+e[a+2]}const d=c/25;D.thresholdBlock(t,i,l,d,n,s)}}}static cap(t,e,r){return t<e?e:t>r?r:t}static thresholdBlock(t,e,r,n,i,o){for(let s=0,a=r*i+e;s<D.BLOCK_SIZE;s++,a+=i)for(let i=0;i<D.BLOCK_SIZE;i++)(255&t[a+i])<=n&&o.set(e+i,r+s)}static calculateBlackPoints(t,e,r,n,i){const o=i-D.BLOCK_SIZE,s=n-D.BLOCK_SIZE,a=new Array(r);for(let i=0;i<r;i++){a[i]=new Int32Array(e);let r=i<<D.BLOCK_SIZE_POWER;r>o&&(r=o);for(let o=0;o<e;o++){let e=o<<D.BLOCK_SIZE_POWER;e>s&&(e=s);let u=0,l=255,h=0;for(let i=0,o=r*n+e;i<D.BLOCK_SIZE;i++,o+=n){for(let e=0;e<D.BLOCK_SIZE;e++){const r=255&t[o+e];u+=r,r<l&&(l=r),r>h&&(h=r)}if(h-l>D.MIN_DYNAMIC_RANGE)for(i++,o+=n;i<D.BLOCK_SIZE;i++,o+=n)for(let e=0;e<D.BLOCK_SIZE;e++)u+=255&t[o+e]}let c=u>>2*D.BLOCK_SIZE_POWER;if(h-l<=D.MIN_DYNAMIC_RANGE&&(c=l/2,i>0&&o>0)){const t=(a[i-1][o]+2*a[i][o-1]+a[i-1][o-1])/4;l<t&&(c=t)}a[i][o]=c}}return a}}D.BLOCK_SIZE_POWER=3,D.BLOCK_SIZE=1<<D.BLOCK_SIZE_POWER,D.BLOCK_SIZE_MASK=D.BLOCK_SIZE-1,D.MINIMUM_DIMENSION=5*D.BLOCK_SIZE,D.MIN_DYNAMIC_RANGE=24;class B{constructor(t,e){this.width=t,this.height=e}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(t,e,r,n){throw new I("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new I("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new I("This luminance source does not support rotation by 45 degrees.")}toString(){const t=new Uint8ClampedArray(this.width);let e=new T;for(let r=0;r<this.height;r++){const n=this.getRow(r,t);for(let t=0;t<this.width;t++){const r=255&n[t];let i;i=r<64?"#":r<128?"+":r<192?".":" ",e.append(i)}e.append("\n")}return e.toString()}}class M extends B{constructor(t){super(t.getWidth(),t.getHeight()),this.delegate=t}getRow(t,e){const r=this.delegate.getRow(t,e),n=this.getWidth();for(let t=0;t<n;t++)r[t]=255-(255&r[t]);return r}getMatrix(){const t=this.delegate.getMatrix(),e=this.getWidth()*this.getHeight(),r=new Uint8ClampedArray(e);for(let n=0;n<e;n++)r[n]=255-(255&t[n]);return r}isCropSupported(){return this.delegate.isCropSupported()}crop(t,e,r,n){return new M(this.delegate.crop(t,e,r,n))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new M(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new M(this.delegate.rotateCounterClockwise45())}}class P extends B{constructor(t){super(t.width,t.height),this.canvas=t,this.tempCanvasElement=null,this.buffer=P.makeBufferFromCanvasImageData(t)}static makeBufferFromCanvasImageData(t){const e=t.getContext("2d").getImageData(0,0,t.width,t.height);return P.toGrayscaleBuffer(e.data,t.width,t.height)}static toGrayscaleBuffer(t,e,r){const n=new Uint8ClampedArray(e*r);for(let e=0,r=0,i=t.length;e<i;e+=4,r++){let i;i=0===t[e+3]?255:306*t[e]+601*t[e+1]+117*t[e+2]+512>>10,n[r]=i}return n}getRow(t,e){if(t<0||t>=this.getHeight())throw new h("Requested row is outside the image: "+t);const r=this.getWidth(),n=t*r;return null===e?e=this.buffer.slice(n,n+r):(e.length<r&&(e=new Uint8ClampedArray(r)),e.set(this.buffer.slice(n,n+r))),e}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(t,e,r,n){return super.crop(t,e,r,n),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(null===this.tempCanvasElement){const t=this.canvas.ownerDocument.createElement("canvas");t.width=this.canvas.width,t.height=this.canvas.height,this.tempCanvasElement=t}return this.tempCanvasElement}rotate(t){const e=this.getTempCanvasElement(),r=e.getContext("2d"),n=t*P.DEGREE_TO_RADIANS,i=this.canvas.width,o=this.canvas.height,s=Math.ceil(Math.abs(Math.cos(n))*i+Math.abs(Math.sin(n))*o),a=Math.ceil(Math.abs(Math.sin(n))*i+Math.abs(Math.cos(n))*o);return e.width=s,e.height=a,r.translate(s/2,a/2),r.rotate(n),r.drawImage(this.canvas,i/-2,o/-2),this.buffer=P.makeBufferFromCanvasImageData(e),this}invert(){return new M(this)}}P.DEGREE_TO_RADIANS=Math.PI/180;class k{constructor(t,e,r){this.deviceId=t,this.label=e,this.kind="videoinput",this.groupId=r||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var L,x=(globalThis||t||self||window?(globalThis||t||self||window||void 0).__awaiter:void 0)||function(t,e,r,n){function i(t){return t instanceof r?t:new r((function(e){e(t)}))}return new(r||(r=Promise))((function(r,o){function s(t){try{u(n.next(t))}catch(t){o(t)}}function a(t){try{u(n.throw(t))}catch(t){o(t)}}function u(t){t.done?r(t.value):i(t.value).then(s,a)}u((n=n.apply(t,e||[])).next())}))};class F{constructor(t,e=500,r){this.reader=t,this.timeBetweenScansMillis=e,this._hints=r,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return"undefined"!=typeof navigator}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!(!this.isMediaDevicesSuported||!navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(t){this._timeBetweenDecodingAttempts=t<0?0:t}set hints(t){this._hints=t||null}get hints(){return this._hints}listVideoInputDevices(){return x(this,void 0,void 0,(function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const t=yield navigator.mediaDevices.enumerateDevices(),e=[];for(const r of t){const t="video"===r.kind?"videoinput":r.kind;if("videoinput"!==t)continue;const n={deviceId:r.deviceId||r.id,label:r.label||"Video device "+(e.length+1),kind:t,groupId:r.groupId};e.push(n)}return e}))}getVideoInputDevices(){return x(this,void 0,void 0,(function*(){return(yield this.listVideoInputDevices()).map((t=>new k(t.deviceId,t.label)))}))}findDeviceById(t){return x(this,void 0,void 0,(function*(){const e=yield this.listVideoInputDevices();return e?e.find((e=>e.deviceId===t)):null}))}decodeFromInputVideoDevice(t,e){return x(this,void 0,void 0,(function*(){return yield this.decodeOnceFromVideoDevice(t,e)}))}decodeOnceFromVideoDevice(t,e){return x(this,void 0,void 0,(function*(){let r;this.reset(),r=t?{deviceId:{exact:t}}:{facingMode:"environment"};const n={video:r};return yield this.decodeOnceFromConstraints(n,e)}))}decodeOnceFromConstraints(t,e){return x(this,void 0,void 0,(function*(){const r=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeOnceFromStream(r,e)}))}decodeOnceFromStream(t,e){return x(this,void 0,void 0,(function*(){this.reset();const r=yield this.attachStreamToVideo(t,e);return yield this.decodeOnce(r)}))}decodeFromInputVideoDeviceContinuously(t,e,r){return x(this,void 0,void 0,(function*(){return yield this.decodeFromVideoDevice(t,e,r)}))}decodeFromVideoDevice(t,e,r){return x(this,void 0,void 0,(function*(){let n;n=t?{deviceId:{exact:t}}:{facingMode:"environment"};const i={video:n};return yield this.decodeFromConstraints(i,e,r)}))}decodeFromConstraints(t,e,r){return x(this,void 0,void 0,(function*(){const n=yield navigator.mediaDevices.getUserMedia(t);return yield this.decodeFromStream(n,e,r)}))}decodeFromStream(t,e,r){return x(this,void 0,void 0,(function*(){this.reset();const n=yield this.attachStreamToVideo(t,e);return yield this.decodeContinuously(n,r)}))}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(t,e){return x(this,void 0,void 0,(function*(){const r=this.prepareVideoElement(e);return this.addVideoSource(r,t),this.videoElement=r,this.stream=t,yield this.playVideoOnLoadAsync(r),r}))}playVideoOnLoadAsync(t){return new Promise(((e,r)=>this.playVideoOnLoad(t,(()=>e()))))}playVideoOnLoad(t,e){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(t),t.addEventListener("ended",this.videoEndedListener),t.addEventListener("canplay",this.videoCanPlayListener),t.addEventListener("playing",e),this.tryPlayVideo(t)}isVideoPlaying(t){return t.currentTime>0&&!t.paused&&!t.ended&&t.readyState>2}tryPlayVideo(t){return x(this,void 0,void 0,(function*(){if(this.isVideoPlaying(t))console.warn("Trying to play video that is already playing.");else try{yield t.play()}catch(t){console.warn("It was not possible to play the video.")}}))}getMediaElement(t,e){const r=document.getElementById(t);if(!r)throw new l(`element with id '${t}' not found`);if(r.nodeName.toLowerCase()!==e.toLowerCase())throw new l(`element with id '${t}' must be an ${e} element`);return r}decodeFromImage(t,e){if(!t&&!e)throw new l("either imageElement with a src set or an url must be provided");return e&&!t?this.decodeFromImageUrl(e):this.decodeFromImageElement(t)}decodeFromVideo(t,e){if(!t&&!e)throw new l("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrl(e):this.decodeFromVideoElement(t)}decodeFromVideoContinuously(t,e,r){if(void 0===t&&void 0===e)throw new l("Either an element with a src set or an URL must be provided");return e&&!t?this.decodeFromVideoUrlContinuously(e,r):this.decodeFromVideoElementContinuously(t,r)}decodeFromImageElement(t){if(!t)throw new l("An image element must be provided.");this.reset();const e=this.prepareImageElement(t);let r;return this.imageElement=e,r=this.isImageLoaded(e)?this.decodeOnce(e,!1,!0):this._decodeOnLoadImage(e),r}decodeFromVideoElement(t){const e=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideo(e)}decodeFromVideoElementContinuously(t,e){const r=this._decodeFromVideoElementSetup(t);return this._decodeOnLoadVideoContinuously(r,e)}_decodeFromVideoElementSetup(t){if(!t)throw new l("A video element must be provided.");this.reset();const e=this.prepareVideoElement(t);return this.videoElement=e,e}decodeFromImageUrl(t){if(!t)throw new l("An URL must be provided.");this.reset();const e=this.prepareImageElement();this.imageElement=e;const r=this._decodeOnLoadImage(e);return e.src=t,r}decodeFromVideoUrl(t){if(!t)throw new l("An URL must be provided.");this.reset();const e=this.prepareVideoElement(),r=this.decodeFromVideoElement(e);return e.src=t,r}decodeFromVideoUrlContinuously(t,e){if(!t)throw new l("An URL must be provided.");this.reset();const r=this.prepareVideoElement(),n=this.decodeFromVideoElementContinuously(r,e);return r.src=t,n}_decodeOnLoadImage(t){return new Promise(((e,r)=>{this.imageLoadedListener=()=>this.decodeOnce(t,!1,!0).then(e,r),t.addEventListener("load",this.imageLoadedListener)}))}_decodeOnLoadVideo(t){return x(this,void 0,void 0,(function*(){return yield this.playVideoOnLoadAsync(t),yield this.decodeOnce(t)}))}_decodeOnLoadVideoContinuously(t,e){return x(this,void 0,void 0,(function*(){yield this.playVideoOnLoadAsync(t),this.decodeContinuously(t,e)}))}isImageLoaded(t){return!!t.complete&&0!==t.naturalWidth}prepareImageElement(t){let e;return void 0===t&&(e=document.createElement("img"),e.width=200,e.height=200),"string"==typeof t&&(e=this.getMediaElement(t,"img")),t instanceof HTMLImageElement&&(e=t),e}prepareVideoElement(t){let e;return t||"undefined"==typeof document||(e=document.createElement("video"),e.width=200,e.height=200),"string"==typeof t&&(e=this.getMediaElement(t,"video")),t instanceof HTMLVideoElement&&(e=t),e.setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e}decodeOnce(t,e=!0,r=!0){this._stopAsyncDecode=!1;const n=(i,o)=>{if(this._stopAsyncDecode)return o(new N("Video stream has ended before any code could be detected.")),void(this._stopAsyncDecode=void 0);try{i(this.decode(t))}catch(t){const s=(t instanceof d||t instanceof C)&&r;if(e&&t instanceof N||s)return setTimeout(n,this._timeBetweenDecodingAttempts,i,o);o(t)}};return new Promise(((t,e)=>n(t,e)))}decodeContinuously(t,e){this._stopContinuousDecode=!1;const r=()=>{if(this._stopContinuousDecode)this._stopContinuousDecode=void 0;else try{const n=this.decode(t);e(n,null),setTimeout(r,this.timeBetweenScansMillis)}catch(t){e(null,t);const n=t instanceof N;(t instanceof d||t instanceof C||n)&&setTimeout(r,this._timeBetweenDecodingAttempts)}};r()}decode(t){const e=this.createBinaryBitmap(t);return this.decodeBitmap(e)}createBinaryBitmap(t){const e=this.getCaptureCanvasContext(t);this.drawImageOnCanvas(e,t);const r=this.getCaptureCanvas(t),n=new P(r),i=new D(n);return new c(i)}getCaptureCanvasContext(t){if(!this.captureCanvasContext){const e=this.getCaptureCanvas(t).getContext("2d");this.captureCanvasContext=e}return this.captureCanvasContext}getCaptureCanvas(t){if(!this.captureCanvas){const e=this.createCaptureCanvas(t);this.captureCanvas=e}return this.captureCanvas}drawImageOnCanvas(t,e){t.drawImage(e,0,0)}decodeBitmap(t){return this.reader.decode(t,this._hints)}createCaptureCanvas(t){if("undefined"==typeof document)return this._destroyCaptureCanvas(),null;const e=document.createElement("canvas");let r,n;return void 0!==t&&(t instanceof HTMLVideoElement?(r=t.videoWidth,n=t.videoHeight):t instanceof HTMLImageElement&&(r=t.naturalWidth||t.width,n=t.naturalHeight||t.height)),e.style.width=r+"px",e.style.height=n+"px",e.width=r,e.height=n,e}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach((t=>t.stop())),this.stream=void 0),!1===this._stopAsyncDecode&&this.stopAsyncDecode(),!1===this._stopContinuousDecode&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(void 0!==this.videoEndedListener&&this.videoElement.removeEventListener("ended",this.videoEndedListener),void 0!==this.videoPlayingEventListener&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),void 0!==this.videoCanPlayListener&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(void 0!==this.imageLoadedListener&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(t,e){try{t.srcObject=e}catch(r){t.src=URL.createObjectURL(e)}}cleanVideoSource(t){try{t.srcObject=null}catch(e){t.src=""}this.videoElement.removeAttribute("src")}}class U{constructor(t,e,r=(null==e?0:8*e.length),n,i,o=g.currentTimeMillis()){this.text=t,this.rawBytes=e,this.numBits=r,this.resultPoints=n,this.format=i,this.timestamp=o,this.text=t,this.rawBytes=e,this.numBits=null==r?null==e?0:8*e.length:r,this.resultPoints=n,this.format=i,this.resultMetadata=null,this.timestamp=null==o?g.currentTimeMillis():o}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(t,e){null===this.resultMetadata&&(this.resultMetadata=new Map),this.resultMetadata.set(t,e)}putAllMetadata(t){null!==t&&(null===this.resultMetadata?this.resultMetadata=t:this.resultMetadata=new Map(t))}addResultPoints(t){const e=this.resultPoints;if(null===e)this.resultPoints=t;else if(null!==t&&t.length>0){const r=new Array(e.length+t.length);g.arraycopy(e,0,r,0,e.length),g.arraycopy(t,0,r,e.length,t.length),this.resultPoints=r}}getTimestamp(){return this.timestamp}toString(){return this.text}}!function(t){t[t.AZTEC=0]="AZTEC",t[t.CODABAR=1]="CODABAR",t[t.CODE_39=2]="CODE_39",t[t.CODE_93=3]="CODE_93",t[t.CODE_128=4]="CODE_128",t[t.DATA_MATRIX=5]="DATA_MATRIX",t[t.EAN_8=6]="EAN_8",t[t.EAN_13=7]="EAN_13",t[t.ITF=8]="ITF",t[t.MAXICODE=9]="MAXICODE",t[t.PDF_417=10]="PDF_417",t[t.QR_CODE=11]="QR_CODE",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"}(L||(L={}));var V,H=L;!function(t){t[t.OTHER=0]="OTHER",t[t.ORIENTATION=1]="ORIENTATION",t[t.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",t[t.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",t[t.ISSUE_NUMBER=4]="ISSUE_NUMBER",t[t.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",t[t.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",t[t.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",t[t.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",t[t.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",t[t.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"}(V||(V={}));var z,G,X,W,Y,K,Z=V;class j{constructor(t,e,r,n,i=-1,o=-1){this.rawBytes=t,this.text=e,this.byteSegments=r,this.ecLevel=n,this.structuredAppendSequenceNumber=i,this.structuredAppendParity=o,this.numBits=null==t?0:8*t.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(t){this.numBits=t}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(t){this.errorsCorrected=t}getErasures(){return this.erasures}setErasures(t){this.erasures=t}getOther(){return this.other}setOther(t){this.other=t}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class q{exp(t){return this.expTable[t]}log(t){if(0===t)throw new h;return this.logTable[t]}static addOrSubtract(t,e){return t^e}}class Q{constructor(t,e){if(0===e.length)throw new h;this.field=t;const r=e.length;if(r>1&&0===e[0]){let t=1;for(;t<r&&0===e[t];)t++;t===r?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(r-t),g.arraycopy(e,t,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(0===t)return this.getCoefficient(0);const e=this.coefficients;let r;if(1===t){r=0;for(let t=0,n=e.length;t!==n;t++){const n=e[t];r=q.addOrSubtract(r,n)}return r}r=e[0];const n=e.length,i=this.field;for(let o=1;o<n;o++)r=q.addOrSubtract(i.multiply(t,r),e[o]);return r}addOrSubtract(t){if(!this.field.equals(t.field))throw new h("GenericGFPolys do not have same GenericGF field");if(this.isZero())return t;if(t.isZero())return this;let e=this.coefficients,r=t.coefficients;if(e.length>r.length){const t=e;e=r,r=t}let n=new Int32Array(r.length);const i=r.length-e.length;g.arraycopy(r,0,n,0,i);for(let t=i;t<r.length;t++)n[t]=q.addOrSubtract(e[t-i],r[t]);return new Q(this.field,n)}multiply(t){if(!this.field.equals(t.field))throw new h("GenericGFPolys do not have same GenericGF field");if(this.isZero()||t.isZero())return this.field.getZero();const e=this.coefficients,r=e.length,n=t.coefficients,i=n.length,o=new Int32Array(r+i-1),s=this.field;for(let t=0;t<r;t++){const r=e[t];for(let e=0;e<i;e++)o[t+e]=q.addOrSubtract(o[t+e],s.multiply(r,n[e]))}return new Q(s,o)}multiplyScalar(t){if(0===t)return this.field.getZero();if(1===t)return this;const e=this.coefficients.length,r=this.field,n=new Int32Array(e),i=this.coefficients;for(let o=0;o<e;o++)n[o]=r.multiply(i[o],t);return new Q(r,n)}multiplyByMonomial(t,e){if(t<0)throw new h;if(0===e)return this.field.getZero();const r=this.coefficients,n=r.length,i=new Int32Array(n+t),o=this.field;for(let t=0;t<n;t++)i[t]=o.multiply(r[t],e);return new Q(o,i)}divide(t){if(!this.field.equals(t.field))throw new h("GenericGFPolys do not have same GenericGF field");if(t.isZero())throw new h("Divide by 0");const e=this.field;let r=e.getZero(),n=this;const i=t.getCoefficient(t.getDegree()),o=e.inverse(i);for(;n.getDegree()>=t.getDegree()&&!n.isZero();){const i=n.getDegree()-t.getDegree(),s=e.multiply(n.getCoefficient(n.getDegree()),o),a=t.multiplyByMonomial(i,s),u=e.buildMonomial(i,s);r=r.addOrSubtract(u),n=n.addOrSubtract(a)}return[r,n]}toString(){let t="";for(let e=this.getDegree();e>=0;e--){let r=this.getCoefficient(e);if(0!==r){if(r<0?(t+=" - ",r=-r):t.length>0&&(t+=" + "),0===e||1!==r){const e=this.field.log(r);0===e?t+="1":1===e?t+="a":(t+="a^",t+=e)}0!==e&&(1===e?t+="x":(t+="x^",t+=e))}}return t}}class J extends u{}class $ extends q{constructor(t,e,r){super(),this.primitive=t,this.size=e,this.generatorBase=r;const n=new Int32Array(e);let i=1;for(let r=0;r<e;r++)n[r]=i,i*=2,i>=e&&(i^=t,i&=e-1);this.expTable=n;const o=new Int32Array(e);for(let t=0;t<e-1;t++)o[n[t]]=t;this.logTable=o,this.zero=new Q(this,Int32Array.from([0])),this.one=new Q(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,e){if(t<0)throw new h;if(0===e)return this.zero;const r=new Int32Array(t+1);return r[0]=e,new Q(this,r)}inverse(t){if(0===t)throw new J;return this.expTable[this.size-this.logTable[t]-1]}multiply(t,e){return 0===t||0===e?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+w.toHexString(this.primitive)+","+this.size+")"}equals(t){return t===this}}$.AZTEC_DATA_12=new $(4201,4096,1),$.AZTEC_DATA_10=new $(1033,1024,1),$.AZTEC_DATA_6=new $(67,64,1),$.AZTEC_PARAM=new $(19,16,1),$.QR_CODE_FIELD_256=new $(285,256,0),$.DATA_MATRIX_FIELD_256=new $(301,256,1),$.AZTEC_DATA_8=$.DATA_MATRIX_FIELD_256,$.MAXICODE_FIELD_64=$.AZTEC_DATA_6;class tt extends u{}class et extends u{}class rt{constructor(t){this.field=t}decode(t,e){const r=this.field,n=new Q(r,t),i=new Int32Array(e);let o=!0;for(let t=0;t<e;t++){const e=n.evaluateAt(r.exp(t+r.getGeneratorBase()));i[i.length-1-t]=e,0!==e&&(o=!1)}if(o)return;const s=new Q(r,i),a=this.runEuclideanAlgorithm(r.buildMonomial(e,1),s,e),u=a[0],l=a[1],h=this.findErrorLocations(u),c=this.findErrorMagnitudes(l,h);for(let e=0;e<h.length;e++){const n=t.length-1-r.log(h[e]);if(n<0)throw new tt("Bad error location");t[n]=$.addOrSubtract(t[n],c[e])}}runEuclideanAlgorithm(t,e,r){if(t.getDegree()<e.getDegree()){const r=t;t=e,e=r}const n=this.field;let i=t,o=e,s=n.getZero(),a=n.getOne();for(;o.getDegree()>=(r/2|0);){let t=i,e=s;if(i=o,s=a,i.isZero())throw new tt("r_{i-1} was zero");o=t;let r=n.getZero();const u=i.getCoefficient(i.getDegree()),l=n.inverse(u);for(;o.getDegree()>=i.getDegree()&&!o.isZero();){const t=o.getDegree()-i.getDegree(),e=n.multiply(o.getCoefficient(o.getDegree()),l);r=r.addOrSubtract(n.buildMonomial(t,e)),o=o.addOrSubtract(i.multiplyByMonomial(t,e))}if(a=r.multiply(s).addOrSubtract(e),o.getDegree()>=i.getDegree())throw new et("Division algorithm failed to reduce polynomial?")}const u=a.getCoefficient(0);if(0===u)throw new tt("sigmaTilde(0) was zero");const l=n.inverse(u);return[a.multiplyScalar(l),o.multiplyScalar(l)]}findErrorLocations(t){const e=t.getDegree();if(1===e)return Int32Array.from([t.getCoefficient(1)]);const r=new Int32Array(e);let n=0;const i=this.field;for(let o=1;o<i.getSize()&&n<e;o++)0===t.evaluateAt(o)&&(r[n]=i.inverse(o),n++);if(n!==e)throw new tt("Error locator degree does not match number of roots");return r}findErrorMagnitudes(t,e){const r=e.length,n=new Int32Array(r),i=this.field;for(let o=0;o<r;o++){const s=i.inverse(e[o]);let a=1;for(let t=0;t<r;t++)if(o!==t){const r=i.multiply(e[t],s),n=0==(1&r)?1|r:-2&r;a=i.multiply(a,n)}n[o]=i.multiply(t.evaluateAt(s),i.inverse(a)),0!==i.getGeneratorBase()&&(n[o]=i.multiply(n[o],s))}return n}}!function(t){t[t.UPPER=0]="UPPER",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.DIGIT=3]="DIGIT",t[t.PUNCT=4]="PUNCT",t[t.BINARY=5]="BINARY"}(z||(z={}));class nt{decode(t){this.ddata=t;let e=t.getBits(),r=this.extractBits(e),n=this.correctBits(r),i=nt.convertBoolArrayToByteArray(n),o=nt.getEncodedData(n),s=new j(i,o,null,null);return s.setNumBits(n.length),s}static highLevelDecode(t){return this.getEncodedData(t)}static getEncodedData(t){let e=t.length,r=z.UPPER,n=z.UPPER,i="",o=0;for(;o<e;)if(n===z.BINARY){if(e-o<5)break;let s=nt.readCode(t,o,5);if(o+=5,0===s){if(e-o<11)break;s=nt.readCode(t,o,11)+31,o+=11}for(let r=0;r<s;r++){if(e-o<8){o=e;break}const r=nt.readCode(t,o,8);i+=S.castAsNonUtf8Char(r),o+=8}n=r}else{let s=n===z.DIGIT?4:5;if(e-o<s)break;let a=nt.readCode(t,o,s);o+=s;let u=nt.getCharacter(n,a);u.startsWith("CTRL_")?(r=n,n=nt.getTable(u.charAt(5)),"L"===u.charAt(6)&&(r=n)):(i+=u,n=r)}return i}static getTable(t){switch(t){case"L":return z.LOWER;case"P":return z.PUNCT;case"M":return z.MIXED;case"D":return z.DIGIT;case"B":return z.BINARY;case"U":default:return z.UPPER}}static getCharacter(t,e){switch(t){case z.UPPER:return nt.UPPER_TABLE[e];case z.LOWER:return nt.LOWER_TABLE[e];case z.MIXED:return nt.MIXED_TABLE[e];case z.PUNCT:return nt.PUNCT_TABLE[e];case z.DIGIT:return nt.DIGIT_TABLE[e];default:throw new et("Bad table")}}correctBits(t){let e,r;this.ddata.getNbLayers()<=2?(r=6,e=$.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(r=8,e=$.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(r=10,e=$.AZTEC_DATA_10):(r=12,e=$.AZTEC_DATA_12);let n=this.ddata.getNbDatablocks(),i=t.length/r;if(i<n)throw new C;let o=t.length%r,s=new Int32Array(i);for(let e=0;e<i;e++,o+=r)s[e]=nt.readCode(t,o,r);try{new rt(e).decode(s,i-n)}catch(t){throw new C(t)}let a=(1<<r)-1,u=0;for(let t=0;t<n;t++){let e=s[t];if(0===e||e===a)throw new C;1!==e&&e!==a-1||u++}let l=new Array(n*r-u),h=0;for(let t=0;t<n;t++){let e=s[t];if(1===e||e===a-1)l.fill(e>1,h,h+r-1),h+=r-1;else for(let t=r-1;t>=0;--t)l[h++]=0!=(e&1<<t)}return l}extractBits(t){let e=this.ddata.isCompact(),r=this.ddata.getNbLayers(),n=(e?11:14)+4*r,i=new Int32Array(n),o=new Array(this.totalBitsInLayer(r,e));if(e)for(let t=0;t<i.length;t++)i[t]=t;else{let t=n+1+2*w.truncDivision(w.truncDivision(n,2)-1,15),e=n/2,r=w.truncDivision(t,2);for(let t=0;t<e;t++){let n=t+w.truncDivision(t,15);i[e-t-1]=r-n-1,i[e+t]=r+n+1}}for(let s=0,a=0;s<r;s++){let u=4*(r-s)+(e?9:12),l=2*s,h=n-1-l;for(let e=0;e<u;e++){let r=2*e;for(let n=0;n<2;n++)o[a+r+n]=t.get(i[l+n],i[l+e]),o[a+2*u+r+n]=t.get(i[l+e],i[h-n]),o[a+4*u+r+n]=t.get(i[h-n],i[h-e]),o[a+6*u+r+n]=t.get(i[h-e],i[l+n])}a+=8*u}return o}static readCode(t,e,r){let n=0;for(let i=e;i<e+r;i++)n<<=1,t[i]&&(n|=1);return n}static readByte(t,e){let r=t.length-e;return r>=8?nt.readCode(t,e,8):nt.readCode(t,e,r)<<8-r}static convertBoolArrayToByteArray(t){let e=new Uint8Array((t.length+7)/8);for(let r=0;r<e.length;r++)e[r]=nt.readByte(t,8*r);return e}totalBitsInLayer(t,e){return((e?88:112)+16*t)*t}}nt.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],nt.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],nt.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","\t","\n","\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],nt.PUNCT_TABLE=["","\r","\r\n",". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],nt.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class it{MathUtils(){}static round(t){return NaN===t?0:t<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:t>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t+(t<0?-.5:.5)|0}static distance(t,e,r,n){const i=t-r,o=e-n;return Math.sqrt(i*i+o*o)}static sum(t){let e=0;for(let r=0,n=t.length;r!==n;r++)e+=t[r];return e}}class ot{static floatToIntBits(t){return t}}ot.MAX_VALUE=Number.MAX_SAFE_INTEGER;class st{constructor(t,e){this.x=t,this.y=e}getX(){return this.x}getY(){return this.y}equals(t){if(t instanceof st){const e=t;return this.x===e.x&&this.y===e.y}return!1}hashCode(){return 31*ot.floatToIntBits(this.x)+ot.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(t){const e=this.distance(t[0],t[1]),r=this.distance(t[1],t[2]),n=this.distance(t[0],t[2]);let i,o,s;if(r>=e&&r>=n?(o=t[0],i=t[1],s=t[2]):n>=r&&n>=e?(o=t[1],i=t[0],s=t[2]):(o=t[2],i=t[0],s=t[1]),this.crossProductZ(i,o,s)<0){const t=i;i=s,s=t}t[0]=i,t[1]=o,t[2]=s}static distance(t,e){return it.distance(t.x,t.y,e.x,e.y)}static crossProductZ(t,e,r){const n=e.x,i=e.y;return(r.x-n)*(t.y-i)-(r.y-i)*(t.x-n)}}class at{constructor(t,e){this.bits=t,this.points=e}getBits(){return this.bits}getPoints(){return this.points}}class ut extends at{constructor(t,e,r,n,i){super(t,e),this.compact=r,this.nbDatablocks=n,this.nbLayers=i}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class lt{constructor(t,e,r,n){this.image=t,this.height=t.getHeight(),this.width=t.getWidth(),null==e&&(e=lt.INIT_SIZE),null==r&&(r=t.getWidth()/2|0),null==n&&(n=t.getHeight()/2|0);const i=e/2|0;if(this.leftInit=r-i,this.rightInit=r+i,this.upInit=n-i,this.downInit=n+i,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new N}detect(){let t=this.leftInit,e=this.rightInit,r=this.upInit,n=this.downInit,i=!1,o=!0,s=!1,a=!1,u=!1,l=!1,h=!1;const c=this.width,d=this.height;for(;o;){o=!1;let f=!0;for(;(f||!a)&&e<c;)f=this.containsBlackPoint(r,n,e,!1),f?(e++,o=!0,a=!0):a||e++;if(e>=c){i=!0;break}let g=!0;for(;(g||!u)&&n<d;)g=this.containsBlackPoint(t,e,n,!0),g?(n++,o=!0,u=!0):u||n++;if(n>=d){i=!0;break}let w=!0;for(;(w||!l)&&t>=0;)w=this.containsBlackPoint(r,n,t,!1),w?(t--,o=!0,l=!0):l||t--;if(t<0){i=!0;break}let p=!0;for(;(p||!h)&&r>=0;)p=this.containsBlackPoint(t,e,r,!0),p?(r--,o=!0,h=!0):h||r--;if(r<0){i=!0;break}o&&(s=!0)}if(!i&&s){const i=e-t;let o=null;for(let e=1;null===o&&e<i;e++)o=this.getBlackPointOnSegment(t,n-e,t+e,n);if(null==o)throw new N;let s=null;for(let e=1;null===s&&e<i;e++)s=this.getBlackPointOnSegment(t,r+e,t+e,r);if(null==s)throw new N;let a=null;for(let t=1;null===a&&t<i;t++)a=this.getBlackPointOnSegment(e,r+t,e-t,r);if(null==a)throw new N;let u=null;for(let t=1;null===u&&t<i;t++)u=this.getBlackPointOnSegment(e,n-t,e-t,n);if(null==u)throw new N;return this.centerEdges(u,o,a,s)}throw new N}getBlackPointOnSegment(t,e,r,n){const i=it.round(it.distance(t,e,r,n)),o=(r-t)/i,s=(n-e)/i,a=this.image;for(let r=0;r<i;r++){const n=it.round(t+r*o),i=it.round(e+r*s);if(a.get(n,i))return new st(n,i)}return null}centerEdges(t,e,r,n){const i=t.getX(),o=t.getY(),s=e.getX(),a=e.getY(),u=r.getX(),l=r.getY(),h=n.getX(),c=n.getY(),d=lt.CORR;return i<this.width/2?[new st(h-d,c+d),new st(s+d,a+d),new st(u-d,l-d),new st(i+d,o-d)]:[new st(h+d,c+d),new st(s+d,a-d),new st(u-d,l+d),new st(i-d,o-d)]}containsBlackPoint(t,e,r,n){const i=this.image;if(n){for(let n=t;n<=e;n++)if(i.get(n,r))return!0}else for(let n=t;n<=e;n++)if(i.get(r,n))return!0;return!1}}lt.INIT_SIZE=10,lt.CORR=1;class ht{static checkAndNudgePoints(t,e){const r=t.getWidth(),n=t.getHeight();let i=!0;for(let t=0;t<e.length&&i;t+=2){const o=Math.floor(e[t]),s=Math.floor(e[t+1]);if(o<-1||o>r||s<-1||s>n)throw new N;i=!1,-1===o?(e[t]=0,i=!0):o===r&&(e[t]=r-1,i=!0),-1===s?(e[t+1]=0,i=!0):s===n&&(e[t+1]=n-1,i=!0)}i=!0;for(let t=e.length-2;t>=0&&i;t-=2){const o=Math.floor(e[t]),s=Math.floor(e[t+1]);if(o<-1||o>r||s<-1||s>n)throw new N;i=!1,-1===o?(e[t]=0,i=!0):o===r&&(e[t]=r-1,i=!0),-1===s?(e[t+1]=0,i=!0):s===n&&(e[t+1]=n-1,i=!0)}}}class ct{constructor(t,e,r,n,i,o,s,a,u){this.a11=t,this.a21=e,this.a31=r,this.a12=n,this.a22=i,this.a32=o,this.a13=s,this.a23=a,this.a33=u}static quadrilateralToQuadrilateral(t,e,r,n,i,o,s,a,u,l,h,c,d,f,g,w){const p=ct.quadrilateralToSquare(t,e,r,n,i,o,s,a);return ct.squareToQuadrilateral(u,l,h,c,d,f,g,w).times(p)}transformPoints(t){const e=t.length,r=this.a11,n=this.a12,i=this.a13,o=this.a21,s=this.a22,a=this.a23,u=this.a31,l=this.a32,h=this.a33;for(let c=0;c<e;c+=2){const e=t[c],d=t[c+1],f=i*e+a*d+h;t[c]=(r*e+o*d+u)/f,t[c+1]=(n*e+s*d+l)/f}}transformPointsWithValues(t,e){const r=this.a11,n=this.a12,i=this.a13,o=this.a21,s=this.a22,a=this.a23,u=this.a31,l=this.a32,h=this.a33,c=t.length;for(let d=0;d<c;d++){const c=t[d],f=e[d],g=i*c+a*f+h;t[d]=(r*c+o*f+u)/g,e[d]=(n*c+s*f+l)/g}}static squareToQuadrilateral(t,e,r,n,i,o,s,a){const u=t-r+i-s,l=e-n+o-a;if(0===u&&0===l)return new ct(r-t,i-r,t,n-e,o-n,e,0,0,1);{const h=r-i,c=s-i,d=n-o,f=a-o,g=h*f-c*d,w=(u*f-c*l)/g,p=(h*l-u*d)/g;return new ct(r-t+w*r,s-t+p*s,t,n-e+w*n,a-e+p*a,e,w,p,1)}}static quadrilateralToSquare(t,e,r,n,i,o,s,a){return ct.squareToQuadrilateral(t,e,r,n,i,o,s,a).buildAdjoint()}buildAdjoint(){return new ct(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(t){return new ct(this.a11*t.a11+this.a21*t.a12+this.a31*t.a13,this.a11*t.a21+this.a21*t.a22+this.a31*t.a23,this.a11*t.a31+this.a21*t.a32+this.a31*t.a33,this.a12*t.a11+this.a22*t.a12+this.a32*t.a13,this.a12*t.a21+this.a22*t.a22+this.a32*t.a23,this.a12*t.a31+this.a22*t.a32+this.a32*t.a33,this.a13*t.a11+this.a23*t.a12+this.a33*t.a13,this.a13*t.a21+this.a23*t.a22+this.a33*t.a23,this.a13*t.a31+this.a23*t.a32+this.a33*t.a33)}}class dt extends ht{sampleGrid(t,e,r,n,i,o,s,a,u,l,h,c,d,f,g,w,p,_,m){const E=ct.quadrilateralToQuadrilateral(n,i,o,s,a,u,l,h,c,d,f,g,w,p,_,m);return this.sampleGridWithTransform(t,e,r,E)}sampleGridWithTransform(t,e,r,n){if(e<=0||r<=0)throw new N;const i=new R(e,r),o=new Float32Array(2*e);for(let e=0;e<r;e++){const r=o.length,s=e+.5;for(let t=0;t<r;t+=2)o[t]=t/2+.5,o[t+1]=s;n.transformPoints(o),ht.checkAndNudgePoints(t,o);try{for(let n=0;n<r;n+=2)t.get(Math.floor(o[n]),Math.floor(o[n+1]))&&i.set(n/2,e)}catch(t){throw new N}}return i}}class ft{static setGridSampler(t){ft.gridSampler=t}static getInstance(){return ft.gridSampler}}ft.gridSampler=new dt;class gt{constructor(t,e){this.x=t,this.y=e}toResultPoint(){return new st(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class wt{constructor(t){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=t}detect(){return this.detectMirror(!1)}detectMirror(t){let e=this.getMatrixCenter(),r=this.getBullsEyeCorners(e);if(t){let t=r[0];r[0]=r[2],r[2]=t}this.extractParameters(r);let n=this.sampleGrid(this.image,r[this.shift%4],r[(this.shift+1)%4],r[(this.shift+2)%4],r[(this.shift+3)%4]),i=this.getMatrixCornerPoints(r);return new ut(n,i,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(t){if(!(this.isValidPoint(t[0])&&this.isValidPoint(t[1])&&this.isValidPoint(t[2])&&this.isValidPoint(t[3])))throw new N;let e=2*this.nbCenterLayers,r=new Int32Array([this.sampleLine(t[0],t[1],e),this.sampleLine(t[1],t[2],e),this.sampleLine(t[2],t[3],e),this.sampleLine(t[3],t[0],e)]);this.shift=this.getRotation(r,e);let n=0;for(let t=0;t<4;t++){let e=r[(this.shift+t)%4];this.compact?(n<<=7,n+=e>>1&127):(n<<=10,n+=(e>>2&992)+(e>>1&31))}let i=this.getCorrectedParameterData(n,this.compact);this.compact?(this.nbLayers=1+(i>>6),this.nbDataBlocks=1+(63&i)):(this.nbLayers=1+(i>>11),this.nbDataBlocks=1+(2047&i))}getRotation(t,e){let r=0;t.forEach(((t,n,i)=>{r=(t>>e-2<<1)+(1&t)+(r<<3)})),r=((1&r)<<11)+(r>>1);for(let t=0;t<4;t++)if(w.bitCount(r^this.EXPECTED_CORNER_BITS[t])<=2)return t;throw new N}getCorrectedParameterData(t,e){let r,n;e?(r=7,n=2):(r=10,n=4);let i=r-n,o=new Int32Array(r);for(let e=r-1;e>=0;--e)o[e]=15&t,t>>=4;try{new rt($.AZTEC_PARAM).decode(o,i)}catch(t){throw new N}let s=0;for(let t=0;t<n;t++)s=(s<<4)+o[t];return s}getBullsEyeCorners(t){let e=t,r=t,n=t,i=t,o=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let t=this.getFirstDifferent(e,o,1,-1),s=this.getFirstDifferent(r,o,1,1),a=this.getFirstDifferent(n,o,-1,1),u=this.getFirstDifferent(i,o,-1,-1);if(this.nbCenterLayers>2){let r=this.distancePoint(u,t)*this.nbCenterLayers/(this.distancePoint(i,e)*(this.nbCenterLayers+2));if(r<.75||r>1.25||!this.isWhiteOrBlackRectangle(t,s,a,u))break}e=t,r=s,n=a,i=u,o=!o}if(5!==this.nbCenterLayers&&7!==this.nbCenterLayers)throw new N;this.compact=5===this.nbCenterLayers;let s=new st(e.getX()+.5,e.getY()-.5),a=new st(r.getX()+.5,r.getY()+.5),u=new st(n.getX()-.5,n.getY()+.5),l=new st(i.getX()-.5,i.getY()-.5);return this.expandSquare([s,a,u,l],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let t,e,r,n;try{let i=new lt(this.image).detect();t=i[0],e=i[1],r=i[2],n=i[3]}catch(i){let o=this.image.getWidth()/2,s=this.image.getHeight()/2;t=this.getFirstDifferent(new gt(o+7,s-7),!1,1,-1).toResultPoint(),e=this.getFirstDifferent(new gt(o+7,s+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new gt(o-7,s+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new gt(o-7,s-7),!1,-1,-1).toResultPoint()}let i=it.round((t.getX()+n.getX()+e.getX()+r.getX())/4),o=it.round((t.getY()+n.getY()+e.getY()+r.getY())/4);try{let s=new lt(this.image,15,i,o).detect();t=s[0],e=s[1],r=s[2],n=s[3]}catch(s){t=this.getFirstDifferent(new gt(i+7,o-7),!1,1,-1).toResultPoint(),e=this.getFirstDifferent(new gt(i+7,o+7),!1,1,1).toResultPoint(),r=this.getFirstDifferent(new gt(i-7,o+7),!1,-1,1).toResultPoint(),n=this.getFirstDifferent(new gt(i-7,o-7),!1,-1,-1).toResultPoint()}return i=it.round((t.getX()+n.getX()+e.getX()+r.getX())/4),o=it.round((t.getY()+n.getY()+e.getY()+r.getY())/4),new gt(i,o)}getMatrixCornerPoints(t){return this.expandSquare(t,2*this.nbCenterLayers,this.getDimension())}sampleGrid(t,e,r,n,i){let o=ft.getInstance(),s=this.getDimension(),a=s/2-this.nbCenterLayers,u=s/2+this.nbCenterLayers;return o.sampleGrid(t,s,s,a,a,u,a,u,u,a,u,e.getX(),e.getY(),r.getX(),r.getY(),n.getX(),n.getY(),i.getX(),i.getY())}sampleLine(t,e,r){let n=0,i=this.distanceResultPoint(t,e),o=i/r,s=t.getX(),a=t.getY(),u=o*(e.getX()-t.getX())/i,l=o*(e.getY()-t.getY())/i;for(let t=0;t<r;t++)this.image.get(it.round(s+t*u),it.round(a+t*l))&&(n|=1<<r-t-1);return n}isWhiteOrBlackRectangle(t,e,r,n){let i=3;t=new gt(t.getX()-i,t.getY()+i),e=new gt(e.getX()-i,e.getY()-i),r=new gt(r.getX()+i,r.getY()-i),n=new gt(n.getX()+i,n.getY()+i);let o=this.getColor(n,t);if(0===o)return!1;let s=this.getColor(t,e);return s===o&&(s=this.getColor(e,r),s===o&&(s=this.getColor(r,n),s===o))}getColor(t,e){let r=this.distancePoint(t,e),n=(e.getX()-t.getX())/r,i=(e.getY()-t.getY())/r,o=0,s=t.getX(),a=t.getY(),u=this.image.get(t.getX(),t.getY()),l=Math.ceil(r);for(let t=0;t<l;t++)s+=n,a+=i,this.image.get(it.round(s),it.round(a))!==u&&o++;let h=o/r;return h>.1&&h<.9?0:h<=.1===u?1:-1}getFirstDifferent(t,e,r,n){let i=t.getX()+r,o=t.getY()+n;for(;this.isValid(i,o)&&this.image.get(i,o)===e;)i+=r,o+=n;for(i-=r,o-=n;this.isValid(i,o)&&this.image.get(i,o)===e;)i+=r;for(i-=r;this.isValid(i,o)&&this.image.get(i,o)===e;)o+=n;return o-=n,new gt(i,o)}expandSquare(t,e,r){let n=r/(2*e),i=t[0].getX()-t[2].getX(),o=t[0].getY()-t[2].getY(),s=(t[0].getX()+t[2].getX())/2,a=(t[0].getY()+t[2].getY())/2,u=new st(s+n*i,a+n*o),l=new st(s-n*i,a-n*o);return i=t[1].getX()-t[3].getX(),o=t[1].getY()-t[3].getY(),s=(t[1].getX()+t[3].getX())/2,a=(t[1].getY()+t[3].getY())/2,[u,new st(s+n*i,a+n*o),l,new st(s-n*i,a-n*o)]}isValid(t,e){return t>=0&&t<this.image.getWidth()&&e>0&&e<this.image.getHeight()}isValidPoint(t){let e=it.round(t.getX()),r=it.round(t.getY());return this.isValid(e,r)}distancePoint(t,e){return it.distance(t.getX(),t.getY(),e.getX(),e.getY())}distanceResultPoint(t,e){return it.distance(t.getX(),t.getY(),e.getX(),e.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(w.truncDivision(this.nbLayers-4,8)+1)+15}}class pt{decode(t,e=null){let r=null,n=new wt(t.getBlackMatrix()),i=null,o=null;try{let t=n.detectMirror(!1);i=t.getPoints(),this.reportFoundResultPoints(e,i),o=(new nt).decode(t)}catch(t){r=t}if(null==o)try{let t=n.detectMirror(!0);i=t.getPoints(),this.reportFoundResultPoints(e,i),o=(new nt).decode(t)}catch(t){if(null!=r)throw r;throw t}let s=new U(o.getText(),o.getRawBytes(),o.getNumBits(),i,H.AZTEC,g.currentTimeMillis()),a=o.getByteSegments();null!=a&&s.putMetadata(Z.BYTE_SEGMENTS,a);let u=o.getECLevel();return null!=u&&s.putMetadata(Z.ERROR_CORRECTION_LEVEL,u),s}reportFoundResultPoints(t,e){if(null!=t){let r=t.get(y.NEED_RESULT_POINT_CALLBACK);null!=r&&e.forEach(((t,e,n)=>{r.foundPossibleResultPoint(t)}))}}reset(){}}class _t extends F{constructor(t=500){super(new pt,t)}}class mt{decode(t,e){try{return this.doDecode(t,e)}catch(r){if(e&&!0===e.get(y.TRY_HARDER)&&t.isRotateSupported()){const r=t.rotateCounterClockwise(),n=this.doDecode(r,e),i=n.getResultMetadata();let o=270;null!==i&&!0===i.get(Z.ORIENTATION)&&(o+=i.get(Z.ORIENTATION)%360),n.putMetadata(Z.ORIENTATION,o);const s=n.getResultPoints();if(null!==s){const t=r.getHeight();for(let e=0;e<s.length;e++)s[e]=new st(t-s[e].getY()-1,s[e].getX())}return n}throw new N}}reset(){}doDecode(t,e){const r=t.getWidth(),n=t.getHeight();let i=new E(r);const o=e&&!0===e.get(y.TRY_HARDER),s=Math.max(1,n>>(o?8:5));let a;a=o?n:15;const u=Math.trunc(n/2);for(let o=0;o<a;o++){const a=Math.trunc((o+1)/2),l=u+s*(0==(1&o)?a:-a);if(l<0||l>=n)break;try{i=t.getBlackRow(l,i)}catch(t){continue}for(let t=0;t<2;t++){if(1===t&&(i.reverse(),e&&!0===e.get(y.NEED_RESULT_POINT_CALLBACK))){const t=new Map;e.forEach(((e,r)=>t.set(r,e))),t.delete(y.NEED_RESULT_POINT_CALLBACK),e=t}try{const n=this.decodeRow(l,i,e);if(1===t){n.putMetadata(Z.ORIENTATION,180);const t=n.getResultPoints();null!==t&&(t[0]=new st(r-t[0].getX()-1,t[0].getY()),t[1]=new st(r-t[1].getX()-1,t[1].getY()))}return n}catch(t){}}}throw new N}static recordPattern(t,e,r){const n=r.length;for(let t=0;t<n;t++)r[t]=0;const i=t.getSize();if(e>=i)throw new N;let o=!t.get(e),s=0,a=e;for(;a<i;){if(t.get(a)!==o)r[s]++;else{if(++s===n)break;r[s]=1,o=!o}a++}if(s!==n&&(s!==n-1||a!==i))throw new N}static recordPatternInReverse(t,e,r){let n=r.length,i=t.get(e);for(;e>0&&n>=0;)t.get(--e)!==i&&(n--,i=!i);if(n>=0)throw new N;mt.recordPattern(t,e+1,r)}static patternMatchVariance(t,e,r){const n=t.length;let i=0,o=0;for(let r=0;r<n;r++)i+=t[r],o+=e[r];if(i<o)return Number.POSITIVE_INFINITY;const s=i/o;r*=s;let a=0;for(let i=0;i<n;i++){const n=t[i],o=e[i]*s,u=n>o?n-o:o-n;if(u>r)return Number.POSITIVE_INFINITY;a+=u}return a/i}}class Et extends mt{constructor(t=!1,e=!1){super(),this.usingCheckDigit=t,this.extendedMode=e,this.decodeRowResult="",this.counters=new Array(9)}decodeRow(t,e,r){let n=this.counters;n.fill(0),this.decodeRowResult="";let i,o,s=Et.findAsteriskPattern(e,n),a=e.getNextSet(s[1]),u=e.getSize();do{Et.recordPattern(e,a,n);let t=Et.toNarrowWidePattern(n);if(t<0)throw new N;i=Et.patternToChar(t),this.decodeRowResult+=i,o=a;for(let t of n)a+=t;a=e.getNextSet(a)}while("*"!==i);this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let l,h=0;for(let t of n)h+=t;if(a!==u&&2*(a-o-h)<h)throw new N;if(this.usingCheckDigit){let t=this.decodeRowResult.length-1,e=0;for(let r=0;r<t;r++)e+=Et.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(r));if(this.decodeRowResult.charAt(t)!==Et.ALPHABET_STRING.charAt(e%43))throw new d;this.decodeRowResult=this.decodeRowResult.substring(0,t)}if(0===this.decodeRowResult.length)throw new N;l=this.extendedMode?Et.decodeExtended(this.decodeRowResult):this.decodeRowResult;let c=(s[1]+s[0])/2,f=o+h/2;return new U(l,null,0,[new st(c,t),new st(f,t)],H.CODE_39,(new Date).getTime())}static findAsteriskPattern(t,e){let r=t.getSize(),n=t.getNextSet(0),i=0,o=n,s=!1,a=e.length;for(let u=n;u<r;u++)if(t.get(u)!==s)e[i]++;else{if(i===a-1){if(this.toNarrowWidePattern(e)===Et.ASTERISK_ENCODING&&t.isRange(Math.max(0,o-Math.floor((u-o)/2)),o,!1))return[o,u];o+=e[0]+e[1],e.copyWithin(0,2,2+i-1),e[i-1]=0,e[i]=0,i--}else i++;e[i]=1,s=!s}throw new N}static toNarrowWidePattern(t){let e,r=t.length,n=0;do{let i=2147483647;for(let e of t)e<i&&e>n&&(i=e);n=i,e=0;let o=0,s=0;for(let i=0;i<r;i++){let a=t[i];a>n&&(s|=1<<r-1-i,e++,o+=a)}if(3===e){for(let i=0;i<r&&e>0;i++){let r=t[i];if(r>n&&(e--,2*r>=o))return-1}return s}}while(e>3);return-1}static patternToChar(t){for(let e=0;e<Et.CHARACTER_ENCODINGS.length;e++)if(Et.CHARACTER_ENCODINGS[e]===t)return Et.ALPHABET_STRING.charAt(e);if(t===Et.ASTERISK_ENCODING)return"*";throw new N}static decodeExtended(t){let e=t.length,r="";for(let n=0;n<e;n++){let e=t.charAt(n);if("+"===e||"$"===e||"%"===e||"/"===e){let i=t.charAt(n+1),o="\0";switch(e){case"+":if(!(i>="A"&&i<="Z"))throw new C;o=String.fromCharCode(i.charCodeAt(0)+32);break;case"$":if(!(i>="A"&&i<="Z"))throw new C;o=String.fromCharCode(i.charCodeAt(0)-64);break;case"%":if(i>="A"&&i<="E")o=String.fromCharCode(i.charCodeAt(0)-38);else if(i>="F"&&i<="J")o=String.fromCharCode(i.charCodeAt(0)-11);else if(i>="K"&&i<="O")o=String.fromCharCode(i.charCodeAt(0)+16);else if(i>="P"&&i<="T")o=String.fromCharCode(i.charCodeAt(0)+43);else if("U"===i)o="\0";else if("V"===i)o="@";else if("W"===i)o="`";else{if("X"!==i&&"Y"!==i&&"Z"!==i)throw new C;o=""}break;case"/":if(i>="A"&&i<="O")o=String.fromCharCode(i.charCodeAt(0)-32);else{if("Z"!==i)throw new C;o=":"}}r+=o,n++}else r+=e}return r}}Et.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Et.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Et.ASTERISK_ENCODING=148;class At extends mt{static findStartPattern(t){const e=t.getSize(),r=t.getNextSet(0);let n=0;const i=[0,0,0,0,0,0];let o=r,s=!1;const a=6;for(let u=r;u<e;u++)if(t.get(u)!==s)i[n]++;else{if(n===a-1){let e=At.MAX_AVG_VARIANCE,r=-1;for(let t=At.CODE_START_A;t<=At.CODE_START_C;t++){const n=mt.patternMatchVariance(i,At.CODE_PATTERNS[t],At.MAX_INDIVIDUAL_VARIANCE);n<e&&(e=n,r=t)}if(r>=0&&t.isRange(Math.max(0,o-(u-o)/2),o,!1))return[o,u,r];o+=i[0]+i[1],i.splice(0,2),i[n-1]=0,i[n]=0,n--}else n++;i[n]=1,s=!s}throw new N}static decodeCode(t,e,r){mt.recordPattern(t,r,e);let n=At.MAX_AVG_VARIANCE,i=-1;for(let t=0;t<At.CODE_PATTERNS.length;t++){const r=At.CODE_PATTERNS[t],o=this.patternMatchVariance(e,r,At.MAX_INDIVIDUAL_VARIANCE);o<n&&(n=o,i=t)}if(i>=0)return i;throw new N}decodeRow(t,e,r){const n=r&&!0===r.get(y.ASSUME_GS1),i=At.findStartPattern(e),o=i[2];let s=0;const a=new Uint8Array(20);let u;switch(a[s++]=o,o){case At.CODE_START_A:u=At.CODE_CODE_A;break;case At.CODE_START_B:u=At.CODE_CODE_B;break;case At.CODE_START_C:u=At.CODE_CODE_C;break;default:throw new C}let l=!1,h=!1,c="",f=i[0],g=i[1];const w=[0,0,0,0,0,0];let p=0,_=0,m=o,E=0,A=!0,b=!1,I=!1;for(;!l;){const t=h;switch(h=!1,p=_,_=At.decodeCode(e,w,g),a[s++]=_,_!==At.CODE_STOP&&(A=!0),_!==At.CODE_STOP&&(E++,m+=E*_),f=g,g+=w.reduce(((t,e)=>t+e),0),_){case At.CODE_START_A:case At.CODE_START_B:case At.CODE_START_C:throw new C}switch(u){case At.CODE_CODE_A:if(_<64)c+=I===b?String.fromCharCode(" ".charCodeAt(0)+_):String.fromCharCode(" ".charCodeAt(0)+_+128),I=!1;else if(_<96)c+=I===b?String.fromCharCode(_-64):String.fromCharCode(_+64),I=!1;else switch(_!==At.CODE_STOP&&(A=!1),_){case At.CODE_FNC_1:n&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case At.CODE_FNC_2:case At.CODE_FNC_3:break;case At.CODE_FNC_4_A:!b&&I?(b=!0,I=!1):b&&I?(b=!1,I=!1):I=!0;break;case At.CODE_SHIFT:h=!0,u=At.CODE_CODE_B;break;case At.CODE_CODE_B:u=At.CODE_CODE_B;break;case At.CODE_CODE_C:u=At.CODE_CODE_C;break;case At.CODE_STOP:l=!0}break;case At.CODE_CODE_B:if(_<96)c+=I===b?String.fromCharCode(" ".charCodeAt(0)+_):String.fromCharCode(" ".charCodeAt(0)+_+128),I=!1;else switch(_!==At.CODE_STOP&&(A=!1),_){case At.CODE_FNC_1:n&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case At.CODE_FNC_2:case At.CODE_FNC_3:break;case At.CODE_FNC_4_B:!b&&I?(b=!0,I=!1):b&&I?(b=!1,I=!1):I=!0;break;case At.CODE_SHIFT:h=!0,u=At.CODE_CODE_A;break;case At.CODE_CODE_A:u=At.CODE_CODE_A;break;case At.CODE_CODE_C:u=At.CODE_CODE_C;break;case At.CODE_STOP:l=!0}break;case At.CODE_CODE_C:if(_<100)_<10&&(c+="0"),c+=_;else switch(_!==At.CODE_STOP&&(A=!1),_){case At.CODE_FNC_1:n&&(0===c.length?c+="]C1":c+=String.fromCharCode(29));break;case At.CODE_CODE_A:u=At.CODE_CODE_A;break;case At.CODE_CODE_B:u=At.CODE_CODE_B;break;case At.CODE_STOP:l=!0}}t&&(u=u===At.CODE_CODE_A?At.CODE_CODE_B:At.CODE_CODE_A)}const v=g-f;if(g=e.getNextUnset(g),!e.isRange(g,Math.min(e.getSize(),g+(g-f)/2),!1))throw new N;if(m-=E*p,m%103!==p)throw new d;const S=c.length;if(0===S)throw new N;S>0&&A&&(c=u===At.CODE_CODE_C?c.substring(0,S-2):c.substring(0,S-1));const T=(i[1]+i[0])/2,R=f+v/2,O=a.length,D=new Uint8Array(O);for(let t=0;t<O;t++)D[t]=a[t];const B=[new st(T,t),new st(R,t)];return new U(c,D,0,B,H.CODE_128,(new Date).getTime())}}At.CODE_PATTERNS=[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,3,1,1,1,2]],At.MAX_AVG_VARIANCE=.25,At.MAX_INDIVIDUAL_VARIANCE=.7,At.CODE_SHIFT=98,At.CODE_CODE_C=99,At.CODE_CODE_B=100,At.CODE_CODE_A=101,At.CODE_FNC_1=102,At.CODE_FNC_2=97,At.CODE_FNC_3=96,At.CODE_FNC_4_A=101,At.CODE_FNC_4_B=100,At.CODE_START_A=103,At.CODE_START_B=104,At.CODE_START_C=105,At.CODE_STOP=106;class yt extends mt{constructor(){super(),this.decodeFinderCounters=new Array(4),this.dataCharacterCounters=new Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(t,e){for(let r=0;r<e.length;r++)if(mt.patternMatchVariance(t,e[r],yt.MAX_INDIVIDUAL_VARIANCE)<yt.MAX_AVG_VARIANCE)return r;throw new N}static count(t){return it.sum(new Int32Array(t))}static increment(t,e){let r=0,n=e[0];for(let i=1;i<t.length;i++)e[i]>n&&(n=e[i],r=i);t[r]++}static decrement(t,e){let r=0,n=e[0];for(let i=1;i<t.length;i++)e[i]<n&&(n=e[i],r=i);t[r]--}static isFinderPattern(t){let e=t[0]+t[1],r=e/(e+t[2]+t[3]);if(r>=yt.MIN_FINDER_PATTERN_RATIO&&r<=yt.MAX_FINDER_PATTERN_RATIO){let e=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER;for(let n of t)n>r&&(r=n),n<e&&(e=n);return r<10*e}return!1}}yt.MAX_AVG_VARIANCE=.2,yt.MAX_INDIVIDUAL_VARIANCE=.45,yt.MIN_FINDER_PATTERN_RATIO=9.5/12,yt.MAX_FINDER_PATTERN_RATIO=12.5/14;class Ct{constructor(t,e){this.value=t,this.checksumPortion=e}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(t){if(!(t instanceof Ct))return!1;const e=t;return this.value===e.value&&this.checksumPortion===e.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class bt extends Ct{constructor(t,e,r){super(t,e),this.count=0,this.finderPattern=r}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class It{constructor(t,e,r,n,i){this.value=t,this.startEnd=e,this.value=t,this.startEnd=e,this.resultPoints=new Array,this.resultPoints.push(new st(r,i)),this.resultPoints.push(new st(n,i))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(t){if(!(t instanceof It))return!1;const e=t;return this.value===e.value}hashCode(){return this.value}}class vt{RSSUtils(){}static getRSSvalue(t,e,r){let n=0;for(let e of t)n+=e;let i=0,o=0,s=t.length;for(let a=0;a<s-1;a++){let u;for(u=1,o|=1<<a;u<t[a];u++,o&=~(1<<a)){let t=vt.combins(n-u-1,s-a-2);if(r&&0===o&&n-u-(s-a-1)>=s-a-1&&(t-=vt.combins(n-u-(s-a),s-a-2)),s-a-1>1){let r=0;for(let t=n-u-(s-a-2);t>e;t--)r+=vt.combins(n-u-t-1,s-a-3);t-=r*(s-1-a)}else n-u>e&&t--;i+=t}n-=u}return i}static combins(t,e){let r,n;t-e>e?(n=e,r=t-e):(n=t-e,r=e);let i=1,o=1;for(let e=t;e>r;e--)i*=e,o<=n&&(i/=o,o++);for(;o<=n;)i/=o,o++;return i}}class St extends yt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(t,e,r){const n=this.decodePair(e,!1,t,r);St.addOrTally(this.possibleLeftPairs,n),e.reverse();let i=this.decodePair(e,!0,t,r);St.addOrTally(this.possibleRightPairs,i),e.reverse();for(let t of this.possibleLeftPairs)if(t.getCount()>1)for(let e of this.possibleRightPairs)if(e.getCount()>1&&St.checkChecksum(t,e))return St.constructResult(t,e);throw new N}static addOrTally(t,e){if(null==e)return;let r=!1;for(let n of t)if(n.getValue()===e.getValue()){n.incrementCount(),r=!0;break}r||t.push(e)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(t,e){let r=4537077*t.getValue()+e.getValue(),n=new String(r).toString(),i=new T;for(let t=13-n.length;t>0;t--)i.append("0");i.append(n);let o=0;for(let t=0;t<13;t++){let e=i.charAt(t).charCodeAt(0)-"0".charCodeAt(0);o+=0==(1&t)?3*e:e}o=10-o%10,10===o&&(o=0),i.append(o.toString());let s=t.getFinderPattern().getResultPoints(),a=e.getFinderPattern().getResultPoints();return new U(i.toString(),null,0,[s[0],s[1],a[0],a[1]],H.RSS_14,(new Date).getTime())}static checkChecksum(t,e){let r=(t.getChecksumPortion()+16*e.getChecksumPortion())%79,n=9*t.getFinderPattern().getValue()+e.getFinderPattern().getValue();return n>72&&n--,n>8&&n--,r===n}decodePair(t,e,r,n){try{let i=this.findFinderPattern(t,e),o=this.parseFoundFinderPattern(t,r,e,i),s=null==n?null:n.get(y.NEED_RESULT_POINT_CALLBACK);if(null!=s){let n=(i[0]+i[1])/2;e&&(n=t.getSize()-1-n),s.foundPossibleResultPoint(new st(n,r))}let a=this.decodeDataCharacter(t,o,!0),u=this.decodeDataCharacter(t,o,!1);return new bt(1597*a.getValue()+u.getValue(),a.getChecksumPortion()+4*u.getChecksumPortion(),o)}catch(t){return null}}decodeDataCharacter(t,e,r){let n=this.getDataCharacterCounters();for(let t=0;t<n.length;t++)n[t]=0;if(r)mt.recordPatternInReverse(t,e.getStartEnd()[0],n);else{mt.recordPattern(t,e.getStartEnd()[1]+1,n);for(let t=0,e=n.length-1;t<e;t++,e--){let r=n[t];n[t]=n[e],n[e]=r}}let i=r?16:15,o=it.sum(new Int32Array(n))/i,s=this.getOddCounts(),a=this.getEvenCounts(),u=this.getOddRoundingErrors(),l=this.getEvenRoundingErrors();for(let t=0;t<n.length;t++){let e=n[t]/o,r=Math.floor(e+.5);r<1?r=1:r>8&&(r=8);let i=Math.floor(t/2);0==(1&t)?(s[i]=r,u[i]=e-r):(a[i]=r,l[i]=e-r)}this.adjustOddEvenCounts(r,i);let h=0,c=0;for(let t=s.length-1;t>=0;t--)c*=9,c+=s[t],h+=s[t];let d=0,f=0;for(let t=a.length-1;t>=0;t--)d*=9,d+=a[t],f+=a[t];let g=c+3*d;if(r){if(0!=(1&h)||h>12||h<4)throw new N;let t=(12-h)/2,e=St.OUTSIDE_ODD_WIDEST[t],r=9-e,n=vt.getRSSvalue(s,e,!1),i=vt.getRSSvalue(a,r,!0),o=St.OUTSIDE_EVEN_TOTAL_SUBSET[t],u=St.OUTSIDE_GSUM[t];return new Ct(n*o+i+u,g)}{if(0!=(1&f)||f>10||f<4)throw new N;let t=(10-f)/2,e=St.INSIDE_ODD_WIDEST[t],r=9-e,n=vt.getRSSvalue(s,e,!0),i=vt.getRSSvalue(a,r,!1),o=St.INSIDE_ODD_TOTAL_SUBSET[t],u=St.INSIDE_GSUM[t];return new Ct(i*o+n+u,g)}}findFinderPattern(t,e){let r=this.getDecodeFinderCounters();r[0]=0,r[1]=0,r[2]=0,r[3]=0;let n=t.getSize(),i=!1,o=0;for(;o<n&&(i=!t.get(o),e!==i);)o++;let s=0,a=o;for(let e=o;e<n;e++)if(t.get(e)!==i)r[s]++;else{if(3===s){if(yt.isFinderPattern(r))return[a,e];a+=r[0]+r[1],r[0]=r[2],r[1]=r[3],r[2]=0,r[3]=0,s--}else s++;r[s]=1,i=!i}throw new N}parseFoundFinderPattern(t,e,r,n){let i=t.get(n[0]),o=n[0]-1;for(;o>=0&&i!==t.get(o);)o--;o++;let s=n[0]-o,a=this.getDecodeFinderCounters(),u=new Array(a.length);g.arraycopy(a,0,u,1,a.length-1),u[0]=s;let l=this.parseFinderValue(u,St.FINDER_PATTERNS),h=o,c=n[1];return r&&(h=t.getSize()-1-h,c=t.getSize()-1-c),new It(l,[o,n[1]],h,c,e)}adjustOddEvenCounts(t,e){let r=it.sum(new Int32Array(this.getOddCounts())),n=it.sum(new Int32Array(this.getEvenCounts())),i=!1,o=!1,s=!1,a=!1;t?(r>12?o=!0:r<4&&(i=!0),n>12?a=!0:n<4&&(s=!0)):(r>11?o=!0:r<5&&(i=!0),n>10?a=!0:n<4&&(s=!0));let u=r+n-e,l=(1&r)==(t?1:0),h=1==(1&n);if(1===u)if(l){if(h)throw new N;o=!0}else{if(!h)throw new N;a=!0}else if(-1===u)if(l){if(h)throw new N;i=!0}else{if(!h)throw new N;s=!0}else{if(0!==u)throw new N;if(l){if(!h)throw new N;r<n?(i=!0,a=!0):(o=!0,s=!0)}else if(h)throw new N}if(i){if(o)throw new N;yt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(o&&yt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),s){if(a)throw new N;yt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}a&&yt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}St.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],St.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],St.OUTSIDE_GSUM=[0,161,961,2015,2715],St.INSIDE_GSUM=[0,336,1036,1516],St.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],St.INSIDE_ODD_WIDEST=[2,4,6,8],St.FINDER_PATTERNS=[[3,8,2,1],[3,5,5,1],[3,3,7,1],[3,1,9,1],[2,7,4,1],[2,5,6,1],[2,3,8,1],[1,5,7,1],[1,3,9,1]];class Tt extends mt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(t,e,r){let n=this.decodeStart(e),i=this.decodeEnd(e),o=new T;Tt.decodeMiddle(e,n[1],i[0],o);let s=o.toString(),a=null;null!=r&&(a=r.get(y.ALLOWED_LENGTHS)),null==a&&(a=Tt.DEFAULT_ALLOWED_LENGTHS);let u=s.length,l=!1,h=0;for(let t of a){if(u===t){l=!0;break}t>h&&(h=t)}if(!l&&u>h&&(l=!0),!l)throw new C;const c=[new st(n[1],t),new st(i[0],t)];return new U(s,null,0,c,H.ITF,(new Date).getTime())}static decodeMiddle(t,e,r,n){let i=new Array(10),o=new Array(5),s=new Array(5);for(i.fill(0),o.fill(0),s.fill(0);e<r;){mt.recordPattern(t,e,i);for(let t=0;t<5;t++){let e=2*t;o[t]=i[e],s[t]=i[e+1]}let r=Tt.decodeDigit(o);n.append(r.toString()),r=this.decodeDigit(s),n.append(r.toString()),i.forEach((function(t){e+=t}))}}decodeStart(t){let e=Tt.skipWhiteSpace(t),r=Tt.findGuardPattern(t,e,Tt.START_PATTERN);return this.narrowLineWidth=(r[1]-r[0])/4,this.validateQuietZone(t,r[0]),r}validateQuietZone(t,e){let r=10*this.narrowLineWidth;r=r<e?r:e;for(let n=e-1;r>0&&n>=0&&!t.get(n);n--)r--;if(0!==r)throw new N}static skipWhiteSpace(t){const e=t.getSize(),r=t.getNextSet(0);if(r===e)throw new N;return r}decodeEnd(t){t.reverse();try{let e,r=Tt.skipWhiteSpace(t);try{e=Tt.findGuardPattern(t,r,Tt.END_PATTERN_REVERSED[0])}catch(n){e=Tt.findGuardPattern(t,r,Tt.END_PATTERN_REVERSED[1])}this.validateQuietZone(t,e[0]);let n=e[0];return e[0]=t.getSize()-e[1],e[1]=t.getSize()-n,e}finally{t.reverse()}}static findGuardPattern(t,e,r){let n=r.length,i=new Array(n),o=t.getSize(),s=!1,a=0,u=e;i.fill(0);for(let l=e;l<o;l++)if(t.get(l)!==s)i[a]++;else{if(a===n-1){if(mt.patternMatchVariance(i,r,Tt.MAX_INDIVIDUAL_VARIANCE)<Tt.MAX_AVG_VARIANCE)return[u,l];u+=i[0]+i[1],g.arraycopy(i,2,i,0,a-1),i[a-1]=0,i[a]=0,a--}else a++;i[a]=1,s=!s}throw new N}static decodeDigit(t){let e=Tt.MAX_AVG_VARIANCE,r=-1,n=Tt.PATTERNS.length;for(let i=0;i<n;i++){let n=Tt.PATTERNS[i],o=mt.patternMatchVariance(t,n,Tt.MAX_INDIVIDUAL_VARIANCE);o<e?(e=o,r=i):o===e&&(r=-1)}if(r>=0)return r%10;throw new N}}Tt.W=3,Tt.w=2,Tt.N=1,Tt.PATTERNS=[[1,1,2,2,1],[2,1,1,1,2],[1,2,1,1,2],[2,2,1,1,1],[1,1,2,1,2],[2,1,2,1,1],[1,2,2,1,1],[1,1,1,2,2],[2,1,1,2,1],[1,2,1,2,1],[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]],Tt.MAX_AVG_VARIANCE=.38,Tt.MAX_INDIVIDUAL_VARIANCE=.5,Tt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Tt.START_PATTERN=[1,1,1,1],Tt.END_PATTERN_REVERSED=[[1,1,2],[1,1,3]];class Rt extends mt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(t){let e=!1,r=null,n=0,i=[0,0,0];for(;!e;){i=[0,0,0],r=Rt.findGuardPattern(t,n,!1,this.START_END_PATTERN,i);let o=r[0];n=r[1];let s=o-(n-o);s>=0&&(e=t.isRange(s,o,!1))}return r}static checkChecksum(t){return Rt.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let e=t.length;if(0===e)return!1;let r=parseInt(t.charAt(e-1),10);return Rt.getStandardUPCEANChecksum(t.substring(0,e-1))===r}static getStandardUPCEANChecksum(t){let e=t.length,r=0;for(let n=e-1;n>=0;n-=2){let e=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(e<0||e>9)throw new C;r+=e}r*=3;for(let n=e-2;n>=0;n-=2){let e=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(e<0||e>9)throw new C;r+=e}return(1e3-r)%10}static decodeEnd(t,e){return Rt.findGuardPattern(t,e,!1,Rt.START_END_PATTERN,new Array(Rt.START_END_PATTERN.length).fill(0))}static findGuardPattern(t,e,r,n,i){let o=t.getSize(),s=0,a=e=r?t.getNextUnset(e):t.getNextSet(e),u=n.length,l=r;for(let r=e;r<o;r++)if(t.get(r)!==l)i[s]++;else{if(s===u-1){if(mt.patternMatchVariance(i,n,Rt.MAX_INDIVIDUAL_VARIANCE)<Rt.MAX_AVG_VARIANCE)return[a,r];a+=i[0]+i[1];let t=i.slice(2,i.length);for(let e=0;e<s-1;e++)i[e]=t[e];i[s-1]=0,i[s]=0,s--}else s++;i[s]=1,l=!l}throw new N}static decodeDigit(t,e,r,n){this.recordPattern(t,r,e);let i=this.MAX_AVG_VARIANCE,o=-1,s=n.length;for(let t=0;t<s;t++){let r=n[t],s=mt.patternMatchVariance(e,r,Rt.MAX_INDIVIDUAL_VARIANCE);s<i&&(i=s,o=t)}if(o>=0)return o;throw new N}}Rt.MAX_AVG_VARIANCE=.48,Rt.MAX_INDIVIDUAL_VARIANCE=.7,Rt.START_END_PATTERN=[1,1,1],Rt.MIDDLE_PATTERN=[1,1,1,1,1],Rt.END_PATTERN=[1,1,1,1,1,1],Rt.L_PATTERNS=[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2]];class Nt{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=[0,0,0,0],this.decodeRowStringBuffer=""}decodeRow(t,e,r){let n=this.decodeRowStringBuffer,i=this.decodeMiddle(e,r,n),o=n.toString(),s=Nt.parseExtensionString(o),a=[new st((r[0]+r[1])/2,t),new st(i,t)],u=new U(o,null,0,a,H.UPC_EAN_EXTENSION,(new Date).getTime());return null!=s&&u.putAllMetadata(s),u}decodeMiddle(t,e,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=t.getSize(),o=e[1],s=0;for(let e=0;e<5&&o<i;e++){let i=Rt.decodeDigit(t,n,o,Rt.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+i%10);for(let t of n)o+=t;i>=10&&(s|=1<<4-e),4!==e&&(o=t.getNextSet(o),o=t.getNextUnset(o))}if(5!==r.length)throw new N;let a=this.determineCheckDigit(s);if(Nt.extensionChecksum(r.toString())!==a)throw new N;return o}static extensionChecksum(t){let e=t.length,r=0;for(let n=e-2;n>=0;n-=2)r+=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);r*=3;for(let n=e-1;n>=0;n-=2)r+=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);return r*=3,r%10}determineCheckDigit(t){for(let e=0;e<10;e++)if(t===this.CHECK_DIGIT_ENCODINGS[e])return e;throw new N}static parseExtensionString(t){if(5!==t.length)return null;let e=Nt.parseExtension5String(t);return null==e?null:new Map([[Z.SUGGESTED_PRICE,e]])}static parseExtension5String(t){let e;switch(t.charAt(0)){case"0":e="£";break;case"5":e="$";break;case"9":switch(t){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}e="";break;default:e=""}let r=parseInt(t.substring(1)),n=r%100;return e+(r/100).toString()+"."+(n<10?"0"+n:n.toString())}}class Ot{constructor(){this.decodeMiddleCounters=[0,0,0,0],this.decodeRowStringBuffer=""}decodeRow(t,e,r){let n=this.decodeRowStringBuffer,i=this.decodeMiddle(e,r,n),o=n.toString(),s=Ot.parseExtensionString(o),a=[new st((r[0]+r[1])/2,t),new st(i,t)],u=new U(o,null,0,a,H.UPC_EAN_EXTENSION,(new Date).getTime());return null!=s&&u.putAllMetadata(s),u}decodeMiddle(t,e,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=t.getSize(),o=e[1],s=0;for(let e=0;e<2&&o<i;e++){let i=Rt.decodeDigit(t,n,o,Rt.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+i%10);for(let t of n)o+=t;i>=10&&(s|=1<<1-e),1!==e&&(o=t.getNextSet(o),o=t.getNextUnset(o))}if(2!==r.length)throw new N;if(parseInt(r.toString())%4!==s)throw new N;return o}static parseExtensionString(t){return 2!==t.length?null:new Map([[Z.ISSUE_NUMBER,parseInt(t)]])}}class Dt{static decodeRow(t,e,r){let n=Rt.findGuardPattern(e,r,!1,this.EXTENSION_START_PATTERN,new Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return(new Nt).decodeRow(t,e,n)}catch(r){return(new Ot).decodeRow(t,e,n)}}}Dt.EXTENSION_START_PATTERN=[1,1,2];class Bt extends Rt{constructor(){super(),this.decodeRowStringBuffer="",Bt.L_AND_G_PATTERNS=Bt.L_PATTERNS.map((function(t){return t.slice()}));for(let t=10;t<20;t++){let e=Bt.L_PATTERNS[t-10],r=new Array(e.length);for(let t=0;t<e.length;t++)r[t]=e[e.length-t-1];Bt.L_AND_G_PATTERNS[t]=r}}decodeRow(t,e,r){let n=Bt.findStartGuardPattern(e),i=null==r?null:r.get(y.NEED_RESULT_POINT_CALLBACK);if(null!=i){const e=new st((n[0]+n[1])/2,t);i.foundPossibleResultPoint(e)}let o=this.decodeMiddle(e,n,this.decodeRowStringBuffer),s=o.rowOffset,a=o.resultString;if(null!=i){const e=new st(s,t);i.foundPossibleResultPoint(e)}let u=Bt.decodeEnd(e,s);if(null!=i){const e=new st((u[0]+u[1])/2,t);i.foundPossibleResultPoint(e)}let l=u[1],h=l+(l-u[0]);if(h>=e.getSize()||!e.isRange(l,h,!1))throw new N;let c=a.toString();if(c.length<8)throw new C;if(!Bt.checkChecksum(c))throw new d;let f=(n[1]+n[0])/2,g=(u[1]+u[0])/2,w=this.getBarcodeFormat(),p=[new st(f,t),new st(g,t)],_=new U(c,null,0,p,w,(new Date).getTime()),m=0;try{let r=Dt.decodeRow(t,e,u[1]);_.putMetadata(Z.UPC_EAN_EXTENSION,r.getText()),_.putAllMetadata(r.getResultMetadata()),_.addResultPoints(r.getResultPoints()),m=r.getText().length}catch(t){}let E=null==r?null:r.get(y.ALLOWED_EAN_EXTENSIONS);if(null!=E){let t=!1;for(let e in E)if(m.toString()===e){t=!0;break}if(!t)throw new N}return w===H.EAN_13||H.UPC_A,_}static checkChecksum(t){return Bt.checkStandardUPCEANChecksum(t)}static checkStandardUPCEANChecksum(t){let e=t.length;if(0===e)return!1;let r=parseInt(t.charAt(e-1),10);return Bt.getStandardUPCEANChecksum(t.substring(0,e-1))===r}static getStandardUPCEANChecksum(t){let e=t.length,r=0;for(let n=e-1;n>=0;n-=2){let e=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(e<0||e>9)throw new C;r+=e}r*=3;for(let n=e-2;n>=0;n-=2){let e=t.charAt(n).charCodeAt(0)-"0".charCodeAt(0);if(e<0||e>9)throw new C;r+=e}return(1e3-r)%10}static decodeEnd(t,e){return Bt.findGuardPattern(t,e,!1,Bt.START_END_PATTERN,new Array(Bt.START_END_PATTERN.length).fill(0))}}class Mt extends Bt{constructor(){super(),this.decodeMiddleCounters=[0,0,0,0]}decodeMiddle(t,e,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=t.getSize(),o=e[1],s=0;for(let e=0;e<6&&o<i;e++){let i=Bt.decodeDigit(t,n,o,Bt.L_AND_G_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+i%10);for(let t of n)o+=t;i>=10&&(s|=1<<5-e)}r=Mt.determineFirstDigit(r,s),o=Bt.findGuardPattern(t,o,!0,Bt.MIDDLE_PATTERN,new Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let e=0;e<6&&o<i;e++){let e=Bt.decodeDigit(t,n,o,Bt.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+e);for(let t of n)o+=t}return{rowOffset:o,resultString:r}}getBarcodeFormat(){return H.EAN_13}static determineFirstDigit(t,e){for(let r=0;r<10;r++)if(e===this.FIRST_DIGIT_ENCODINGS[r])return t=String.fromCharCode("0".charCodeAt(0)+r)+t;throw new N}}Mt.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class Pt extends Bt{constructor(){super(),this.decodeMiddleCounters=[0,0,0,0]}decodeMiddle(t,e,r){let n=this.decodeMiddleCounters;n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i=t.getSize(),o=e[1];for(let e=0;e<4&&o<i;e++){let e=Bt.decodeDigit(t,n,o,Bt.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+e);for(let t of n)o+=t}o=Bt.findGuardPattern(t,o,!0,Bt.MIDDLE_PATTERN,new Array(Bt.MIDDLE_PATTERN.length).fill(0))[1];for(let e=0;e<4&&o<i;e++){let e=Bt.decodeDigit(t,n,o,Bt.L_PATTERNS);r+=String.fromCharCode("0".charCodeAt(0)+e);for(let t of n)o+=t}return{rowOffset:o,resultString:r}}getBarcodeFormat(){return H.EAN_8}}class kt extends mt{constructor(t){super();let e=null==t?null:t.get(y.POSSIBLE_FORMATS),r=[];null!=e&&(e.indexOf(H.EAN_13)>-1&&r.push(new Mt),e.indexOf(H.EAN_8)>-1&&r.push(new Pt)),0===r.length&&(r.push(new Mt),r.push(new Pt)),this.readers=r}decodeRow(t,e,r){for(let n of this.readers)try{return n.decodeRow(t,e,r)}catch(t){}throw new N}reset(){for(let t of this.readers)t.reset()}}class Lt extends mt{constructor(t){super(),this.readers=[];const e=t?t.get(y.POSSIBLE_FORMATS):null,r=t&&void 0!==t.get(y.ASSUME_CODE_39_CHECK_DIGIT);e&&((e.includes(H.EAN_13)||e.includes(H.EAN_8))&&this.readers.push(new kt(t)),e.includes(H.CODE_39)&&this.readers.push(new Et(r)),e.includes(H.CODE_128)&&this.readers.push(new At),e.includes(H.ITF)&&this.readers.push(new Tt),e.includes(H.RSS_14)&&this.readers.push(new St)),0===this.readers.length&&(this.readers.push(new Et),this.readers.push(new kt(t)),this.readers.push(new At),this.readers.push(new Tt),this.readers.push(new St))}decodeRow(t,e,r){for(let n=0;n<this.readers.length;n++)try{return this.readers[n].decodeRow(t,e,r)}catch(t){}throw new N}reset(){this.readers.forEach((t=>t.reset()))}}class xt extends F{constructor(t=500,e){super(new Lt(e),t,e)}}class Ft{constructor(t,e,r){this.ecCodewords=t,this.ecBlocks=[e],r&&this.ecBlocks.push(r)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class Ut{constructor(t,e){this.count=t,this.dataCodewords=e}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Vt{constructor(t,e,r,n,i,o){this.versionNumber=t,this.symbolSizeRows=e,this.symbolSizeColumns=r,this.dataRegionSizeRows=n,this.dataRegionSizeColumns=i,this.ecBlocks=o;let s=0;const a=o.getECCodewords(),u=o.getECBlocks();for(let t of u)s+=t.getCount()*(t.getDataCodewords()+a);this.totalCodewords=s}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(t,e){if(0!=(1&t)||0!=(1&e))throw new C;for(let r of Vt.VERSIONS)if(r.symbolSizeRows===t&&r.symbolSizeColumns===e)return r;throw new C}toString(){return""+this.versionNumber}static buildVersions(){return[new Vt(1,10,10,8,8,new Ft(5,new Ut(1,3))),new Vt(2,12,12,10,10,new Ft(7,new Ut(1,5))),new Vt(3,14,14,12,12,new Ft(10,new Ut(1,8))),new Vt(4,16,16,14,14,new Ft(12,new Ut(1,12))),new Vt(5,18,18,16,16,new Ft(14,new Ut(1,18))),new Vt(6,20,20,18,18,new Ft(18,new Ut(1,22))),new Vt(7,22,22,20,20,new Ft(20,new Ut(1,30))),new Vt(8,24,24,22,22,new Ft(24,new Ut(1,36))),new Vt(9,26,26,24,24,new Ft(28,new Ut(1,44))),new Vt(10,32,32,14,14,new Ft(36,new Ut(1,62))),new Vt(11,36,36,16,16,new Ft(42,new Ut(1,86))),new Vt(12,40,40,18,18,new Ft(48,new Ut(1,114))),new Vt(13,44,44,20,20,new Ft(56,new Ut(1,144))),new Vt(14,48,48,22,22,new Ft(68,new Ut(1,174))),new Vt(15,52,52,24,24,new Ft(42,new Ut(2,102))),new Vt(16,64,64,14,14,new Ft(56,new Ut(2,140))),new Vt(17,72,72,16,16,new Ft(36,new Ut(4,92))),new Vt(18,80,80,18,18,new Ft(48,new Ut(4,114))),new Vt(19,88,88,20,20,new Ft(56,new Ut(4,144))),new Vt(20,96,96,22,22,new Ft(68,new Ut(4,174))),new Vt(21,104,104,24,24,new Ft(56,new Ut(6,136))),new Vt(22,120,120,18,18,new Ft(68,new Ut(6,175))),new Vt(23,132,132,20,20,new Ft(62,new Ut(8,163))),new Vt(24,144,144,22,22,new Ft(62,new Ut(8,156),new Ut(2,155))),new Vt(25,8,18,6,16,new Ft(7,new Ut(1,5))),new Vt(26,8,32,6,14,new Ft(11,new Ut(1,10))),new Vt(27,12,26,10,24,new Ft(14,new Ut(1,16))),new Vt(28,12,36,10,16,new Ft(18,new Ut(1,22))),new Vt(29,16,36,14,16,new Ft(24,new Ut(1,32))),new Vt(30,16,48,14,22,new Ft(28,new Ut(1,49)))]}}Vt.VERSIONS=Vt.buildVersions();class Ht{constructor(t){const e=t.getHeight();if(e<8||e>144||0!=(1&e))throw new C;this.version=Ht.readVersion(t),this.mappingBitMatrix=this.extractDataRegion(t),this.readMappingMatrix=new R(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(t){const e=t.getHeight(),r=t.getWidth();return Vt.getVersionForDimensions(e,r)}readCodewords(){const t=new Int8Array(this.version.getTotalCodewords());let e=0,r=4,n=0;const i=this.mappingBitMatrix.getHeight(),o=this.mappingBitMatrix.getWidth();let s=!1,a=!1,u=!1,l=!1;do{if(r!==i||0!==n||s)if(r!==i-2||0!==n||0==(3&o)||a)if(r!==i+4||2!==n||0!=(7&o)||u)if(r!==i-2||0!==n||4!=(7&o)||l){do{r<i&&n>=0&&!this.readMappingMatrix.get(n,r)&&(t[e++]=255&this.readUtah(r,n,i,o)),r-=2,n+=2}while(r>=0&&n<o);r+=1,n+=3;do{r>=0&&n<o&&!this.readMappingMatrix.get(n,r)&&(t[e++]=255&this.readUtah(r,n,i,o)),r+=2,n-=2}while(r<i&&n>=0);r+=3,n+=1}else t[e++]=255&this.readCorner4(i,o),r-=2,n+=2,l=!0;else t[e++]=255&this.readCorner3(i,o),r-=2,n+=2,u=!0;else t[e++]=255&this.readCorner2(i,o),r-=2,n+=2,a=!0;else t[e++]=255&this.readCorner1(i,o),r-=2,n+=2,s=!0}while(r<i||n<o);if(e!==this.version.getTotalCodewords())throw new C;return t}readModule(t,e,r,n){return t<0&&(t+=r,e+=4-(r+4&7)),e<0&&(e+=n,t+=4-(n+4&7)),this.readMappingMatrix.set(e,t),this.mappingBitMatrix.get(e,t)}readUtah(t,e,r,n){let i=0;return this.readModule(t-2,e-2,r,n)&&(i|=1),i<<=1,this.readModule(t-2,e-1,r,n)&&(i|=1),i<<=1,this.readModule(t-1,e-2,r,n)&&(i|=1),i<<=1,this.readModule(t-1,e-1,r,n)&&(i|=1),i<<=1,this.readModule(t-1,e,r,n)&&(i|=1),i<<=1,this.readModule(t,e-2,r,n)&&(i|=1),i<<=1,this.readModule(t,e-1,r,n)&&(i|=1),i<<=1,this.readModule(t,e,r,n)&&(i|=1),i}readCorner1(t,e){let r=0;return this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,1,t,e)&&(r|=1),r<<=1,this.readModule(t-1,2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(2,e-1,t,e)&&(r|=1),r<<=1,this.readModule(3,e-1,t,e)&&(r|=1),r}readCorner2(t,e){let r=0;return this.readModule(t-3,0,t,e)&&(r|=1),r<<=1,this.readModule(t-2,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(0,e-4,t,e)&&(r|=1),r<<=1,this.readModule(0,e-3,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r}readCorner3(t,e){let r=0;return this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(0,e-3,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-3,t,e)&&(r|=1),r<<=1,this.readModule(1,e-2,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r}readCorner4(t,e){let r=0;return this.readModule(t-3,0,t,e)&&(r|=1),r<<=1,this.readModule(t-2,0,t,e)&&(r|=1),r<<=1,this.readModule(t-1,0,t,e)&&(r|=1),r<<=1,this.readModule(0,e-2,t,e)&&(r|=1),r<<=1,this.readModule(0,e-1,t,e)&&(r|=1),r<<=1,this.readModule(1,e-1,t,e)&&(r|=1),r<<=1,this.readModule(2,e-1,t,e)&&(r|=1),r<<=1,this.readModule(3,e-1,t,e)&&(r|=1),r}extractDataRegion(t){const e=this.version.getSymbolSizeRows(),r=this.version.getSymbolSizeColumns();if(t.getHeight()!==e)throw new h("Dimension of bitMatrix must match the version size");const n=this.version.getDataRegionSizeRows(),i=this.version.getDataRegionSizeColumns(),o=e/n|0,s=r/i|0,a=new R(s*i,o*n);for(let e=0;e<o;++e){const r=e*n;for(let o=0;o<s;++o){const s=o*i;for(let u=0;u<n;++u){const l=e*(n+2)+1+u,h=r+u;for(let e=0;e<i;++e){const r=o*(i+2)+1+e;if(t.get(r,l)){const t=s+e;a.set(t,h)}}}}}return a}}class zt{constructor(t,e){this.numDataCodewords=t,this.codewords=e}static getDataBlocks(t,e){const r=e.getECBlocks();let n=0;const i=r.getECBlocks();for(let t of i)n+=t.getCount();const o=new Array(n);let s=0;for(let t of i)for(let e=0;e<t.getCount();e++){const e=t.getDataCodewords(),n=r.getECCodewords()+e;o[s++]=new zt(e,new Uint8Array(n))}const a=o[0].codewords.length-r.getECCodewords(),u=a-1;let l=0;for(let e=0;e<u;e++)for(let r=0;r<s;r++)o[r].codewords[e]=t[l++];const c=24===e.getVersionNumber(),d=c?8:s;for(let e=0;e<d;e++)o[e].codewords[a-1]=t[l++];const f=o[0].codewords.length;for(let e=a;e<f;e++)for(let r=0;r<s;r++){const n=c?(r+8)%s:r,i=c&&n>7?e-1:e;o[n].codewords[i]=t[l++]}if(l!==t.length)throw new h;return o}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class Gt{constructor(t){this.bytes=t,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(t){if(t<1||t>32||t>this.available())throw new h(""+t);let e=0,r=this.bitOffset,n=this.byteOffset;const i=this.bytes;if(r>0){const o=8-r,s=t<o?t:o,a=o-s,u=255>>8-s<<a;e=(i[n]&u)>>a,t-=s,r+=s,8===r&&(r=0,n++)}if(t>0){for(;t>=8;)e=e<<8|255&i[n],n++,t-=8;if(t>0){const o=8-t,s=255>>o<<o;e=e<<t|(i[n]&s)>>o,r+=t}}return this.bitOffset=r,this.byteOffset=n,e}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}!function(t){t[t.PAD_ENCODE=0]="PAD_ENCODE",t[t.ASCII_ENCODE=1]="ASCII_ENCODE",t[t.C40_ENCODE=2]="C40_ENCODE",t[t.TEXT_ENCODE=3]="TEXT_ENCODE",t[t.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",t[t.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",t[t.BASE256_ENCODE=6]="BASE256_ENCODE"}(G||(G={}));class Xt{static decode(t){const e=new Gt(t),r=new T,n=new T,i=new Array;let o=G.ASCII_ENCODE;do{if(o===G.ASCII_ENCODE)o=this.decodeAsciiSegment(e,r,n);else{switch(o){case G.C40_ENCODE:this.decodeC40Segment(e,r);break;case G.TEXT_ENCODE:this.decodeTextSegment(e,r);break;case G.ANSIX12_ENCODE:this.decodeAnsiX12Segment(e,r);break;case G.EDIFACT_ENCODE:this.decodeEdifactSegment(e,r);break;case G.BASE256_ENCODE:this.decodeBase256Segment(e,r,i);break;default:throw new C}o=G.ASCII_ENCODE}}while(o!==G.PAD_ENCODE&&e.available()>0);return n.length()>0&&r.append(n.toString()),new j(t,r.toString(),0===i.length?null:i,null)}static decodeAsciiSegment(t,e,r){let n=!1;do{let i=t.readBits(8);if(0===i)throw new C;if(i<=128)return n&&(i+=128),e.append(String.fromCharCode(i-1)),G.ASCII_ENCODE;if(129===i)return G.PAD_ENCODE;if(i<=229){const t=i-130;t<10&&e.append("0"),e.append(""+t)}else switch(i){case 230:return G.C40_ENCODE;case 231:return G.BASE256_ENCODE;case 232:e.append(String.fromCharCode(29));break;case 233:case 234:break;case 235:n=!0;break;case 236:e.append("[)>05"),r.insert(0,"");break;case 237:e.append("[)>06"),r.insert(0,"");break;case 238:return G.ANSIX12_ENCODE;case 239:return G.TEXT_ENCODE;case 240:return G.EDIFACT_ENCODE;case 241:break;default:if(254!==i||0!==t.available())throw new C}}while(t.available()>0);return G.ASCII_ENCODE}static decodeC40Segment(t,e){let r=!1;const n=[];let i=0;do{if(8===t.available())return;const o=t.readBits(8);if(254===o)return;this.parseTwoBytes(o,t.readBits(8),n);for(let t=0;t<3;t++){const o=n[t];switch(i){case 0:if(o<3)i=o+1;else{if(!(o<this.C40_BASIC_SET_CHARS.length))throw new C;{const t=this.C40_BASIC_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t)}}break;case 1:r?(e.append(String.fromCharCode(o+128)),r=!1):e.append(String.fromCharCode(o)),i=0;break;case 2:if(o<this.C40_SHIFT2_SET_CHARS.length){const t=this.C40_SHIFT2_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t)}else switch(o){case 27:e.append(String.fromCharCode(29));break;case 30:r=!0;break;default:throw new C}i=0;break;case 3:r?(e.append(String.fromCharCode(o+224)),r=!1):e.append(String.fromCharCode(o+96)),i=0;break;default:throw new C}}}while(t.available()>0)}static decodeTextSegment(t,e){let r=!1,n=[],i=0;do{if(8===t.available())return;const o=t.readBits(8);if(254===o)return;this.parseTwoBytes(o,t.readBits(8),n);for(let t=0;t<3;t++){const o=n[t];switch(i){case 0:if(o<3)i=o+1;else{if(!(o<this.TEXT_BASIC_SET_CHARS.length))throw new C;{const t=this.TEXT_BASIC_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t)}}break;case 1:r?(e.append(String.fromCharCode(o+128)),r=!1):e.append(String.fromCharCode(o)),i=0;break;case 2:if(o<this.TEXT_SHIFT2_SET_CHARS.length){const t=this.TEXT_SHIFT2_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t)}else switch(o){case 27:e.append(String.fromCharCode(29));break;case 30:r=!0;break;default:throw new C}i=0;break;case 3:if(!(o<this.TEXT_SHIFT3_SET_CHARS.length))throw new C;{const t=this.TEXT_SHIFT3_SET_CHARS[o];r?(e.append(String.fromCharCode(t.charCodeAt(0)+128)),r=!1):e.append(t),i=0}break;default:throw new C}}}while(t.available()>0)}static decodeAnsiX12Segment(t,e){const r=[];do{if(8===t.available())return;const n=t.readBits(8);if(254===n)return;this.parseTwoBytes(n,t.readBits(8),r);for(let t=0;t<3;t++){const n=r[t];switch(n){case 0:e.append("\r");break;case 1:e.append("*");break;case 2:e.append(">");break;case 3:e.append(" ");break;default:if(n<14)e.append(String.fromCharCode(n+44));else{if(!(n<40))throw new C;e.append(String.fromCharCode(n+51))}}}}while(t.available()>0)}static parseTwoBytes(t,e,r){let n=(t<<8)+e-1,i=Math.floor(n/1600);r[0]=i,n-=1600*i,i=Math.floor(n/40),r[1]=i,r[2]=n-40*i}static decodeEdifactSegment(t,e){do{if(t.available()<=16)return;for(let r=0;r<4;r++){let r=t.readBits(6);if(31===r){const e=8-t.getBitOffset();return void(8!==e&&t.readBits(e))}0==(32&r)&&(r|=64),e.append(String.fromCharCode(r))}}while(t.available()>0)}static decodeBase256Segment(t,e,r){let n=1+t.getByteOffset();const i=this.unrandomize255State(t.readBits(8),n++);let o;if(o=0===i?t.available()/8|0:i<250?i:250*(i-249)+this.unrandomize255State(t.readBits(8),n++),o<0)throw new C;const s=new Uint8Array(o);for(let e=0;e<o;e++){if(t.available()<8)throw new C;s[e]=this.unrandomize255State(t.readBits(8),n++)}r.push(s);try{e.append(v.decode(s,S.ISO88591))}catch(t){throw new et("Platform does not support required encoding: "+t.message)}}static unrandomize255State(t,e){const r=t-(149*e%255+1);return r>=0?r:r+256}}Xt.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Xt.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Xt.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Xt.TEXT_SHIFT2_SET_CHARS=Xt.C40_SHIFT2_SET_CHARS,Xt.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",String.fromCharCode(127)];class Wt{constructor(){this.rsDecoder=new rt($.DATA_MATRIX_FIELD_256)}decode(t){const e=new Ht(t),r=e.getVersion(),n=e.readCodewords(),i=zt.getDataBlocks(n,r);let o=0;for(let t of i)o+=t.getNumDataCodewords();const s=new Uint8Array(o),a=i.length;for(let t=0;t<a;t++){const e=i[t],r=e.getCodewords(),n=e.getNumDataCodewords();this.correctErrors(r,n);for(let e=0;e<n;e++)s[e*a+t]=r[e]}return Xt.decode(s)}correctErrors(t,e){t.length;const r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-e)}catch(t){throw new d}for(let n=0;n<e;n++)t[n]=r[n]}}class Yt{constructor(t){this.image=t,this.rectangleDetector=new lt(this.image)}detect(){const t=this.rectangleDetector.detect();let e=this.detectSolid1(t);if(e=this.detectSolid2(e),e[3]=this.correctTopRight(e),!e[3])throw new N;e=this.shiftToModuleCenter(e);const r=e[0],n=e[1],i=e[2],o=e[3];let s=this.transitionsBetween(r,o)+1,a=this.transitionsBetween(i,o)+1;1==(1&s)&&(s+=1),1==(1&a)&&(a+=1),4*s<7*a&&4*a<7*s&&(s=a=Math.max(s,a));let u=Yt.sampleGrid(this.image,r,n,i,o,s,a);return new at(u,[r,n,i,o])}static shiftPoint(t,e,r){let n=(e.getX()-t.getX())/(r+1),i=(e.getY()-t.getY())/(r+1);return new st(t.getX()+n,t.getY()+i)}static moveAway(t,e,r){let n=t.getX(),i=t.getY();return n<e?n-=1:n+=1,i<r?i-=1:i+=1,new st(n,i)}detectSolid1(t){let e=t[0],r=t[1],n=t[3],i=t[2],o=this.transitionsBetween(e,r),s=this.transitionsBetween(r,n),a=this.transitionsBetween(n,i),u=this.transitionsBetween(i,e),l=o,h=[i,e,r,n];return l>s&&(l=s,h[0]=e,h[1]=r,h[2]=n,h[3]=i),l>a&&(l=a,h[0]=r,h[1]=n,h[2]=i,h[3]=e),l>u&&(h[0]=n,h[1]=i,h[2]=e,h[3]=r),h}detectSolid2(t){let e=t[0],r=t[1],n=t[2],i=t[3],o=this.transitionsBetween(e,i),s=Yt.shiftPoint(r,n,4*(o+1)),a=Yt.shiftPoint(n,r,4*(o+1));return this.transitionsBetween(s,e)<this.transitionsBetween(a,i)?(t[0]=e,t[1]=r,t[2]=n,t[3]=i):(t[0]=r,t[1]=n,t[2]=i,t[3]=e),t}correctTopRight(t){let e=t[0],r=t[1],n=t[2],i=t[3],o=this.transitionsBetween(e,i),s=this.transitionsBetween(r,i),a=Yt.shiftPoint(e,r,4*(s+1)),u=Yt.shiftPoint(n,r,4*(o+1));o=this.transitionsBetween(a,i),s=this.transitionsBetween(u,i);let l=new st(i.getX()+(n.getX()-r.getX())/(o+1),i.getY()+(n.getY()-r.getY())/(o+1)),h=new st(i.getX()+(e.getX()-r.getX())/(s+1),i.getY()+(e.getY()-r.getY())/(s+1));return this.isValid(l)?this.isValid(h)?this.transitionsBetween(a,l)+this.transitionsBetween(u,l)>this.transitionsBetween(a,h)+this.transitionsBetween(u,h)?l:h:l:this.isValid(h)?h:null}shiftToModuleCenter(t){let e=t[0],r=t[1],n=t[2],i=t[3],o=this.transitionsBetween(e,i)+1,s=this.transitionsBetween(n,i)+1,a=Yt.shiftPoint(e,r,4*s),u=Yt.shiftPoint(n,r,4*o);o=this.transitionsBetween(a,i)+1,s=this.transitionsBetween(u,i)+1,1==(1&o)&&(o+=1),1==(1&s)&&(s+=1);let l,h,c=(e.getX()+r.getX()+n.getX()+i.getX())/4,d=(e.getY()+r.getY()+n.getY()+i.getY())/4;return e=Yt.moveAway(e,c,d),r=Yt.moveAway(r,c,d),n=Yt.moveAway(n,c,d),i=Yt.moveAway(i,c,d),a=Yt.shiftPoint(e,r,4*s),a=Yt.shiftPoint(a,i,4*o),l=Yt.shiftPoint(r,e,4*s),l=Yt.shiftPoint(l,n,4*o),u=Yt.shiftPoint(n,i,4*s),u=Yt.shiftPoint(u,r,4*o),h=Yt.shiftPoint(i,n,4*s),h=Yt.shiftPoint(h,e,4*o),[a,l,u,h]}isValid(t){return t.getX()>=0&&t.getX()<this.image.getWidth()&&t.getY()>0&&t.getY()<this.image.getHeight()}static sampleGrid(t,e,r,n,i,o,s){return ft.getInstance().sampleGrid(t,o,s,.5,.5,o-.5,.5,o-.5,s-.5,.5,s-.5,e.getX(),e.getY(),i.getX(),i.getY(),n.getX(),n.getY(),r.getX(),r.getY())}transitionsBetween(t,e){let r=Math.trunc(t.getX()),n=Math.trunc(t.getY()),i=Math.trunc(e.getX()),o=Math.trunc(e.getY()),s=Math.abs(o-n)>Math.abs(i-r);if(s){let t=r;r=n,n=t,t=i,i=o,o=t}let a=Math.abs(i-r),u=Math.abs(o-n),l=-a/2,h=n<o?1:-1,c=r<i?1:-1,d=0,f=this.image.get(s?n:r,s?r:n);for(let t=r,e=n;t!==i;t+=c){let r=this.image.get(s?e:t,s?t:e);if(r!==f&&(d++,f=r),l+=u,l>0){if(e===o)break;e+=h,l-=a}}return d}}class Kt{constructor(){this.decoder=new Wt}decode(t,e=null){let r,n;if(null!=e&&e.has(y.PURE_BARCODE)){const e=Kt.extractPureBits(t.getBlackMatrix());r=this.decoder.decode(e),n=Kt.NO_POINTS}else{const e=new Yt(t.getBlackMatrix()).detect();r=this.decoder.decode(e.getBits()),n=e.getPoints()}const i=r.getRawBytes(),o=new U(r.getText(),i,8*i.length,n,H.DATA_MATRIX,g.currentTimeMillis()),s=r.getByteSegments();null!=s&&o.putMetadata(Z.BYTE_SEGMENTS,s);const a=r.getECLevel();return null!=a&&o.putMetadata(Z.ERROR_CORRECTION_LEVEL,a),o}reset(){}static extractPureBits(t){const e=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(null==e||null==r)throw new N;const n=this.moduleSize(e,t);let i=e[1];const o=r[1];let s=e[0];const a=(r[0]-s+1)/n,u=(o-i+1)/n;if(a<=0||u<=0)throw new N;const l=n/2;i+=l,s+=l;const h=new R(a,u);for(let e=0;e<u;e++){const r=i+e*n;for(let i=0;i<a;i++)t.get(s+i*n,r)&&h.set(i,e)}return h}static moduleSize(t,e){const r=e.getWidth();let n=t[0];const i=t[1];for(;n<r&&e.get(n,i);)n++;if(n===r)throw new N;const o=n-t[0];if(0===o)throw new N;return o}}Kt.NO_POINTS=[];class Zt extends F{constructor(t=500){super(new Kt,t)}}!function(t){t[t.L=0]="L",t[t.M=1]="M",t[t.Q=2]="Q",t[t.H=3]="H"}(X||(X={}));class jt{constructor(t,e,r){this.value=t,this.stringValue=e,this.bits=r,jt.FOR_BITS.set(r,this),jt.FOR_VALUE.set(t,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(t){switch(t){case"L":return jt.L;case"M":return jt.M;case"Q":return jt.Q;case"H":return jt.H;default:throw new l(t+"not available")}}toString(){return this.stringValue}equals(t){if(!(t instanceof jt))return!1;const e=t;return this.value===e.value}static forBits(t){if(t<0||t>=jt.FOR_BITS.size)throw new h;return jt.FOR_BITS.get(t)}}jt.FOR_BITS=new Map,jt.FOR_VALUE=new Map,jt.L=new jt(X.L,"L",1),jt.M=new jt(X.M,"M",0),jt.Q=new jt(X.Q,"Q",3),jt.H=new jt(X.H,"H",2);class qt{constructor(t){this.errorCorrectionLevel=jt.forBits(t>>3&3),this.dataMask=7&t}static numBitsDiffering(t,e){return w.bitCount(t^e)}static decodeFormatInformation(t,e){const r=qt.doDecodeFormatInformation(t,e);return null!==r?r:qt.doDecodeFormatInformation(t^qt.FORMAT_INFO_MASK_QR,e^qt.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(t,e){let r=Number.MAX_SAFE_INTEGER,n=0;for(const i of qt.FORMAT_INFO_DECODE_LOOKUP){const o=i[0];if(o===t||o===e)return new qt(i[1]);let s=qt.numBitsDiffering(t,o);s<r&&(n=i[1],r=s),t!==e&&(s=qt.numBitsDiffering(e,o),s<r&&(n=i[1],r=s))}return r<=3?new qt(n):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(t){if(!(t instanceof qt))return!1;const e=t;return this.errorCorrectionLevel===e.errorCorrectionLevel&&this.dataMask===e.dataMask}}qt.FORMAT_INFO_MASK_QR=21522,qt.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class Qt{constructor(t,...e){this.ecCodewordsPerBlock=t,this.ecBlocks=e}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let t=0;const e=this.ecBlocks;for(const r of e)t+=r.getCount();return t}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class Jt{constructor(t,e){this.count=t,this.dataCodewords=e}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class $t{constructor(t,e,...r){this.versionNumber=t,this.alignmentPatternCenters=e,this.ecBlocks=r;let n=0;const i=r[0].getECCodewordsPerBlock(),o=r[0].getECBlocks();for(const t of o)n+=t.getCount()*(t.getDataCodewords()+i);this.totalCodewords=n}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(t){return this.ecBlocks[t.getValue()]}static getProvisionalVersionForDimension(t){if(t%4!=1)throw new C;try{return this.getVersionForNumber((t-17)/4)}catch(t){throw new C}}static getVersionForNumber(t){if(t<1||t>40)throw new h;return $t.VERSIONS[t-1]}static decodeVersionInformation(t){let e=Number.MAX_SAFE_INTEGER,r=0;for(let n=0;n<$t.VERSION_DECODE_INFO.length;n++){const i=$t.VERSION_DECODE_INFO[n];if(i===t)return $t.getVersionForNumber(n+7);const o=qt.numBitsDiffering(t,i);o<e&&(r=n+7,e=o)}return e<=3?$t.getVersionForNumber(r):null}buildFunctionPattern(){const t=this.getDimensionForVersion(),e=new R(t);e.setRegion(0,0,9,9),e.setRegion(t-8,0,8,9),e.setRegion(0,t-8,9,8);const r=this.alignmentPatternCenters.length;for(let t=0;t<r;t++){const n=this.alignmentPatternCenters[t]-2;for(let i=0;i<r;i++)0===t&&(0===i||i===r-1)||t===r-1&&0===i||e.setRegion(this.alignmentPatternCenters[i]-2,n,5,5)}return e.setRegion(6,9,1,t-17),e.setRegion(9,6,t-17,1),this.versionNumber>6&&(e.setRegion(t-11,0,3,6),e.setRegion(0,t-11,6,3)),e}toString(){return""+this.versionNumber}}$t.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),$t.VERSIONS=[new $t(1,new Int32Array(0),new Qt(7,new Jt(1,19)),new Qt(10,new Jt(1,16)),new Qt(13,new Jt(1,13)),new Qt(17,new Jt(1,9))),new $t(2,Int32Array.from([6,18]),new Qt(10,new Jt(1,34)),new Qt(16,new Jt(1,28)),new Qt(22,new Jt(1,22)),new Qt(28,new Jt(1,16))),new $t(3,Int32Array.from([6,22]),new Qt(15,new Jt(1,55)),new Qt(26,new Jt(1,44)),new Qt(18,new Jt(2,17)),new Qt(22,new Jt(2,13))),new $t(4,Int32Array.from([6,26]),new Qt(20,new Jt(1,80)),new Qt(18,new Jt(2,32)),new Qt(26,new Jt(2,24)),new Qt(16,new Jt(4,9))),new $t(5,Int32Array.from([6,30]),new Qt(26,new Jt(1,108)),new Qt(24,new Jt(2,43)),new Qt(18,new Jt(2,15),new Jt(2,16)),new Qt(22,new Jt(2,11),new Jt(2,12))),new $t(6,Int32Array.from([6,34]),new Qt(18,new Jt(2,68)),new Qt(16,new Jt(4,27)),new Qt(24,new Jt(4,19)),new Qt(28,new Jt(4,15))),new $t(7,Int32Array.from([6,22,38]),new Qt(20,new Jt(2,78)),new Qt(18,new Jt(4,31)),new Qt(18,new Jt(2,14),new Jt(4,15)),new Qt(26,new Jt(4,13),new Jt(1,14))),new $t(8,Int32Array.from([6,24,42]),new Qt(24,new Jt(2,97)),new Qt(22,new Jt(2,38),new Jt(2,39)),new Qt(22,new Jt(4,18),new Jt(2,19)),new Qt(26,new Jt(4,14),new Jt(2,15))),new $t(9,Int32Array.from([6,26,46]),new Qt(30,new Jt(2,116)),new Qt(22,new Jt(3,36),new Jt(2,37)),new Qt(20,new Jt(4,16),new Jt(4,17)),new Qt(24,new Jt(4,12),new Jt(4,13))),new $t(10,Int32Array.from([6,28,50]),new Qt(18,new Jt(2,68),new Jt(2,69)),new Qt(26,new Jt(4,43),new Jt(1,44)),new Qt(24,new Jt(6,19),new Jt(2,20)),new Qt(28,new Jt(6,15),new Jt(2,16))),new $t(11,Int32Array.from([6,30,54]),new Qt(20,new Jt(4,81)),new Qt(30,new Jt(1,50),new Jt(4,51)),new Qt(28,new Jt(4,22),new Jt(4,23)),new Qt(24,new Jt(3,12),new Jt(8,13))),new $t(12,Int32Array.from([6,32,58]),new Qt(24,new Jt(2,92),new Jt(2,93)),new Qt(22,new Jt(6,36),new Jt(2,37)),new Qt(26,new Jt(4,20),new Jt(6,21)),new Qt(28,new Jt(7,14),new Jt(4,15))),new $t(13,Int32Array.from([6,34,62]),new Qt(26,new Jt(4,107)),new Qt(22,new Jt(8,37),new Jt(1,38)),new Qt(24,new Jt(8,20),new Jt(4,21)),new Qt(22,new Jt(12,11),new Jt(4,12))),new $t(14,Int32Array.from([6,26,46,66]),new Qt(30,new Jt(3,115),new Jt(1,116)),new Qt(24,new Jt(4,40),new Jt(5,41)),new Qt(20,new Jt(11,16),new Jt(5,17)),new Qt(24,new Jt(11,12),new Jt(5,13))),new $t(15,Int32Array.from([6,26,48,70]),new Qt(22,new Jt(5,87),new Jt(1,88)),new Qt(24,new Jt(5,41),new Jt(5,42)),new Qt(30,new Jt(5,24),new Jt(7,25)),new Qt(24,new Jt(11,12),new Jt(7,13))),new $t(16,Int32Array.from([6,26,50,74]),new Qt(24,new Jt(5,98),new Jt(1,99)),new Qt(28,new Jt(7,45),new Jt(3,46)),new Qt(24,new Jt(15,19),new Jt(2,20)),new Qt(30,new Jt(3,15),new Jt(13,16))),new $t(17,Int32Array.from([6,30,54,78]),new Qt(28,new Jt(1,107),new Jt(5,108)),new Qt(28,new Jt(10,46),new Jt(1,47)),new Qt(28,new Jt(1,22),new Jt(15,23)),new Qt(28,new Jt(2,14),new Jt(17,15))),new $t(18,Int32Array.from([6,30,56,82]),new Qt(30,new Jt(5,120),new Jt(1,121)),new Qt(26,new Jt(9,43),new Jt(4,44)),new Qt(28,new Jt(17,22),new Jt(1,23)),new Qt(28,new Jt(2,14),new Jt(19,15))),new $t(19,Int32Array.from([6,30,58,86]),new Qt(28,new Jt(3,113),new Jt(4,114)),new Qt(26,new Jt(3,44),new Jt(11,45)),new Qt(26,new Jt(17,21),new Jt(4,22)),new Qt(26,new Jt(9,13),new Jt(16,14))),new $t(20,Int32Array.from([6,34,62,90]),new Qt(28,new Jt(3,107),new Jt(5,108)),new Qt(26,new Jt(3,41),new Jt(13,42)),new Qt(30,new Jt(15,24),new Jt(5,25)),new Qt(28,new Jt(15,15),new Jt(10,16))),new $t(21,Int32Array.from([6,28,50,72,94]),new Qt(28,new Jt(4,116),new Jt(4,117)),new Qt(26,new Jt(17,42)),new Qt(28,new Jt(17,22),new Jt(6,23)),new Qt(30,new Jt(19,16),new Jt(6,17))),new $t(22,Int32Array.from([6,26,50,74,98]),new Qt(28,new Jt(2,111),new Jt(7,112)),new Qt(28,new Jt(17,46)),new Qt(30,new Jt(7,24),new Jt(16,25)),new Qt(24,new Jt(34,13))),new $t(23,Int32Array.from([6,30,54,78,102]),new Qt(30,new Jt(4,121),new Jt(5,122)),new Qt(28,new Jt(4,47),new Jt(14,48)),new Qt(30,new Jt(11,24),new Jt(14,25)),new Qt(30,new Jt(16,15),new Jt(14,16))),new $t(24,Int32Array.from([6,28,54,80,106]),new Qt(30,new Jt(6,117),new Jt(4,118)),new Qt(28,new Jt(6,45),new Jt(14,46)),new Qt(30,new Jt(11,24),new Jt(16,25)),new Qt(30,new Jt(30,16),new Jt(2,17))),new $t(25,Int32Array.from([6,32,58,84,110]),new Qt(26,new Jt(8,106),new Jt(4,107)),new Qt(28,new Jt(8,47),new Jt(13,48)),new Qt(30,new Jt(7,24),new Jt(22,25)),new Qt(30,new Jt(22,15),new Jt(13,16))),new $t(26,Int32Array.from([6,30,58,86,114]),new Qt(28,new Jt(10,114),new Jt(2,115)),new Qt(28,new Jt(19,46),new Jt(4,47)),new Qt(28,new Jt(28,22),new Jt(6,23)),new Qt(30,new Jt(33,16),new Jt(4,17))),new $t(27,Int32Array.from([6,34,62,90,118]),new Qt(30,new Jt(8,122),new Jt(4,123)),new Qt(28,new Jt(22,45),new Jt(3,46)),new Qt(30,new Jt(8,23),new Jt(26,24)),new Qt(30,new Jt(12,15),new Jt(28,16))),new $t(28,Int32Array.from([6,26,50,74,98,122]),new Qt(30,new Jt(3,117),new Jt(10,118)),new Qt(28,new Jt(3,45),new Jt(23,46)),new Qt(30,new Jt(4,24),new Jt(31,25)),new Qt(30,new Jt(11,15),new Jt(31,16))),new $t(29,Int32Array.from([6,30,54,78,102,126]),new Qt(30,new Jt(7,116),new Jt(7,117)),new Qt(28,new Jt(21,45),new Jt(7,46)),new Qt(30,new Jt(1,23),new Jt(37,24)),new Qt(30,new Jt(19,15),new Jt(26,16))),new $t(30,Int32Array.from([6,26,52,78,104,130]),new Qt(30,new Jt(5,115),new Jt(10,116)),new Qt(28,new Jt(19,47),new Jt(10,48)),new Qt(30,new Jt(15,24),new Jt(25,25)),new Qt(30,new Jt(23,15),new Jt(25,16))),new $t(31,Int32Array.from([6,30,56,82,108,134]),new Qt(30,new Jt(13,115),new Jt(3,116)),new Qt(28,new Jt(2,46),new Jt(29,47)),new Qt(30,new Jt(42,24),new Jt(1,25)),new Qt(30,new Jt(23,15),new Jt(28,16))),new $t(32,Int32Array.from([6,34,60,86,112,138]),new Qt(30,new Jt(17,115)),new Qt(28,new Jt(10,46),new Jt(23,47)),new Qt(30,new Jt(10,24),new Jt(35,25)),new Qt(30,new Jt(19,15),new Jt(35,16))),new $t(33,Int32Array.from([6,30,58,86,114,142]),new Qt(30,new Jt(17,115),new Jt(1,116)),new Qt(28,new Jt(14,46),new Jt(21,47)),new Qt(30,new Jt(29,24),new Jt(19,25)),new Qt(30,new Jt(11,15),new Jt(46,16))),new $t(34,Int32Array.from([6,34,62,90,118,146]),new Qt(30,new Jt(13,115),new Jt(6,116)),new Qt(28,new Jt(14,46),new Jt(23,47)),new Qt(30,new Jt(44,24),new Jt(7,25)),new Qt(30,new Jt(59,16),new Jt(1,17))),new $t(35,Int32Array.from([6,30,54,78,102,126,150]),new Qt(30,new Jt(12,121),new Jt(7,122)),new Qt(28,new Jt(12,47),new Jt(26,48)),new Qt(30,new Jt(39,24),new Jt(14,25)),new Qt(30,new Jt(22,15),new Jt(41,16))),new $t(36,Int32Array.from([6,24,50,76,102,128,154]),new Qt(30,new Jt(6,121),new Jt(14,122)),new Qt(28,new Jt(6,47),new Jt(34,48)),new Qt(30,new Jt(46,24),new Jt(10,25)),new Qt(30,new Jt(2,15),new Jt(64,16))),new $t(37,Int32Array.from([6,28,54,80,106,132,158]),new Qt(30,new Jt(17,122),new Jt(4,123)),new Qt(28,new Jt(29,46),new Jt(14,47)),new Qt(30,new Jt(49,24),new Jt(10,25)),new Qt(30,new Jt(24,15),new Jt(46,16))),new $t(38,Int32Array.from([6,32,58,84,110,136,162]),new Qt(30,new Jt(4,122),new Jt(18,123)),new Qt(28,new Jt(13,46),new Jt(32,47)),new Qt(30,new Jt(48,24),new Jt(14,25)),new Qt(30,new Jt(42,15),new Jt(32,16))),new $t(39,Int32Array.from([6,26,54,82,110,138,166]),new Qt(30,new Jt(20,117),new Jt(4,118)),new Qt(28,new Jt(40,47),new Jt(7,48)),new Qt(30,new Jt(43,24),new Jt(22,25)),new Qt(30,new Jt(10,15),new Jt(67,16))),new $t(40,Int32Array.from([6,30,58,86,114,142,170]),new Qt(30,new Jt(19,118),new Jt(6,119)),new Qt(28,new Jt(18,47),new Jt(31,48)),new Qt(30,new Jt(34,24),new Jt(34,25)),new Qt(30,new Jt(20,15),new Jt(61,16)))],function(t){t[t.DATA_MASK_000=0]="DATA_MASK_000",t[t.DATA_MASK_001=1]="DATA_MASK_001",t[t.DATA_MASK_010=2]="DATA_MASK_010",t[t.DATA_MASK_011=3]="DATA_MASK_011",t[t.DATA_MASK_100=4]="DATA_MASK_100",t[t.DATA_MASK_101=5]="DATA_MASK_101",t[t.DATA_MASK_110=6]="DATA_MASK_110",t[t.DATA_MASK_111=7]="DATA_MASK_111"}(W||(W={}));class te{constructor(t,e){this.value=t,this.isMasked=e}unmaskBitMatrix(t,e){for(let r=0;r<e;r++)for(let n=0;n<e;n++)this.isMasked(r,n)&&t.flip(n,r)}}te.values=new Map([[W.DATA_MASK_000,new te(W.DATA_MASK_000,((t,e)=>0==(t+e&1)))],[W.DATA_MASK_001,new te(W.DATA_MASK_001,((t,e)=>0==(1&t)))],[W.DATA_MASK_010,new te(W.DATA_MASK_010,((t,e)=>e%3==0))],[W.DATA_MASK_011,new te(W.DATA_MASK_011,((t,e)=>(t+e)%3==0))],[W.DATA_MASK_100,new te(W.DATA_MASK_100,((t,e)=>0==(Math.floor(t/2)+Math.floor(e/3)&1)))],[W.DATA_MASK_101,new te(W.DATA_MASK_101,((t,e)=>t*e%6==0))],[W.DATA_MASK_110,new te(W.DATA_MASK_110,((t,e)=>t*e%6<3))],[W.DATA_MASK_111,new te(W.DATA_MASK_111,((t,e)=>0==(t+e+t*e%3&1)))]]);class ee{constructor(t){const e=t.getHeight();if(e<21||1!=(3&e))throw new C;this.bitMatrix=t}readFormatInformation(){if(null!==this.parsedFormatInfo&&void 0!==this.parsedFormatInfo)return this.parsedFormatInfo;let t=0;for(let e=0;e<6;e++)t=this.copyBit(e,8,t);t=this.copyBit(7,8,t),t=this.copyBit(8,8,t),t=this.copyBit(8,7,t);for(let e=5;e>=0;e--)t=this.copyBit(8,e,t);const e=this.bitMatrix.getHeight();let r=0;const n=e-7;for(let t=e-1;t>=n;t--)r=this.copyBit(8,t,r);for(let t=e-8;t<e;t++)r=this.copyBit(t,8,r);if(this.parsedFormatInfo=qt.decodeFormatInformation(t,r),null!==this.parsedFormatInfo)return this.parsedFormatInfo;throw new C}readVersion(){if(null!==this.parsedVersion&&void 0!==this.parsedVersion)return this.parsedVersion;const t=this.bitMatrix.getHeight(),e=Math.floor((t-17)/4);if(e<=6)return $t.getVersionForNumber(e);let r=0;const n=t-11;for(let e=5;e>=0;e--)for(let i=t-9;i>=n;i--)r=this.copyBit(i,e,r);let i=$t.decodeVersionInformation(r);if(null!==i&&i.getDimensionForVersion()===t)return this.parsedVersion=i,i;r=0;for(let e=5;e>=0;e--)for(let i=t-9;i>=n;i--)r=this.copyBit(e,i,r);if(i=$t.decodeVersionInformation(r),null!==i&&i.getDimensionForVersion()===t)return this.parsedVersion=i,i;throw new C}copyBit(t,e,r){return(this.isMirror?this.bitMatrix.get(e,t):this.bitMatrix.get(t,e))?r<<1|1:r<<1}readCodewords(){const t=this.readFormatInformation(),e=this.readVersion(),r=te.values.get(t.getDataMask()),n=this.bitMatrix.getHeight();r.unmaskBitMatrix(this.bitMatrix,n);const i=e.buildFunctionPattern();let o=!0;const s=new Uint8Array(e.getTotalCodewords());let a=0,u=0,l=0;for(let t=n-1;t>0;t-=2){6===t&&t--;for(let e=0;e<n;e++){const r=o?n-1-e:e;for(let e=0;e<2;e++)i.get(t-e,r)||(l++,u<<=1,this.bitMatrix.get(t-e,r)&&(u|=1),8===l&&(s[a++]=u,l=0,u=0))}o=!o}if(a!==e.getTotalCodewords())throw new C;return s}remask(){if(null===this.parsedFormatInfo)return;const t=te.values[this.parsedFormatInfo.getDataMask()],e=this.bitMatrix.getHeight();t.unmaskBitMatrix(this.bitMatrix,e)}setMirror(t){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=t}mirror(){const t=this.bitMatrix;for(let e=0,r=t.getWidth();e<r;e++)for(let r=e+1,n=t.getHeight();r<n;r++)t.get(e,r)!==t.get(r,e)&&(t.flip(r,e),t.flip(e,r))}}class re{constructor(t){this.mirrored=t}isMirrored(){return this.mirrored}applyMirroredCorrection(t){if(!this.mirrored||null===t||t.length<3)return;const e=t[0];t[0]=t[2],t[2]=e}}class ne{constructor(t,e){this.numDataCodewords=t,this.codewords=e}static getDataBlocks(t,e,r){if(t.length!==e.getTotalCodewords())throw new h;const n=e.getECBlocksForLevel(r);let i=0;const o=n.getECBlocks();for(const t of o)i+=t.getCount();const s=new Array(i);let a=0;for(const t of o)for(let e=0;e<t.getCount();e++){const e=t.getDataCodewords(),r=n.getECCodewordsPerBlock()+e;s[a++]=new ne(e,new Uint8Array(r))}const u=s[0].codewords.length;let l=s.length-1;for(;l>=0&&s[l].codewords.length!==u;)l--;l++;const c=u-n.getECCodewordsPerBlock();let d=0;for(let e=0;e<c;e++)for(let r=0;r<a;r++)s[r].codewords[e]=t[d++];for(let e=l;e<a;e++)s[e].codewords[c]=t[d++];const f=s[0].codewords.length;for(let e=c;e<f;e++)for(let r=0;r<a;r++){const n=r<l?e:e+1;s[r].codewords[n]=t[d++]}return s}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}!function(t){t[t.TERMINATOR=0]="TERMINATOR",t[t.NUMERIC=1]="NUMERIC",t[t.ALPHANUMERIC=2]="ALPHANUMERIC",t[t.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",t[t.BYTE=4]="BYTE",t[t.ECI=5]="ECI",t[t.KANJI=6]="KANJI",t[t.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",t[t.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",t[t.HANZI=9]="HANZI"}(Y||(Y={}));class ie{constructor(t,e,r,n){this.value=t,this.stringValue=e,this.characterCountBitsForVersions=r,this.bits=n,ie.FOR_BITS.set(n,this),ie.FOR_VALUE.set(t,this)}static forBits(t){const e=ie.FOR_BITS.get(t);if(void 0===e)throw new h;return e}getCharacterCountBits(t){const e=t.getVersionNumber();let r;return r=e<=9?0:e<=26?1:2,this.characterCountBitsForVersions[r]}getValue(){return this.value}getBits(){return this.bits}equals(t){if(!(t instanceof ie))return!1;const e=t;return this.value===e.value}toString(){return this.stringValue}}ie.FOR_BITS=new Map,ie.FOR_VALUE=new Map,ie.TERMINATOR=new ie(Y.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),ie.NUMERIC=new ie(Y.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),ie.ALPHANUMERIC=new ie(Y.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),ie.STRUCTURED_APPEND=new ie(Y.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),ie.BYTE=new ie(Y.BYTE,"BYTE",Int32Array.from([8,16,16]),4),ie.ECI=new ie(Y.ECI,"ECI",Int32Array.from([0,0,0]),7),ie.KANJI=new ie(Y.KANJI,"KANJI",Int32Array.from([8,10,12]),8),ie.FNC1_FIRST_POSITION=new ie(Y.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),ie.FNC1_SECOND_POSITION=new ie(Y.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),ie.HANZI=new ie(Y.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class oe{static decode(t,e,r,n){const i=new Gt(t);let o=new T;const s=new Array;let a=-1,u=-1;try{let t,r=null,l=!1;do{if(i.available()<4)t=ie.TERMINATOR;else{const e=i.readBits(4);t=ie.forBits(e)}switch(t){case ie.TERMINATOR:break;case ie.FNC1_FIRST_POSITION:case ie.FNC1_SECOND_POSITION:l=!0;break;case ie.STRUCTURED_APPEND:if(i.available()<16)throw new C;a=i.readBits(8),u=i.readBits(8);break;case ie.ECI:const h=oe.parseECIValue(i);if(r=b.getCharacterSetECIByValue(h),null===r)throw new C;break;case ie.HANZI:const c=i.readBits(4),d=i.readBits(t.getCharacterCountBits(e));c===oe.GB2312_SUBSET&&oe.decodeHanziSegment(i,o,d);break;default:const f=i.readBits(t.getCharacterCountBits(e));switch(t){case ie.NUMERIC:oe.decodeNumericSegment(i,o,f);break;case ie.ALPHANUMERIC:oe.decodeAlphanumericSegment(i,o,f,l);break;case ie.BYTE:oe.decodeByteSegment(i,o,f,r,s,n);break;case ie.KANJI:oe.decodeKanjiSegment(i,o,f);break;default:throw new C}}}while(t!==ie.TERMINATOR)}catch(t){throw new C}return new j(t,o.toString(),0===s.length?null:s,null===r?null:r.toString(),a,u)}static decodeHanziSegment(t,e,r){if(13*r>t.available())throw new C;const n=new Uint8Array(2*r);let i=0;for(;r>0;){const e=t.readBits(13);let o=e/96<<8&4294967295|e%96;o+=o<959?41377:42657,n[i]=o>>8&255,n[i+1]=255&o,i+=2,r--}try{e.append(v.decode(n,S.GB2312))}catch(t){throw new C(t)}}static decodeKanjiSegment(t,e,r){if(13*r>t.available())throw new C;const n=new Uint8Array(2*r);let i=0;for(;r>0;){const e=t.readBits(13);let o=e/192<<8&4294967295|e%192;o+=o<7936?33088:49472,n[i]=o>>8,n[i+1]=o,i+=2,r--}try{e.append(v.decode(n,S.SHIFT_JIS))}catch(t){throw new C(t)}}static decodeByteSegment(t,e,r,n,i,o){if(8*r>t.available())throw new C;const s=new Uint8Array(r);for(let e=0;e<r;e++)s[e]=t.readBits(8);let a;a=null===n?S.guessEncoding(s,o):n.getName();try{e.append(v.decode(s,a))}catch(t){throw new C(t)}i.push(s)}static toAlphaNumericChar(t){if(t>=oe.ALPHANUMERIC_CHARS.length)throw new C;return oe.ALPHANUMERIC_CHARS[t]}static decodeAlphanumericSegment(t,e,r,n){const i=e.length();for(;r>1;){if(t.available()<11)throw new C;const n=t.readBits(11);e.append(oe.toAlphaNumericChar(Math.floor(n/45))),e.append(oe.toAlphaNumericChar(n%45)),r-=2}if(1===r){if(t.available()<6)throw new C;e.append(oe.toAlphaNumericChar(t.readBits(6)))}if(n)for(let t=i;t<e.length();t++)"%"===e.charAt(t)&&(t<e.length()-1&&"%"===e.charAt(t+1)?e.deleteCharAt(t+1):e.setCharAt(t,String.fromCharCode(29)))}static decodeNumericSegment(t,e,r){for(;r>=3;){if(t.available()<10)throw new C;const n=t.readBits(10);if(n>=1e3)throw new C;e.append(oe.toAlphaNumericChar(Math.floor(n/100))),e.append(oe.toAlphaNumericChar(Math.floor(n/10)%10)),e.append(oe.toAlphaNumericChar(n%10)),r-=3}if(2===r){if(t.available()<7)throw new C;const r=t.readBits(7);if(r>=100)throw new C;e.append(oe.toAlphaNumericChar(Math.floor(r/10))),e.append(oe.toAlphaNumericChar(r%10))}else if(1===r){if(t.available()<4)throw new C;const r=t.readBits(4);if(r>=10)throw new C;e.append(oe.toAlphaNumericChar(r))}}static parseECIValue(t){const e=t.readBits(8);if(0==(128&e))return 127&e;if(128==(192&e))return(63&e)<<8&4294967295|t.readBits(8);if(192==(224&e))return(31&e)<<16&4294967295|t.readBits(16);throw new C}}oe.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",oe.GB2312_SUBSET=1;class se{constructor(){this.rsDecoder=new rt($.QR_CODE_FIELD_256)}decodeBooleanArray(t,e){return this.decodeBitMatrix(R.parseFromBooleanArray(t),e)}decodeBitMatrix(t,e){const r=new ee(t);let n=null;try{return this.decodeBitMatrixParser(r,e)}catch(t){n=t}try{r.remask(),r.setMirror(!0),r.readVersion(),r.readFormatInformation(),r.mirror();const t=this.decodeBitMatrixParser(r,e);return t.setOther(new re(!0)),t}catch(t){if(null!==n)throw n;throw t}}decodeBitMatrixParser(t,e){const r=t.readVersion(),n=t.readFormatInformation().getErrorCorrectionLevel(),i=t.readCodewords(),o=ne.getDataBlocks(i,r,n);let s=0;for(const t of o)s+=t.getNumDataCodewords();const a=new Uint8Array(s);let u=0;for(const t of o){const e=t.getCodewords(),r=t.getNumDataCodewords();this.correctErrors(e,r);for(let t=0;t<r;t++)a[u++]=e[t]}return oe.decode(a,r,n,e)}correctErrors(t,e){t.length;const r=new Int32Array(t);try{this.rsDecoder.decode(r,t.length-e)}catch(t){throw new d}for(let n=0;n<e;n++)t[n]=r[n]}}class ae extends st{constructor(t,e,r,n){super(t,e),this.estimatedModuleSize=r,this.count=n,void 0===n&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(t,e,r){if(Math.abs(e-this.getY())<=t&&Math.abs(r-this.getX())<=t){const e=Math.abs(t-this.estimatedModuleSize);return e<=1||e<=this.estimatedModuleSize}return!1}combineEstimate(t,e,r){const n=this.count+1,i=(this.count*this.getX()+e)/n,o=(this.count*this.getY()+t)/n,s=(this.count*this.estimatedModuleSize+r)/n;return new ae(i,o,s,n)}}class ue{constructor(t){this.bottomLeft=t[0],this.topLeft=t[1],this.topRight=t[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class le{constructor(t,e){this.image=t,this.resultPointCallback=e,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=e}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(t){const e=null!=t&&void 0!==t.get(y.TRY_HARDER),r=null!=t&&void 0!==t.get(y.PURE_BARCODE),n=this.image,i=n.getHeight(),o=n.getWidth();let s=Math.floor(3*i/(4*le.MAX_MODULES));(s<le.MIN_SKIP||e)&&(s=le.MIN_SKIP);let a=!1;const u=new Int32Array(5);for(let t=s-1;t<i&&!a;t+=s){u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0;let e=0;for(let i=0;i<o;i++)if(n.get(i,t))1==(1&e)&&e++,u[e]++;else if(0==(1&e))if(4===e)if(le.foundPatternCross(u)){if(!0!==this.handlePossibleCenter(u,t,i,r)){u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,e=3;continue}if(s=2,!0===this.hasSkipped)a=this.haveMultiplyConfirmedCenters();else{const e=this.findRowSkip();e>u[2]&&(t+=e-u[2]-s,i=o-1)}e=0,u[0]=0,u[1]=0,u[2]=0,u[3]=0,u[4]=0}else u[0]=u[2],u[1]=u[3],u[2]=u[4],u[3]=1,u[4]=0,e=3;else u[++e]++;else u[e]++;le.foundPatternCross(u)&&!0===this.handlePossibleCenter(u,t,o,r)&&(s=u[0],this.hasSkipped&&(a=this.haveMultiplyConfirmedCenters()))}const l=this.selectBestPatterns();return st.orderBestPatterns(l),new ue(l)}static centerFromEnd(t,e){return e-t[4]-t[3]-t[2]/2}static foundPatternCross(t){let e=0;for(let r=0;r<5;r++){const n=t[r];if(0===n)return!1;e+=n}if(e<7)return!1;const r=e/7,n=r/2;return Math.abs(r-t[0])<n&&Math.abs(r-t[1])<n&&Math.abs(3*r-t[2])<3*n&&Math.abs(r-t[3])<n&&Math.abs(r-t[4])<n}getCrossCheckStateCount(){const t=this.crossCheckStateCount;return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t}crossCheckDiagonal(t,e,r,n){const i=this.getCrossCheckStateCount();let o=0;const s=this.image;for(;t>=o&&e>=o&&s.get(e-o,t-o);)i[2]++,o++;if(t<o||e<o)return!1;for(;t>=o&&e>=o&&!s.get(e-o,t-o)&&i[1]<=r;)i[1]++,o++;if(t<o||e<o||i[1]>r)return!1;for(;t>=o&&e>=o&&s.get(e-o,t-o)&&i[0]<=r;)i[0]++,o++;if(i[0]>r)return!1;const a=s.getHeight(),u=s.getWidth();for(o=1;t+o<a&&e+o<u&&s.get(e+o,t+o);)i[2]++,o++;if(t+o>=a||e+o>=u)return!1;for(;t+o<a&&e+o<u&&!s.get(e+o,t+o)&&i[3]<r;)i[3]++,o++;if(t+o>=a||e+o>=u||i[3]>=r)return!1;for(;t+o<a&&e+o<u&&s.get(e+o,t+o)&&i[4]<r;)i[4]++,o++;if(i[4]>=r)return!1;const l=i[0]+i[1]+i[2]+i[3]+i[4];return Math.abs(l-n)<2*n&&le.foundPatternCross(i)}crossCheckVertical(t,e,r,n){const i=this.image,o=i.getHeight(),s=this.getCrossCheckStateCount();let a=t;for(;a>=0&&i.get(e,a);)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(e,a)&&s[1]<=r;)s[1]++,a--;if(a<0||s[1]>r)return NaN;for(;a>=0&&i.get(e,a)&&s[0]<=r;)s[0]++,a--;if(s[0]>r)return NaN;for(a=t+1;a<o&&i.get(e,a);)s[2]++,a++;if(a===o)return NaN;for(;a<o&&!i.get(e,a)&&s[3]<r;)s[3]++,a++;if(a===o||s[3]>=r)return NaN;for(;a<o&&i.get(e,a)&&s[4]<r;)s[4]++,a++;if(s[4]>=r)return NaN;const u=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(u-n)>=2*n?NaN:le.foundPatternCross(s)?le.centerFromEnd(s,a):NaN}crossCheckHorizontal(t,e,r,n){const i=this.image,o=i.getWidth(),s=this.getCrossCheckStateCount();let a=t;for(;a>=0&&i.get(a,e);)s[2]++,a--;if(a<0)return NaN;for(;a>=0&&!i.get(a,e)&&s[1]<=r;)s[1]++,a--;if(a<0||s[1]>r)return NaN;for(;a>=0&&i.get(a,e)&&s[0]<=r;)s[0]++,a--;if(s[0]>r)return NaN;for(a=t+1;a<o&&i.get(a,e);)s[2]++,a++;if(a===o)return NaN;for(;a<o&&!i.get(a,e)&&s[3]<r;)s[3]++,a++;if(a===o||s[3]>=r)return NaN;for(;a<o&&i.get(a,e)&&s[4]<r;)s[4]++,a++;if(s[4]>=r)return NaN;const u=s[0]+s[1]+s[2]+s[3]+s[4];return 5*Math.abs(u-n)>=n?NaN:le.foundPatternCross(s)?le.centerFromEnd(s,a):NaN}handlePossibleCenter(t,e,r,n){const i=t[0]+t[1]+t[2]+t[3]+t[4];let o=le.centerFromEnd(t,r),s=this.crossCheckVertical(e,Math.floor(o),t[2],i);if(!isNaN(s)&&(o=this.crossCheckHorizontal(Math.floor(o),Math.floor(s),t[2],i),!isNaN(o)&&(!n||this.crossCheckDiagonal(Math.floor(s),Math.floor(o),t[2],i)))){const t=i/7;let e=!1;const r=this.possibleCenters;for(let n=0,i=r.length;n<i;n++){const i=r[n];if(i.aboutEquals(t,s,o)){r[n]=i.combineEstimate(s,o,t),e=!0;break}}if(!e){const e=new ae(o,s,t);r.push(e),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(e)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let t=null;for(const e of this.possibleCenters)if(e.getCount()>=le.CENTER_QUORUM){if(null!=t)return this.hasSkipped=!0,Math.floor((Math.abs(t.getX()-e.getX())-Math.abs(t.getY()-e.getY()))/2);t=e}return 0}haveMultiplyConfirmedCenters(){let t=0,e=0;const r=this.possibleCenters.length;for(const r of this.possibleCenters)r.getCount()>=le.CENTER_QUORUM&&(t++,e+=r.getEstimatedModuleSize());if(t<3)return!1;const n=e/r;let i=0;for(const t of this.possibleCenters)i+=Math.abs(t.getEstimatedModuleSize()-n);return i<=.05*e}selectBestPatterns(){const t=this.possibleCenters.length;if(t<3)throw new N;const e=this.possibleCenters;let r;if(t>3){let n=0,i=0;for(const t of this.possibleCenters){const e=t.getEstimatedModuleSize();n+=e,i+=e*e}r=n/t;let o=Math.sqrt(i/t-r*r);e.sort(((t,e)=>{const n=Math.abs(e.getEstimatedModuleSize()-r),i=Math.abs(t.getEstimatedModuleSize()-r);return n<i?-1:n>i?1:0}));const s=Math.max(.2*r,o);for(let t=0;t<e.length&&e.length>3;t++){const n=e[t];Math.abs(n.getEstimatedModuleSize()-r)>s&&(e.splice(t,1),t--)}}if(e.length>3){let t=0;for(const r of e)t+=r.getEstimatedModuleSize();r=t/e.length,e.sort(((t,e)=>{if(e.getCount()===t.getCount()){const n=Math.abs(e.getEstimatedModuleSize()-r),i=Math.abs(t.getEstimatedModuleSize()-r);return n<i?1:n>i?-1:0}return e.getCount()-t.getCount()})),e.splice(3)}return[e[0],e[1],e[2]]}}le.CENTER_QUORUM=2,le.MIN_SKIP=3,le.MAX_MODULES=57;class he extends st{constructor(t,e,r){super(t,e),this.estimatedModuleSize=r}aboutEquals(t,e,r){if(Math.abs(e-this.getY())<=t&&Math.abs(r-this.getX())<=t){const e=Math.abs(t-this.estimatedModuleSize);return e<=1||e<=this.estimatedModuleSize}return!1}combineEstimate(t,e,r){const n=(this.getX()+e)/2,i=(this.getY()+t)/2,o=(this.estimatedModuleSize+r)/2;return new he(n,i,o)}}class ce{constructor(t,e,r,n,i,o,s){this.image=t,this.startX=e,this.startY=r,this.width=n,this.height=i,this.moduleSize=o,this.resultPointCallback=s,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const t=this.startX,e=this.height,r=t+this.width,n=this.startY+e/2,i=new Int32Array(3),o=this.image;for(let s=0;s<e;s++){const e=n+(0==(1&s)?Math.floor((s+1)/2):-Math.floor((s+1)/2));i[0]=0,i[1]=0,i[2]=0;let a=t;for(;a<r&&!o.get(a,e);)a++;let u=0;for(;a<r;){if(o.get(a,e))if(1===u)i[1]++;else if(2===u){if(this.foundPatternCross(i)){const t=this.handlePossibleCenter(i,e,a);if(null!==t)return t}i[0]=i[2],i[1]=1,i[2]=0,u=1}else i[++u]++;else 1===u&&u++,i[u]++;a++}if(this.foundPatternCross(i)){const t=this.handlePossibleCenter(i,e,r);if(null!==t)return t}}if(0!==this.possibleCenters.length)return this.possibleCenters[0];throw new N}static centerFromEnd(t,e){return e-t[2]-t[1]/2}foundPatternCross(t){const e=this.moduleSize,r=e/2;for(let n=0;n<3;n++)if(Math.abs(e-t[n])>=r)return!1;return!0}crossCheckVertical(t,e,r,n){const i=this.image,o=i.getHeight(),s=this.crossCheckStateCount;s[0]=0,s[1]=0,s[2]=0;let a=t;for(;a>=0&&i.get(e,a)&&s[1]<=r;)s[1]++,a--;if(a<0||s[1]>r)return NaN;for(;a>=0&&!i.get(e,a)&&s[0]<=r;)s[0]++,a--;if(s[0]>r)return NaN;for(a=t+1;a<o&&i.get(e,a)&&s[1]<=r;)s[1]++,a++;if(a===o||s[1]>r)return NaN;for(;a<o&&!i.get(e,a)&&s[2]<=r;)s[2]++,a++;if(s[2]>r)return NaN;const u=s[0]+s[1]+s[2];return 5*Math.abs(u-n)>=2*n?NaN:this.foundPatternCross(s)?ce.centerFromEnd(s,a):NaN}handlePossibleCenter(t,e,r){const n=t[0]+t[1]+t[2],i=ce.centerFromEnd(t,r),o=this.crossCheckVertical(e,i,2*t[1],n);if(!isNaN(o)){const e=(t[0]+t[1]+t[2])/3;for(const t of this.possibleCenters)if(t.aboutEquals(e,o,i))return t.combineEstimate(o,i,e);const r=new he(i,o,e);this.possibleCenters.push(r),null!==this.resultPointCallback&&void 0!==this.resultPointCallback&&this.resultPointCallback.foundPossibleResultPoint(r)}return null}}class de{constructor(t){this.image=t}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(t){this.resultPointCallback=null==t?null:t.get(y.NEED_RESULT_POINT_CALLBACK);const e=new le(this.image,this.resultPointCallback).find(t);return this.processFinderPatternInfo(e)}processFinderPatternInfo(t){const e=t.getTopLeft(),r=t.getTopRight(),n=t.getBottomLeft(),i=this.calculateModuleSize(e,r,n);if(i<1)throw new N("No pattern found in proccess finder.");const o=de.computeDimension(e,r,n,i),s=$t.getProvisionalVersionForDimension(o),a=s.getDimensionForVersion()-7;let u=null;if(s.getAlignmentPatternCenters().length>0){const t=r.getX()-e.getX()+n.getX(),o=r.getY()-e.getY()+n.getY(),s=1-3/a,l=Math.floor(e.getX()+s*(t-e.getX())),h=Math.floor(e.getY()+s*(o-e.getY()));for(let t=4;t<=16;t<<=1)try{u=this.findAlignmentInRegion(i,l,h,t);break}catch(t){if(!(t instanceof N))throw t}}const l=de.createTransform(e,r,n,u,o),h=de.sampleGrid(this.image,l,o);let c;return c=null===u?[n,e,r]:[n,e,r,u],new at(h,c)}static createTransform(t,e,r,n,i){const o=i-3.5;let s,a,u,l;return null!==n?(s=n.getX(),a=n.getY(),u=o-3,l=u):(s=e.getX()-t.getX()+r.getX(),a=e.getY()-t.getY()+r.getY(),u=o,l=o),ct.quadrilateralToQuadrilateral(3.5,3.5,o,3.5,u,l,3.5,o,t.getX(),t.getY(),e.getX(),e.getY(),s,a,r.getX(),r.getY())}static sampleGrid(t,e,r){return ft.getInstance().sampleGridWithTransform(t,r,r,e)}static computeDimension(t,e,r,n){const i=it.round(st.distance(t,e)/n),o=it.round(st.distance(t,r)/n);let s=Math.floor((i+o)/2)+7;switch(3&s){case 0:s++;break;case 2:s--;break;case 3:throw new N("Dimensions could be not found.")}return s}calculateModuleSize(t,e,r){return(this.calculateModuleSizeOneWay(t,e)+this.calculateModuleSizeOneWay(t,r))/2}calculateModuleSizeOneWay(t,e){const r=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(t.getX()),Math.floor(t.getY()),Math.floor(e.getX()),Math.floor(e.getY())),n=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(e.getX()),Math.floor(e.getY()),Math.floor(t.getX()),Math.floor(t.getY()));return isNaN(r)?n/7:isNaN(n)?r/7:(r+n)/14}sizeOfBlackWhiteBlackRunBothWays(t,e,r,n){let i=this.sizeOfBlackWhiteBlackRun(t,e,r,n),o=1,s=t-(r-t);s<0?(o=t/(t-s),s=0):s>=this.image.getWidth()&&(o=(this.image.getWidth()-1-t)/(s-t),s=this.image.getWidth()-1);let a=Math.floor(e-(n-e)*o);return o=1,a<0?(o=e/(e-a),a=0):a>=this.image.getHeight()&&(o=(this.image.getHeight()-1-e)/(a-e),a=this.image.getHeight()-1),s=Math.floor(t+(s-t)*o),i+=this.sizeOfBlackWhiteBlackRun(t,e,s,a),i-1}sizeOfBlackWhiteBlackRun(t,e,r,n){const i=Math.abs(n-e)>Math.abs(r-t);if(i){let i=t;t=e,e=i,i=r,r=n,n=i}const o=Math.abs(r-t),s=Math.abs(n-e);let a=-o/2;const u=t<r?1:-1,l=e<n?1:-1;let h=0;const c=r+u;for(let r=t,d=e;r!==c;r+=u){const u=i?d:r,c=i?r:d;if(1===h===this.image.get(u,c)){if(2===h)return it.distance(r,d,t,e);h++}if(a+=s,a>0){if(d===n)break;d+=l,a-=o}}return 2===h?it.distance(r+u,n,t,e):NaN}findAlignmentInRegion(t,e,r,n){const i=Math.floor(n*t),o=Math.max(0,e-i),s=Math.min(this.image.getWidth()-1,e+i);if(s-o<3*t)throw new N("Alignment top exceeds estimated module size.");const a=Math.max(0,r-i),u=Math.min(this.image.getHeight()-1,r+i);if(u-a<3*t)throw new N("Alignment bottom exceeds estimated module size.");return new ce(this.image,o,a,s-o,u-a,t,this.resultPointCallback).find()}}class fe{constructor(){this.decoder=new se}getDecoder(){return this.decoder}decode(t,e){let r,n;if(null!=e&&void 0!==e.get(y.PURE_BARCODE)){const i=fe.extractPureBits(t.getBlackMatrix());r=this.decoder.decodeBitMatrix(i,e),n=fe.NO_POINTS}else{const i=new de(t.getBlackMatrix()).detect(e);r=this.decoder.decodeBitMatrix(i.getBits(),e),n=i.getPoints()}r.getOther()instanceof re&&r.getOther().applyMirroredCorrection(n);const i=new U(r.getText(),r.getRawBytes(),void 0,n,H.QR_CODE,void 0),o=r.getByteSegments();null!==o&&i.putMetadata(Z.BYTE_SEGMENTS,o);const s=r.getECLevel();return null!==s&&i.putMetadata(Z.ERROR_CORRECTION_LEVEL,s),r.hasStructuredAppend()&&(i.putMetadata(Z.STRUCTURED_APPEND_SEQUENCE,r.getStructuredAppendSequenceNumber()),i.putMetadata(Z.STRUCTURED_APPEND_PARITY,r.getStructuredAppendParity())),i}reset(){}static extractPureBits(t){const e=t.getTopLeftOnBit(),r=t.getBottomRightOnBit();if(null===e||null===r)throw new N;const n=this.moduleSize(e,t);let i=e[1],o=r[1],s=e[0],a=r[0];if(s>=a||i>=o)throw new N;if(o-i!=a-s&&(a=s+(o-i),a>=t.getWidth()))throw new N;const u=Math.round((a-s+1)/n),l=Math.round((o-i+1)/n);if(u<=0||l<=0)throw new N;if(l!==u)throw new N;const h=Math.floor(n/2);i+=h,s+=h;const c=s+Math.floor((u-1)*n)-a;if(c>0){if(c>h)throw new N;s-=c}const d=i+Math.floor((l-1)*n)-o;if(d>0){if(d>h)throw new N;i-=d}const f=new R(u,l);for(let e=0;e<l;e++){const r=i+Math.floor(e*n);for(let i=0;i<u;i++)t.get(s+Math.floor(i*n),r)&&f.set(i,e)}return f}static moduleSize(t,e){const r=e.getHeight(),n=e.getWidth();let i=t[0],o=t[1],s=!0,a=0;for(;i<n&&o<r;){if(s!==e.get(i,o)){if(5==++a)break;s=!s}i++,o++}if(i===n||o===r)throw new N;return(i-t[0])/7}}fe.NO_POINTS=new Array;class ge{PDF417Common(){}static getBitCountSum(t){return it.sum(t)}static toIntArray(t){if(null==t||!t.length)return ge.EMPTY_INT_ARRAY;const e=new Int32Array(t.length);let r=0;for(const n of t)e[r++]=n;return e}static getCodeword(t){const e=m.binarySearch(ge.SYMBOL_TABLE,262143&t);return e<0?-1:(ge.CODEWORD_TABLE[e]-1)%ge.NUMBER_OF_CODEWORDS}}ge.NUMBER_OF_CODEWORDS=929,ge.MAX_CODEWORDS_IN_BARCODE=ge.NUMBER_OF_CODEWORDS-1,ge.MIN_ROWS_IN_BARCODE=3,ge.MAX_ROWS_IN_BARCODE=90,ge.MODULES_IN_CODEWORD=17,ge.MODULES_IN_STOP_PATTERN=18,ge.BARS_IN_MODULE=8,ge.EMPTY_INT_ARRAY=new Int32Array([]),ge.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),ge.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class we{constructor(t,e){this.bits=t,this.points=e}getBits(){return this.bits}getPoints(){return this.points}}class pe{static detectMultiple(t,e,r){let n=t.getBlackMatrix(),i=pe.detect(r,n);return i.length||(n=n.clone(),n.rotate180(),i=pe.detect(r,n)),new we(n,i)}static detect(t,e){const r=new Array;let n=0,i=0,o=!1;for(;n<e.getHeight();){const s=pe.findVertices(e,n,i);if(null!=s[0]||null!=s[3]){if(o=!0,r.push(s),!t)break;null!=s[2]?(i=Math.trunc(s[2].getX()),n=Math.trunc(s[2].getY())):(i=Math.trunc(s[4].getX()),n=Math.trunc(s[4].getY()))}else{if(!o)break;o=!1,i=0;for(const t of r)null!=t[1]&&(n=Math.trunc(Math.max(n,t[1].getY()))),null!=t[3]&&(n=Math.max(n,Math.trunc(t[3].getY())));n+=pe.ROW_STEP}}return r}static findVertices(t,e,r){const n=t.getHeight(),i=t.getWidth(),o=new Array(8);return pe.copyToResult(o,pe.findRowsWithPattern(t,n,i,e,r,pe.START_PATTERN),pe.INDEXES_START_PATTERN),null!=o[4]&&(r=Math.trunc(o[4].getX()),e=Math.trunc(o[4].getY())),pe.copyToResult(o,pe.findRowsWithPattern(t,n,i,e,r,pe.STOP_PATTERN),pe.INDEXES_STOP_PATTERN),o}static copyToResult(t,e,r){for(let n=0;n<r.length;n++)t[r[n]]=e[n]}static findRowsWithPattern(t,e,r,n,i,o){const s=new Array(4);let a=!1;const u=new Int32Array(o.length);for(;n<e;n+=pe.ROW_STEP){let e=pe.findGuardPattern(t,i,n,r,!1,o,u);if(null!=e){for(;n>0;){const s=pe.findGuardPattern(t,i,--n,r,!1,o,u);if(null==s){n++;break}e=s}s[0]=new st(e[0],n),s[1]=new st(e[1],n),a=!0;break}}let l=n+1;if(a){let n=0,i=Int32Array.from([Math.trunc(s[0].getX()),Math.trunc(s[1].getX())]);for(;l<e;l++){const e=pe.findGuardPattern(t,i[0],l,r,!1,o,u);if(null!=e&&Math.abs(i[0]-e[0])<pe.MAX_PATTERN_DRIFT&&Math.abs(i[1]-e[1])<pe.MAX_PATTERN_DRIFT)i=e,n=0;else{if(n>pe.SKIPPED_ROW_COUNT_MAX)break;n++}}l-=n+1,s[2]=new st(i[0],l),s[3]=new st(i[1],l)}return l-n<pe.BARCODE_MIN_HEIGHT&&m.fill(s,null),s}static findGuardPattern(t,e,r,n,i,o,s){m.fillWithin(s,0,s.length,0);let a=e,u=0;for(;t.get(a,r)&&a>0&&u++<pe.MAX_PIXEL_DRIFT;)a--;let l=a,h=0,c=o.length;for(let e=i;l<n;l++)if(t.get(l,r)!==e)s[h]++;else{if(h===c-1){if(pe.patternMatchVariance(s,o,pe.MAX_INDIVIDUAL_VARIANCE)<pe.MAX_AVG_VARIANCE)return new Int32Array([a,l]);a+=s[0]+s[1],g.arraycopy(s,2,s,0,h-1),s[h-1]=0,s[h]=0,h--}else h++;s[h]=1,e=!e}return h===c-1&&pe.patternMatchVariance(s,o,pe.MAX_INDIVIDUAL_VARIANCE)<pe.MAX_AVG_VARIANCE?new Int32Array([a,l-1]):null}static patternMatchVariance(t,e,r){let n=t.length,i=0,o=0;for(let r=0;r<n;r++)i+=t[r],o+=e[r];if(i<o)return 1/0;let s=i/o;r*=s;let a=0;for(let i=0;i<n;i++){let n=t[i],o=e[i]*s,u=n>o?n-o:o-n;if(u>r)return 1/0;a+=u}return a/i}}pe.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),pe.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),pe.MAX_AVG_VARIANCE=.42,pe.MAX_INDIVIDUAL_VARIANCE=.8,pe.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),pe.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),pe.MAX_PIXEL_DRIFT=3,pe.MAX_PATTERN_DRIFT=5,pe.SKIPPED_ROW_COUNT_MAX=25,pe.ROW_STEP=5,pe.BARCODE_MIN_HEIGHT=10;class _e{constructor(t,e){if(0===e.length)throw new h;this.field=t;let r=e.length;if(r>1&&0===e[0]){let t=1;for(;t<r&&0===e[t];)t++;t===r?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(r-t),g.arraycopy(e,t,this.coefficients,0,this.coefficients.length))}else this.coefficients=e}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return 0===this.coefficients[0]}getCoefficient(t){return this.coefficients[this.coefficients.length-1-t]}evaluateAt(t){if(0===t)return this.getCoefficient(0);if(1===t){let t=0;for(let e of this.coefficients)t=this.field.add(t,e);return t}let e=this.coefficients[0],r=this.coefficients.length;for(let n=1;n<r;n++)e=this.field.add(this.field.multiply(t,e),this.coefficients[n]);return e}add(t){if(!this.field.equals(t.field))throw new h("ModulusPolys do not have same ModulusGF field");if(this.isZero())return t;if(t.isZero())return this;let e=this.coefficients,r=t.coefficients;if(e.length>r.length){let t=e;e=r,r=t}let n=new Int32Array(r.length),i=r.length-e.length;g.arraycopy(r,0,n,0,i);for(let t=i;t<r.length;t++)n[t]=this.field.add(e[t-i],r[t]);return new _e(this.field,n)}subtract(t){if(!this.field.equals(t.field))throw new h("ModulusPolys do not have same ModulusGF field");return t.isZero()?this:this.add(t.negative())}multiply(t){return t instanceof _e?this.multiplyOther(t):this.multiplyScalar(t)}multiplyOther(t){if(!this.field.equals(t.field))throw new h("ModulusPolys do not have same ModulusGF field");if(this.isZero()||t.isZero())return new _e(this.field,new Int32Array([0]));let e=this.coefficients,r=e.length,n=t.coefficients,i=n.length,o=new Int32Array(r+i-1);for(let t=0;t<r;t++){let r=e[t];for(let e=0;e<i;e++)o[t+e]=this.field.add(o[t+e],this.field.multiply(r,n[e]))}return new _e(this.field,o)}negative(){let t=this.coefficients.length,e=new Int32Array(t);for(let r=0;r<t;r++)e[r]=this.field.subtract(0,this.coefficients[r]);return new _e(this.field,e)}multiplyScalar(t){if(0===t)return new _e(this.field,new Int32Array([0]));if(1===t)return this;let e=this.coefficients.length,r=new Int32Array(e);for(let n=0;n<e;n++)r[n]=this.field.multiply(this.coefficients[n],t);return new _e(this.field,r)}multiplyByMonomial(t,e){if(t<0)throw new h;if(0===e)return new _e(this.field,new Int32Array([0]));let r=this.coefficients.length,n=new Int32Array(r+t);for(let t=0;t<r;t++)n[t]=this.field.multiply(this.coefficients[t],e);return new _e(this.field,n)}toString(){let t=new T;for(let e=this.getDegree();e>=0;e--){let r=this.getCoefficient(e);0!==r&&(r<0?(t.append(" - "),r=-r):t.length()>0&&t.append(" + "),0!==e&&1===r||t.append(r),0!==e&&(1===e?t.append("x"):(t.append("x^"),t.append(e))))}return t.toString()}}class me{add(t,e){return(t+e)%this.modulus}subtract(t,e){return(this.modulus+t-e)%this.modulus}exp(t){return this.expTable[t]}log(t){if(0===t)throw new h;return this.logTable[t]}inverse(t){if(0===t)throw new J;return this.expTable[this.modulus-this.logTable[t]-1]}multiply(t,e){return 0===t||0===e?0:this.expTable[(this.logTable[t]+this.logTable[e])%(this.modulus-1)]}getSize(){return this.modulus}equals(t){return t===this}}class Ee extends me{constructor(t,e){super(),this.modulus=t,this.expTable=new Int32Array(t),this.logTable=new Int32Array(t);let r=1;for(let n=0;n<t;n++)this.expTable[n]=r,r=r*e%t;for(let e=0;e<t-1;e++)this.logTable[this.expTable[e]]=e;this.zero=new _e(this,new Int32Array([0])),this.one=new _e(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(t,e){if(t<0)throw new h;if(0===e)return this.zero;let r=new Int32Array(t+1);return r[0]=e,new _e(this,r)}}Ee.PDF417_GF=new Ee(ge.NUMBER_OF_CODEWORDS,3);class Ae{constructor(){this.field=Ee.PDF417_GF}decode(t,e,r){let n=new _e(this.field,t),i=new Int32Array(e),o=!1;for(let t=e;t>0;t--){let r=n.evaluateAt(this.field.exp(t));i[e-t]=r,0!==r&&(o=!0)}if(!o)return 0;let s=this.field.getOne();if(null!=r)for(const e of r){let r=this.field.exp(t.length-1-e),n=new _e(this.field,new Int32Array([this.field.subtract(0,r),1]));s=s.multiply(n)}let a=new _e(this.field,i),u=this.runEuclideanAlgorithm(this.field.buildMonomial(e,1),a,e),l=u[0],h=u[1],c=this.findErrorLocations(l),f=this.findErrorMagnitudes(h,l,c);for(let e=0;e<c.length;e++){let r=t.length-1-this.field.log(c[e]);if(r<0)throw d.getChecksumInstance();t[r]=this.field.subtract(t[r],f[e])}return c.length}runEuclideanAlgorithm(t,e,r){if(t.getDegree()<e.getDegree()){let r=t;t=e,e=r}let n=t,i=e,o=this.field.getZero(),s=this.field.getOne();for(;i.getDegree()>=Math.round(r/2);){let t=n,e=o;if(n=i,o=s,n.isZero())throw d.getChecksumInstance();i=t;let r=this.field.getZero(),a=n.getCoefficient(n.getDegree()),u=this.field.inverse(a);for(;i.getDegree()>=n.getDegree()&&!i.isZero();){let t=i.getDegree()-n.getDegree(),e=this.field.multiply(i.getCoefficient(i.getDegree()),u);r=r.add(this.field.buildMonomial(t,e)),i=i.subtract(n.multiplyByMonomial(t,e))}s=r.multiply(o).subtract(e).negative()}let a=s.getCoefficient(0);if(0===a)throw d.getChecksumInstance();let u=this.field.inverse(a);return[s.multiply(u),i.multiply(u)]}findErrorLocations(t){let e=t.getDegree(),r=new Int32Array(e),n=0;for(let i=1;i<this.field.getSize()&&n<e;i++)0===t.evaluateAt(i)&&(r[n]=this.field.inverse(i),n++);if(n!==e)throw d.getChecksumInstance();return r}findErrorMagnitudes(t,e,r){let n=e.getDegree(),i=new Int32Array(n);for(let t=1;t<=n;t++)i[n-t]=this.field.multiply(t,e.getCoefficient(t));let o=new _e(this.field,i),s=r.length,a=new Int32Array(s);for(let e=0;e<s;e++){let n=this.field.inverse(r[e]),i=this.field.subtract(0,t.evaluateAt(n)),s=this.field.inverse(o.evaluateAt(n));a[e]=this.field.multiply(i,s)}return a}}class ye{constructor(t,e,r,n,i){t instanceof ye?this.constructor_2(t):this.constructor_1(t,e,r,n,i)}constructor_1(t,e,r,n,i){const o=null==e||null==r,s=null==n||null==i;if(o&&s)throw new N;o?(e=new st(0,n.getY()),r=new st(0,i.getY())):s&&(n=new st(t.getWidth()-1,e.getY()),i=new st(t.getWidth()-1,r.getY())),this.image=t,this.topLeft=e,this.bottomLeft=r,this.topRight=n,this.bottomRight=i,this.minX=Math.trunc(Math.min(e.getX(),r.getX())),this.maxX=Math.trunc(Math.max(n.getX(),i.getX())),this.minY=Math.trunc(Math.min(e.getY(),n.getY())),this.maxY=Math.trunc(Math.max(r.getY(),i.getY()))}constructor_2(t){this.image=t.image,this.topLeft=t.getTopLeft(),this.bottomLeft=t.getBottomLeft(),this.topRight=t.getTopRight(),this.bottomRight=t.getBottomRight(),this.minX=t.getMinX(),this.maxX=t.getMaxX(),this.minY=t.getMinY(),this.maxY=t.getMaxY()}static merge(t,e){return null==t?e:null==e?t:new ye(t.image,t.topLeft,t.bottomLeft,e.topRight,e.bottomRight)}addMissingRows(t,e,r){let n=this.topLeft,i=this.bottomLeft,o=this.topRight,s=this.bottomRight;if(t>0){let e=r?this.topLeft:this.topRight,i=Math.trunc(e.getY()-t);i<0&&(i=0);let s=new st(e.getX(),i);r?n=s:o=s}if(e>0){let t=r?this.bottomLeft:this.bottomRight,n=Math.trunc(t.getY()+e);n>=this.image.getHeight()&&(n=this.image.getHeight()-1);let o=new st(t.getX(),n);r?i=o:s=o}return new ye(this.image,n,i,o,s)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class Ce{constructor(t,e,r,n){this.columnCount=t,this.errorCorrectionLevel=n,this.rowCountUpperPart=e,this.rowCountLowerPart=r,this.rowCount=e+r}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class be{constructor(){this.buffer=""}static form(t,e){let r=-1;function n(t,n,i,o,s,a){if("%%"===t)return"%";if(void 0===e[++r])return;t=o?parseInt(o.substr(1)):void 0;let u,l=s?parseInt(s.substr(1)):void 0;switch(a){case"s":u=e[r];break;case"c":u=e[r][0];break;case"f":u=parseFloat(e[r]).toFixed(t);break;case"p":u=parseFloat(e[r]).toPrecision(t);break;case"e":u=parseFloat(e[r]).toExponential(t);break;case"x":u=parseInt(e[r]).toString(l||16);break;case"d":u=parseFloat(parseInt(e[r],l||10).toPrecision(t)).toFixed(0)}u="object"==typeof u?JSON.stringify(u):(+u).toString(l);let h=parseInt(i),c=i&&i[0]+""=="0"?"0":" ";for(;u.length<h;)u=void 0!==n?u+c:c+u;return u}let i=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return t.replace(i,n)}format(t,...e){this.buffer+=be.form(t,e)}toString(){return this.buffer}}class Ie{constructor(t){this.boundingBox=new ye(t),this.codewords=new Array(t.getMaxY()-t.getMinY()+1)}getCodewordNearby(t){let e=this.getCodeword(t);if(null!=e)return e;for(let r=1;r<Ie.MAX_NEARBY_DISTANCE;r++){let n=this.imageRowToCodewordIndex(t)-r;if(n>=0&&(e=this.codewords[n],null!=e))return e;if(n=this.imageRowToCodewordIndex(t)+r,n<this.codewords.length&&(e=this.codewords[n],null!=e))return e}return null}imageRowToCodewordIndex(t){return t-this.boundingBox.getMinY()}setCodeword(t,e){this.codewords[this.imageRowToCodewordIndex(t)]=e}getCodeword(t){return this.codewords[this.imageRowToCodewordIndex(t)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const t=new be;let e=0;for(const r of this.codewords)null!=r?t.format("%3d: %3d|%3d%n",e++,r.getRowNumber(),r.getValue()):t.format("%3d:    |   %n",e++);return t.toString()}}Ie.MAX_NEARBY_DISTANCE=5;class ve{constructor(){this.values=new Map}setValue(t){t=Math.trunc(t);let e=this.values.get(t);null==e&&(e=0),e++,this.values.set(t,e)}getValue(){let t=-1,e=new Array;for(const[r,n]of this.values.entries()){const i={getKey:()=>r,getValue:()=>n};i.getValue()>t?(t=i.getValue(),e=[],e.push(i.getKey())):i.getValue()===t&&e.push(i.getKey())}return ge.toIntArray(e)}getConfidence(t){return this.values.get(t)}}class Se extends Ie{constructor(t,e){super(t),this._isLeft=e}setRowNumbers(){for(let t of this.getCodewords())null!=t&&t.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(t){let e=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(e,t);let r=this.getBoundingBox(),n=this._isLeft?r.getTopLeft():r.getTopRight(),i=this._isLeft?r.getBottomLeft():r.getBottomRight(),o=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.imageRowToCodewordIndex(Math.trunc(i.getY())),a=-1,u=1,l=0;for(let r=o;r<s;r++){if(null==e[r])continue;let n=e[r],i=n.getRowNumber()-a;if(0===i)l++;else if(1===i)u=Math.max(u,l),l=1,a=n.getRowNumber();else if(i<0||n.getRowNumber()>=t.getRowCount()||i>r)e[r]=null;else{let t;t=u>2?(u-2)*i:i;let o=t>=r;for(let n=1;n<=t&&!o;n++)o=null!=e[r-n];o?e[r]=null:(a=n.getRowNumber(),l=1)}}}getRowHeights(){let t=this.getBarcodeMetadata();if(null==t)return null;this.adjustIncompleteIndicatorColumnRowNumbers(t);let e=new Int32Array(t.getRowCount());for(let t of this.getCodewords())if(null!=t){let r=t.getRowNumber();if(r>=e.length)continue;e[r]++}return e}adjustIncompleteIndicatorColumnRowNumbers(t){let e=this.getBoundingBox(),r=this._isLeft?e.getTopLeft():e.getTopRight(),n=this._isLeft?e.getBottomLeft():e.getBottomRight(),i=this.imageRowToCodewordIndex(Math.trunc(r.getY())),o=this.imageRowToCodewordIndex(Math.trunc(n.getY())),s=this.getCodewords(),a=-1;for(let e=i;e<o;e++){if(null==s[e])continue;let r=s[e];r.setRowNumberAsRowIndicatorColumn();let n=r.getRowNumber()-a;0===n||(1===n?a=r.getRowNumber():r.getRowNumber()>=t.getRowCount()?s[e]=null:a=r.getRowNumber())}}getBarcodeMetadata(){let t=this.getCodewords(),e=new ve,r=new ve,n=new ve,i=new ve;for(let o of t){if(null==o)continue;o.setRowNumberAsRowIndicatorColumn();let t=o.getValue()%30,s=o.getRowNumber();switch(this._isLeft||(s+=2),s%3){case 0:r.setValue(3*t+1);break;case 1:i.setValue(t/3),n.setValue(t%3);break;case 2:e.setValue(t+1)}}if(0===e.getValue().length||0===r.getValue().length||0===n.getValue().length||0===i.getValue().length||e.getValue()[0]<1||r.getValue()[0]+n.getValue()[0]<ge.MIN_ROWS_IN_BARCODE||r.getValue()[0]+n.getValue()[0]>ge.MAX_ROWS_IN_BARCODE)return null;let o=new Ce(e.getValue()[0],r.getValue()[0],n.getValue()[0],i.getValue()[0]);return this.removeIncorrectCodewords(t,o),o}removeIncorrectCodewords(t,e){for(let r=0;r<t.length;r++){let n=t[r];if(null==t[r])continue;let i=n.getValue()%30,o=n.getRowNumber();if(o>e.getRowCount())t[r]=null;else switch(this._isLeft||(o+=2),o%3){case 0:3*i+1!==e.getRowCountUpperPart()&&(t[r]=null);break;case 1:Math.trunc(i/3)===e.getErrorCorrectionLevel()&&i%3===e.getRowCountLowerPart()||(t[r]=null);break;case 2:i+1!==e.getColumnCount()&&(t[r]=null)}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+"\n"+super.toString()}}class Te{constructor(t,e){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=t,this.barcodeColumnCount=t.getColumnCount(),this.boundingBox=e,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let t,e=ge.MAX_CODEWORDS_IN_BARCODE;do{t=e,e=this.adjustRowNumbersAndGetCount()}while(e>0&&e<t);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(t){null!=t&&t.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let t=this.adjustRowNumbersByRow();if(0===t)return 0;for(let t=1;t<this.barcodeColumnCount+1;t++){let e=this.detectionResultColumns[t].getCodewords();for(let r=0;r<e.length;r++)null!=e[r]&&(e[r].hasValidRowNumber()||this.adjustRowNumbers(t,r,e))}return t}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(null==this.detectionResultColumns[0]||null==this.detectionResultColumns[this.barcodeColumnCount+1])return;let t=this.detectionResultColumns[0].getCodewords(),e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<t.length;r++)if(null!=t[r]&&null!=e[r]&&t[r].getRowNumber()===e[r].getRowNumber())for(let e=1;e<=this.barcodeColumnCount;e++){let n=this.detectionResultColumns[e].getCodewords()[r];null!=n&&(n.setRowNumber(t[r].getRowNumber()),n.hasValidRowNumber()||(this.detectionResultColumns[e].getCodewords()[r]=null))}}adjustRowNumbersFromRRI(){if(null==this.detectionResultColumns[this.barcodeColumnCount+1])return 0;let t=0,e=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let r=0;r<e.length;r++){if(null==e[r])continue;let n=e[r].getRowNumber(),i=0;for(let e=this.barcodeColumnCount+1;e>0&&i<this.ADJUST_ROW_NUMBER_SKIP;e--){let o=this.detectionResultColumns[e].getCodewords()[r];null!=o&&(i=Te.adjustRowNumberIfValid(n,i,o),o.hasValidRowNumber()||t++)}}return t}adjustRowNumbersFromLRI(){if(null==this.detectionResultColumns[0])return 0;let t=0,e=this.detectionResultColumns[0].getCodewords();for(let r=0;r<e.length;r++){if(null==e[r])continue;let n=e[r].getRowNumber(),i=0;for(let e=1;e<this.barcodeColumnCount+1&&i<this.ADJUST_ROW_NUMBER_SKIP;e++){let o=this.detectionResultColumns[e].getCodewords()[r];null!=o&&(i=Te.adjustRowNumberIfValid(n,i,o),o.hasValidRowNumber()||t++)}}return t}static adjustRowNumberIfValid(t,e,r){return null==r||r.hasValidRowNumber()||(r.isValidRowNumber(t)?(r.setRowNumber(t),e=0):++e),e}adjustRowNumbers(t,e,r){let n=r[e],i=this.detectionResultColumns[t-1].getCodewords(),o=i;null!=this.detectionResultColumns[t+1]&&(o=this.detectionResultColumns[t+1].getCodewords());let s=new Array(14);s[2]=i[e],s[3]=o[e],e>0&&(s[0]=r[e-1],s[4]=i[e-1],s[5]=o[e-1]),e>1&&(s[8]=r[e-2],s[10]=i[e-2],s[11]=o[e-2]),e<r.length-1&&(s[1]=r[e+1],s[6]=i[e+1],s[7]=o[e+1]),e<r.length-2&&(s[9]=r[e+2],s[12]=i[e+2],s[13]=o[e+2]);for(let t of s)if(Te.adjustRowNumber(n,t))return}static adjustRowNumber(t,e){return!(null==e||!e.hasValidRowNumber()||e.getBucket()!==t.getBucket()||(t.setRowNumber(e.getRowNumber()),0))}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(t){this.boundingBox=t}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(t,e){this.detectionResultColumns[t]=e}getDetectionResultColumn(t){return this.detectionResultColumns[t]}toString(){let t=this.detectionResultColumns[0];null==t&&(t=this.detectionResultColumns[this.barcodeColumnCount+1]);let e=new be;for(let r=0;r<t.getCodewords().length;r++){e.format("CW %3d:",r);for(let t=0;t<this.barcodeColumnCount+2;t++){if(null==this.detectionResultColumns[t]){e.format("    |   ");continue}let n=this.detectionResultColumns[t].getCodewords()[r];null!=n?e.format(" %3d|%3d",n.getRowNumber(),n.getValue()):e.format("    |   ")}e.format("%n")}return e.toString()}}class Re{constructor(t,e,r,n){this.rowNumber=Re.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(t),this.endX=Math.trunc(e),this.bucket=Math.trunc(r),this.value=Math.trunc(n)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(t){return t!==Re.BARCODE_ROW_UNKNOWN&&this.bucket===t%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(3*Math.trunc(this.value/30)+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(t){this.rowNumber=t}toString(){return this.rowNumber+"|"+this.value}}Re.BARCODE_ROW_UNKNOWN=-1;class Ne{static initialize(){for(let t=0;t<ge.SYMBOL_TABLE.length;t++){let e=ge.SYMBOL_TABLE[t],r=1&e;for(let n=0;n<ge.BARS_IN_MODULE;n++){let i=0;for(;(1&e)===r;)i+=1,e>>=1;r=1&e,Ne.RATIOS_TABLE[t]||(Ne.RATIOS_TABLE[t]=new Array(ge.BARS_IN_MODULE)),Ne.RATIOS_TABLE[t][ge.BARS_IN_MODULE-n-1]=Math.fround(i/ge.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(t){let e=Ne.getDecodedCodewordValue(Ne.sampleBitCounts(t));return-1!==e?e:Ne.getClosestDecodedValue(t)}static sampleBitCounts(t){let e=it.sum(t),r=new Int32Array(ge.BARS_IN_MODULE),n=0,i=0;for(let o=0;o<ge.MODULES_IN_CODEWORD;o++){let s=e/(2*ge.MODULES_IN_CODEWORD)+o*e/ge.MODULES_IN_CODEWORD;i+t[n]<=s&&(i+=t[n],n++),r[n]++}return r}static getDecodedCodewordValue(t){let e=Ne.getBitValue(t);return-1===ge.getCodeword(e)?-1:e}static getBitValue(t){let e=0;for(let r=0;r<t.length;r++)for(let n=0;n<t[r];n++)e=e<<1|(r%2==0?1:0);return Math.trunc(e)}static getClosestDecodedValue(t){let e=it.sum(t),r=new Array(ge.BARS_IN_MODULE);if(e>1)for(let n=0;n<r.length;n++)r[n]=Math.fround(t[n]/e);let n=ot.MAX_VALUE,i=-1;this.bSymbolTableReady||Ne.initialize();for(let t=0;t<Ne.RATIOS_TABLE.length;t++){let e=0,o=Ne.RATIOS_TABLE[t];for(let t=0;t<ge.BARS_IN_MODULE;t++){let i=Math.fround(o[t]-r[t]);if(e+=Math.fround(i*i),e>=n)break}e<n&&(n=e,i=ge.SYMBOL_TABLE[t])}return i}}Ne.bSymbolTableReady=!1,Ne.RATIOS_TABLE=new Array(ge.SYMBOL_TABLE.length).map((t=>new Array(ge.BARS_IN_MODULE)));class Oe{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(t){this.segmentIndex=t}getFileId(){return this.fileId}setFileId(t){this.fileId=t}getOptionalData(){return this.optionalData}setOptionalData(t){this.optionalData=t}isLastSegment(){return this.lastSegment}setLastSegment(t){this.lastSegment=t}getSegmentCount(){return this.segmentCount}setSegmentCount(t){this.segmentCount=t}getSender(){return this.sender||null}setSender(t){this.sender=t}getAddressee(){return this.addressee||null}setAddressee(t){this.addressee=t}getFileName(){return this.fileName}setFileName(t){this.fileName=t}getFileSize(){return this.fileSize}setFileSize(t){this.fileSize=t}getChecksum(){return this.checksum}setChecksum(t){this.checksum=t}getTimestamp(){return this.timestamp}setTimestamp(t){this.timestamp=t}}class De{static parseLong(t,e){return parseInt(t,e)}}class Be extends u{}class Me{writeBytes(t){this.writeBytesOffset(t,0,t.length)}writeBytesOffset(t,e,r){if(null==t)throw new Be;if(e<0||e>t.length||r<0||e+r>t.length||e+r<0)throw new p;if(0!==r)for(let n=0;n<r;n++)this.write(t[e+n])}flush(){}close(){}}class Pe extends u{}class ke extends Me{constructor(t=32){if(super(),this.count=0,t<0)throw new h("Negative initial size: "+t);this.buf=new Uint8Array(t)}ensureCapacity(t){t-this.buf.length>0&&this.grow(t)}grow(t){let e=this.buf.length<<1;if(e-t<0&&(e=t),e<0){if(t<0)throw new Pe;e=w.MAX_VALUE}this.buf=m.copyOfUint8Array(this.buf,e)}write(t){this.ensureCapacity(this.count+1),this.buf[this.count]=t,this.count+=1}writeBytesOffset(t,e,r){if(e<0||e>t.length||r<0||e+r-t.length>0)throw new p;this.ensureCapacity(this.count+r),g.arraycopy(t,e,this.buf,this.count,r),this.count+=r}writeTo(t){t.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return m.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(t){return t?"string"==typeof t?this.toString_string(t):this.toString_number(t):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(t){return new String(this.buf).toString()}toString_number(t){return new String(this.buf).toString()}close(){}}function Le(){if("undefined"!=typeof window)return window.BigInt||null;if(void 0!==t)return t.BigInt||null;if("undefined"!=typeof self)return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let xe;function Fe(t){if(void 0===xe&&(xe=Le()),null===xe)throw new Error("BigInt is not supported!");return xe(t)}function Ue(){let t=[];t[0]=Fe(1);let e=Fe(900);t[1]=e;for(let r=2;r<16;r++)t[r]=t[r-1]*e;return t}!function(t){t[t.ALPHA=0]="ALPHA",t[t.LOWER=1]="LOWER",t[t.MIXED=2]="MIXED",t[t.PUNCT=3]="PUNCT",t[t.ALPHA_SHIFT=4]="ALPHA_SHIFT",t[t.PUNCT_SHIFT=5]="PUNCT_SHIFT"}(K||(K={}));class Ve{static decode(t,e){let r=new T(""),n=b.ISO8859_1;r.enableDecoding(n);let i=1,o=t[i++],s=new Oe;for(;i<t[0];){switch(o){case Ve.TEXT_COMPACTION_MODE_LATCH:i=Ve.textCompaction(t,i,r);break;case Ve.BYTE_COMPACTION_MODE_LATCH:case Ve.BYTE_COMPACTION_MODE_LATCH_6:i=Ve.byteCompaction(o,t,n,i,r);break;case Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:r.append(t[i++]);break;case Ve.NUMERIC_COMPACTION_MODE_LATCH:i=Ve.numericCompaction(t,i,r);break;case Ve.ECI_CHARSET:b.getCharacterSetECIByValue(t[i++]);break;case Ve.ECI_GENERAL_PURPOSE:i+=2;break;case Ve.ECI_USER_DEFINED:i++;break;case Ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:i=Ve.decodeMacroBlock(t,i,s);break;case Ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ve.MACRO_PDF417_TERMINATOR:throw new C;default:i--,i=Ve.textCompaction(t,i,r)}if(!(i<t.length))throw C.getFormatInstance();o=t[i++]}if(0===r.length())throw C.getFormatInstance();let a=new j(null,r.toString(),null,e);return a.setOther(s),a}static decodeMacroBlock(t,e,r){if(e+Ve.NUMBER_OF_SEQUENCE_CODEWORDS>t[0])throw C.getFormatInstance();let n=new Int32Array(Ve.NUMBER_OF_SEQUENCE_CODEWORDS);for(let r=0;r<Ve.NUMBER_OF_SEQUENCE_CODEWORDS;r++,e++)n[r]=t[e];r.setSegmentIndex(w.parseInt(Ve.decodeBase900toBase10(n,Ve.NUMBER_OF_SEQUENCE_CODEWORDS)));let i=new T;e=Ve.textCompaction(t,e,i),r.setFileId(i.toString());let o=-1;for(t[e]===Ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(o=e+1);e<t[0];)switch(t[e]){case Ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(t[++e]){case Ve.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let n=new T;e=Ve.textCompaction(t,e+1,n),r.setFileName(n.toString());break;case Ve.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let i=new T;e=Ve.textCompaction(t,e+1,i),r.setSender(i.toString());break;case Ve.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let o=new T;e=Ve.textCompaction(t,e+1,o),r.setAddressee(o.toString());break;case Ve.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let s=new T;e=Ve.numericCompaction(t,e+1,s),r.setSegmentCount(w.parseInt(s.toString()));break;case Ve.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let a=new T;e=Ve.numericCompaction(t,e+1,a),r.setTimestamp(De.parseLong(a.toString()));break;case Ve.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let u=new T;e=Ve.numericCompaction(t,e+1,u),r.setChecksum(w.parseInt(u.toString()));break;case Ve.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let l=new T;e=Ve.numericCompaction(t,e+1,l),r.setFileSize(De.parseLong(l.toString()));break;default:throw C.getFormatInstance()}break;case Ve.MACRO_PDF417_TERMINATOR:e++,r.setLastSegment(!0);break;default:throw C.getFormatInstance()}if(-1!==o){let n=e-o;r.isLastSegment()&&n--,r.setOptionalData(m.copyOfRange(t,o,o+n))}return e}static textCompaction(t,e,r){let n=new Int32Array(2*(t[0]-e)),i=new Int32Array(2*(t[0]-e)),o=0,s=!1;for(;e<t[0]&&!s;){let r=t[e++];if(r<Ve.TEXT_COMPACTION_MODE_LATCH)n[o]=r/30,n[o+1]=r%30,o+=2;else switch(r){case Ve.TEXT_COMPACTION_MODE_LATCH:n[o++]=Ve.TEXT_COMPACTION_MODE_LATCH;break;case Ve.BYTE_COMPACTION_MODE_LATCH:case Ve.BYTE_COMPACTION_MODE_LATCH_6:case Ve.NUMERIC_COMPACTION_MODE_LATCH:case Ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ve.MACRO_PDF417_TERMINATOR:e--,s=!0;break;case Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n[o]=Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,r=t[e++],i[o]=r,o++}}return Ve.decodeTextCompaction(n,i,o,r),e}static decodeTextCompaction(t,e,r,n){let i=K.ALPHA,o=K.ALPHA,s=0;for(;s<r;){let r=t[s],a="";switch(i){case K.ALPHA:if(r<26)a=String.fromCharCode(65+r);else switch(r){case 26:a=" ";break;case Ve.LL:i=K.LOWER;break;case Ve.ML:i=K.MIXED;break;case Ve.PS:o=i,i=K.PUNCT_SHIFT;break;case Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case Ve.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.LOWER:if(r<26)a=String.fromCharCode(97+r);else switch(r){case 26:a=" ";break;case Ve.AS:o=i,i=K.ALPHA_SHIFT;break;case Ve.ML:i=K.MIXED;break;case Ve.PS:o=i,i=K.PUNCT_SHIFT;break;case Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case Ve.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.MIXED:if(r<Ve.PL)a=Ve.MIXED_CHARS[r];else switch(r){case Ve.PL:i=K.PUNCT;break;case 26:a=" ";break;case Ve.LL:i=K.LOWER;break;case Ve.AL:i=K.ALPHA;break;case Ve.PS:o=i,i=K.PUNCT_SHIFT;break;case Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case Ve.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.PUNCT:if(r<Ve.PAL)a=Ve.PUNCT_CHARS[r];else switch(r){case Ve.PAL:i=K.ALPHA;break;case Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case Ve.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.ALPHA_SHIFT:if(i=o,r<26)a=String.fromCharCode(65+r);else switch(r){case 26:a=" ";break;case Ve.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}break;case K.PUNCT_SHIFT:if(i=o,r<Ve.PAL)a=Ve.PUNCT_CHARS[r];else switch(r){case Ve.PAL:i=K.ALPHA;break;case Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:n.append(e[s]);break;case Ve.TEXT_COMPACTION_MODE_LATCH:i=K.ALPHA}}""!==a&&n.append(a),s++}}static byteCompaction(t,e,r,n,i){let o=new ke,s=0,a=0,u=!1;switch(t){case Ve.BYTE_COMPACTION_MODE_LATCH:let t=new Int32Array(6),r=e[n++];for(;n<e[0]&&!u;)switch(t[s++]=r,a=900*a+r,r=e[n++],r){case Ve.TEXT_COMPACTION_MODE_LATCH:case Ve.BYTE_COMPACTION_MODE_LATCH:case Ve.NUMERIC_COMPACTION_MODE_LATCH:case Ve.BYTE_COMPACTION_MODE_LATCH_6:case Ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ve.MACRO_PDF417_TERMINATOR:n--,u=!0;break;default:if(s%5==0&&s>0){for(let t=0;t<6;++t)o.write(Number(Fe(a)>>Fe(8*(5-t))));a=0,s=0}}n===e[0]&&r<Ve.TEXT_COMPACTION_MODE_LATCH&&(t[s++]=r);for(let e=0;e<s;e++)o.write(t[e]);break;case Ve.BYTE_COMPACTION_MODE_LATCH_6:for(;n<e[0]&&!u;){let t=e[n++];if(t<Ve.TEXT_COMPACTION_MODE_LATCH)s++,a=900*a+t;else switch(t){case Ve.TEXT_COMPACTION_MODE_LATCH:case Ve.BYTE_COMPACTION_MODE_LATCH:case Ve.NUMERIC_COMPACTION_MODE_LATCH:case Ve.BYTE_COMPACTION_MODE_LATCH_6:case Ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ve.MACRO_PDF417_TERMINATOR:n--,u=!0}if(s%5==0&&s>0){for(let t=0;t<6;++t)o.write(Number(Fe(a)>>Fe(8*(5-t))));a=0,s=0}}}return i.append(v.decode(o.toByteArray(),r)),n}static numericCompaction(t,e,r){let n=0,i=!1,o=new Int32Array(Ve.MAX_NUMERIC_CODEWORDS);for(;e<t[0]&&!i;){let s=t[e++];if(e===t[0]&&(i=!0),s<Ve.TEXT_COMPACTION_MODE_LATCH)o[n]=s,n++;else switch(s){case Ve.TEXT_COMPACTION_MODE_LATCH:case Ve.BYTE_COMPACTION_MODE_LATCH:case Ve.BYTE_COMPACTION_MODE_LATCH_6:case Ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case Ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case Ve.MACRO_PDF417_TERMINATOR:e--,i=!0}(n%Ve.MAX_NUMERIC_CODEWORDS==0||s===Ve.NUMERIC_COMPACTION_MODE_LATCH||i)&&n>0&&(r.append(Ve.decodeBase900toBase10(o,n)),n=0)}return e}static decodeBase900toBase10(t,e){let r=Fe(0);for(let n=0;n<e;n++)r+=Ve.EXP900[e-n-1]*Fe(t[n]);let n=r.toString();if("1"!==n.charAt(0))throw new C;return n.substring(1)}}Ve.TEXT_COMPACTION_MODE_LATCH=900,Ve.BYTE_COMPACTION_MODE_LATCH=901,Ve.NUMERIC_COMPACTION_MODE_LATCH=902,Ve.BYTE_COMPACTION_MODE_LATCH_6=924,Ve.ECI_USER_DEFINED=925,Ve.ECI_GENERAL_PURPOSE=926,Ve.ECI_CHARSET=927,Ve.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,Ve.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,Ve.MACRO_PDF417_TERMINATOR=922,Ve.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,Ve.MAX_NUMERIC_CODEWORDS=15,Ve.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,Ve.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,Ve.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,Ve.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,Ve.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,Ve.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,Ve.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,Ve.PL=25,Ve.LL=27,Ve.AS=27,Ve.ML=28,Ve.AL=28,Ve.PS=29,Ve.PAL=29,Ve.PUNCT_CHARS=";<>@[\\]_`~!\r\t,:\n-.$/\"|*()?{}'",Ve.MIXED_CHARS="0123456789&\r\t,:#-.$/+%*=^",Ve.EXP900=Le()?Ue():[],Ve.NUMBER_OF_SEQUENCE_CODEWORDS=2;class He{constructor(){}static decode(t,e,r,n,i,o,s){let a,u=new ye(t,e,r,n,i),l=null,h=null;for(let r=!0;;r=!1){if(null!=e&&(l=He.getRowIndicatorColumn(t,u,e,!0,o,s)),null!=n&&(h=He.getRowIndicatorColumn(t,u,n,!1,o,s)),a=He.merge(l,h),null==a)throw N.getNotFoundInstance();let i=a.getBoundingBox();if(!r||null==i||!(i.getMinY()<u.getMinY()||i.getMaxY()>u.getMaxY()))break;u=i}a.setBoundingBox(u);let c=a.getBarcodeColumnCount()+1;a.setDetectionResultColumn(0,l),a.setDetectionResultColumn(c,h);let d=null!=l;for(let e=1;e<=c;e++){let r,n=d?e:c-e;if(void 0!==a.getDetectionResultColumn(n))continue;r=0===n||n===c?new Se(u,0===n):new Ie(u),a.setDetectionResultColumn(n,r);let i=-1,l=i;for(let e=u.getMinY();e<=u.getMaxY();e++){if(i=He.getStartColumn(a,n,e,d),i<0||i>u.getMaxX()){if(-1===l)continue;i=l}let h=He.detectCodeword(t,u.getMinX(),u.getMaxX(),d,i,e,o,s);null!=h&&(r.setCodeword(e,h),l=i,o=Math.min(o,h.getWidth()),s=Math.max(s,h.getWidth()))}}return He.createDecoderResult(a)}static merge(t,e){if(null==t&&null==e)return null;let r=He.getBarcodeMetadata(t,e);if(null==r)return null;let n=ye.merge(He.adjustBoundingBox(t),He.adjustBoundingBox(e));return new Te(r,n)}static adjustBoundingBox(t){if(null==t)return null;let e=t.getRowHeights();if(null==e)return null;let r=He.getMax(e),n=0;for(let t of e)if(n+=r-t,t>0)break;let i=t.getCodewords();for(let t=0;n>0&&null==i[t];t++)n--;let o=0;for(let t=e.length-1;t>=0&&(o+=r-e[t],!(e[t]>0));t--);for(let t=i.length-1;o>0&&null==i[t];t--)o--;return t.getBoundingBox().addMissingRows(n,o,t.isLeft())}static getMax(t){let e=-1;for(let r of t)e=Math.max(e,r);return e}static getBarcodeMetadata(t,e){let r,n;return null==t||null==(r=t.getBarcodeMetadata())?null==e?null:e.getBarcodeMetadata():null==e||null==(n=e.getBarcodeMetadata())?r:r.getColumnCount()!==n.getColumnCount()&&r.getErrorCorrectionLevel()!==n.getErrorCorrectionLevel()&&r.getRowCount()!==n.getRowCount()?null:r}static getRowIndicatorColumn(t,e,r,n,i,o){let s=new Se(e,n);for(let a=0;a<2;a++){let u=0===a?1:-1,l=Math.trunc(Math.trunc(r.getX()));for(let a=Math.trunc(Math.trunc(r.getY()));a<=e.getMaxY()&&a>=e.getMinY();a+=u){let e=He.detectCodeword(t,0,t.getWidth(),n,l,a,i,o);null!=e&&(s.setCodeword(a,e),l=n?e.getStartX():e.getEndX())}}return s}static adjustCodewordCount(t,e){let r=e[0][1],n=r.getValue(),i=t.getBarcodeColumnCount()*t.getBarcodeRowCount()-He.getNumberOfECCodeWords(t.getBarcodeECLevel());if(0===n.length){if(i<1||i>ge.MAX_CODEWORDS_IN_BARCODE)throw N.getNotFoundInstance();r.setValue(i)}else n[0]!==i&&r.setValue(i)}static createDecoderResult(t){let e=He.createBarcodeMatrix(t);He.adjustCodewordCount(t,e);let r=new Array,n=new Int32Array(t.getBarcodeRowCount()*t.getBarcodeColumnCount()),i=[],o=new Array;for(let s=0;s<t.getBarcodeRowCount();s++)for(let a=0;a<t.getBarcodeColumnCount();a++){let u=e[s][a+1].getValue(),l=s*t.getBarcodeColumnCount()+a;0===u.length?r.push(l):1===u.length?n[l]=u[0]:(o.push(l),i.push(u))}let s=new Array(i.length);for(let t=0;t<s.length;t++)s[t]=i[t];return He.createDecoderResultFromAmbiguousValues(t.getBarcodeECLevel(),n,ge.toIntArray(r),ge.toIntArray(o),s)}static createDecoderResultFromAmbiguousValues(t,e,r,n,i){let o=new Int32Array(n.length),s=100;for(;s-- >0;){for(let t=0;t<o.length;t++)e[n[t]]=i[t][o[t]];try{return He.decodeCodewords(e,t,r)}catch(t){if(!(t instanceof d))throw t}if(0===o.length)throw d.getChecksumInstance();for(let t=0;t<o.length;t++){if(o[t]<i[t].length-1){o[t]++;break}if(o[t]=0,t===o.length-1)throw d.getChecksumInstance()}}throw d.getChecksumInstance()}static createBarcodeMatrix(t){let e=Array.from({length:t.getBarcodeRowCount()},(()=>new Array(t.getBarcodeColumnCount()+2)));for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)e[t][r]=new ve;let r=0;for(let n of t.getDetectionResultColumns()){if(null!=n)for(let t of n.getCodewords())if(null!=t){let n=t.getRowNumber();if(n>=0){if(n>=e.length)continue;e[n][r].setValue(t.getValue())}}r++}return e}static isValidBarcodeColumn(t,e){return e>=0&&e<=t.getBarcodeColumnCount()+1}static getStartColumn(t,e,r,n){let i=n?1:-1,o=null;if(He.isValidBarcodeColumn(t,e-i)&&(o=t.getDetectionResultColumn(e-i).getCodeword(r)),null!=o)return n?o.getEndX():o.getStartX();if(o=t.getDetectionResultColumn(e).getCodewordNearby(r),null!=o)return n?o.getStartX():o.getEndX();if(He.isValidBarcodeColumn(t,e-i)&&(o=t.getDetectionResultColumn(e-i).getCodewordNearby(r)),null!=o)return n?o.getEndX():o.getStartX();let s=0;for(;He.isValidBarcodeColumn(t,e-i);){e-=i;for(let r of t.getDetectionResultColumn(e).getCodewords())if(null!=r)return(n?r.getEndX():r.getStartX())+i*s*(r.getEndX()-r.getStartX());s++}return n?t.getBoundingBox().getMinX():t.getBoundingBox().getMaxX()}static detectCodeword(t,e,r,n,i,o,s,a){i=He.adjustCodewordStartColumn(t,e,r,n,i,o);let u,l=He.getModuleBitCount(t,e,r,n,i,o);if(null==l)return null;let h=it.sum(l);if(n)u=i+h;else{for(let t=0;t<l.length/2;t++){let e=l[t];l[t]=l[l.length-1-t],l[l.length-1-t]=e}u=i,i=u-h}if(!He.checkCodewordSkew(h,s,a))return null;let c=Ne.getDecodedValue(l),d=ge.getCodeword(c);return-1===d?null:new Re(i,u,He.getCodewordBucketNumber(c),d)}static getModuleBitCount(t,e,r,n,i,o){let s=i,a=new Int32Array(8),u=0,l=n?1:-1,h=n;for(;(n?s<r:s>=e)&&u<a.length;)t.get(s,o)===h?(a[u]++,s+=l):(u++,h=!h);return u===a.length||s===(n?r:e)&&u===a.length-1?a:null}static getNumberOfECCodeWords(t){return 2<<t}static adjustCodewordStartColumn(t,e,r,n,i,o){let s=i,a=n?-1:1;for(let u=0;u<2;u++){for(;(n?s>=e:s<r)&&n===t.get(s,o);){if(Math.abs(i-s)>He.CODEWORD_SKEW_SIZE)return i;s+=a}a=-a,n=!n}return s}static checkCodewordSkew(t,e,r){return e-He.CODEWORD_SKEW_SIZE<=t&&t<=r+He.CODEWORD_SKEW_SIZE}static decodeCodewords(t,e,r){if(0===t.length)throw C.getFormatInstance();let n=1<<e+1,i=He.correctErrors(t,r,n);He.verifyCodewordCount(t,n);let o=Ve.decode(t,""+e);return o.setErrorsCorrected(i),o.setErasures(r.length),o}static correctErrors(t,e,r){if(null!=e&&e.length>r/2+He.MAX_ERRORS||r<0||r>He.MAX_EC_CODEWORDS)throw d.getChecksumInstance();return He.errorCorrection.decode(t,r,e)}static verifyCodewordCount(t,e){if(t.length<4)throw C.getFormatInstance();let r=t[0];if(r>t.length)throw C.getFormatInstance();if(0===r){if(!(e<t.length))throw C.getFormatInstance();t[0]=t.length-e}}static getBitCountForCodeword(t){let e=new Int32Array(8),r=0,n=e.length-1;for(;!((1&t)!==r&&(r=1&t,n--,n<0));)e[n]++,t>>=1;return e}static getCodewordBucketNumber(t){return t instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(t):this.getCodewordBucketNumber_number(t)}static getCodewordBucketNumber_number(t){return He.getCodewordBucketNumber(He.getBitCountForCodeword(t))}static getCodewordBucketNumber_Int32Array(t){return(t[0]-t[2]+t[4]-t[6]+9)%9}static toString(t){let e=new be;for(let r=0;r<t.length;r++){e.format("Row %2d: ",r);for(let n=0;n<t[r].length;n++){let i=t[r][n];0===i.getValue().length?e.format("        ",null):e.format("%4d(%2d)",i.getValue()[0],i.getConfidence(i.getValue()[0]))}e.format("%n")}return e.toString()}}He.CODEWORD_SKEW_SIZE=2,He.MAX_ERRORS=3,He.MAX_EC_CODEWORDS=512,He.errorCorrection=new Ae;class ze{decode(t,e=null){let r=ze.decode(t,e,!1);if(null==r||0===r.length||null==r[0])throw N.getNotFoundInstance();return r[0]}decodeMultiple(t,e=null){try{return ze.decode(t,e,!0)}catch(t){if(t instanceof C||t instanceof d)throw N.getNotFoundInstance();throw t}}static decode(t,e,r){const n=new Array,i=pe.detectMultiple(t,e,r);for(const t of i.getPoints()){const e=He.decode(i.getBits(),t[4],t[5],t[6],t[7],ze.getMinCodewordWidth(t),ze.getMaxCodewordWidth(t)),r=new U(e.getText(),e.getRawBytes(),void 0,t,H.PDF_417);r.putMetadata(Z.ERROR_CORRECTION_LEVEL,e.getECLevel());const o=e.getOther();null!=o&&r.putMetadata(Z.PDF417_EXTRA_METADATA,o),n.push(r)}return n.map((t=>t))}static getMaxWidth(t,e){return null==t||null==e?0:Math.trunc(Math.abs(t.getX()-e.getX()))}static getMinWidth(t,e){return null==t||null==e?w.MAX_VALUE:Math.trunc(Math.abs(t.getX()-e.getX()))}static getMaxCodewordWidth(t){return Math.floor(Math.max(Math.max(ze.getMaxWidth(t[0],t[4]),ze.getMaxWidth(t[6],t[2])*ge.MODULES_IN_CODEWORD/ge.MODULES_IN_STOP_PATTERN),Math.max(ze.getMaxWidth(t[1],t[5]),ze.getMaxWidth(t[7],t[3])*ge.MODULES_IN_CODEWORD/ge.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(t){return Math.floor(Math.min(Math.min(ze.getMinWidth(t[0],t[4]),ze.getMinWidth(t[6],t[2])*ge.MODULES_IN_CODEWORD/ge.MODULES_IN_STOP_PATTERN),Math.min(ze.getMinWidth(t[1],t[5]),ze.getMinWidth(t[7],t[3])*ge.MODULES_IN_CODEWORD/ge.MODULES_IN_STOP_PATTERN)))}reset(){}}class Ge extends u{}class Xe{decode(t,e){return this.setHints(e),this.decodeInternal(t)}decodeWithState(t){return null!==this.readers&&void 0!==this.readers||this.setHints(null),this.decodeInternal(t)}setHints(t){this.hints=t;const e=null!=t&&void 0!==t.get(y.TRY_HARDER),r=null==t?null:t.get(y.POSSIBLE_FORMATS),n=new Array;if(null!=r){const i=r.some((t=>t===H.UPC_A||t===H.UPC_E||t===H.EAN_13||t===H.EAN_8||t===H.CODABAR||t===H.CODE_39||t===H.CODE_93||t===H.CODE_128||t===H.ITF||t===H.RSS_14||t===H.RSS_EXPANDED));i&&!e&&n.push(new Lt(t)),r.includes(H.QR_CODE)&&n.push(new fe),r.includes(H.DATA_MATRIX)&&n.push(new Kt),r.includes(H.AZTEC)&&n.push(new pt),r.includes(H.PDF_417)&&n.push(new ze),i&&e&&n.push(new Lt(t))}0===n.length&&(e||n.push(new Lt(t)),n.push(new fe),n.push(new Kt),n.push(new pt),n.push(new ze),e&&n.push(new Lt(t))),this.readers=n}reset(){if(null!==this.readers)for(const t of this.readers)t.reset()}decodeInternal(t){if(null===this.readers)throw new Ge("No readers where selected, nothing can be read.");for(const e of this.readers)try{return e.decode(t,this.hints)}catch(t){if(t instanceof Ge)continue}throw new N("No MultiFormat Readers were able to detect the code.")}}class We extends F{constructor(t=null,e=500){const r=new Xe;r.setHints(t),super(r,e)}decodeBitmap(t){return this.reader.decodeWithState(t)}}class Ye extends F{constructor(t=500){super(new ze,t)}}class Ke extends F{constructor(t=500){super(new fe,t)}}var Ze;!function(t){t[t.ERROR_CORRECTION=0]="ERROR_CORRECTION",t[t.CHARACTER_SET=1]="CHARACTER_SET",t[t.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",t[t.MIN_SIZE=3]="MIN_SIZE",t[t.MAX_SIZE=4]="MAX_SIZE",t[t.MARGIN=5]="MARGIN",t[t.PDF417_COMPACT=6]="PDF417_COMPACT",t[t.PDF417_COMPACTION=7]="PDF417_COMPACTION",t[t.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",t[t.AZTEC_LAYERS=9]="AZTEC_LAYERS",t[t.QR_VERSION=10]="QR_VERSION"}(Ze||(Ze={}));var je=Ze;class qe{constructor(t){this.field=t,this.cachedGenerators=[],this.cachedGenerators.push(new Q(t,Int32Array.from([1])))}buildGenerator(t){const e=this.cachedGenerators;if(t>=e.length){let r=e[e.length-1];const n=this.field;for(let i=e.length;i<=t;i++){const t=r.multiply(new Q(n,Int32Array.from([1,n.exp(i-1+n.getGeneratorBase())])));e.push(t),r=t}}return e[t]}encode(t,e){if(0===e)throw new h("No error correction bytes");const r=t.length-e;if(r<=0)throw new h("No data bytes provided");const n=this.buildGenerator(e),i=new Int32Array(r);g.arraycopy(t,0,i,0,r);let o=new Q(this.field,i);o=o.multiplyByMonomial(e,1);const s=o.divide(n)[1].getCoefficients(),a=e-s.length;for(let e=0;e<a;e++)t[r+e]=0;g.arraycopy(s,0,t,r+a,s.length)}}class Qe{constructor(){}static applyMaskPenaltyRule1(t){return Qe.applyMaskPenaltyRule1Internal(t,!0)+Qe.applyMaskPenaltyRule1Internal(t,!1)}static applyMaskPenaltyRule2(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i-1;t++){const i=r[t];for(let o=0;o<n-1;o++){const n=i[o];n===i[o+1]&&n===r[t+1][o]&&n===r[t+1][o+1]&&e++}}return Qe.N2*e}static applyMaskPenaltyRule3(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i;t++)for(let o=0;o<n;o++){const s=r[t];o+6<n&&1===s[o]&&0===s[o+1]&&1===s[o+2]&&1===s[o+3]&&1===s[o+4]&&0===s[o+5]&&1===s[o+6]&&(Qe.isWhiteHorizontal(s,o-4,o)||Qe.isWhiteHorizontal(s,o+7,o+11))&&e++,t+6<i&&1===r[t][o]&&0===r[t+1][o]&&1===r[t+2][o]&&1===r[t+3][o]&&1===r[t+4][o]&&0===r[t+5][o]&&1===r[t+6][o]&&(Qe.isWhiteVertical(r,o,t-4,t)||Qe.isWhiteVertical(r,o,t+7,t+11))&&e++}return e*Qe.N3}static isWhiteHorizontal(t,e,r){e=Math.max(e,0),r=Math.min(r,t.length);for(let n=e;n<r;n++)if(1===t[n])return!1;return!0}static isWhiteVertical(t,e,r,n){r=Math.max(r,0),n=Math.min(n,t.length);for(let i=r;i<n;i++)if(1===t[i][e])return!1;return!0}static applyMaskPenaltyRule4(t){let e=0;const r=t.getArray(),n=t.getWidth(),i=t.getHeight();for(let t=0;t<i;t++){const i=r[t];for(let t=0;t<n;t++)1===i[t]&&e++}const o=t.getHeight()*t.getWidth();return Math.floor(10*Math.abs(2*e-o)/o)*Qe.N4}static getDataMaskBit(t,e,r){let n,i;switch(t){case 0:n=r+e&1;break;case 1:n=1&r;break;case 2:n=e%3;break;case 3:n=(r+e)%3;break;case 4:n=Math.floor(r/2)+Math.floor(e/3)&1;break;case 5:i=r*e,n=(1&i)+i%3;break;case 6:i=r*e,n=(1&i)+i%3&1;break;case 7:i=r*e,n=i%3+(r+e&1)&1;break;default:throw new h("Invalid mask pattern: "+t)}return 0===n}static applyMaskPenaltyRule1Internal(t,e){let r=0;const n=e?t.getHeight():t.getWidth(),i=e?t.getWidth():t.getHeight(),o=t.getArray();for(let t=0;t<n;t++){let n=0,s=-1;for(let a=0;a<i;a++){const i=e?o[t][a]:o[a][t];i===s?n++:(n>=5&&(r+=Qe.N1+(n-5)),n=1,s=i)}n>=5&&(r+=Qe.N1+(n-5))}return r}}Qe.N1=3,Qe.N2=3,Qe.N3=40,Qe.N4=10;class Je{constructor(t,e){this.width=t,this.height=e;const r=new Array(e);for(let n=0;n!==e;n++)r[n]=new Uint8Array(t);this.bytes=r}getHeight(){return this.height}getWidth(){return this.width}get(t,e){return this.bytes[e][t]}getArray(){return this.bytes}setNumber(t,e,r){this.bytes[e][t]=r}setBoolean(t,e,r){this.bytes[e][t]=r?1:0}clear(t){for(const e of this.bytes)m.fill(e,t)}equals(t){if(!(t instanceof Je))return!1;const e=t;if(this.width!==e.width)return!1;if(this.height!==e.height)return!1;for(let t=0,r=this.height;t<r;++t){const r=this.bytes[t],n=e.bytes[t];for(let t=0,e=this.width;t<e;++t)if(r[t]!==n[t])return!1}return!0}toString(){const t=new T;for(let e=0,r=this.height;e<r;++e){const r=this.bytes[e];for(let e=0,n=this.width;e<n;++e)switch(r[e]){case 0:t.append(" 0");break;case 1:t.append(" 1");break;default:t.append("  ")}t.append("\n")}return t.toString()}}class $e{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const t=new T;return t.append("<<\n"),t.append(" mode: "),t.append(this.mode?this.mode.toString():"null"),t.append("\n ecLevel: "),t.append(this.ecLevel?this.ecLevel.toString():"null"),t.append("\n version: "),t.append(this.version?this.version.toString():"null"),t.append("\n maskPattern: "),t.append(this.maskPattern.toString()),this.matrix?(t.append("\n matrix:\n"),t.append(this.matrix.toString())):t.append("\n matrix: null\n"),t.append(">>\n"),t.toString()}setMode(t){this.mode=t}setECLevel(t){this.ecLevel=t}setVersion(t){this.version=t}setMaskPattern(t){this.maskPattern=t}setMatrix(t){this.matrix=t}static isValidMaskPattern(t){return t>=0&&t<$e.NUM_MASK_PATTERNS}}$e.NUM_MASK_PATTERNS=8;class tr extends u{}class er{constructor(){}static clearMatrix(t){t.clear(255)}static buildMatrix(t,e,r,n,i){er.clearMatrix(i),er.embedBasicPatterns(r,i),er.embedTypeInfo(e,n,i),er.maybeEmbedVersionInfo(r,i),er.embedDataBits(t,n,i)}static embedBasicPatterns(t,e){er.embedPositionDetectionPatternsAndSeparators(e),er.embedDarkDotAtLeftBottomCorner(e),er.maybeEmbedPositionAdjustmentPatterns(t,e),er.embedTimingPatterns(e)}static embedTypeInfo(t,e,r){const n=new E;er.makeTypeInfoBits(t,e,n);for(let t=0,e=n.getSize();t<e;++t){const e=n.get(n.getSize()-1-t),i=er.TYPE_INFO_COORDINATES[t],o=i[0],s=i[1];if(r.setBoolean(o,s,e),t<8){const n=r.getWidth()-t-1,i=8;r.setBoolean(n,i,e)}else{const n=8,i=r.getHeight()-7+(t-8);r.setBoolean(n,i,e)}}}static maybeEmbedVersionInfo(t,e){if(t.getVersionNumber()<7)return;const r=new E;er.makeVersionInfoBits(t,r);let n=17;for(let t=0;t<6;++t)for(let i=0;i<3;++i){const o=r.get(n);n--,e.setBoolean(t,e.getHeight()-11+i,o),e.setBoolean(e.getHeight()-11+i,t,o)}}static embedDataBits(t,e,r){let n=0,i=-1,o=r.getWidth()-1,s=r.getHeight()-1;for(;o>0;){for(6===o&&(o-=1);s>=0&&s<r.getHeight();){for(let i=0;i<2;++i){const a=o-i;if(!er.isEmpty(r.get(a,s)))continue;let u;n<t.getSize()?(u=t.get(n),++n):u=!1,255!==e&&Qe.getDataMaskBit(e,a,s)&&(u=!u),r.setBoolean(a,s,u)}s+=i}i=-i,s+=i,o-=2}if(n!==t.getSize())throw new tr("Not all bits consumed: "+n+"/"+t.getSize())}static findMSBSet(t){return 32-w.numberOfLeadingZeros(t)}static calculateBCHCode(t,e){if(0===e)throw new h("0 polynomial");const r=er.findMSBSet(e);for(t<<=r-1;er.findMSBSet(t)>=r;)t^=e<<er.findMSBSet(t)-r;return t}static makeTypeInfoBits(t,e,r){if(!$e.isValidMaskPattern(e))throw new tr("Invalid mask pattern");const n=t.getBits()<<3|e;r.appendBits(n,5);const i=er.calculateBCHCode(n,er.TYPE_INFO_POLY);r.appendBits(i,10);const o=new E;if(o.appendBits(er.TYPE_INFO_MASK_PATTERN,15),r.xor(o),15!==r.getSize())throw new tr("should not happen but we got: "+r.getSize())}static makeVersionInfoBits(t,e){e.appendBits(t.getVersionNumber(),6);const r=er.calculateBCHCode(t.getVersionNumber(),er.VERSION_INFO_POLY);if(e.appendBits(r,12),18!==e.getSize())throw new tr("should not happen but we got: "+e.getSize())}static isEmpty(t){return 255===t}static embedTimingPatterns(t){for(let e=8;e<t.getWidth()-8;++e){const r=(e+1)%2;er.isEmpty(t.get(e,6))&&t.setNumber(e,6,r),er.isEmpty(t.get(6,e))&&t.setNumber(6,e,r)}}static embedDarkDotAtLeftBottomCorner(t){if(0===t.get(8,t.getHeight()-8))throw new tr;t.setNumber(8,t.getHeight()-8,1)}static embedHorizontalSeparationPattern(t,e,r){for(let n=0;n<8;++n){if(!er.isEmpty(r.get(t+n,e)))throw new tr;r.setNumber(t+n,e,0)}}static embedVerticalSeparationPattern(t,e,r){for(let n=0;n<7;++n){if(!er.isEmpty(r.get(t,e+n)))throw new tr;r.setNumber(t,e+n,0)}}static embedPositionAdjustmentPattern(t,e,r){for(let n=0;n<5;++n){const i=er.POSITION_ADJUSTMENT_PATTERN[n];for(let o=0;o<5;++o)r.setNumber(t+o,e+n,i[o])}}static embedPositionDetectionPattern(t,e,r){for(let n=0;n<7;++n){const i=er.POSITION_DETECTION_PATTERN[n];for(let o=0;o<7;++o)r.setNumber(t+o,e+n,i[o])}}static embedPositionDetectionPatternsAndSeparators(t){const e=er.POSITION_DETECTION_PATTERN[0].length;er.embedPositionDetectionPattern(0,0,t),er.embedPositionDetectionPattern(t.getWidth()-e,0,t),er.embedPositionDetectionPattern(0,t.getWidth()-e,t);const r=8;er.embedHorizontalSeparationPattern(0,r-1,t),er.embedHorizontalSeparationPattern(t.getWidth()-r,r-1,t),er.embedHorizontalSeparationPattern(0,t.getWidth()-r,t);const n=7;er.embedVerticalSeparationPattern(n,0,t),er.embedVerticalSeparationPattern(t.getHeight()-n-1,0,t),er.embedVerticalSeparationPattern(n,t.getHeight()-n,t)}static maybeEmbedPositionAdjustmentPatterns(t,e){if(t.getVersionNumber()<2)return;const r=t.getVersionNumber()-1,n=er.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[r];for(let t=0,r=n.length;t!==r;t++){const i=n[t];if(i>=0)for(let t=0;t!==r;t++){const r=n[t];r>=0&&er.isEmpty(e.get(r,i))&&er.embedPositionAdjustmentPattern(r-2,i-2,e)}}}}er.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),er.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),er.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),er.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),er.VERSION_INFO_POLY=7973,er.TYPE_INFO_POLY=1335,er.TYPE_INFO_MASK_PATTERN=21522;class rr{constructor(t,e){this.dataBytes=t,this.errorCorrectionBytes=e}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class nr{constructor(){}static calculateMaskPenalty(t){return Qe.applyMaskPenaltyRule1(t)+Qe.applyMaskPenaltyRule2(t)+Qe.applyMaskPenaltyRule3(t)+Qe.applyMaskPenaltyRule4(t)}static encode(t,e,r=null){let n=nr.DEFAULT_BYTE_MODE_ENCODING;const i=null!==r&&void 0!==r.get(je.CHARACTER_SET);i&&(n=r.get(je.CHARACTER_SET).toString());const o=this.chooseMode(t,n),s=new E;if(o===ie.BYTE&&(i||nr.DEFAULT_BYTE_MODE_ENCODING!==n)){const t=b.getCharacterSetECIByName(n);void 0!==t&&this.appendECI(t,s)}this.appendModeInfo(o,s);const a=new E;let u;if(this.appendBytes(t,o,a,n),null!==r&&void 0!==r.get(je.QR_VERSION)){const t=Number.parseInt(r.get(je.QR_VERSION).toString(),10);u=$t.getVersionForNumber(t);const n=this.calculateBitsNeeded(o,s,a,u);if(!this.willFit(n,u,e))throw new tr("Data too big for requested version")}else u=this.recommendVersion(e,o,s,a);const l=new E;l.appendBitArray(s);const h=o===ie.BYTE?a.getSizeInBytes():t.length;this.appendLengthInfo(h,u,o,l),l.appendBitArray(a);const c=u.getECBlocksForLevel(e),d=u.getTotalCodewords()-c.getTotalECCodewords();this.terminateBits(d,l);const f=this.interleaveWithECBytes(l,u.getTotalCodewords(),d,c.getNumBlocks()),g=new $e;g.setECLevel(e),g.setMode(o),g.setVersion(u);const w=u.getDimensionForVersion(),p=new Je(w,w),_=this.chooseMaskPattern(f,e,u,p);return g.setMaskPattern(_),er.buildMatrix(f,e,u,_,p),g.setMatrix(p),g}static recommendVersion(t,e,r,n){const i=this.calculateBitsNeeded(e,r,n,$t.getVersionForNumber(1)),o=this.chooseVersion(i,t),s=this.calculateBitsNeeded(e,r,n,o);return this.chooseVersion(s,t)}static calculateBitsNeeded(t,e,r,n){return e.getSize()+t.getCharacterCountBits(n)+r.getSize()}static getAlphanumericCode(t){return t<nr.ALPHANUMERIC_TABLE.length?nr.ALPHANUMERIC_TABLE[t]:-1}static chooseMode(t,e=null){if(b.SJIS.getName()===e&&this.isOnlyDoubleByteKanji(t))return ie.KANJI;let r=!1,n=!1;for(let e=0,i=t.length;e<i;++e){const i=t.charAt(e);if(nr.isDigit(i))r=!0;else{if(-1===this.getAlphanumericCode(i.charCodeAt(0)))return ie.BYTE;n=!0}}return n?ie.ALPHANUMERIC:r?ie.NUMERIC:ie.BYTE}static isOnlyDoubleByteKanji(t){let e;try{e=v.encode(t,b.SJIS)}catch(t){return!1}const r=e.length;if(r%2!=0)return!1;for(let t=0;t<r;t+=2){const r=255&e[t];if((r<129||r>159)&&(r<224||r>235))return!1}return!0}static chooseMaskPattern(t,e,r,n){let i=Number.MAX_SAFE_INTEGER,o=-1;for(let s=0;s<$e.NUM_MASK_PATTERNS;s++){er.buildMatrix(t,e,r,s,n);let a=this.calculateMaskPenalty(n);a<i&&(i=a,o=s)}return o}static chooseVersion(t,e){for(let r=1;r<=40;r++){const n=$t.getVersionForNumber(r);if(nr.willFit(t,n,e))return n}throw new tr("Data too big")}static willFit(t,e,r){return e.getTotalCodewords()-e.getECBlocksForLevel(r).getTotalECCodewords()>=(t+7)/8}static terminateBits(t,e){const r=8*t;if(e.getSize()>r)throw new tr("data bits cannot fit in the QR Code"+e.getSize()+" > "+r);for(let t=0;t<4&&e.getSize()<r;++t)e.appendBit(!1);const n=7&e.getSize();if(n>0)for(let t=n;t<8;t++)e.appendBit(!1);const i=t-e.getSizeInBytes();for(let t=0;t<i;++t)e.appendBits(0==(1&t)?236:17,8);if(e.getSize()!==r)throw new tr("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(t,e,r,n,i,o){if(n>=r)throw new tr("Block ID too large");const s=t%r,a=r-s,u=Math.floor(t/r),l=u+1,h=Math.floor(e/r),c=h+1,d=u-h,f=l-c;if(d!==f)throw new tr("EC bytes mismatch");if(r!==a+s)throw new tr("RS blocks mismatch");if(t!==(h+d)*a+(c+f)*s)throw new tr("Total bytes mismatch");n<a?(i[0]=h,o[0]=d):(i[0]=c,o[0]=f)}static interleaveWithECBytes(t,e,r,n){if(t.getSizeInBytes()!==r)throw new tr("Number of bits and data bytes does not match");let i=0,o=0,s=0;const a=new Array;for(let u=0;u<n;++u){const l=new Int32Array(1),h=new Int32Array(1);nr.getNumDataBytesAndNumECBytesForBlockID(e,r,n,u,l,h);const c=l[0],d=new Uint8Array(c);t.toBytes(8*i,d,0,c);const f=nr.generateECBytes(d,h[0]);a.push(new rr(d,f)),o=Math.max(o,c),s=Math.max(s,f.length),i+=l[0]}if(r!==i)throw new tr("Data bytes does not match offset");const u=new E;for(let t=0;t<o;++t)for(const e of a){const r=e.getDataBytes();t<r.length&&u.appendBits(r[t],8)}for(let t=0;t<s;++t)for(const e of a){const r=e.getErrorCorrectionBytes();t<r.length&&u.appendBits(r[t],8)}if(e!==u.getSizeInBytes())throw new tr("Interleaving error: "+e+" and "+u.getSizeInBytes()+" differ.");return u}static generateECBytes(t,e){const r=t.length,n=new Int32Array(r+e);for(let e=0;e<r;e++)n[e]=255&t[e];new qe($.QR_CODE_FIELD_256).encode(n,e);const i=new Uint8Array(e);for(let t=0;t<e;t++)i[t]=n[r+t];return i}static appendModeInfo(t,e){e.appendBits(t.getBits(),4)}static appendLengthInfo(t,e,r,n){const i=r.getCharacterCountBits(e);if(t>=1<<i)throw new tr(t+" is bigger than "+((1<<i)-1));n.appendBits(t,i)}static appendBytes(t,e,r,n){switch(e){case ie.NUMERIC:nr.appendNumericBytes(t,r);break;case ie.ALPHANUMERIC:nr.appendAlphanumericBytes(t,r);break;case ie.BYTE:nr.append8BitBytes(t,r,n);break;case ie.KANJI:nr.appendKanjiBytes(t,r);break;default:throw new tr("Invalid mode: "+e)}}static getDigit(t){return t.charCodeAt(0)-48}static isDigit(t){const e=nr.getDigit(t);return e>=0&&e<=9}static appendNumericBytes(t,e){const r=t.length;let n=0;for(;n<r;){const i=nr.getDigit(t.charAt(n));if(n+2<r){const r=nr.getDigit(t.charAt(n+1)),o=nr.getDigit(t.charAt(n+2));e.appendBits(100*i+10*r+o,10),n+=3}else if(n+1<r){const r=nr.getDigit(t.charAt(n+1));e.appendBits(10*i+r,7),n+=2}else e.appendBits(i,4),n++}}static appendAlphanumericBytes(t,e){const r=t.length;let n=0;for(;n<r;){const i=nr.getAlphanumericCode(t.charCodeAt(n));if(-1===i)throw new tr;if(n+1<r){const r=nr.getAlphanumericCode(t.charCodeAt(n+1));if(-1===r)throw new tr;e.appendBits(45*i+r,11),n+=2}else e.appendBits(i,6),n++}}static append8BitBytes(t,e,r){let n;try{n=v.encode(t,r)}catch(t){throw new tr(t)}for(let t=0,r=n.length;t!==r;t++){const r=n[t];e.appendBits(r,8)}}static appendKanjiBytes(t,e){let r;try{r=v.encode(t,b.SJIS)}catch(t){throw new tr(t)}const n=r.length;for(let t=0;t<n;t+=2){const n=(255&r[t])<<8&4294967295|255&r[t+1];let i=-1;if(n>=33088&&n<=40956?i=n-33088:n>=57408&&n<=60351&&(i=n-49472),-1===i)throw new tr("Invalid byte sequence");const o=192*(i>>8)+(255&i);e.appendBits(o,13)}}static appendECI(t,e){e.appendBits(ie.ECI.getBits(),4),e.appendBits(t.getValue(),8)}}nr.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),nr.DEFAULT_BYTE_MODE_ENCODING=b.UTF8.getName();class ir{write(t,e,r,n=null){if(0===t.length)throw new h("Found empty contents");if(e<0||r<0)throw new h("Requested dimensions are too small: "+e+"x"+r);let i=jt.L,o=ir.QUIET_ZONE_SIZE;null!==n&&(void 0!==n.get(je.ERROR_CORRECTION)&&(i=jt.fromString(n.get(je.ERROR_CORRECTION).toString())),void 0!==n.get(je.MARGIN)&&(o=Number.parseInt(n.get(je.MARGIN).toString(),10)));const s=nr.encode(t,i,n);return this.renderResult(s,e,r,o)}writeToDom(t,e,r,n,i=null){"string"==typeof t&&(t=document.querySelector(t));const o=this.write(e,r,n,i);t&&t.appendChild(o)}renderResult(t,e,r,n){const i=t.getMatrix();if(null===i)throw new et;const o=i.getWidth(),s=i.getHeight(),a=o+2*n,u=s+2*n,l=Math.max(e,a),h=Math.max(r,u),c=Math.min(Math.floor(l/a),Math.floor(h/u)),d=Math.floor((l-o*c)/2),f=Math.floor((h-s*c)/2),g=this.createSVGElement(l,h);for(let t=0,e=f;t<s;t++,e+=c)for(let r=0,n=d;r<o;r++,n+=c)if(1===i.get(r,t)){const t=this.createSvgRectElement(n,e,c,c);g.appendChild(t)}return g}createSVGElement(t,e){const r=document.createElementNS(ir.SVG_NS,"svg");return r.setAttributeNS(null,"height",t.toString()),r.setAttributeNS(null,"width",e.toString()),r}createSvgRectElement(t,e,r,n){const i=document.createElementNS(ir.SVG_NS,"rect");return i.setAttributeNS(null,"x",t.toString()),i.setAttributeNS(null,"y",e.toString()),i.setAttributeNS(null,"height",r.toString()),i.setAttributeNS(null,"width",n.toString()),i.setAttributeNS(null,"fill","#000000"),i}}ir.QUIET_ZONE_SIZE=4,ir.SVG_NS="http://www.w3.org/2000/svg";class or{encode(t,e,r,n,i){if(0===t.length)throw new h("Found empty contents");if(e!==H.QR_CODE)throw new h("Can only encode QR_CODE, but got "+e);if(r<0||n<0)throw new h(`Requested dimensions are too small: ${r}x${n}`);let o=jt.L,s=or.QUIET_ZONE_SIZE;null!==i&&(void 0!==i.get(je.ERROR_CORRECTION)&&(o=jt.fromString(i.get(je.ERROR_CORRECTION).toString())),void 0!==i.get(je.MARGIN)&&(s=Number.parseInt(i.get(je.MARGIN).toString(),10)));const a=nr.encode(t,o,i);return or.renderResult(a,r,n,s)}static renderResult(t,e,r,n){const i=t.getMatrix();if(null===i)throw new et;const o=i.getWidth(),s=i.getHeight(),a=o+2*n,u=s+2*n,l=Math.max(e,a),h=Math.max(r,u),c=Math.min(Math.floor(l/a),Math.floor(h/u)),d=Math.floor((l-o*c)/2),f=Math.floor((h-s*c)/2),g=new R(l,h);for(let t=0,e=f;t<s;t++,e+=c)for(let r=0,n=d;r<o;r++,n+=c)1===i.get(r,t)&&g.setRegion(n,e,c,c);return g}}or.QUIET_ZONE_SIZE=4;class sr{encode(t,e,r,n,i){let o;switch(e){case H.QR_CODE:o=new or;break;default:throw new h("No encoder available for format "+e)}return o.encode(t,e,r,n,i)}}class ar extends B{constructor(t,e,r,n,i,o,s,a){if(super(o,s),this.yuvData=t,this.dataWidth=e,this.dataHeight=r,this.left=n,this.top=i,n+o>e||i+s>r)throw new h("Crop rectangle does not fit within image data.");a&&this.reverseHorizontal(o,s)}getRow(t,e){if(t<0||t>=this.getHeight())throw new h("Requested row is outside the image: "+t);const r=this.getWidth();(null==e||e.length<r)&&(e=new Uint8ClampedArray(r));const n=(t+this.top)*this.dataWidth+this.left;return g.arraycopy(this.yuvData,n,e,0,r),e}getMatrix(){const t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.yuvData;const r=t*e,n=new Uint8ClampedArray(r);let i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return g.arraycopy(this.yuvData,i,n,0,r),n;for(let r=0;r<e;r++){const e=r*t;g.arraycopy(this.yuvData,i,n,e,t),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(t,e,r,n){return new ar(this.yuvData,this.dataWidth,this.dataHeight,this.left+t,this.top+e,r,n,!1)}renderThumbnail(){const t=this.getWidth()/ar.THUMBNAIL_SCALE_FACTOR,e=this.getHeight()/ar.THUMBNAIL_SCALE_FACTOR,r=new Int32Array(t*e),n=this.yuvData;let i=this.top*this.dataWidth+this.left;for(let o=0;o<e;o++){const e=o*t;for(let o=0;o<t;o++){const t=255&n[i+o*ar.THUMBNAIL_SCALE_FACTOR];r[e+o]=4278190080|65793*t}i+=this.dataWidth*ar.THUMBNAIL_SCALE_FACTOR}return r}getThumbnailWidth(){return this.getWidth()/ar.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/ar.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(t,e){const r=this.yuvData;for(let n=0,i=this.top*this.dataWidth+this.left;n<e;n++,i+=this.dataWidth){const e=i+t/2;for(let n=i,o=i+t-1;n<e;n++,o--){const t=r[n];r[n]=r[o],r[o]=t}}}invert(){return new M(this)}}ar.THUMBNAIL_SCALE_FACTOR=2;class ur extends B{constructor(t,e,r,n,i,o,s){if(super(e,r),this.dataWidth=n,this.dataHeight=i,this.left=o,this.top=s,4===t.BYTES_PER_ELEMENT){const n=e*r,i=new Uint8ClampedArray(n);for(let e=0;e<n;e++){const r=t[e],n=r>>16&255,o=r>>7&510,s=255&r;i[e]=(n+o+s)/4&255}this.luminances=i}else this.luminances=t;if(void 0===n&&(this.dataWidth=e),void 0===i&&(this.dataHeight=r),void 0===o&&(this.left=0),void 0===s&&(this.top=0),this.left+e>this.dataWidth||this.top+r>this.dataHeight)throw new h("Crop rectangle does not fit within image data.")}getRow(t,e){if(t<0||t>=this.getHeight())throw new h("Requested row is outside the image: "+t);const r=this.getWidth();(null==e||e.length<r)&&(e=new Uint8ClampedArray(r));const n=(t+this.top)*this.dataWidth+this.left;return g.arraycopy(this.luminances,n,e,0,r),e}getMatrix(){const t=this.getWidth(),e=this.getHeight();if(t===this.dataWidth&&e===this.dataHeight)return this.luminances;const r=t*e,n=new Uint8ClampedArray(r);let i=this.top*this.dataWidth+this.left;if(t===this.dataWidth)return g.arraycopy(this.luminances,i,n,0,r),n;for(let r=0;r<e;r++){const e=r*t;g.arraycopy(this.luminances,i,n,e,t),i+=this.dataWidth}return n}isCropSupported(){return!0}crop(t,e,r,n){return new ur(this.luminances,r,n,this.dataWidth,this.dataHeight,this.left+t,this.top+e)}invert(){return new M(this)}}class lr extends b{static forName(t){return this.getCharacterSetECIByName(t)}}class hr{}hr.ISO_8859_1=b.ISO8859_1;class cr{isCompact(){return this.compact}setCompact(t){this.compact=t}getSize(){return this.size}setSize(t){this.size=t}getLayers(){return this.layers}setLayers(t){this.layers=t}getCodeWords(){return this.codeWords}setCodeWords(t){this.codeWords=t}getMatrix(){return this.matrix}setMatrix(t){this.matrix=t}}class dr{static singletonList(t){return[t]}static min(t,e){return t.sort(e)[0]}}class fr{constructor(t){this.previous=t}getPrevious(){return this.previous}}class gr extends fr{constructor(t,e,r){super(t),this.value=e,this.bitCount=r}appendTo(t,e){t.appendBits(this.value,this.bitCount)}add(t,e){return new gr(this,t,e)}addBinaryShift(t,e){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new gr(this,t,e)}toString(){let t=this.value&(1<<this.bitCount)-1;return t|=1<<this.bitCount,"<"+w.toBinaryString(t|1<<this.bitCount).substring(1)+">"}}class wr extends gr{constructor(t,e,r){super(t,0,0),this.binaryShiftStart=e,this.binaryShiftByteCount=r}appendTo(t,e){for(let r=0;r<this.binaryShiftByteCount;r++)(0===r||31===r&&this.binaryShiftByteCount<=62)&&(t.appendBits(31,5),this.binaryShiftByteCount>62?t.appendBits(this.binaryShiftByteCount-31,16):0===r?t.appendBits(Math.min(this.binaryShiftByteCount,31),5):t.appendBits(this.binaryShiftByteCount-31,5)),t.appendBits(e[this.binaryShiftStart+r],8)}addBinaryShift(t,e){return new wr(this,t,e)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function pr(t,e,r){return new wr(t,e,r)}function _r(t,e,r){return new gr(t,e,r)}const mr=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],Er=0,Ar=1,yr=2,Cr=3,br=4,Ir=new gr(null,0,0),vr=[Int32Array.from([0,327708,327710,327709,656318]),Int32Array.from([590318,0,327710,327709,656318]),Int32Array.from([262158,590300,0,590301,932798]),Int32Array.from([327709,327708,656318,0,327710]),Int32Array.from([327711,656380,656382,656381,0])];function Sr(t){for(let e of t)m.fill(e,-1);return t[Er][br]=0,t[Ar][br]=0,t[Ar][Er]=28,t[Cr][br]=0,t[yr][br]=0,t[yr][Er]=15,t}const Tr=Sr(m.createInt32Array(6,6));class Rr{constructor(t,e,r,n){this.token=t,this.mode=e,this.binaryShiftByteCount=r,this.bitCount=n}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(t,e){let r=this.bitCount,n=this.token;if(t!==this.mode){let e=vr[this.mode][t];n=_r(n,65535&e,e>>16),r+=e>>16}let i=t===yr?4:5;return n=_r(n,e,i),new Rr(n,t,0,r+i)}shiftAndAppend(t,e){let r=this.token,n=this.mode===yr?4:5;return r=_r(r,Tr[this.mode][t],n),r=_r(r,e,5),new Rr(r,this.mode,0,this.bitCount+n+5)}addBinaryShiftChar(t){let e=this.token,r=this.mode,n=this.bitCount;if(this.mode===br||this.mode===yr){let t=vr[r][Er];e=_r(e,65535&t,t>>16),n+=t>>16,r=Er}let i=0===this.binaryShiftByteCount||31===this.binaryShiftByteCount?18:62===this.binaryShiftByteCount?9:8,o=new Rr(e,r,this.binaryShiftByteCount+1,n+i);return 2078===o.binaryShiftByteCount&&(o=o.endBinaryShift(t+1)),o}endBinaryShift(t){if(0===this.binaryShiftByteCount)return this;let e=this.token;return e=pr(e,t-this.binaryShiftByteCount,this.binaryShiftByteCount),new Rr(e,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(t){let e=this.bitCount+(vr[this.mode][t.mode]>>16);return this.binaryShiftByteCount<t.binaryShiftByteCount?e+=Rr.calculateBinaryShiftCost(t)-Rr.calculateBinaryShiftCost(this):this.binaryShiftByteCount>t.binaryShiftByteCount&&t.binaryShiftByteCount>0&&(e+=10),e<=t.bitCount}toBitArray(t){let e=[];for(let r=this.endBinaryShift(t.length).token;null!==r;r=r.getPrevious())e.unshift(r);let r=new E;for(const n of e)n.appendTo(r,t);return r}toString(){return S.format("%s bits=%d bytes=%d",mr[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(t){return t.binaryShiftByteCount>62?21:t.binaryShiftByteCount>31?20:t.binaryShiftByteCount>0?10:0}}function Nr(t){const e=S.getCharCode(" "),r=S.getCharCode("."),n=S.getCharCode(",");t[Er][e]=1;const i=S.getCharCode("Z"),o=S.getCharCode("A");for(let e=o;e<=i;e++)t[Er][e]=e-o+2;t[Ar][e]=1;const s=S.getCharCode("z"),a=S.getCharCode("a");for(let e=a;e<=s;e++)t[Ar][e]=e-a+2;t[yr][e]=1;const u=S.getCharCode("9"),l=S.getCharCode("0");for(let e=l;e<=u;e++)t[yr][e]=e-l+2;t[yr][n]=12,t[yr][r]=13;const h=["\0"," ","","","","","","","","\b","\t","\n","\v","\f","\r","","","","","","@","\\","^","_","`","|","~",""];for(let e=0;e<h.length;e++)t[Cr][S.getCharCode(h[e])]=e;const c=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let e=0;e<c.length;e++)S.getCharCode(c[e])>0&&(t[br][S.getCharCode(c[e])]=e);return t}Rr.INITIAL_STATE=new Rr(Ir,Er,0,0);const Or=Nr(m.createInt32Array(5,256));class Dr{constructor(t){this.text=t}encode(){const t=S.getCharCode(" "),e=S.getCharCode("\n");let r=dr.singletonList(Rr.INITIAL_STATE);for(let n=0;n<this.text.length;n++){let i,o=n+1<this.text.length?this.text[n+1]:0;switch(this.text[n]){case S.getCharCode("\r"):i=o===e?2:0;break;case S.getCharCode("."):i=o===t?3:0;break;case S.getCharCode(","):i=o===t?4:0;break;case S.getCharCode(":"):i=o===t?5:0;break;default:i=0}i>0?(r=Dr.updateStateListForPair(r,n,i),n++):r=this.updateStateListForChar(r,n)}return dr.min(r,((t,e)=>t.getBitCount()-e.getBitCount())).toBitArray(this.text)}updateStateListForChar(t,e){const r=[];for(let n of t)this.updateStateForChar(n,e,r);return Dr.simplifyStates(r)}updateStateForChar(t,e,r){let n=255&this.text[e],i=Or[t.getMode()][n]>0,o=null;for(let s=0;s<=br;s++){let a=Or[s][n];if(a>0){if(null==o&&(o=t.endBinaryShift(e)),!i||s===t.getMode()||s===yr){const t=o.latchAndAppend(s,a);r.push(t)}if(!i&&Tr[t.getMode()][s]>=0){const t=o.shiftAndAppend(s,a);r.push(t)}}}if(t.getBinaryShiftByteCount()>0||0===Or[t.getMode()][n]){let n=t.addBinaryShiftChar(e);r.push(n)}}static updateStateListForPair(t,e,r){const n=[];for(let i of t)this.updateStateForPair(i,e,r,n);return this.simplifyStates(n)}static updateStateForPair(t,e,r,n){let i=t.endBinaryShift(e);if(n.push(i.latchAndAppend(br,r)),t.getMode()!==br&&n.push(i.shiftAndAppend(br,r)),3===r||4===r){let t=i.latchAndAppend(yr,16-r).latchAndAppend(yr,1);n.push(t)}if(t.getBinaryShiftByteCount()>0){let r=t.addBinaryShiftChar(e).addBinaryShiftChar(e+1);n.push(r)}}static simplifyStates(t){let e=[];for(const r of t){let t=!0;for(const n of e){if(n.isBetterThanOrEqualTo(r)){t=!1;break}r.isBetterThanOrEqualTo(n)&&(e=e.filter((t=>t!==n)))}t&&e.push(r)}return e}}class Br{constructor(){}static encodeBytes(t){return Br.encode(t,Br.DEFAULT_EC_PERCENT,Br.DEFAULT_AZTEC_LAYERS)}static encode(t,e,r){let n,i,o,s,a,u=new Dr(t).encode(),l=w.truncDivision(u.getSize()*e,100)+11,c=u.getSize()+l;if(r!==Br.DEFAULT_AZTEC_LAYERS){if(n=r<0,i=Math.abs(r),i>(n?Br.MAX_NB_BITS_COMPACT:Br.MAX_NB_BITS))throw new h(S.format("Illegal value %s for layers",r));o=Br.totalBitsInLayer(i,n),s=Br.WORD_SIZE[i];let t=o-o%s;if(a=Br.stuffBits(u,s),a.getSize()+l>t)throw new h("Data to large for user specified layer");if(n&&a.getSize()>64*s)throw new h("Data to large for user specified layer")}else{s=0,a=null;for(let t=0;;t++){if(t>Br.MAX_NB_BITS)throw new h("Data too large for an Aztec code");if(n=t<=3,i=n?t+1:t,o=Br.totalBitsInLayer(i,n),c>o)continue;null!=a&&s===Br.WORD_SIZE[i]||(s=Br.WORD_SIZE[i],a=Br.stuffBits(u,s));let e=o-o%s;if(!(n&&a.getSize()>64*s)&&a.getSize()+l<=e)break}}let d,f=Br.generateCheckWords(a,o,s),g=a.getSize()/s,p=Br.generateModeMessage(n,i,g),_=(n?11:14)+4*i,m=new Int32Array(_);if(n){d=_;for(let t=0;t<m.length;t++)m[t]=t}else{d=_+1+2*w.truncDivision(w.truncDivision(_,2)-1,15);let t=w.truncDivision(_,2),e=w.truncDivision(d,2);for(let r=0;r<t;r++){let n=r+w.truncDivision(r,15);m[t-r-1]=e-n-1,m[t+r]=e+n+1}}let E=new R(d);for(let t=0,e=0;t<i;t++){let r=4*(i-t)+(n?9:12);for(let n=0;n<r;n++){let i=2*n;for(let o=0;o<2;o++)f.get(e+i+o)&&E.set(m[2*t+o],m[2*t+n]),f.get(e+2*r+i+o)&&E.set(m[2*t+n],m[_-1-2*t-o]),f.get(e+4*r+i+o)&&E.set(m[_-1-2*t-o],m[_-1-2*t-n]),f.get(e+6*r+i+o)&&E.set(m[_-1-2*t-n],m[2*t+o])}e+=8*r}if(Br.drawModeMessage(E,n,d,p),n)Br.drawBullsEye(E,w.truncDivision(d,2),5);else{Br.drawBullsEye(E,w.truncDivision(d,2),7);for(let t=0,e=0;t<w.truncDivision(_,2)-1;t+=15,e+=16)for(let t=1&w.truncDivision(d,2);t<d;t+=2)E.set(w.truncDivision(d,2)-e,t),E.set(w.truncDivision(d,2)+e,t),E.set(t,w.truncDivision(d,2)-e),E.set(t,w.truncDivision(d,2)+e)}let A=new cr;return A.setCompact(n),A.setSize(d),A.setLayers(i),A.setCodeWords(g),A.setMatrix(E),A}static drawBullsEye(t,e,r){for(let n=0;n<r;n+=2)for(let r=e-n;r<=e+n;r++)t.set(r,e-n),t.set(r,e+n),t.set(e-n,r),t.set(e+n,r);t.set(e-r,e-r),t.set(e-r+1,e-r),t.set(e-r,e-r+1),t.set(e+r,e-r),t.set(e+r,e-r+1),t.set(e+r,e+r-1)}static generateModeMessage(t,e,r){let n=new E;return t?(n.appendBits(e-1,2),n.appendBits(r-1,6),n=Br.generateCheckWords(n,28,4)):(n.appendBits(e-1,5),n.appendBits(r-1,11),n=Br.generateCheckWords(n,40,4)),n}static drawModeMessage(t,e,r,n){let i=w.truncDivision(r,2);if(e)for(let e=0;e<7;e++){let r=i-3+e;n.get(e)&&t.set(r,i-5),n.get(e+7)&&t.set(i+5,r),n.get(20-e)&&t.set(r,i+5),n.get(27-e)&&t.set(i-5,r)}else for(let e=0;e<10;e++){let r=i-5+e+w.truncDivision(e,5);n.get(e)&&t.set(r,i-7),n.get(e+10)&&t.set(i+7,r),n.get(29-e)&&t.set(r,i+7),n.get(39-e)&&t.set(i-7,r)}}static generateCheckWords(t,e,r){let n=t.getSize()/r,i=new qe(Br.getGF(r)),o=w.truncDivision(e,r),s=Br.bitsToWords(t,r,o);i.encode(s,o-n);let a=e%r,u=new E;u.appendBits(0,a);for(const t of Array.from(s))u.appendBits(t,r);return u}static bitsToWords(t,e,r){let n,i,o=new Int32Array(r);for(n=0,i=t.getSize()/e;n<i;n++){let r=0;for(let i=0;i<e;i++)r|=t.get(n*e+i)?1<<e-i-1:0;o[n]=r}return o}static getGF(t){switch(t){case 4:return $.AZTEC_PARAM;case 6:return $.AZTEC_DATA_6;case 8:return $.AZTEC_DATA_8;case 10:return $.AZTEC_DATA_10;case 12:return $.AZTEC_DATA_12;default:throw new h("Unsupported word size "+t)}}static stuffBits(t,e){let r=new E,n=t.getSize(),i=(1<<e)-2;for(let o=0;o<n;o+=e){let s=0;for(let r=0;r<e;r++)(o+r>=n||t.get(o+r))&&(s|=1<<e-1-r);(s&i)===i?(r.appendBits(s&i,e),o--):0==(s&i)?(r.appendBits(1|s,e),o--):r.appendBits(s,e)}return r}static totalBitsInLayer(t,e){return((e?88:112)+16*t)*t}}Br.DEFAULT_EC_PERCENT=33,Br.DEFAULT_AZTEC_LAYERS=0,Br.MAX_NB_BITS=32,Br.MAX_NB_BITS_COMPACT=4,Br.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Mr{encode(t,e,r,n){return this.encodeWithHints(t,e,r,n,null)}encodeWithHints(t,e,r,n,i){let o=hr.ISO_8859_1,s=Br.DEFAULT_EC_PERCENT,a=Br.DEFAULT_AZTEC_LAYERS;return null!=i&&(i.has(je.CHARACTER_SET)&&(o=lr.forName(i.get(je.CHARACTER_SET).toString())),i.has(je.ERROR_CORRECTION)&&(s=w.parseInt(i.get(je.ERROR_CORRECTION).toString())),i.has(je.AZTEC_LAYERS)&&(a=w.parseInt(i.get(je.AZTEC_LAYERS).toString()))),Mr.encodeLayers(t,e,r,n,o,s,a)}static encodeLayers(t,e,r,n,i,o,s){if(e!==H.AZTEC)throw new h("Can only encode AZTEC, but got "+e);let a=Br.encode(S.getBytes(t,i),o,s);return Mr.renderResult(a,r,n)}static renderResult(t,e,r){let n=t.getMatrix();if(null==n)throw new et;let i=n.getWidth(),o=n.getHeight(),s=Math.max(e,i),a=Math.max(r,o),u=Math.min(s/i,a/o),l=(s-i*u)/2,h=(a-o*u)/2,c=new R(s,a);for(let t=0,e=h;t<o;t++,e+=u)for(let r=0,o=l;r<i;r++,o+=u)n.get(r,t)&&c.setRegion(o,e,u,u);return c}}class Pr{constructor(t){this.newPosition=t}getNewPosition(){return this.newPosition}}class kr extends Pr{constructor(t,e){super(t),this.value=e}getValue(){return this.value}isFNC1(){return this.value===kr.FNC1}}kr.FNC1="$";class Lr extends Pr{constructor(t,e,r){if(super(t),e<0||e>10||r<0||r>10)throw new C;this.firstDigit=e,this.secondDigit=r}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return 10*this.firstDigit+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit==Lr.FNC1}isSecondDigitFNC1(){return this.secondDigit==Lr.FNC1}isAnyFNC1(){return this.firstDigit===Lr.FNC1||this.secondDigit===Lr.FNC1}}Lr.FNC1=10;class xr extends Pr{constructor(t,e,r){super(t),r?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=e}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class Fr{constructor(){}static parseFieldsInGeneralPurpose(t){if(!t)return null;if(t.length<2)throw new N;let e=t.substring(0,2);for(let r of Fr.TWO_DIGIT_DATA_LENGTH)if(r[0]===e)return r[1]===Fr.VARIABLE_LENGTH?Fr.processVariableAI(2,r[2],t):Fr.processFixedAI(2,r[1],t);if(t.length<3)throw new N;let r=t.substring(0,3);for(let e of Fr.THREE_DIGIT_DATA_LENGTH)if(e[0]===r)return e[1]===Fr.VARIABLE_LENGTH?Fr.processVariableAI(3,e[2],t):Fr.processFixedAI(3,e[1],t);for(let e of Fr.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(e[0]===r)return e[1]===Fr.VARIABLE_LENGTH?Fr.processVariableAI(4,e[2],t):Fr.processFixedAI(4,e[1],t);if(t.length<4)throw new N;let n=t.substring(0,4);for(let e of Fr.FOUR_DIGIT_DATA_LENGTH)if(e[0]===n)return e[1]===Fr.VARIABLE_LENGTH?Fr.processVariableAI(4,e[2],t):Fr.processFixedAI(4,e[1],t);throw new N}static processFixedAI(t,e,r){if(r.length<t)throw new N;let n=r.substring(0,t);if(r.length<t+e)throw new N;let i=r.substring(t,t+e),o=r.substring(t+e),s="("+n+")"+i,a=Fr.parseFieldsInGeneralPurpose(o);return null==a?s:s+a}static processVariableAI(t,e,r){let n,i=r.substring(0,t);n=r.length<t+e?r.length:t+e;let o=r.substring(t,n),s=r.substring(n),a="("+i+")"+o,u=Fr.parseFieldsInGeneralPurpose(s);return null==u?a:a+u}}Fr.VARIABLE_LENGTH=[],Fr.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",Fr.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",Fr.VARIABLE_LENGTH,20],["22",Fr.VARIABLE_LENGTH,29],["30",Fr.VARIABLE_LENGTH,8],["37",Fr.VARIABLE_LENGTH,8],["90",Fr.VARIABLE_LENGTH,30],["91",Fr.VARIABLE_LENGTH,30],["92",Fr.VARIABLE_LENGTH,30],["93",Fr.VARIABLE_LENGTH,30],["94",Fr.VARIABLE_LENGTH,30],["95",Fr.VARIABLE_LENGTH,30],["96",Fr.VARIABLE_LENGTH,30],["97",Fr.VARIABLE_LENGTH,3],["98",Fr.VARIABLE_LENGTH,30],["99",Fr.VARIABLE_LENGTH,30]],Fr.THREE_DIGIT_DATA_LENGTH=[["240",Fr.VARIABLE_LENGTH,30],["241",Fr.VARIABLE_LENGTH,30],["242",Fr.VARIABLE_LENGTH,6],["250",Fr.VARIABLE_LENGTH,30],["251",Fr.VARIABLE_LENGTH,30],["253",Fr.VARIABLE_LENGTH,17],["254",Fr.VARIABLE_LENGTH,20],["400",Fr.VARIABLE_LENGTH,30],["401",Fr.VARIABLE_LENGTH,30],["402",17],["403",Fr.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",Fr.VARIABLE_LENGTH,20],["421",Fr.VARIABLE_LENGTH,15],["422",3],["423",Fr.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],Fr.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",Fr.VARIABLE_LENGTH,15],["391",Fr.VARIABLE_LENGTH,18],["392",Fr.VARIABLE_LENGTH,15],["393",Fr.VARIABLE_LENGTH,18],["703",Fr.VARIABLE_LENGTH,30]],Fr.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",Fr.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",Fr.VARIABLE_LENGTH,20],["8003",Fr.VARIABLE_LENGTH,30],["8004",Fr.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",Fr.VARIABLE_LENGTH,30],["8008",Fr.VARIABLE_LENGTH,12],["8018",18],["8020",Fr.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",Fr.VARIABLE_LENGTH,70],["8200",Fr.VARIABLE_LENGTH,70]];class Ur{constructor(t,e){e?this.decodedInformation=null:(this.finished=t,this.decodedInformation=e)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class Vr{constructor(t){this.buffer=new T,this.information=t}decodeAllCodes(t,e){let r=e,n=null;for(;;){let e=this.decodeGeneralPurposeField(r,n),i=Fr.parseFieldsInGeneralPurpose(e.getNewString());if(null!=i&&t.append(i),n=e.isRemaining()?""+e.getRemainingValue():null,r==e.getNewPosition())break;r=e.getNewPosition()}return t.toString()}isStillNumeric(t){if(t+7>this.information.getSize())return t+4<=this.information.getSize();for(let e=t;e<t+3;++e)if(this.information.get(e))return!0;return this.information.get(t+3)}decodeNumeric(t){if(t+7>this.information.getSize()){let e=this.extractNumericValueFromBitArray(t,4);return new Lr(this.information.getSize(),0==e?Lr.FNC1:e-1,Lr.FNC1)}let e=this.extractNumericValueFromBitArray(t,7);return new Lr(t+7,(e-8)/11,(e-8)%11)}extractNumericValueFromBitArray(t,e){return Vr.extractNumericValueFromBitArray(this.information,t,e)}static extractNumericValueFromBitArray(t,e,r){let n=0;for(let i=0;i<r;++i)t.get(e+i)&&(n|=1<<r-i-1);return n}decodeGeneralPurposeField(t,e){this.buffer.setLengthToZero(),null!=e&&this.buffer.append(e),this.current.setPosition(t);let r=this.parseBlocks();return null!=r&&r.isRemaining()?new xr(this.current.getPosition(),this.buffer.toString(),r.getRemainingValue()):new xr(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let t,e;do{let r=this.current.getPosition();if(this.current.isAlpha()?(e=this.parseAlphaBlock(),t=e.isFinished()):this.current.isIsoIec646()?(e=this.parseIsoIec646Block(),t=e.isFinished()):(e=this.parseNumericBlock(),t=e.isFinished()),r==this.current.getPosition()&&!t)break}while(!t);return e.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let t=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFirstDigitFNC1()){let e;return e=t.isSecondDigitFNC1()?new xr(this.current.getPosition(),this.buffer.toString()):new xr(this.current.getPosition(),this.buffer.toString(),t.getSecondDigit()),new Ur(!0,e)}if(this.buffer.append(t.getFirstDigit()),t.isSecondDigitFNC1()){let t=new xr(this.current.getPosition(),this.buffer.toString());return new Ur(!0,t)}this.buffer.append(t.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new Ur(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let t=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let t=new xr(this.current.getPosition(),this.buffer.toString());return new Ur(!0,t)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new Ur(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let t=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(t.getNewPosition()),t.isFNC1()){let t=new xr(this.current.getPosition(),this.buffer.toString());return new Ur(!0,t)}this.buffer.append(t.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new Ur(!1)}isStillIsoIec646(t){if(t+5>this.information.getSize())return!1;let e=this.extractNumericValueFromBitArray(t,5);if(e>=5&&e<16)return!0;if(t+7>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,7);if(r>=64&&r<116)return!0;if(t+8>this.information.getSize())return!1;let n=this.extractNumericValueFromBitArray(t,8);return n>=232&&n<253}decodeIsoIec646(t){let e=this.extractNumericValueFromBitArray(t,5);if(15==e)return new kr(t+5,kr.FNC1);if(e>=5&&e<15)return new kr(t+5,"0"+(e-5));let r,n=this.extractNumericValueFromBitArray(t,7);if(n>=64&&n<90)return new kr(t+7,""+(n+1));if(n>=90&&n<116)return new kr(t+7,""+(n+7));switch(this.extractNumericValueFromBitArray(t,8)){case 232:r="!";break;case 233:r='"';break;case 234:r="%";break;case 235:r="&";break;case 236:r="'";break;case 237:r="(";break;case 238:r=")";break;case 239:r="*";break;case 240:r="+";break;case 241:r=",";break;case 242:r="-";break;case 243:r=".";break;case 244:r="/";break;case 245:r=":";break;case 246:r=";";break;case 247:r="<";break;case 248:r="=";break;case 249:r=">";break;case 250:r="?";break;case 251:r="_";break;case 252:r=" ";break;default:throw new C}return new kr(t+8,r)}isStillAlpha(t){if(t+5>this.information.getSize())return!1;let e=this.extractNumericValueFromBitArray(t,5);if(e>=5&&e<16)return!0;if(t+6>this.information.getSize())return!1;let r=this.extractNumericValueFromBitArray(t,6);return r>=16&&r<63}decodeAlphanumeric(t){let e=this.extractNumericValueFromBitArray(t,5);if(15==e)return new kr(t+5,kr.FNC1);if(e>=5&&e<15)return new kr(t+5,"0"+(e-5));let r,n=this.extractNumericValueFromBitArray(t,6);if(n>=32&&n<58)return new kr(t+6,""+(n+33));switch(n){case 58:r="*";break;case 59:r=",";break;case 60:r="-";break;case 61:r=".";break;case 62:r="/";break;default:throw new et("Decoding invalid alphanumeric value: "+n)}return new kr(t+6,r)}isAlphaTo646ToAlphaLatch(t){if(t+1>this.information.getSize())return!1;for(let e=0;e<5&&e+t<this.information.getSize();++e)if(2==e){if(!this.information.get(t+2))return!1}else if(this.information.get(t+e))return!1;return!0}isAlphaOr646ToNumericLatch(t){if(t+3>this.information.getSize())return!1;for(let e=t;e<t+3;++e)if(this.information.get(e))return!1;return!0}isNumericToAlphaNumericLatch(t){if(t+1>this.information.getSize())return!1;for(let e=0;e<4&&e+t<this.information.getSize();++e)if(this.information.get(t+e))return!1;return!0}}class Hr{constructor(t){this.information=t,this.generalDecoder=new Vr(t)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class zr extends Hr{constructor(t){super(t)}encodeCompressedGtin(t,e){t.append("(01)");let r=t.length();t.append("9"),this.encodeCompressedGtinWithoutAI(t,e,r)}encodeCompressedGtinWithoutAI(t,e,r){for(let r=0;r<4;++r){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(e+10*r,10);n/100==0&&t.append("0"),n/10==0&&t.append("0"),t.append(n)}zr.appendCheckDigit(t,r)}static appendCheckDigit(t,e){let r=0;for(let n=0;n<13;n++){let i=t.charAt(n+e).charCodeAt(0)-"0".charCodeAt(0);r+=0==(1&n)?3*i:i}r=10-r%10,10==r&&(r=0),t.append(r)}}zr.GTIN_SIZE=40;class Gr extends zr{constructor(t){super(t)}parseInformation(){let t=new T;t.append("(01)");let e=t.length(),r=this.getGeneralDecoder().extractNumericValueFromBitArray(Gr.HEADER_SIZE,4);return t.append(r),this.encodeCompressedGtinWithoutAI(t,Gr.HEADER_SIZE+4,e),this.getGeneralDecoder().decodeAllCodes(t,Gr.HEADER_SIZE+44)}}Gr.HEADER_SIZE=4;class Xr extends Hr{constructor(t){super(t)}parseInformation(){let t=new T;return this.getGeneralDecoder().decodeAllCodes(t,Xr.HEADER_SIZE)}}Xr.HEADER_SIZE=5;class Wr extends zr{constructor(t){super(t)}encodeCompressedWeight(t,e,r){let n=this.getGeneralDecoder().extractNumericValueFromBitArray(e,r);this.addWeightCode(t,n);let i=this.checkWeight(n),o=1e5;for(let e=0;e<5;++e)i/o==0&&t.append("0"),o/=10;t.append(i)}}class Yr extends Wr{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()!=Yr.HEADER_SIZE+Wr.GTIN_SIZE+Yr.WEIGHT_SIZE)throw new N;let t=new T;return this.encodeCompressedGtin(t,Yr.HEADER_SIZE),this.encodeCompressedWeight(t,Yr.HEADER_SIZE+Wr.GTIN_SIZE,Yr.WEIGHT_SIZE),t.toString()}}Yr.HEADER_SIZE=5,Yr.WEIGHT_SIZE=15;class Kr extends Yr{constructor(t){super(t)}addWeightCode(t,e){t.append("(3103)")}checkWeight(t){return t}}class Zr extends Yr{constructor(t){super(t)}addWeightCode(t,e){e<1e4?t.append("(3202)"):t.append("(3203)")}checkWeight(t){return t<1e4?t:t-1e4}}class jr extends zr{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()<jr.HEADER_SIZE+zr.GTIN_SIZE)throw new N;let t=new T;this.encodeCompressedGtin(t,jr.HEADER_SIZE);let e=this.getGeneralDecoder().extractNumericValueFromBitArray(jr.HEADER_SIZE+zr.GTIN_SIZE,jr.LAST_DIGIT_SIZE);t.append("(392"),t.append(e),t.append(")");let r=this.getGeneralDecoder().decodeGeneralPurposeField(jr.HEADER_SIZE+zr.GTIN_SIZE+jr.LAST_DIGIT_SIZE,null);return t.append(r.getNewString()),t.toString()}}jr.HEADER_SIZE=8,jr.LAST_DIGIT_SIZE=2;class qr extends zr{constructor(t){super(t)}parseInformation(){if(this.getInformation().getSize()<qr.HEADER_SIZE+zr.GTIN_SIZE)throw new N;let t=new T;this.encodeCompressedGtin(t,qr.HEADER_SIZE);let e=this.getGeneralDecoder().extractNumericValueFromBitArray(qr.HEADER_SIZE+zr.GTIN_SIZE,qr.LAST_DIGIT_SIZE);t.append("(393"),t.append(e),t.append(")");let r=this.getGeneralDecoder().extractNumericValueFromBitArray(qr.HEADER_SIZE+zr.GTIN_SIZE+qr.LAST_DIGIT_SIZE,qr.FIRST_THREE_DIGITS_SIZE);r/100==0&&t.append("0"),r/10==0&&t.append("0"),t.append(r);let n=this.getGeneralDecoder().decodeGeneralPurposeField(qr.HEADER_SIZE+zr.GTIN_SIZE+qr.LAST_DIGIT_SIZE+qr.FIRST_THREE_DIGITS_SIZE,null);return t.append(n.getNewString()),t.toString()}}qr.HEADER_SIZE=8,qr.LAST_DIGIT_SIZE=2,qr.FIRST_THREE_DIGITS_SIZE=10;class Qr extends Wr{constructor(t,e,r){super(t),this.dateCode=r,this.firstAIdigits=e}parseInformation(){if(this.getInformation().getSize()!=Qr.HEADER_SIZE+Qr.GTIN_SIZE+Qr.WEIGHT_SIZE+Qr.DATE_SIZE)throw new N;let t=new T;return this.encodeCompressedGtin(t,Qr.HEADER_SIZE),this.encodeCompressedWeight(t,Qr.HEADER_SIZE+Qr.GTIN_SIZE,Qr.WEIGHT_SIZE),this.encodeCompressedDate(t,Qr.HEADER_SIZE+Qr.GTIN_SIZE+Qr.WEIGHT_SIZE),t.toString()}encodeCompressedDate(t,e){let r=this.getGeneralDecoder().extractNumericValueFromBitArray(e,Qr.DATE_SIZE);if(38400==r)return;t.append("("),t.append(this.dateCode),t.append(")");let n=r%32;r/=32;let i=r%12+1;r/=12;let o=r;o/10==0&&t.append("0"),t.append(o),i/10==0&&t.append("0"),t.append(i),n/10==0&&t.append("0"),t.append(n)}addWeightCode(t,e){t.append("("),t.append(this.firstAIdigits),t.append(e/1e5),t.append(")")}checkWeight(t){return t%1e5}}function Jr(t){try{if(t.get(1))return new Gr(t);if(!t.get(2))return new Xr(t);switch(Vr.extractNumericValueFromBitArray(t,1,4)){case 4:return new Kr(t);case 5:return new Zr(t)}switch(Vr.extractNumericValueFromBitArray(t,1,5)){case 12:return new jr(t);case 13:return new qr(t)}switch(Vr.extractNumericValueFromBitArray(t,1,7)){case 56:return new Qr(t,"310","11");case 57:return new Qr(t,"320","11");case 58:return new Qr(t,"310","13");case 59:return new Qr(t,"320","13");case 60:return new Qr(t,"310","15");case 61:return new Qr(t,"320","15");case 62:return new Qr(t,"310","17");case 63:return new Qr(t,"320","17")}}catch(e){throw console.log(e),new et("unknown decoder: "+t)}}Qr.HEADER_SIZE=8,Qr.WEIGHT_SIZE=20,Qr.DATE_SIZE=16;class $r{constructor(t,e,r,n){this.leftchar=t,this.rightchar=e,this.finderpattern=r,this.maybeLast=n}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return null==this.rightchar}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(null==this.finderpattern?"null":this.finderpattern.getValue())+" ]"}static equals(t,e){return t instanceof $r&&$r.equalsOrNull(t.leftchar,e.leftchar)&&$r.equalsOrNull(t.rightchar,e.rightchar)&&$r.equalsOrNull(t.finderpattern,e.finderpattern)}static equalsOrNull(t,e){return null===t?null===e:$r.equals(t,e)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}static hashNotNull(t){return null===t?0:t.hashCode()}}class tn{constructor(t,e,r){this.pairs=t,this.rowNumber=e,this.wasReversed=r}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(t){return this.checkEqualitity(this,t)}toString(){return"{ "+this.pairs+" }"}equals(t,e){return t instanceof tn&&this.checkEqualitity(t,e)&&t.wasReversed===e.wasReversed}checkEqualitity(t,e){if(!t||!e)return;let r;return t.forEach(((t,n)=>{e.forEach((e=>{t.getLeftChar().getValue()===e.getLeftChar().getValue()&&t.getRightChar().getValue()===e.getRightChar().getValue()&&t.getFinderPatter().getValue()===e.getFinderPatter().getValue()&&(r=!0)}))})),r}}class en{constructor(){}static buildBitArray(t){let e=2*t.length-1;null==t[t.length-1].getRightChar()&&(e-=1);let r=new E(12*e),n=0,i=t[0].getRightChar().getValue();for(let t=11;t>=0;--t)0!=(i&1<<t)&&r.set(n),n++;for(let e=1;e<t.length;++e){let i=t[e],o=i.getLeftChar().getValue();for(let t=11;t>=0;--t)0!=(o&1<<t)&&r.set(n),n++;if(null!=i.getRightChar()){let t=i.getRightChar().getValue();for(let e=11;e>=0;--e)0!=(t&1<<e)&&r.set(n),n++}}return r}}class rn extends yt{constructor(){super(...arguments),this.pairs=new Array(rn.MAX_PAIRS),this.rows=new Array,this.startEnd=[2]}decodeRow(t,e,r){this.pairs.length=0,this.startFromEven=!1;try{return rn.constructResult(this.decodeRow2pairs(t,e))}catch(t){console.log(t)}return this.pairs.length=0,this.startFromEven=!0,rn.constructResult(this.decodeRow2pairs(t,e))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(t,e){let r,n=!1;for(;!n;)try{this.pairs.push(this.retrieveNextPair(e,this.pairs,t))}catch(t){if(!this.pairs.length)throw new t;n=!0}if(this.checkChecksum())return this.pairs;if(r=!!this.rows.length,this.storeRow(t,!1),r){let t=this.checkRowsBoolean(!1);if(null!=t)return t;if(t=this.checkRowsBoolean(!0),null!=t)return t}throw new N}checkRowsBoolean(t){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,t&&(this.rows=this.rows.reverse());let e=null;try{e=this.checkRows(new Array,0)}catch(t){console.log(t)}return t&&(this.rows=this.rows.reverse()),e}checkRows(t,e){for(let r=e;r<this.rows.length;r++){let e=this.rows[r];this.pairs.length=0;for(let e of t)this.pairs.push(e.getPairs());if(this.pairs.push(e.getPairs()),!rn.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let n=new Array(t);n.push(e);try{return this.checkRows(n,r+1)}catch(t){console.log(t)}}throw new N}static isValidSequence(t){for(let e of rn.FINDER_PATTERN_SEQUENCES){if(t.length>e.length)continue;let r=!0;for(let n=0;n<t.length;n++)if(t[n].getFinderPattern().getValue()!=e[n]){r=!1;break}if(r)return!0}return!1}storeRow(t,e){let r=0,n=!1,i=!1;for(;r<this.rows.length;){let e=this.rows[r];if(e.getRowNumber()>t){i=e.isEquivalent(this.pairs);break}n=e.isEquivalent(this.pairs),r++}i||n||rn.isPartialRow(this.pairs,this.rows)||(this.rows.push(r,new tn(this.pairs,t,e)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(t,e){for(let r of e)if(r.getPairs().length!==t.length)for(let e of r.getPairs())for(let r of t)if($r.equals(e,r))break}static isPartialRow(t,e){for(let r of e){let e=!0;for(let n of t){let t=!1;for(let e of r.getPairs())if(n.equals(e)){t=!0;break}if(!t){e=!1;break}}if(e)return!0}return!1}getRows(){return this.rows}static constructResult(t){let e=Jr(en.buildBitArray(t)).parseInformation(),r=t[0].getFinderPattern().getResultPoints(),n=t[t.length-1].getFinderPattern().getResultPoints(),i=[r[0],r[1],n[0],n[1]];return new U(e,null,null,i,H.RSS_EXPANDED,null)}checkChecksum(){let t=this.pairs.get(0),e=t.getLeftChar(),r=t.getRightChar();if(null==r)return!1;let n=r.getChecksumPortion(),i=2;for(let t=1;t<this.pairs.size();++t){let e=this.pairs.get(t);n+=e.getLeftChar().getChecksumPortion(),i++;let r=e.getRightChar();null!=r&&(n+=r.getChecksumPortion(),i++)}return n%=211,211*(i-4)+n==e.getValue()}static getNextSecondBar(t,e){let r;return t.get(e)?(r=t.getNextUnset(e),r=t.getNextSet(r)):(r=t.getNextSet(e),r=t.getNextUnset(r)),r}retrieveNextPair(t,e,r){let n,i=e.length%2==0;this.startFromEven&&(i=!i);let o=!0,s=-1;do{this.findNextPair(t,e,s),n=this.parseFoundFinderPattern(t,r,i),null==n?s=rn.getNextSecondBar(t,this.startEnd[0]):o=!1}while(o);let a,u=this.decodeDataCharacter(t,n,i,!0);if(!this.isEmptyPair(e)&&e[e.length-1].mustBeLast())throw new N;try{a=this.decodeDataCharacter(t,n,i,!1)}catch(t){a=null,console.log(t)}return new $r(u,a,n,!0)}isEmptyPair(t){return 0===t.length}findNextPair(t,e,r){let n=this.getDecodeFinderCounters();n[0]=0,n[1]=0,n[2]=0,n[3]=0;let i,o=t.getSize();i=r>=0?r:this.isEmptyPair(e)?0:e[e.length-1].getFinderPattern().getStartEnd()[1];let s=e.length%2!=0;this.startFromEven&&(s=!s);let a=!1;for(;i<o&&(a=!t.get(i),a);)i++;let u=0,l=i;for(let e=i;e<o;e++)if(t.get(e)!=a)n[u]++;else{if(3==u){if(s&&rn.reverseCounters(n),rn.isFinderPattern(n))return this.startEnd[0]=l,void(this.startEnd[1]=e);s&&rn.reverseCounters(n),l+=n[0]+n[1],n[0]=n[2],n[1]=n[3],n[2]=0,n[3]=0,u--}else u++;n[u]=1,a=!a}throw new N}static reverseCounters(t){let e=t.length;for(let r=0;r<e/2;++r){let n=t[r];t[r]=t[e-r-1],t[e-r-1]=n}}parseFoundFinderPattern(t,e,r){let n,i,o;if(r){let e=this.startEnd[0]-1;for(;e>=0&&!t.get(e);)e--;e++,n=this.startEnd[0]-e,i=e,o=this.startEnd[1]}else i=this.startEnd[0],o=t.getNextUnset(this.startEnd[1]+1),n=o-this.startEnd[1];let s,a=this.getDecodeFinderCounters();g.arraycopy(a,0,a,1,a.length-1),a[0]=n;try{s=this.parseFinderValue(a,rn.FINDER_PATTERNS)}catch(t){return null}return new It(s,[i,o],i,o,e)}decodeDataCharacter(t,e,r,n){let i=this.getDataCharacterCounters();for(let t=0;t<i.length;t++)i[t]=0;if(n)rn.recordPatternInReverse(t,e.getStartEnd()[0],i);else{rn.recordPattern(t,e.getStartEnd()[1],i);for(let t=0,e=i.length-1;t<e;t++,e--){let r=i[t];i[t]=i[e],i[e]=r}}let o=17,s=it.sum(new Int32Array(i))/o,a=(e.getStartEnd()[1]-e.getStartEnd()[0])/15;if(Math.abs(s-a)/a>.3)throw new N;let u=this.getOddCounts(),l=this.getEvenCounts(),h=this.getOddRoundingErrors(),c=this.getEvenRoundingErrors();for(let t=0;t<i.length;t++){let e=1*i[t]/s,r=e+.5;if(r<1){if(e<.3)throw new N;r=1}else if(r>8){if(e>8.7)throw new N;r=8}let n=t/2;0==(1&t)?(u[n]=r,h[n]=e-r):(l[n]=r,c[n]=e-r)}this.adjustOddEvenCounts(o);let d=4*e.getValue()+(r?0:2)+(n?0:1)-1,f=0,g=0;for(let t=u.length-1;t>=0;t--){if(rn.isNotA1left(e,r,n)){let e=rn.WEIGHTS[d][2*t];g+=u[t]*e}f+=u[t]}let w=0;for(let t=l.length-1;t>=0;t--)if(rn.isNotA1left(e,r,n)){let e=rn.WEIGHTS[d][2*t+1];w+=l[t]*e}let p=g+w;if(0!=(1&f)||f>13||f<4)throw new N;let _=(13-f)/2,m=rn.SYMBOL_WIDEST[_],E=9-m,A=vt.getRSSvalue(u,m,!0),y=vt.getRSSvalue(l,E,!1),C=rn.EVEN_TOTAL_SUBSET[_],b=rn.GSUM[_];return new Ct(A*C+y+b,p)}static isNotA1left(t,e,r){return!(0==t.getValue()&&e&&r)}adjustOddEvenCounts(t){let e=it.sum(new Int32Array(this.getOddCounts())),r=it.sum(new Int32Array(this.getEvenCounts())),n=!1,i=!1;e>13?i=!0:e<4&&(n=!0);let o=!1,s=!1;r>13?s=!0:r<4&&(o=!0);let a=e+r-t,u=1==(1&e),l=0==(1&r);if(1==a)if(u){if(l)throw new N;i=!0}else{if(!l)throw new N;s=!0}else if(-1==a)if(u){if(l)throw new N;n=!0}else{if(!l)throw new N;o=!0}else{if(0!=a)throw new N;if(u){if(!l)throw new N;e<r?(n=!0,s=!0):(i=!0,o=!0)}else if(l)throw new N}if(n){if(i)throw new N;rn.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(i&&rn.decrement(this.getOddCounts(),this.getOddRoundingErrors()),o){if(s)throw new N;rn.increment(this.getEvenCounts(),this.getOddRoundingErrors())}s&&rn.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}rn.SYMBOL_WIDEST=[7,5,4,3,1],rn.EVEN_TOTAL_SUBSET=[4,20,52,104,204],rn.GSUM=[0,348,1388,2948,3988],rn.FINDER_PATTERNS=[[1,8,4,1],[3,6,4,1],[3,4,6,1],[3,2,8,1],[2,6,5,1],[2,2,9,1]],rn.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],rn.FINDER_PAT_A=0,rn.FINDER_PAT_B=1,rn.FINDER_PAT_C=2,rn.FINDER_PAT_D=3,rn.FINDER_PAT_E=4,rn.FINDER_PAT_F=5,rn.FINDER_PATTERN_SEQUENCES=[[rn.FINDER_PAT_A,rn.FINDER_PAT_A],[rn.FINDER_PAT_A,rn.FINDER_PAT_B,rn.FINDER_PAT_B],[rn.FINDER_PAT_A,rn.FINDER_PAT_C,rn.FINDER_PAT_B,rn.FINDER_PAT_D],[rn.FINDER_PAT_A,rn.FINDER_PAT_E,rn.FINDER_PAT_B,rn.FINDER_PAT_D,rn.FINDER_PAT_C],[rn.FINDER_PAT_A,rn.FINDER_PAT_E,rn.FINDER_PAT_B,rn.FINDER_PAT_D,rn.FINDER_PAT_D,rn.FINDER_PAT_F],[rn.FINDER_PAT_A,rn.FINDER_PAT_E,rn.FINDER_PAT_B,rn.FINDER_PAT_D,rn.FINDER_PAT_E,rn.FINDER_PAT_F,rn.FINDER_PAT_F],[rn.FINDER_PAT_A,rn.FINDER_PAT_A,rn.FINDER_PAT_B,rn.FINDER_PAT_B,rn.FINDER_PAT_C,rn.FINDER_PAT_C,rn.FINDER_PAT_D,rn.FINDER_PAT_D],[rn.FINDER_PAT_A,rn.FINDER_PAT_A,rn.FINDER_PAT_B,rn.FINDER_PAT_B,rn.FINDER_PAT_C,rn.FINDER_PAT_C,rn.FINDER_PAT_D,rn.FINDER_PAT_E,rn.FINDER_PAT_E],[rn.FINDER_PAT_A,rn.FINDER_PAT_A,rn.FINDER_PAT_B,rn.FINDER_PAT_B,rn.FINDER_PAT_C,rn.FINDER_PAT_C,rn.FINDER_PAT_D,rn.FINDER_PAT_E,rn.FINDER_PAT_F,rn.FINDER_PAT_F],[rn.FINDER_PAT_A,rn.FINDER_PAT_A,rn.FINDER_PAT_B,rn.FINDER_PAT_B,rn.FINDER_PAT_C,rn.FINDER_PAT_D,rn.FINDER_PAT_D,rn.FINDER_PAT_E,rn.FINDER_PAT_E,rn.FINDER_PAT_F,rn.FINDER_PAT_F]],rn.MAX_PAIRS=11,e.ArgumentException=l,e.ArithmeticException=J,e.AztecCode=cr,e.AztecCodeReader=pt,e.AztecCodeWriter=Mr,e.AztecDecoder=nt,e.AztecDetector=wt,e.AztecDetectorResult=ut,e.AztecEncoder=Br,e.AztecHighLevelEncoder=Dr,e.AztecPoint=gt,e.BarcodeFormat=H,e.Binarizer=f,e.BinaryBitmap=c,e.BitArray=E,e.BitMatrix=R,e.BitSource=Gt,e.BrowserAztecCodeReader=_t,e.BrowserBarcodeReader=xt,e.BrowserCodeReader=F,e.BrowserDatamatrixCodeReader=Zt,e.BrowserMultiFormatReader=We,e.BrowserPDF417Reader=Ye,e.BrowserQRCodeReader=Ke,e.BrowserQRCodeSvgWriter=ir,e.CharacterSetECI=b,e.ChecksumException=d,e.Code128Reader=At,e.Code39Reader=Et,e.DataMatrixDecodedBitStreamParser=Xt,e.DataMatrixReader=Kt,e.DecodeHintType=y,e.DecoderResult=j,e.DefaultGridSampler=dt,e.DetectorResult=at,e.EAN13Reader=Mt,e.EncodeHintType=je,e.Exception=u,e.FormatException=C,e.GenericGF=$,e.GenericGFPoly=Q,e.GlobalHistogramBinarizer=O,e.GridSampler=ht,e.GridSamplerInstance=ft,e.HTMLCanvasElementLuminanceSource=P,e.HybridBinarizer=D,e.ITFReader=Tt,e.IllegalArgumentException=h,e.IllegalStateException=et,e.InvertedLuminanceSource=M,e.LuminanceSource=B,e.MathUtils=it,e.MultiFormatOneDReader=Lt,e.MultiFormatReader=Xe,e.MultiFormatWriter=sr,e.NotFoundException=N,e.OneDReader=mt,e.PDF417DecodedBitStreamParser=Ve,e.PDF417DecoderErrorCorrection=Ae,e.PDF417Reader=ze,e.PDF417ResultMetadata=Oe,e.PerspectiveTransform=ct,e.PlanarYUVLuminanceSource=ar,e.QRCodeByteMatrix=Je,e.QRCodeDataMask=te,e.QRCodeDecodedBitStreamParser=oe,e.QRCodeDecoderErrorCorrectionLevel=jt,e.QRCodeDecoderFormatInformation=qt,e.QRCodeEncoder=nr,e.QRCodeEncoderQRCode=$e,e.QRCodeMaskUtil=Qe,e.QRCodeMatrixUtil=er,e.QRCodeMode=ie,e.QRCodeReader=fe,e.QRCodeVersion=$t,e.QRCodeWriter=or,e.RGBLuminanceSource=ur,e.RSS14Reader=St,e.RSSExpandedReader=rn,e.ReaderException=Ge,e.ReedSolomonDecoder=rt,e.ReedSolomonEncoder=qe,e.ReedSolomonException=tt,e.Result=U,e.ResultMetadataType=Z,e.ResultPoint=st,e.StringUtils=S,e.UnsupportedOperationException=I,e.VideoInputDevice=k,e.WhiteRectangleDetector=lt,e.WriterException=tr,e.ZXingArrays=m,e.ZXingCharset=lr,e.ZXingInteger=w,e.ZXingStandardCharsets=hr,e.ZXingStringBuilder=T,e.ZXingStringEncoding=v,e.ZXingSystem=g,Object.defineProperty(e,"__esModule",{value:!0})}(r)})),Pr=(Dr=Mr)&&Dr.__esModule&&Object.prototype.hasOwnProperty.call(Dr,"default")?Dr.default:Dr;const kr=new Set,Lr=new Map,xr=new Map,Fr=new WeakMap,{document:Ur,customElements:Vr,DocumentFragment:Hr,HTMLElement:zr}=window,Gr=Symbol("isOOMAbstract");class Xr{static proxyGetter(t,e,r){return e in t?"function"==typeof t[e]?(...n)=>{const i=t[e](...n);return i===t?r:i}:t[e]:(...n)=>(t.append(Xr.create(Yr,e,...n)),r)}static proxyHandler={get:this.proxyGetter,set:()=>!1};static create(t,...e){const r=e[e.length-1],n="function"==typeof r&&!Lr.has(r)?e.pop():null,i=new t(...e);return n&&n(i.dom),i}static factory(t,...e){const r="string"==typeof t||Lr.has(t);return Xr.create(r?Yr:Wr,t,...e)}static[Symbol.hasInstance](t){return t&&t[Gr]}[Gr]=!0;dom;append(t){return t instanceof Xr?this.dom.append(t.dom):t&&this.dom.append(t),this}oom(...t){const e=Xr.factory(...t);return this.append(e),this}clone(){const t=Ur.importNode(this.dom,!0),e=new this.constructor(t);return new Proxy(e,Xr.proxyHandler)}}class Wr extends Xr{get html(){let t="";for(const e of this.dom.children)t+=e.outerHTML;return t}constructor(t){super(),t instanceof Hr?this.dom=t:(this.dom=Ur.createDocumentFragment(),this.append(t))}}class Yr extends Xr{static resolveTagName(t){let e;return e="string"==typeof t&&t[0]===t[0].toUpperCase()?t.replace(/^[A-Z]/,(t=>t.toLowerCase())).replace(/[A-Z]/g,(t=>"-"+t.toLowerCase())):t,e}static setAttribute(t,e,r){if("options"===e&&xr.has(t.constructor))Fr.set(t,r);else{const n=typeof r;"function"===n?t[e]=r:(/[A-Z]/.test(e)&&(e=e.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()))),"object"===n?t.setAttribute(e,"json::"+JSON.stringify(r)):t.setAttribute(e,r))}}static getAttribute(t,e){let r;if("options"===e&&xr.has(t.constructor))r=Fr.get(t,r);else{const n=t[e];"function"==typeof n?r=n:(/[A-Z]/.test(e)&&(e=e.replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()))),r=t.getAttribute(e),r&&r.startsWith("json::")&&(r=JSON.parse(r.replace("json::",""))))}return r}static setAttributes(t,e={},r){if("string"==typeof e)Yr.setAttribute(t,e,r);else for(const[r,n]of Object.entries(e))Yr.setAttribute(t,r,n)}static resolveArgs(t,e){return"string"==typeof t||t instanceof Xr||t instanceof Hr||t instanceof zr?[e,t]:[t,e]}get html(){return this.dom.outerHTML}constructor(t,e,r){[e,r]=Yr.resolveArgs(e,r),super(),t instanceof zr?this.dom=t:(Lr.has(t)?(t=Lr.get(t),Vr.get(t).options=e?e.options:void 0):(t=Yr.resolveTagName(t),kr.has(t)&&(Vr.get(t).options=e?e.options:void 0)),this.dom=Ur.createElement(t)),this.setAttributes(e),this.append(r)}setAttributes(t){return Yr.setAttributes(this.dom,t),this}}const{HTMLElement:Kr,customElements:Zr}=window,jr=Symbol("observedAttributes"),qr=Symbol("attributeChangedCache"),Qr={get:Yr.getAttribute,set:(...t)=>(Yr.setAttribute(...t),!0)};function Jr(t,e){const r=Object.getOwnPropertyNames(t),n=Reflect.getPrototypeOf(t);Object.isPrototypeOf.call(Kr,n.constructor)&&Jr(n,e);for(const n of r){const{value:r}=Reflect.getOwnPropertyDescriptor(t,n),i="function"==typeof r,o=n.endsWith("Changed"),s=/^[a-z][\w]+$/.test(n);if(i&&o&&s){const t=n.replace(/Changed$/,"").replace(/[A-Z]/g,(t=>"-"+t.toLowerCase()));e.set(t,n)}}return e.size>0?e:null}function $r(t){class e extends t{static[jr]=Jr(t.prototype,new Map);static get observedAttributes(){return this[jr]?[...this[jr].keys(),...super.observedAttributes||[]]:super.observedAttributes}constructor(){super(e.options||{}),delete e.options}attributeChangedCallback(t,e,r){!function(t,e,r,n){const i=t.constructor[jr];i&&i.has(e)&&(n&&n.startsWith("json::")&&(n=JSON.parse(n.replace("json::",""))),t.isConnected?t[i.get(e)](r,n):(qr in t||(t[qr]=new Set),t[qr].add({name:i.get(e),args:[r,n]})))}(this,t,e,r),super.attributeChangedCallback&&super.attributeChangedCallback(t,e,r)}connectedCallback(){!function(t){const e=t[qr];let r=t.constructor.template,{template:n}=t,i="function"==typeof r&&r.length>0||"function"==typeof n&&n.length>0||null;if(i&&(i=Object.assign({},Fr.get(t),{element:t,attributes:new Proxy(t,Qr)})),n instanceof Xr?n=n.clone():"string"!=typeof n&&(r instanceof Xr?r=r.clone():"function"==typeof r&&(r=t.constructor.template(i)),"function"==typeof n?(i&&(i.template=r),n=t.template(i)||r):n=r),n instanceof Xr?(t.innerHTML="",t.append(n.dom)):"string"==typeof n&&(t.innerHTML=n),e instanceof Set){for(const r of e)t[r.name](...r.args),e.delete(r);delete t[qr]}}(this),super.connectedCallback&&super.connectedCallback()}}return e}const{customElements:tn}=window,en=Object.assign(Object.create(null),{append:(...t)=>rn().append(...t),setAttributes:(...t)=>(Yr.setAttributes(...t),rn),define:(...t)=>(function(t,e,r){Object.isPrototypeOf.call(Kr,t)&&([e,r]=[t,e],t=e.tagName||Yr.resolveTagName(e.name));const n=xr.get(e)||$r(e);Zr.define(t,n,r),xr.set(n,e),Lr.set(e,t),kr.add(t)}(...t),rn),getDefined:t=>xr.get(tn.get(t)),oom:(...t)=>rn(...t)}),rn=new Proxy(Xr,{apply:(t,e,r)=>{const n=Xr.factory(...r);return new Proxy(n,Xr.proxyHandler)},get:(t,e)=>en[e]||((...t)=>{const r=Xr.create(Yr,e,...t),n=new Wr(r);return new Proxy(n,Xr.proxyHandler)}),set:()=>!1});var nn=function(){return(nn=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function on(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),i=0;for(e=0;e<r;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)n[i]=o[s];return n}var sn=Object.keys,an=Array.isArray,un="undefined"!=typeof self?self:"undefined"!=typeof window?window:global;function ln(t,e){return"object"!=typeof e||sn(e).forEach((function(r){t[r]=e[r]})),t}"undefined"==typeof Promise||un.Promise||(un.Promise=Promise);var hn=Object.getPrototypeOf,cn={}.hasOwnProperty;function dn(t,e){return cn.call(t,e)}function fn(t,e){"function"==typeof e&&(e=e(hn(t))),sn(e).forEach((function(r){wn(t,r,e[r])}))}var gn=Object.defineProperty;function wn(t,e,r,n){gn(t,e,ln(r&&dn(r,"get")&&"function"==typeof r.get?{get:r.get,set:r.set,configurable:!0}:{value:r,configurable:!0,writable:!0},n))}function pn(t){return{from:function(e){return t.prototype=Object.create(e.prototype),wn(t.prototype,"constructor",t),{extend:fn.bind(null,t.prototype)}}}}var _n=Object.getOwnPropertyDescriptor;function mn(t,e){var r;return _n(t,e)||(r=hn(t))&&mn(r,e)}var En=[].slice;function An(t,e,r){return En.call(t,e,r)}function yn(t,e){return e(t)}function Cn(t){if(!t)throw new Error("Assertion Failed")}function bn(t){un.setImmediate?setImmediate(t):setTimeout(t,0)}function In(t,e){return t.reduce((function(t,r,n){var i=e(r,n);return i&&(t[i[0]]=i[1]),t}),{})}function vn(t,e){if(dn(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var r=[],n=0,i=e.length;n<i;++n){var o=vn(t,e[n]);r.push(o)}return r}var s=e.indexOf(".");if(-1!==s){var a=t[e.substr(0,s)];return void 0===a?void 0:vn(a,e.substr(s+1))}}function Sn(t,e,r){if(t&&void 0!==e&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){Cn("string"!=typeof r&&"length"in r);for(var n=0,i=e.length;n<i;++n)Sn(t,e[n],r[n])}else{var o=e.indexOf(".");if(-1!==o){var s=e.substr(0,o),a=e.substr(o+1);if(""===a)void 0===r?an(t)&&!isNaN(parseInt(s))?t.splice(s,1):delete t[s]:t[s]=r;else{var u=t[s];u||(u=t[s]={}),Sn(u,a,r)}}else void 0===r?an(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=r}}function Tn(t){var e={};for(var r in t)dn(t,r)&&(e[r]=t[r]);return e}var Rn=[].concat;function Nn(t){return Rn.apply([],t)}var On="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(Nn([8,16,32,64].map((function(t){return["Int","Uint","Float"].map((function(e){return e+t+"Array"}))})))).filter((function(t){return un[t]})),Dn=On.map((function(t){return un[t]})),Bn=In(On,(function(t){return[t,!0]}));function Mn(t){if(!t||"object"!=typeof t)return t;var e;if(an(t)){e=[];for(var r=0,n=t.length;r<n;++r)e.push(Mn(t[r]))}else if(Dn.indexOf(t.constructor)>=0)e=t;else for(var i in e=t.constructor?Object.create(t.constructor.prototype):{},t)dn(t,i)&&(e[i]=Mn(t[i]));return e}var Pn={}.toString;function kn(t){return Pn.call(t).slice(8,-1)}var Ln=function(t,e){return"Array"===e?""+t.map((function(t){return Ln(t,kn(t))})):"ArrayBuffer"===e?""+new Uint8Array(t):"Date"===e?t.getTime():ArrayBuffer.isView(t)?""+new Uint8Array(t.buffer):t};function xn(t,e,r,n){return r=r||{},n=n||"",sn(t).forEach((function(i){if(dn(e,i)){var o=t[i],s=e[i];if("object"==typeof o&&"object"==typeof s&&o&&s){var a=kn(o),u=kn(s);a===u?Bn[a]?Ln(o,a)!==Ln(s,u)&&(r[n+i]=e[i]):xn(o,s,r,n+i+"."):r[n+i]=e[i]}else o!==s&&(r[n+i]=e[i])}else r[n+i]=void 0})),sn(e).forEach((function(i){dn(t,i)||(r[n+i]=e[i])})),r}var Fn="undefined"!=typeof Symbol&&Symbol.iterator,Un=Fn?function(t){var e;return null!=t&&(e=t[Fn])&&e.apply(t)}:function(){return null},Vn={};function Hn(t){var e,r,n,i;if(1===arguments.length){if(an(t))return t.slice();if(this===Vn&&"string"==typeof t)return[t];if(i=Un(t)){for(r=[];!(n=i.next()).done;)r.push(n.value);return r}if(null==t)return[t];if("number"==typeof(e=t.length)){for(r=new Array(e);e--;)r[e]=t[e];return r}return[t]}for(e=arguments.length,r=new Array(e);e--;)r[e]=arguments[e];return r}var zn="undefined"!=typeof Symbol?function(t){return"AsyncFunction"===t[Symbol.toStringTag]}:function(){return!1},Gn="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Xn(t,e){Gn=t,Wn=e}var Wn=function(){return!0},Yn=!new Error("").stack;function Kn(){if(Yn)try{throw new Error}catch(t){return t}return new Error}function Zn(t,e){var r=t.stack;return r?(e=e||0,0===r.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),r.split("\n").slice(e).filter(Wn).map((function(t){return"\n"+t})).join("")):""}var jn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],qn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(jn),Qn={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function Jn(t,e){this._e=Kn(),this.name=t,this.message=e}function $n(t,e){return t+". Errors: "+Object.keys(e).map((function(t){return e[t].toString()})).filter((function(t,e,r){return r.indexOf(t)===e})).join("\n")}function ti(t,e,r,n){this._e=Kn(),this.failures=e,this.failedKeys=n,this.successCount=r,this.message=$n(t,e)}function ei(t,e){this._e=Kn(),this.name="BulkError",this.failures=e,this.message=$n(t,e)}pn(Jn).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Zn(this._e,2))}},toString:function(){return this.name+": "+this.message}}),pn(ti).from(Jn),pn(ei).from(Jn);var ri=qn.reduce((function(t,e){return t[e]=e+"Error",t}),{}),ni=Jn,ii=qn.reduce((function(t,e){var r=e+"Error";function n(t,n){this._e=Kn(),this.name=r,t?"string"==typeof t?(this.message=t+(n?"\n "+n:""),this.inner=n||null):"object"==typeof t&&(this.message=t.name+" "+t.message,this.inner=t):(this.message=Qn[e]||r,this.inner=null)}return pn(n).from(ni),t[e]=n,t}),{});ii.Syntax=SyntaxError,ii.Type=TypeError,ii.Range=RangeError;var oi=jn.reduce((function(t,e){return t[e+"Error"]=ii[e],t}),{});var si=qn.reduce((function(t,e){return-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=ii[e]),t}),{});function ai(){}function ui(t){return t}function li(t,e){return null==t||t===ui?e:function(r){return e(t(r))}}function hi(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function ci(t,e){return t===ai?e:function(){var r=t.apply(this,arguments);void 0!==r&&(arguments[0]=r);var n=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=e.apply(this,arguments);return n&&(this.onsuccess=this.onsuccess?hi(n,this.onsuccess):n),i&&(this.onerror=this.onerror?hi(i,this.onerror):i),void 0!==o?o:r}}function di(t,e){return t===ai?e:function(){t.apply(this,arguments);var r=this.onsuccess,n=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),r&&(this.onsuccess=this.onsuccess?hi(r,this.onsuccess):r),n&&(this.onerror=this.onerror?hi(n,this.onerror):n)}}function fi(t,e){return t===ai?e:function(r){var n=t.apply(this,arguments);ln(r,n);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=e.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?hi(i,this.onsuccess):i),o&&(this.onerror=this.onerror?hi(o,this.onerror):o),void 0===n?void 0===s?void 0:s:ln(n,s)}}function gi(t,e){return t===ai?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function wi(t,e){return t===ai?e:function(){var r=t.apply(this,arguments);if(r&&"function"==typeof r.then){for(var n=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return r.then((function(){return e.apply(n,o)}))}return e.apply(this,arguments)}}si.ModifyError=ti,si.DexieError=Jn,si.BulkError=ei;var pi={},_i="undefined"==typeof Promise?[]:function(){var t=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[t,t.__proto__,t];var e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,e.__proto__,t]}(),mi=_i[0],Ei=_i[1],Ai=_i[2],yi=Ei&&Ei.then,Ci=mi&&mi.constructor,bi=!!Ai,Ii=!1,vi=Ai?function(){Ai.then(Zi)}:un.setImmediate?setImmediate.bind(null,Zi):un.MutationObserver?function(){var t=document.createElement("div");new MutationObserver((function(){Zi(),t=null})).observe(t,{attributes:!0}),t.setAttribute("i","1")}:function(){setTimeout(Zi,0)},Si=function(t,e){ki.push([t,e]),Ri&&(vi(),Ri=!1)},Ti=!0,Ri=!0,Ni=[],Oi=[],Di=null,Bi=ui,Mi={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:mo,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(t){try{mo(t[0],t[1])}catch(t){}}))}},Pi=Mi,ki=[],Li=0,xi=[];function Fi(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=ai,this._lib=!1;var e=this._PSD=Pi;if(Gn&&(this._stackHolder=Kn(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==pi)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&zi(this,this._value))}this._state=null,this._value=null,++e.ref,Hi(this,t)}var Ui={get:function(){var t=Pi,e=io;function r(r,n){var i=this,o=!t.global&&(t!==Pi||e!==io);o&&uo();var s=new Fi((function(e,s){Xi(i,new Vi(po(r,t,o),po(n,t,o),e,s,t))}));return Gn&&Ki(s,this),s}return r.prototype=pi,r},set:function(t){wn(this,"then",t&&t.prototype===pi?Ui:{get:function(){return t},set:Ui.set})}};function Vi(t,e,r,n,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=r,this.reject=n,this.psd=i}function Hi(t,e){try{e((function(e){if(null===t._state){if(e===t)throw new TypeError("A promise cannot be resolved with itself.");var r=t._lib&&ji();e&&"function"==typeof e.then?Hi(t,(function(t,r){e instanceof Fi?e._then(t,r):e.then(t,r)})):(t._state=!0,t._value=e,Gi(t)),r&&qi()}}),zi.bind(null,t))}catch(e){zi(t,e)}}function zi(t,e){if(Oi.push(e),null===t._state){var r=t._lib&&ji();e=Bi(e),t._state=!1,t._value=e,Gn&&null!==e&&"object"==typeof e&&!e._promise&&function(t,e,r){try{t.apply(null,r)}catch(t){e&&e(t)}}((function(){var r=mn(e,"stack");e._promise=t,wn(e,"stack",{get:function(){return Ii?r&&(r.get?r.get.apply(e):r.value):t.stack}})})),function(t){Ni.some((function(e){return e._value===t._value}))||Ni.push(t)}(t),Gi(t),r&&qi()}}function Gi(t){var e=t._listeners;t._listeners=[];for(var r=0,n=e.length;r<n;++r)Xi(t,e[r]);var i=t._PSD;--i.ref||i.finalize(),0===Li&&(++Li,Si((function(){0==--Li&&Qi()}),[]))}function Xi(t,e){if(null!==t._state){var r=t._state?e.onFulfilled:e.onRejected;if(null===r)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++Li,Si(Wi,[r,t,e])}else t._listeners.push(e)}function Wi(t,e,r){try{Di=e;var n,i=e._value;e._state?n=t(i):(Oi.length&&(Oi=[]),n=t(i),-1===Oi.indexOf(i)&&function(t){var e=Ni.length;for(;e;)if(Ni[--e]._value===t._value)return void Ni.splice(e,1)}(e)),r.resolve(n)}catch(t){r.reject(t)}finally{Di=null,0==--Li&&Qi(),--r.psd.ref||r.psd.finalize()}}function Yi(t,e,r){if(e.length===r)return e;var n="";if(!1===t._state){var i,o,s=t._value;null!=s?(i=s.name||"Error",o=s.message||s,n=Zn(s,0)):(i=s,o=""),e.push(i+(o?": "+o:"")+n)}return Gn&&((n=Zn(t._stackHolder,2))&&-1===e.indexOf(n)&&e.push(n),t._prev&&Yi(t._prev,e,r)),e}function Ki(t,e){var r=e?e._numPrev+1:0;r<100&&(t._prev=e,t._numPrev=r)}function Zi(){ji()&&qi()}function ji(){var t=Ti;return Ti=!1,Ri=!1,t}function qi(){var t,e,r;do{for(;ki.length>0;)for(t=ki,ki=[],r=t.length,e=0;e<r;++e){var n=t[e];n[0].apply(null,n[1])}}while(ki.length>0);Ti=!0,Ri=!0}function Qi(){var t=Ni;Ni=[],t.forEach((function(t){t._PSD.onunhandled.call(null,t._value,t)}));for(var e=xi.slice(0),r=e.length;r;)e[--r]()}function Ji(t){return new Fi(pi,!1,t)}function $i(t,e){var r=Pi;return function(){var n=ji(),i=Pi;try{return fo(r,!0),t.apply(this,arguments)}catch(t){e&&e(t)}finally{fo(i,!1),n&&qi()}}}fn(Fi.prototype,{then:Ui,_then:function(t,e){Xi(this,new Vi(null,null,t,e,Pi))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=arguments[0],r=arguments[1];return"function"==typeof e?this.then(null,(function(t){return t instanceof e?r(t):Ji(t)})):this.then(null,(function(t){return t&&t.name===e?r(t):Ji(t)}))},finally:function(t){return this.then((function(e){return t(),e}),(function(e){return t(),Ji(e)}))},stack:{get:function(){if(this._stack)return this._stack;try{Ii=!0;var t=Yi(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{Ii=!1}}},timeout:function(t,e){var r=this;return t<1/0?new Fi((function(n,i){var o=setTimeout((function(){return i(new ii.Timeout(e))}),t);r.then(n,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&wn(Fi.prototype,Symbol.toStringTag,"Dexie.Promise"),Mi.env=go(),fn(Fi,{all:function(){var t=Hn.apply(null,arguments).map(lo);return new Fi((function(e,r){0===t.length&&e([]);var n=t.length;t.forEach((function(i,o){return Fi.resolve(i).then((function(r){t[o]=r,--n||e(t)}),r)}))}))},resolve:function(t){if(t instanceof Fi)return t;if(t&&"function"==typeof t.then)return new Fi((function(e,r){t.then(e,r)}));var e=new Fi(pi,!0,t);return Ki(e,Di),e},reject:Ji,race:function(){var t=Hn.apply(null,arguments).map(lo);return new Fi((function(e,r){t.map((function(t){return Fi.resolve(t).then(e,r)}))}))},PSD:{get:function(){return Pi},set:function(t){return Pi=t}},newPSD:so,usePSD:wo,scheduler:{get:function(){return Si},set:function(t){Si=t}},rejectionMapper:{get:function(){return Bi},set:function(t){Bi=t}},follow:function(t,e){return new Fi((function(r,n){return so((function(e,r){var n=Pi;n.unhandleds=[],n.onunhandled=r,n.finalize=hi((function(){var t=this;!function(t){function e(){t(),xi.splice(xi.indexOf(e),1)}xi.push(e),++Li,Si((function(){0==--Li&&Qi()}),[])}((function(){0===t.unhandleds.length?e():r(t.unhandleds[0])}))}),n.finalize),t()}),e,r,n)}))}}),Ci&&(Ci.allSettled&&wn(Fi,"allSettled",(function(){var t=Hn.apply(null,arguments).map(lo);return new Fi((function(e){0===t.length&&e([]);var r=t.length,n=new Array(r);t.forEach((function(t,i){return Fi.resolve(t).then((function(t){return n[i]={status:"fulfilled",value:t}}),(function(t){return n[i]={status:"rejected",reason:t}})).then((function(){return--r||e(n)}))}))}))})),Ci.any&&"undefined"!=typeof AggregateError&&wn(Fi,"any",(function(){var t=Hn.apply(null,arguments).map(lo);return new Fi((function(e,r){0===t.length&&r(new AggregateError([]));var n=t.length,i=new Array(n);t.forEach((function(t,o){return Fi.resolve(t).then((function(t){return e(t)}),(function(t){i[o]=t,--n||r(new AggregateError(i))}))}))}))})));var to={awaits:0,echoes:0,id:0},eo=0,ro=[],no=0,io=0,oo=0;function so(t,e,r,n){var i=Pi,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++oo;var s=Mi.env;o.env=bi?{Promise:Fi,PromiseProp:{value:Fi,configurable:!0,writable:!0},all:Fi.all,race:Fi.race,allSettled:Fi.allSettled,any:Fi.any,resolve:Fi.resolve,reject:Fi.reject,nthen:_o(s.nthen,o),gthen:_o(s.gthen,o)}:{},e&&ln(o,e),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=wo(o,t,r,n);return 0===o.ref&&o.finalize(),a}function ao(){return to.id||(to.id=++eo),++to.awaits,to.echoes+=100,to.id}function uo(t){!to.awaits||t&&t!==to.id||(0==--to.awaits&&(to.id=0),to.echoes=100*to.awaits)}function lo(t){return to.echoes&&t&&t.constructor===Ci?(ao(),t.then((function(t){return uo(),t}),(function(t){return uo(),Eo(t)}))):t}function ho(t){++io,to.echoes&&0!=--to.echoes||(to.echoes=to.id=0),ro.push(Pi),fo(t,!0)}function co(){var t=ro[ro.length-1];ro.pop(),fo(t,!1)}function fo(t,e){var r,n=Pi;if((e?!to.echoes||no++&&t===Pi:!no||--no&&t===Pi)||(r=e?ho.bind(null,t):co,yi.call(mi,r)),t!==Pi&&(Pi=t,n===Mi&&(Mi.env=go()),bi)){var i=Mi.env.Promise,o=t.env;Ei.then=o.nthen,i.prototype.then=o.gthen,(n.global||t.global)&&(Object.defineProperty(un,"Promise",o.PromiseProp),i.all=o.all,i.race=o.race,i.resolve=o.resolve,i.reject=o.reject,o.allSettled&&(i.allSettled=o.allSettled),o.any&&(i.any=o.any))}}function go(){var t=un.Promise;return bi?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(un,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:Ei.then,gthen:t.prototype.then}:{}}function wo(t,e,r,n,i){var o=Pi;try{return fo(t,!0),e(r,n,i)}finally{fo(o,!1)}}function po(t,e,r){return"function"!=typeof t?t:function(){var n=Pi;r&&ao(),fo(e,!0);try{return t.apply(this,arguments)}finally{fo(n,!1)}}}function _o(t,e){return function(r,n){return t.call(this,po(r,e,!1),po(n,e,!1))}}-1===(""+yi).indexOf("[native code]")&&(ao=uo=ai);function mo(t,e){var r;try{r=e.onuncatched(t)}catch(t){}if(!1!==r)try{var n,i={promise:e,reason:t};if(un.document&&document.createEvent?((n=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),ln(n,i)):un.CustomEvent&&ln(n=new CustomEvent("unhandledrejection",{detail:i}),i),n&&un.dispatchEvent&&(dispatchEvent(n),!un.PromiseRejectionEvent&&un.onunhandledrejection))try{un.onunhandledrejection(n)}catch(t){}Gn&&n&&!n.defaultPrevented&&console.warn("Unhandled rejection: "+(t.stack||t))}catch(t){}}var Eo=Fi.reject;function Ao(t,e,r,n){if(t._state.openComplete||Pi.letThrough){var i=t._createTransaction(e,r,t._dbSchema);try{i.create()}catch(t){return Eo(t)}return i._promise(e,(function(t,e){return so((function(){return Pi.trans=i,n(t,e,i)}))})).then((function(t){return i._completion.then((function(){return t}))}))}if(!t._state.isBeingOpened){if(!t._options.autoOpen)return Eo(new ii.DatabaseClosed);t.open().catch(ai)}return t._state.dbReadyPromise.then((function(){return Ao(t,e,r,n)}))}var yo=String.fromCharCode(65535),Co="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",bo=[],Io="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),vo=Io,So=Io,To=function(t){return!/(dexie\.js|dexie\.min\.js)/.test(t)};function Ro(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}var No={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1},Oo=function(){function t(){}return t.prototype._trans=function(t,e,r){var n=this._tx||Pi.trans,i=this.name;function o(t,r,n){if(!n.schema[i])throw new ii.NotFound("Table "+i+" not part of transaction");return e(n.idbtrans,n)}var s=ji();try{return n&&n.db===this.db?n===Pi.trans?n._promise(t,o,r):so((function(){return n._promise(t,o,r)}),{trans:n,transless:Pi.transless||Pi}):Ao(this.db,t,[this.name],o)}finally{s&&qi()}},t.prototype.get=function(t,e){var r=this;return t&&t.constructor===Object?this.where(t).first(e):this._trans("readonly",(function(e){return r.core.get({trans:e,key:t}).then((function(t){return r.hook.reading.fire(t)}))})).then(e)},t.prototype.where=function(t){if("string"==typeof t)return new this.db.WhereClause(this,t);if(an(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var e=sn(t);if(1===e.length)return this.where(e[0]).equals(t[e[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter((function(t){return t.compound&&e.every((function(e){return t.keyPath.indexOf(e)>=0}))&&t.keyPath.every((function(t){return e.indexOf(t)>=0}))}))[0];if(r&&this.db._maxKey!==yo)return this.where(r.name).equals(r.keyPath.map((function(e){return t[e]})));!r&&Gn&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a compound index ["+e.join("+")+"]");var n=this.schema.idxByName,i=this.db._deps.indexedDB;function o(t,e){try{return 0===i.cmp(t,e)}catch(t){return!1}}var s=e.reduce((function(e,r){var i=e[0],s=e[1],a=n[r],u=t[r];return[i||a,i||!a?Ro(s,a&&a.multi?function(t){var e=vn(t,r);return an(e)&&e.some((function(t){return o(u,t)}))}:function(t){return o(u,vn(t,r))}):s]}),[null,null]),a=s[0],u=s[1];return a?this.where(a.name).equals(t[a.keyPath]).filter(u):r?this.filter(u):this.where(e).equals("")},t.prototype.filter=function(t){return this.toCollection().and(t)},t.prototype.count=function(t){return this.toCollection().count(t)},t.prototype.offset=function(t){return this.toCollection().offset(t)},t.prototype.limit=function(t){return this.toCollection().limit(t)},t.prototype.each=function(t){return this.toCollection().each(t)},t.prototype.toArray=function(t){return this.toCollection().toArray(t)},t.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},t.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,an(t)?"["+t.join("+")+"]":t))},t.prototype.reverse=function(){return this.toCollection().reverse()},t.prototype.mapToClass=function(t){this.schema.mappedClass=t;var e=function(e){if(!e)return e;var r=Object.create(t.prototype);for(var n in e)if(dn(e,n))try{r[n]=e[n]}catch(t){}return r};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=e,this.hook("reading",e),t},t.prototype.defineClass=function(){return this.mapToClass((function(t){ln(this,t)}))},t.prototype.add=function(t,e){var r=this;return this._trans("readwrite",(function(n){return r.core.mutate({trans:n,type:"add",keys:null!=e?[e]:null,values:[t]})})).then((function(t){return t.numFailures?Fi.reject(t.failures[0]):t.lastResult})).then((function(e){if(!r.core.schema.primaryKey.outbound)try{Sn(t,r.core.schema.primaryKey.keyPath,e)}catch(t){}return e}))},t.prototype.update=function(t,e){if("object"!=typeof e||an(e))throw new ii.InvalidArgument("Modifications must be an object.");if("object"!=typeof t||an(t))return this.where(":id").equals(t).modify(e);sn(e).forEach((function(r){Sn(t,r,e[r])}));var r=vn(t,this.schema.primKey.keyPath);return void 0===r?Eo(new ii.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(e)},t.prototype.put=function(t,e){var r=this;return this._trans("readwrite",(function(n){return r.core.mutate({trans:n,type:"put",values:[t],keys:null!=e?[e]:null})})).then((function(t){return t.numFailures?Fi.reject(t.failures[0]):t.lastResult})).then((function(e){if(!r.core.schema.primaryKey.outbound)try{Sn(t,r.core.schema.primaryKey.keyPath,e)}catch(t){}return e}))},t.prototype.delete=function(t){var e=this;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"delete",keys:[t]})})).then((function(t){return t.numFailures?Fi.reject(t.failures[0]):void 0}))},t.prototype.clear=function(){var t=this;return this._trans("readwrite",(function(e){return t.core.mutate({trans:e,type:"deleteRange",range:No})})).then((function(t){return t.numFailures?Fi.reject(t.failures[0]):void 0}))},t.prototype.bulkGet=function(t){var e=this;return this._trans("readonly",(function(r){return e.core.getMany({keys:t,trans:r}).then((function(t){return t.map((function(t){return e.hook.reading.fire(t)}))}))}))},t.prototype.bulkAdd=function(t,e,r){var n=this,i=Array.isArray(e)?e:void 0,o=(r=r||(i?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",(function(e){if(!n.core.schema.primaryKey.outbound&&i)throw new ii.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new ii.InvalidArgument("Arguments objects and keys must have the same length");var r=t.length;return n.core.mutate({trans:e,type:"add",keys:i,values:t,wantResults:o}).then((function(t){var e=t.numFailures,i=t.results,s=t.lastResult,a=t.failures;if(0===e)return o?i:s;throw new ei(n.name+".bulkAdd(): "+e+" of "+r+" operations failed",Object.keys(a).map((function(t){return a[t]})))}))}))},t.prototype.bulkPut=function(t,e,r){var n=this,i=Array.isArray(e)?e:void 0,o=(r=r||(i?void 0:e))?r.allKeys:void 0;return this._trans("readwrite",(function(e){if(!n.core.schema.primaryKey.outbound&&i)throw new ii.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==t.length)throw new ii.InvalidArgument("Arguments objects and keys must have the same length");var r=t.length;return n.core.mutate({trans:e,type:"put",keys:i,values:t,wantResults:o}).then((function(t){var e=t.numFailures,i=t.results,s=t.lastResult,a=t.failures;if(0===e)return o?i:s;throw new ei(n.name+".bulkPut(): "+e+" of "+r+" operations failed",Object.keys(a).map((function(t){return a[t]})))}))}))},t.prototype.bulkDelete=function(t){var e=this,r=t.length;return this._trans("readwrite",(function(r){return e.core.mutate({trans:r,type:"delete",keys:t})})).then((function(t){var n=t.numFailures,i=t.lastResult,o=t.failures;if(0===n)return i;throw new ei(e.name+".bulkDelete(): "+n+" of "+r+" operations failed",o)}))},t}();function Do(t){var e={},r=function(r,n){if(n){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return e[r].subscribe.apply(null,o),t}if("string"==typeof r)return e[r]};r.addEventType=o;for(var n=1,i=arguments.length;n<i;++n)o(arguments[n]);return r;function o(t,n,i){if("object"==typeof t)return s(t);n||(n=gi),i||(i=ai);var o={subscribers:[],fire:i,subscribe:function(t){-1===o.subscribers.indexOf(t)&&(o.subscribers.push(t),o.fire=n(o.fire,t))},unsubscribe:function(t){o.subscribers=o.subscribers.filter((function(e){return e!==t})),o.fire=o.subscribers.reduce(n,i)}};return e[t]=r[t]=o,o}function s(t){sn(t).forEach((function(e){var r=t[e];if(an(r))o(e,t[e][0],t[e][1]);else{if("asap"!==r)throw new ii.InvalidArgument("Invalid event config");var n=o(e,ui,(function(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];n.subscribers.forEach((function(t){bn((function(){t.apply(null,e)}))}))}))}}))}}function Bo(t,e){return pn(e).from({prototype:t}),e}function Mo(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function Po(t,e){t.filter=Ro(t.filter,e)}function ko(t,e,r){var n=t.replayFilter;t.replayFilter=n?function(){return Ro(n(),e())}:e,t.justLimit=r&&!n}function Lo(t,e){if(t.isPrimKey)return e.primaryKey;var r=e.getIndexByKeyPath(t.index);if(!r)throw new ii.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return r}function xo(t,e,r){var n=Lo(t,e.schema);return e.openCursor({trans:r,values:!t.keysOnly,reverse:"prev"===t.dir,unique:!!t.unique,query:{index:n,range:t.range}})}function Fo(t,e,r,n){var i=t.replayFilter?Ro(t.filter,t.replayFilter()):t.filter;if(t.or){var o={},s=function(t,r,n){if(!i||i(r,n,(function(t){return r.stop(t)}),(function(t){return r.fail(t)}))){var s=r.primaryKey,a=""+s;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(s)),dn(o,a)||(o[a]=!0,e(t,r,n))}};return Promise.all([t.or._iterate(s,r),Uo(xo(t,n,r),t.algorithm,s,!t.keysOnly&&t.valueMapper)])}return Uo(xo(t,n,r),Ro(t.algorithm,i),e,!t.keysOnly&&t.valueMapper)}function Uo(t,e,r,n){var i=$i(n?function(t,e,i){return r(n(t),e,i)}:r);return t.then((function(t){if(t)return t.start((function(){var r=function(){return t.continue()};e&&!e(t,(function(t){return r=t}),(function(e){t.stop(e),r=ai}),(function(e){t.fail(e),r=ai}))||i(t.value,t,(function(t){return r=t})),r()}))}))}var Vo=function(){function t(){}return t.prototype._read=function(t,e){var r=this._ctx;return r.error?r.table._trans(null,Eo.bind(null,r.error)):r.table._trans("readonly",t).then(e)},t.prototype._write=function(t){var e=this._ctx;return e.error?e.table._trans(null,Eo.bind(null,e.error)):e.table._trans("readwrite",t,"locked")},t.prototype._addAlgorithm=function(t){var e=this._ctx;e.algorithm=Ro(e.algorithm,t)},t.prototype._iterate=function(t,e){return Fo(this._ctx,t,e,this._ctx.table.core)},t.prototype.clone=function(t){var e=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&ln(r,t),e._ctx=r,e},t.prototype.raw=function(){return this._ctx.valueMapper=null,this},t.prototype.each=function(t){var e=this._ctx;return this._read((function(r){return Fo(e,t,r,e.table.core)}))},t.prototype.count=function(t){var e=this;return this._read((function(t){var r=e._ctx,n=r.table.core;if(Mo(r,!0))return n.count({trans:t,query:{index:Lo(r,n.schema),range:r.range}}).then((function(t){return Math.min(t,r.limit)}));var i=0;return Fo(r,(function(){return++i,!1}),t,n).then((function(){return i}))})).then(t)},t.prototype.sortBy=function(t,e){var r=t.split(".").reverse(),n=r[0],i=r.length-1;function o(t,e){return e?o(t[r[e]],e-1):t[n]}var s="next"===this._ctx.dir?1:-1;function a(t,e){var r=o(t,i),n=o(e,i);return r<n?-s:r>n?s:0}return this.toArray((function(t){return t.sort(a)})).then(e)},t.prototype.toArray=function(t){var e=this;return this._read((function(t){var r=e._ctx;if("next"===r.dir&&Mo(r,!0)&&r.limit>0){var n=r.valueMapper,i=Lo(r,r.table.core.schema);return r.table.core.query({trans:t,limit:r.limit,values:!0,query:{index:i,range:r.range}}).then((function(t){var e=t.result;return n?e.map(n):e}))}var o=[];return Fo(r,(function(t){return o.push(t)}),t,r.table.core).then((function(){return o}))}),t)},t.prototype.offset=function(t){var e=this._ctx;return t<=0||(e.offset+=t,Mo(e)?ko(e,(function(){var e=t;return function(t,r){return 0===e||(1===e?(--e,!1):(r((function(){t.advance(e),e=0})),!1))}})):ko(e,(function(){var e=t;return function(){return--e<0}}))),this},t.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),ko(this._ctx,(function(){var e=t;return function(t,r,n){return--e<=0&&r(n),e>=0}}),!0),this},t.prototype.until=function(t,e){return Po(this._ctx,(function(r,n,i){return!t(r.value)||(n(i),e)})),this},t.prototype.first=function(t){return this.limit(1).toArray((function(t){return t[0]})).then(t)},t.prototype.last=function(t){return this.reverse().first(t)},t.prototype.filter=function(t){var e,r;return Po(this._ctx,(function(e){return t(e.value)})),e=this._ctx,r=t,e.isMatch=Ro(e.isMatch,r),this},t.prototype.and=function(t){return this.filter(t)},t.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},t.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},t.prototype.desc=function(){return this.reverse()},t.prototype.eachKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each((function(e,r){t(r.key,r)}))},t.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},t.prototype.eachPrimaryKey=function(t){var e=this._ctx;return e.keysOnly=!e.isMatch,this.each((function(e,r){t(r.primaryKey,r)}))},t.prototype.keys=function(t){var e=this._ctx;e.keysOnly=!e.isMatch;var r=[];return this.each((function(t,e){r.push(e.key)})).then((function(){return r})).then(t)},t.prototype.primaryKeys=function(t){var e=this._ctx;if("next"===e.dir&&Mo(e,!0)&&e.limit>0)return this._read((function(t){var r=Lo(e,e.table.core.schema);return e.table.core.query({trans:t,values:!1,limit:e.limit,query:{index:r,range:e.range}})})).then((function(t){return t.result})).then(t);e.keysOnly=!e.isMatch;var r=[];return this.each((function(t,e){r.push(e.primaryKey)})).then((function(){return r})).then(t)},t.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},t.prototype.firstKey=function(t){return this.limit(1).keys((function(t){return t[0]})).then(t)},t.prototype.lastKey=function(t){return this.reverse().firstKey(t)},t.prototype.distinct=function(){var t=this._ctx,e=t.index&&t.table.schema.idxByName[t.index];if(!e||!e.multi)return this;var r={};return Po(this._ctx,(function(t){var e=t.primaryKey.toString(),n=dn(r,e);return r[e]=!0,!n})),this},t.prototype.modify=function(t){var e=this,r=this._ctx;return this._write((function(n){var i;if("function"==typeof t)i=t;else{var o=sn(t),s=o.length;i=function(e){for(var r=!1,n=0;n<s;++n){var i=o[n],a=t[i];vn(e,i)!==a&&(Sn(e,i,a),r=!0)}return r}}var a=r.table.core,u=a.schema.primaryKey,l=u.outbound,h=u.extractKey,c="testmode"in Os?1:2e3,d=e.db.core.cmp,f=[],g=0,w=[],p=function(t,e){var r=e.failures,n=e.numFailures;g+=t-n;for(var i=0,o=sn(r);i<o.length;i++){var s=o[i];f.push(r[s])}};return e.clone().primaryKeys().then((function(t){var e=function(r){var o=Math.min(c,t.length-r);return a.getMany({trans:n,keys:t.slice(r,r+o)}).then((function(s){for(var u=[],f=[],g=l?[]:null,w=[],_=0;_<o;++_){var m=s[_],E={value:Mn(m),primKey:t[r+_]};!1!==i.call(E,E.value,E)&&(null==E.value?w.push(t[r+_]):l||0===d(h(m),h(E.value))?(f.push(E.value),l&&g.push(t[r+_])):(w.push(t[r+_]),u.push(E.value)))}return Promise.resolve(u.length>0&&a.mutate({trans:n,type:"add",values:u}).then((function(t){for(var e in t.failures)w.splice(parseInt(e),1);p(u.length,t)}))).then((function(t){return f.length>0&&a.mutate({trans:n,type:"put",keys:g,values:f}).then((function(t){return p(f.length,t)}))})).then((function(){return w.length>0&&a.mutate({trans:n,type:"delete",keys:w}).then((function(t){return p(w.length,t)}))})).then((function(){return t.length>r+o&&e(r+c)}))}))};return e(0).then((function(){if(f.length>0)throw new ti("Error modifying one or more objects",f,g,w);return t.length}))}))}))},t.prototype.delete=function(){var t=this._ctx,e=t.range;return Mo(t)&&(t.isPrimKey&&!So||3===e.type)?this._write((function(r){var n=t.table.core.schema.primaryKey,i=e;return t.table.core.count({trans:r,query:{index:n,range:i}}).then((function(e){return t.table.core.mutate({trans:r,type:"deleteRange",range:i}).then((function(t){var r=t.failures,n=(t.lastResult,t.results,t.numFailures);if(n)throw new ti("Could not delete some values",Object.keys(r).map((function(t){return r[t]})),e-n);return e-n}))}))})):this.modify((function(t,e){return e.value=null}))},t}();function Ho(t,e){return t<e?-1:t===e?0:1}function zo(t,e){return t>e?-1:t===e?0:1}function Go(t,e,r){var n=t instanceof jo?new t.Collection(t):t;return n._ctx.error=r?new r(e):new TypeError(e),n}function Xo(t){return new t.Collection(t,(function(){return Zo("")})).limit(0)}function Wo(t,e,r,n,i,o){for(var s=Math.min(t.length,n.length),a=-1,u=0;u<s;++u){var l=e[u];if(l!==n[u])return i(t[u],r[u])<0?t.substr(0,u)+r[u]+r.substr(u+1):i(t[u],n[u])<0?t.substr(0,u)+n[u]+r.substr(u+1):a>=0?t.substr(0,a)+e[a]+r.substr(a+1):null;i(t[u],l)<0&&(a=u)}return s<n.length&&"next"===o?t+r.substr(t.length):s<t.length&&"prev"===o?t.substr(0,r.length):a<0?null:t.substr(0,a)+n[a]+r.substr(a+1)}function Yo(t,e,r,n){var i,o,s,a,u,l,h,c=r.length;if(!r.every((function(t){return"string"==typeof t})))return Go(t,"String expected.");function d(t){i=function(t){return"next"===t?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}(t),o=function(t){return"next"===t?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}(t),s="next"===t?Ho:zo;var e=r.map((function(t){return{lower:o(t),upper:i(t)}})).sort((function(t,e){return s(t.lower,e.lower)}));a=e.map((function(t){return t.upper})),u=e.map((function(t){return t.lower})),l=t,h="next"===t?"":n}d("next");var f=new t.Collection(t,(function(){return Ko(a[0],u[c-1]+n)}));f._ondirectionchange=function(t){d(t)};var g=0;return f._addAlgorithm((function(t,r,n){var i=t.key;if("string"!=typeof i)return!1;var d=o(i);if(e(d,u,g))return!0;for(var f=null,w=g;w<c;++w){var p=Wo(i,d,a[w],u[w],s,l);null===p&&null===f?g=w+1:(null===f||s(f,p)>0)&&(f=p)}return r(null!==f?function(){t.continue(f+h)}:n),!1})),f}function Ko(t,e,r,n){return{type:2,lower:t,upper:e,lowerOpen:r,upperOpen:n}}function Zo(t){return{type:1,lower:t,upper:t}}var jo=function(){function t(){}return Object.defineProperty(t.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!0,configurable:!0}),t.prototype.between=function(t,e,r,n){r=!1!==r,n=!0===n;try{return this._cmp(t,e)>0||0===this._cmp(t,e)&&(r||n)&&(!r||!n)?Xo(this):new this.Collection(this,(function(){return Ko(t,e,!r,!n)}))}catch(t){return Go(this,Co)}},t.prototype.equals=function(t){return new this.Collection(this,(function(){return Zo(t)}))},t.prototype.above=function(t){return null==t?Go(this,Co):new this.Collection(this,(function(){return Ko(t,void 0,!0)}))},t.prototype.aboveOrEqual=function(t){return null==t?Go(this,Co):new this.Collection(this,(function(){return Ko(t,void 0,!1)}))},t.prototype.below=function(t){return null==t?Go(this,Co):new this.Collection(this,(function(){return Ko(void 0,t,!1,!0)}))},t.prototype.belowOrEqual=function(t){return null==t?Go(this,Co):new this.Collection(this,(function(){return Ko(void 0,t)}))},t.prototype.startsWith=function(t){return"string"!=typeof t?Go(this,"String expected."):this.between(t,t+yo,!0,!0)},t.prototype.startsWithIgnoreCase=function(t){return""===t?this.startsWith(t):Yo(this,(function(t,e){return 0===t.indexOf(e[0])}),[t],yo)},t.prototype.equalsIgnoreCase=function(t){return Yo(this,(function(t,e){return t===e[0]}),[t],"")},t.prototype.anyOfIgnoreCase=function(){var t=Hn.apply(Vn,arguments);return 0===t.length?Xo(this):Yo(this,(function(t,e){return-1!==e.indexOf(t)}),t,"")},t.prototype.startsWithAnyOfIgnoreCase=function(){var t=Hn.apply(Vn,arguments);return 0===t.length?Xo(this):Yo(this,(function(t,e){return e.some((function(e){return 0===t.indexOf(e)}))}),t,yo)},t.prototype.anyOf=function(){var t=this,e=Hn.apply(Vn,arguments),r=this._cmp;try{e.sort(r)}catch(t){return Go(this,Co)}if(0===e.length)return Xo(this);var n=new this.Collection(this,(function(){return Ko(e[0],e[e.length-1])}));n._ondirectionchange=function(n){r="next"===n?t._ascending:t._descending,e.sort(r)};var i=0;return n._addAlgorithm((function(t,n,o){for(var s=t.key;r(s,e[i])>0;)if(++i===e.length)return n(o),!1;return 0===r(s,e[i])||(n((function(){t.continue(e[i])})),!1)})),n},t.prototype.notEqual=function(t){return this.inAnyRange([[-(1/0),t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},t.prototype.noneOf=function(){var t=Hn.apply(Vn,arguments);if(0===t.length)return new this.Collection(this);try{t.sort(this._ascending)}catch(t){return Go(this,Co)}var e=t.reduce((function(t,e){return t?t.concat([[t[t.length-1][1],e]]):[[-(1/0),e]]}),null);return e.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(e,{includeLowers:!1,includeUppers:!1})},t.prototype.inAnyRange=function(t,e){var r=this,n=this._cmp,i=this._ascending,o=this._descending,s=this._min,a=this._max;if(0===t.length)return Xo(this);if(!t.every((function(t){return void 0!==t[0]&&void 0!==t[1]&&i(t[0],t[1])<=0})))return Go(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",ii.InvalidArgument);var u=!e||!1!==e.includeLowers,l=e&&!0===e.includeUppers;var h,c=i;function d(t,e){return c(t[0],e[0])}try{(h=t.reduce((function(t,e){for(var r=0,i=t.length;r<i;++r){var o=t[r];if(n(e[0],o[1])<0&&n(e[1],o[0])>0){o[0]=s(o[0],e[0]),o[1]=a(o[1],e[1]);break}}return r===i&&t.push(e),t}),[])).sort(d)}catch(t){return Go(this,Co)}var f=0,g=l?function(t){return i(t,h[f][1])>0}:function(t){return i(t,h[f][1])>=0},w=u?function(t){return o(t,h[f][0])>0}:function(t){return o(t,h[f][0])>=0};var p=g,_=new this.Collection(this,(function(){return Ko(h[0][0],h[h.length-1][1],!u,!l)}));return _._ondirectionchange=function(t){"next"===t?(p=g,c=i):(p=w,c=o),h.sort(d)},_._addAlgorithm((function(t,e,n){for(var o=t.key;p(o);)if(++f===h.length)return e(n),!1;return!!function(t){return!g(t)&&!w(t)}(o)||(0===r._cmp(o,h[f][1])||0===r._cmp(o,h[f][0])||e((function(){c===i?t.continue(h[f][0]):t.continue(h[f][1])})),!1)})),_},t.prototype.startsWithAnyOf=function(){var t=Hn.apply(Vn,arguments);return t.every((function(t){return"string"==typeof t}))?0===t.length?Xo(this):this.inAnyRange(t.map((function(t){return[t,t+yo]}))):Go(this,"startsWithAnyOf() only works with strings")},t}();function qo(t){return 1===t.length?t[0]:t}function Qo(t){try{return t.only([[]]),[[]]}catch(t){return yo}}function Jo(t){return $i((function(e){return $o(e),t(e.target.error),!1}))}function $o(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}var ts=function(){function t(){}return t.prototype._lock=function(){return Cn(!Pi.global),++this._reculock,1!==this._reculock||Pi.global||(Pi.lockOwnerFor=this),this},t.prototype._unlock=function(){if(Cn(!Pi.global),0==--this._reculock)for(Pi.global||(Pi.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{wo(t[1],t[0])}catch(t){}}return this},t.prototype._locked=function(){return this._reculock&&Pi.lockOwnerFor!==this},t.prototype.create=function(t){var e=this;if(!this.mode)return this;var r=this.db.idbdb,n=this.db._state.dbOpenError;if(Cn(!this.idbtrans),!t&&!r)switch(n&&n.name){case"DatabaseClosedError":throw new ii.DatabaseClosed(n);case"MissingAPIError":throw new ii.MissingAPI(n.message,n);default:throw new ii.OpenFailed(n)}if(!this.active)throw new ii.TransactionInactive;return Cn(null===this._completion._state),(t=this.idbtrans=t||r.transaction(qo(this.storeNames),this.mode)).onerror=$i((function(r){$o(r),e._reject(t.error)})),t.onabort=$i((function(r){$o(r),e.active&&e._reject(new ii.Abort(t.error)),e.active=!1,e.on("abort").fire(r)})),t.oncomplete=$i((function(){e.active=!1,e._resolve()})),this},t.prototype._promise=function(t,e,r){var n=this;if("readwrite"===t&&"readwrite"!==this.mode)return Eo(new ii.ReadOnly("Transaction is readonly"));if(!this.active)return Eo(new ii.TransactionInactive);if(this._locked())return new Fi((function(i,o){n._blockedFuncs.push([function(){n._promise(t,e,r).then(i,o)},Pi])}));if(r)return so((function(){var t=new Fi((function(t,r){n._lock();var i=e(t,r,n);i&&i.then&&i.then(t,r)}));return t.finally((function(){return n._unlock()})),t._lib=!0,t}));var i=new Fi((function(t,r){var i=e(t,r,n);i&&i.then&&i.then(t,r)}));return i._lib=!0,i},t.prototype._root=function(){return this.parent?this.parent._root():this},t.prototype.waitFor=function(t){var e=this._root(),r=Fi.resolve(t);if(e._waitingFor)e._waitingFor=e._waitingFor.then((function(){return r}));else{e._waitingFor=r,e._waitingQueue=[];var n=e.idbtrans.objectStore(e.storeNames[0]);!function t(){for(++e._spinCount;e._waitingQueue.length;)e._waitingQueue.shift()();e._waitingFor&&(n.get(-1/0).onsuccess=t)}()}var i=e._waitingFor;return new Fi((function(t,n){r.then((function(r){return e._waitingQueue.push($i(t.bind(null,r)))}),(function(t){return e._waitingQueue.push($i(n.bind(null,t)))})).finally((function(){e._waitingFor===i&&(e._waitingFor=null)}))}))},t.prototype.abort=function(){this.active&&this._reject(new ii.Abort),this.active=!1},t.prototype.table=function(t){var e=this._memoizedTables||(this._memoizedTables={});if(dn(e,t))return e[t];var r=this.schema[t];if(!r)throw new ii.NotFound("Table "+t+" not part of transaction");var n=new this.db.Table(t,r,this);return n.core=this.db.core.table(t),e[t]=n,n},t}();function es(t,e,r,n,i,o,s){return{name:t,keyPath:e,unique:r,multi:n,auto:i,compound:o,src:(r&&!s?"&":"")+(n?"*":"")+(i?"++":"")+rs(e)}}function rs(t){return"string"==typeof t?t:t?"["+[].join.call(t,"+")+"]":""}function ns(t,e,r){return{name:t,primKey:e,indexes:r,mappedClass:null,idxByName:In(r,(function(t){return[t.name,t]}))}}function is(t){return null==t?function(){}:"string"==typeof t?function(t){return 1===t.split(".").length?function(e){return e[t]}:function(e){return vn(e,t)}}(t):function(e){return vn(e,t)}}function os(t,e){return"delete"===e.type?e.keys:e.keys||e.values.map(t.extractKey)}function ss(t){return[].slice.call(t)}var as=0;function us(t){return null==t?":id":"string"==typeof t?t:"["+t.join("+")+"]"}function ls(t,e,r,n){var i=e.cmp.bind(e);function o(t){if(3===t.type)return null;if(4===t.type)throw new Error("Cannot convert never type to IDBKeyRange");var e=t.lower,n=t.upper,i=t.lowerOpen,o=t.upperOpen;return void 0===e?void 0===n?null:r.upperBound(n,!!o):void 0===n?r.lowerBound(e,!!i):r.bound(e,n,!!i,!!o)}var s=function(t,e){var r=ss(t.objectStoreNames);return{schema:{name:t.name,tables:r.map((function(t){return e.objectStore(t)})).map((function(t){var e=t.keyPath,r=t.autoIncrement,n=an(e),i=null==e,o={},s={name:t.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:n,keyPath:e,autoIncrement:r,unique:!0,extractKey:is(e)},indexes:ss(t.indexNames).map((function(e){return t.index(e)})).map((function(t){var e=t.name,r=t.unique,n=t.multiEntry,i=t.keyPath,s={name:e,compound:an(i),keyPath:i,unique:r,multiEntry:n,extractKey:is(i)};return o[us(i)]=s,s})),getIndexByKeyPath:function(t){return o[us(t)]}};return o[":id"]=s.primaryKey,null!=e&&(o[us(e)]=s.primaryKey),s}))},hasGetAll:r.length>0&&"getAll"in e.objectStore(r[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),a=s.schema,u=s.hasGetAll,l=a.tables.map((function(t){return function(t){var e=t.name;return{name:e,schema:t,mutate:function(r){var n=r.trans,i=r.type,s=r.keys,a=r.values,u=r.range,l=r.wantResults;return new Promise((function(r,h){r=$i(r);var c=n.objectStore(e),d=null==c.keyPath,f="put"===i||"add"===i;if(!f&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var g=(s||a||{length:1}).length;if(s&&a&&s.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===g)return r({numFailures:0,failures:{},results:[],lastResult:void 0});var w,p=l&&on(s||os(t.primaryKey,{type:i,keys:s,values:a})),_=[],m=0,E=function(t){++m,$o(t),p&&(p[t.target._reqno]=void 0),_[t.target._reqno]=t.target.error},A=function(t){var e=t.target;p[e._reqno]=e.result};if("deleteRange"===i){if(4===u.type)return r({numFailures:m,failures:_,results:p,lastResult:void 0});w=3===u.type?c.clear():c.delete(o(u))}else{var y=f?d?[a,s]:[a,null]:[s,null],C=y[0],b=y[1];if(f)for(var I=0;I<g;++I)(w=b&&void 0!==b[I]?c[i](C[I],b[I]):c[i](C[I]))._reqno=I,p&&void 0===p[I]&&(w.onsuccess=A),w.onerror=E;else for(I=0;I<g;++I)(w=c[i](C[I]))._reqno=I,w.onerror=E}var v=function(t){var e=t.target.result;p&&(p[g-1]=e),r({numFailures:m,failures:_,results:p,lastResult:e})};w.onerror=function(t){E(t),v(t)},w.onsuccess=v}))},getMany:function(t){var r=t.trans,n=t.keys;return new Promise((function(t,i){t=$i(t);for(var o,s=r.objectStore(e),a=n.length,u=new Array(a),l=0,h=0,c=function(e){var r=e.target;u[r._pos]=r.result,++h===l&&t(u)},d=Jo(i),f=0;f<a;++f)null!=n[f]&&((o=s.get(n[f]))._pos=f,o.onsuccess=c,o.onerror=d,++l);0===l&&t(u)}))},get:function(t){var r=t.trans,n=t.key;return new Promise((function(t,i){t=$i(t);var o=r.objectStore(e).get(n);o.onsuccess=function(e){return t(e.target.result)},o.onerror=Jo(i)}))},query:function(t){return function(r){return new Promise((function(n,i){n=$i(n);var s=r.trans,a=r.values,u=r.limit,l=r.query,h=u===1/0?void 0:u,c=l.index,d=l.range,f=s.objectStore(e),g=c.isPrimaryKey?f:f.index(c.name),w=o(d);if(0===u)return n({result:[]});if(t){var p=a?g.getAll(w,h):g.getAllKeys(w,h);p.onsuccess=function(t){return n({result:t.target.result})},p.onerror=Jo(i)}else{var _=0,m=a||!("openKeyCursor"in g)?g.openCursor(w):g.openKeyCursor(w),E=[];m.onsuccess=function(t){var e=m.result;return e?(E.push(a?e.value:e.primaryKey),++_===u?n({result:E}):void e.continue()):n({result:E})},m.onerror=Jo(i)}}))}}(u),openCursor:function(t){var r=t.trans,n=t.values,i=t.query,s=t.reverse,a=t.unique;return new Promise((function(t,u){t=$i(t);var l=i.index,h=i.range,c=r.objectStore(e),d=l.isPrimaryKey?c:c.index(l.name),f=s?a?"prevunique":"prev":a?"nextunique":"next",g=n||!("openKeyCursor"in d)?d.openCursor(o(h),f):d.openKeyCursor(o(h),f);g.onerror=Jo(u),g.onsuccess=$i((function(e){var n=g.result;if(n){n.___id=++as,n.done=!1;var i=n.continue.bind(n),o=n.continuePrimaryKey;o&&(o=o.bind(n));var s=n.advance.bind(n),a=function(){throw new Error("Cursor not stopped")};n.trans=r,n.stop=n.continue=n.continuePrimaryKey=n.advance=function(){throw new Error("Cursor not started")},n.fail=$i(u),n.next=function(){var t=this,e=1;return this.start((function(){return e--?t.continue():t.stop()})).then((function(){return t}))},n.start=function(t){var e=new Promise((function(t,e){t=$i(t),g.onerror=Jo(e),n.fail=e,n.stop=function(e){n.stop=n.continue=n.continuePrimaryKey=n.advance=a,t(e)}})),r=function(){if(g.result)try{t()}catch(t){n.fail(t)}else n.done=!0,n.start=function(){throw new Error("Cursor behind last entry")},n.stop()};return g.onsuccess=$i((function(t){g.onsuccess=r,r()})),n.continue=i,n.continuePrimaryKey=o,n.advance=s,r(),e},t(n)}else t(null)}),u)}))},count:function(t){var r=t.query,n=t.trans,i=r.index,s=r.range;return new Promise((function(t,r){var a=n.objectStore(e),u=i.isPrimaryKey?a:a.index(i.name),l=o(s),h=l?u.count(l):u.count();h.onsuccess=$i((function(e){return t(e.target.result)})),h.onerror=Jo(r)}))}}}(t)})),h={};return l.forEach((function(t){return h[t.name]=t})),{stack:"dbcore",transaction:t.transaction.bind(t),table:function(t){if(!h[t])throw new Error("Table '"+t+"' not found");return h[t]},cmp:i,MIN_KEY:-1/0,MAX_KEY:Qo(r),schema:a}}function hs(t,e,r,n){var i=r.IDBKeyRange;return{dbcore:function(t,e){return e.reduce((function(t,e){var r=e.create;return nn(nn({},t),r(t))}),t)}(ls(e,r.indexedDB,i,n),t.dbcore)}}function cs(t,e){var r=e.db,n=hs(t._middlewares,r,t._deps,e);t.core=n.dbcore,t.tables.forEach((function(e){var r=e.name;t.core.schema.tables.some((function(t){return t.name===r}))&&(e.core=t.core.table(r),t[r]instanceof t.Table&&(t[r].core=e.core))}))}function ds(t,e,r,n){r.forEach((function(r){var i=n[r];e.forEach((function(e){r in e||(e===t.Transaction.prototype||e instanceof t.Transaction?wn(e,r,{get:function(){return this.table(r)},set:function(t){gn(this,r,{value:t,writable:!0,configurable:!0,enumerable:!0})}}):e[r]=new t.Table(r,i))}))}))}function fs(t,e){e.forEach((function(e){for(var r in e)e[r]instanceof t.Table&&delete e[r]}))}function gs(t,e){return t._cfg.version-e._cfg.version}function ws(t,e,r,n){var i=t._dbSchema,o=t._createTransaction("readwrite",t._storeNames,i);o.create(r),o._completion.catch(n);var s=o._reject.bind(o),a=Pi.transless||Pi;so((function(){Pi.trans=o,Pi.transless=a,0===e?(sn(i).forEach((function(t){ps(r,t,i[t].primKey,i[t].indexes)})),cs(t,r),Fi.follow((function(){return t.on.populate.fire(o)})).catch(s)):function(t,e,r,n){var i=[],o=t._versions,s=t._dbSchema=ms(t,t.idbdb,n),a=!1;function u(){return i.length?Fi.resolve(i.shift()(r.idbtrans)).then(u):Fi.resolve()}return o.filter((function(t){return t._cfg.version>=e})).forEach((function(o){i.push((function(){var i=s,u=o._cfg.dbschema;Es(t,i,n),Es(t,u,n),s=t._dbSchema=u;var l=function(t,e){var r,n={del:[],add:[],change:[]};for(r in t)e[r]||n.del.push(r);for(r in e){var i=t[r],o=e[r];if(i){var s={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src===o.primKey.src||Io){var a=i.idxByName,u=o.idxByName,l=void 0;for(l in a)u[l]||s.del.push(l);for(l in u){var h=a[l],c=u[l];h?h.src!==c.src&&s.change.push(c):s.add.push(c)}(s.del.length>0||s.add.length>0||s.change.length>0)&&n.change.push(s)}else s.recreate=!0,n.change.push(s)}else n.add.push([r,o])}return n}(i,u);l.add.forEach((function(t){ps(n,t[0],t[1].primKey,t[1].indexes)})),l.change.forEach((function(t){if(t.recreate)throw new ii.Upgrade("Not yet support for changing primary key");var e=n.objectStore(t.name);t.add.forEach((function(t){return _s(e,t)})),t.change.forEach((function(t){e.deleteIndex(t.name),_s(e,t)})),t.del.forEach((function(t){return e.deleteIndex(t)}))}));var h=o._cfg.contentUpgrade;if(h&&o._cfg.version>e){cs(t,n),a=!0;var c=Tn(u);l.del.forEach((function(t){c[t]=i[t]})),fs(t,[t.Transaction.prototype]),ds(t,[t.Transaction.prototype],sn(c),c),r.schema=c;var d,f=zn(h);f&&ao();var g=Fi.follow((function(){if((d=h(r))&&f){var t=uo.bind(null,null);d.then(t,t)}}));return d&&"function"==typeof d.then?Fi.resolve(d):g.then((function(){return d}))}})),i.push((function(e){a&&vo||function(t,e){for(var r=0;r<e.db.objectStoreNames.length;++r){var n=e.db.objectStoreNames[r];null==t[n]&&e.db.deleteObjectStore(n)}}(o._cfg.dbschema,e);fs(t,[t.Transaction.prototype]),ds(t,[t.Transaction.prototype],t._storeNames,t._dbSchema),r.schema=t._dbSchema}))})),u().then((function(){var t,e;e=n,sn(t=s).forEach((function(r){e.db.objectStoreNames.contains(r)||ps(e,r,t[r].primKey,t[r].indexes)}))}))}(t,e,o,r).catch(s)}))}function ps(t,e,r,n){var i=t.db.createObjectStore(e,r.keyPath?{keyPath:r.keyPath,autoIncrement:r.auto}:{autoIncrement:r.auto});return n.forEach((function(t){return _s(i,t)})),i}function _s(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function ms(t,e,r){var n={};return An(e.objectStoreNames,0).forEach((function(t){for(var e=r.objectStore(t),i=e.keyPath,o=es(rs(i),i||"",!1,!1,!!e.autoIncrement,i&&"string"!=typeof i,!0),s=[],a=0;a<e.indexNames.length;++a){var u=e.index(e.indexNames[a]);i=u.keyPath;var l=es(u.name,i,!!u.unique,!!u.multiEntry,!1,i&&"string"!=typeof i,!1);s.push(l)}n[t]=ns(t,o,s)})),n}function Es(t,e,r){for(var n=r.db.objectStoreNames,i=0;i<n.length;++i){var o=n[i],s=r.objectStore(o);t._hasGetAll="getAll"in s;for(var a=0;a<s.indexNames.length;++a){var u=s.indexNames[a],l=s.index(u).keyPath,h="string"==typeof l?l:"["+An(l).join("+")+"]";if(e[o]){var c=e[o].idxByName[h];c&&(c.name=u,delete e[o].idxByName[h],e[o].idxByName[u]=c)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&un.WorkerGlobalScope&&un instanceof un.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}var As,ys=function(){function t(){}return t.prototype._parseStoresSpec=function(t,e){sn(t).forEach((function(r){if(null!==t[r]){var n=t[r].split(",").map((function(t,e){var r=(t=t.trim()).replace(/([&*]|\+\+)/g,""),n=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return es(r,n||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),an(n),0===e)})),i=n.shift();if(i.multi)throw new ii.Schema("Primary key cannot be multi-valued");n.forEach((function(t){if(t.auto)throw new ii.Schema("Only primary key can be marked as autoIncrement (++)");if(!t.keyPath)throw new ii.Schema("Index must have a name and cannot be an empty string")})),e[r]=ns(r,i,n)}}))},t.prototype.stores=function(t){var e=this.db;this._cfg.storesSource=this._cfg.storesSource?ln(this._cfg.storesSource,t):t;var r=e._versions,n={},i={};return r.forEach((function(t){ln(n,t._cfg.storesSource),i=t._cfg.dbschema={},t._parseStoresSpec(n,i)})),e._dbSchema=i,fs(e,[e._allTables,e,e.Transaction.prototype]),ds(e,[e._allTables,e,e.Transaction.prototype,this._cfg.tables],sn(i),i),e._storeNames=sn(i),this},t.prototype.upgrade=function(t){return this._cfg.contentUpgrade=t,this},t}();function Cs(t){return so((function(){return Pi.letThrough=!0,t()}))}function bs(t){var e=t._state,r=t._deps.indexedDB;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then((function(){return e.dbOpenError?Eo(e.dbOpenError):t}));Gn&&(e.openCanceller._stackHolder=Kn()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;var n=e.dbReadyResolve,i=null;return Fi.race([e.openCanceller,new Fi((function(n,o){if(!r)throw new ii.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var s=t.name,a=e.autoSchema?r.open(s):r.open(s,Math.round(10*t.verno));if(!a)throw new ii.MissingAPI("IndexedDB API not available");a.onerror=Jo(o),a.onblocked=$i(t._fireOnBlocked),a.onupgradeneeded=$i((function(n){if(i=a.transaction,e.autoSchema&&!t._options.allowEmptyDB){a.onerror=$o,i.abort(),a.result.close();var u=r.deleteDatabase(s);u.onsuccess=u.onerror=$i((function(){o(new ii.NoSuchDatabase("Database "+s+" doesnt exist"))}))}else{i.onerror=Jo(o);var l=n.oldVersion>Math.pow(2,62)?0:n.oldVersion;t.idbdb=a.result,ws(t,l/10,i,o)}}),o),a.onsuccess=$i((function(){i=null;var r=t.idbdb=a.result,o=An(r.objectStoreNames);if(o.length>0)try{var u=r.transaction(qo(o),"readonly");e.autoSchema?function(t,e,r){t.verno=e.version/10;var n=t._dbSchema=ms(0,e,r);t._storeNames=An(e.objectStoreNames,0),ds(t,[t._allTables],sn(n),n)}(t,r,u):Es(t,t._dbSchema,u),cs(t,u)}catch(t){}bo.push(t),r.onversionchange=$i((function(r){e.vcFired=!0,t.on("versionchange").fire(r)})),As.add(s),n()}),o)}))]).then((function(){return e.onReadyBeingFired=[],Fi.resolve(Cs(t.on.ready.fire)).then((function t(){if(e.onReadyBeingFired.length>0){var r=e.onReadyBeingFired.reduce(wi,ai);return e.onReadyBeingFired=[],Fi.resolve(Cs(r)).then(t)}}))})).finally((function(){e.onReadyBeingFired=null})).then((function(){return e.isBeingOpened=!1,t})).catch((function(r){try{i&&i.abort()}catch(t){}return e.isBeingOpened=!1,t.close(),e.dbOpenError=r,Eo(e.dbOpenError)})).finally((function(){e.openComplete=!0,n()}))}function Is(t){var e=function(e){return t.next(e)},r=i(e),n=i((function(e){return t.throw(e)}));function i(t){return function(e){var i=t(e),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(r,n):an(o)?Promise.all(o).then(r,n):r(o)}}return i(e)()}function vs(t,e,r){var n=arguments.length;if(n<2)throw new ii.InvalidArgument("Too few arguments");for(var i=new Array(n-1);--n;)i[n-1]=arguments[n];r=i.pop();var o=Nn(i);return[t,o,r]}function Ss(t,e,r,n,i){return Fi.resolve().then((function(){var o=Pi.transless||Pi,s=t._createTransaction(e,r,t._dbSchema,n),a={trans:s,transless:o};n?s.idbtrans=n.idbtrans:s.create();var u,l=zn(i);l&&ao();var h=Fi.follow((function(){if(u=i.call(s,s))if(l){var t=uo.bind(null,null);u.then(t,t)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=Is(u))}),a);return(u&&"function"==typeof u.then?Fi.resolve(u).then((function(t){return s.active?t:Eo(new ii.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):h.then((function(){return u}))).then((function(t){return n&&s._resolve(),s._completion.then((function(){return t}))})).catch((function(t){return s._reject(t),Eo(t)}))}))}function Ts(t,e,r){for(var n=an(t)?t.slice():[t],i=0;i<r;++i)n.push(e);return n}var Rs={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return nn(nn({},t),{table:function(e){var r=t.table(e),n=r.schema,i={},o=[];function s(t,e,r){var n=us(t),a=i[n]=i[n]||[],u=null==t?0:"string"==typeof t?1:t.length,l=e>0,h=nn(nn({},r),{isVirtual:l,isPrimaryKey:!l&&r.isPrimaryKey,keyTail:e,keyLength:u,extractKey:is(t),unique:!l&&r.unique});(a.push(h),h.isPrimaryKey||o.push(h),u>1)&&s(2===u?t[0]:t.slice(0,u-1),e+1,r);return a.sort((function(t,e){return t.keyTail-e.keyTail})),h}var a=s(n.primaryKey.keyPath,0,n.primaryKey);i[":id"]=[a];for(var u=0,l=n.indexes;u<l.length;u++){var h=l[u];s(h.keyPath,0,h)}function c(e){var r,n,i=e.query.index;return i.isVirtual?nn(nn({},e),{query:{index:i,range:(r=e.query.range,n=i.keyTail,{type:1===r.type?2:r.type,lower:Ts(r.lower,r.lowerOpen?t.MAX_KEY:t.MIN_KEY,n),lowerOpen:!0,upper:Ts(r.upper,r.upperOpen?t.MIN_KEY:t.MAX_KEY,n),upperOpen:!0})}}):e}return nn(nn({},r),{schema:nn(nn({},n),{primaryKey:a,indexes:o,getIndexByKeyPath:function(t){var e=i[us(t)];return e&&e[0]}}),count:function(t){return r.count(c(t))},query:function(t){return r.query(c(t))},openCursor:function(e){var n=e.query.index,i=n.keyTail,o=n.isVirtual,s=n.keyLength;if(!o)return r.openCursor(e);return r.openCursor(c(e)).then((function(r){return r&&function(r){return Object.create(r,{continue:{value:function(n){null!=n?r.continue(Ts(n,e.reverse?t.MAX_KEY:t.MIN_KEY,i)):e.unique?r.continue(Ts(r.key,e.reverse?t.MIN_KEY:t.MAX_KEY,i)):r.continue()}},continuePrimaryKey:{value:function(e,n){r.continuePrimaryKey(Ts(e,t.MAX_KEY,i),n)}},key:{get:function(){var t=r.key;return 1===s?t[0]:t.slice(0,s)}},value:{get:function(){return r.value}}})}(r)}))}})}})}},Ns={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(t){return nn(nn({},t),{table:function(e){var r=t.table(e),n=r.schema.primaryKey;return nn(nn({},r),{mutate:function(t){var i=Pi.trans,o=i.table(e).hook,s=o.deleting,a=o.creating,u=o.updating;switch(t.type){case"add":if(a.fire===ai)break;return i._promise("readwrite",(function(){return l(t)}),!0);case"put":if(a.fire===ai&&u.fire===ai)break;return i._promise("readwrite",(function(){return l(t)}),!0);case"delete":if(s.fire===ai)break;return i._promise("readwrite",(function(){return l(t)}),!0);case"deleteRange":if(s.fire===ai)break;return i._promise("readwrite",(function(){return function(t){return h(t.trans,t.range,1e4)}(t)}),!0)}return r.mutate(t);function l(t){var e=Pi.trans,i=t.keys||os(n,t);if(!i)throw new Error("Keys missing");return"delete"!==(t="add"===t.type||"put"===t.type?nn(nn({},t),{keys:i,wantResults:!0}):nn({},t)).type&&(t.values=on(t.values)),t.keys&&(t.keys=on(t.keys)),function(t,e,r){return"add"===e.type?Promise.resolve(new Array(e.values.length)):t.getMany({trans:e.trans,keys:r})}(r,t,i).then((function(o){var l=i.map((function(r,i){var l=o[i],h={onerror:null,onsuccess:null};if("delete"===t.type)s.fire.call(h,r,l,e);else if("add"===t.type||void 0===l){var c=a.fire.call(h,r,t.values[i],e);null==r&&null!=c&&(r=c,t.keys[i]=r,n.outbound||Sn(t.values[i],n.keyPath,r))}else{var d=xn(l,t.values[i]),f=u.fire.call(h,d,r,l,e);if(f){var g=t.values[i];Object.keys(f).forEach((function(t){Sn(g,t,f[t])}))}}return h}));return r.mutate(t).then((function(e){for(var r=e.failures,n=e.results,s=e.numFailures,a=e.lastResult,u=0;u<i.length;++u){var h=n?n[u]:i[u],c=l[u];null==h?c.onerror&&c.onerror(r[u]):c.onsuccess&&c.onsuccess("put"===t.type&&o[u]?t.values[u]:h)}return{failures:r,results:n,numFailures:s,lastResult:a}})).catch((function(t){return l.forEach((function(e){return e.onerror&&e.onerror(t)})),Promise.reject(t)}))}))}function h(t,e,i){return r.query({trans:t,values:!1,query:{index:n,range:e},limit:i}).then((function(r){var n=r.result;return l({type:"delete",keys:n,trans:t}).then((function(r){return r.numFailures>0?Promise.reject(r.failures[0]):n.length<i?{failures:[],numFailures:0,lastResult:void 0}:h(t,nn(nn({},e),{lower:n[n.length-1],lowerOpen:!0}),i)}))}))}}})}})}},Os=function(){function t(e,r){var n=this;this._middlewares={},this.verno=0;var i=t.dependencies;this._options=r=nn({addons:t.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var o=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null;var s,a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ai,dbReadyPromise:null,cancelOpen:ai,openCanceller:null,autoSchema:!0};a.dbReadyPromise=new Fi((function(t){a.dbReadyResolve=t})),a.openCanceller=new Fi((function(t,e){a.cancelOpen=e})),this._state=a,this.name=e,this.on=Do(this,"populate","blocked","versionchange",{ready:[wi,ai]}),this.on.ready.subscribe=yn(this.on.ready.subscribe,(function(e){return function(r,i){t.vip((function(){var t=n._state;if(t.openComplete)t.dbOpenError||Fi.resolve().then(r),i&&e(r);else if(t.onReadyBeingFired)t.onReadyBeingFired.push(r),i&&e(r);else{e(r);var o=n;i||e((function t(){o.on.ready.unsubscribe(r),o.on.ready.unsubscribe(t)}))}}))}})),this.Collection=(s=this,Bo(Vo.prototype,(function(t,e){this.db=s;var r=No,n=null;if(e)try{r=e()}catch(t){n=t}var i=t._ctx,o=i.table,a=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:n,or:i.or,valueMapper:a!==ui?a:null}}))),this.Table=function(t){return Bo(Oo.prototype,(function(e,r,n){this.db=t,this._tx=n,this.name=e,this.schema=r,this.hook=t._allTables[e]?t._allTables[e].hook:Do(null,{creating:[ci,ai],reading:[li,ui],updating:[fi,ai],deleting:[di,ai]})}))}(this),this.Transaction=function(t){return Bo(ts.prototype,(function(e,r,n,i){var o=this;this.db=t,this.mode=e,this.storeNames=r,this.schema=n,this.idbtrans=null,this.on=Do(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Fi((function(t,e){o._resolve=t,o._reject=e})),this._completion.then((function(){o.active=!1,o.on.complete.fire()}),(function(t){var e=o.active;return o.active=!1,o.on.error.fire(t),o.parent?o.parent._reject(t):e&&o.idbtrans&&o.idbtrans.abort(),Eo(t)}))}))}(this),this.Version=function(t){return Bo(ys.prototype,(function(e){this.db=t,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(t){return Bo(jo.prototype,(function(e,r,n){this.db=t,this._ctx={table:e,index:":id"===r?null:r,or:n};var i=t._deps.indexedDB;if(!i)throw new ii.MissingAPI("indexedDB API missing");this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(t,e){return i.cmp(e,t)},this._max=function(t,e){return i.cmp(t,e)>0?t:e},this._min=function(t,e){return i.cmp(t,e)<0?t:e},this._IDBKeyRange=t._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(t){t.newVersion>0?console.warn("Another connection wants to upgrade database '"+n.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+n.name+"'. Closing db now to resume the delete request."),n.close()})),this.on("blocked",(function(t){!t.newVersion||t.newVersion<t.oldVersion?console.warn("Dexie.delete('"+n.name+"') was blocked"):console.warn("Upgrade '"+n.name+"' blocked by other connection holding version "+t.oldVersion/10)})),this._maxKey=Qo(r.IDBKeyRange),this._createTransaction=function(t,e,r,i){return new n.Transaction(t,e,r,i)},this._fireOnBlocked=function(t){n.on("blocked").fire(t),bo.filter((function(t){return t.name===n.name&&t!==n&&!t._state.vcFired})).map((function(e){return e.on("versionchange").fire(t)}))},this.use(Rs),this.use(Ns),o.forEach((function(t){return t(n)}))}return t.prototype.version=function(t){if(isNaN(t)||t<.1)throw new ii.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new ii.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var e=this._versions,r=e.filter((function(e){return e._cfg.version===t}))[0];return r||(r=new this.Version(t),e.push(r),e.sort(gs),r.stores({}),this._state.autoSchema=!1,r)},t.prototype._whenReady=function(t){var e=this;return this._state.openComplete||Pi.letThrough?t():new Fi((function(t,r){if(!e._state.isBeingOpened){if(!e._options.autoOpen)return void r(new ii.DatabaseClosed);e.open().catch(ai)}e._state.dbReadyPromise.then(t,r)})).then(t)},t.prototype.use=function(t){var e=t.stack,r=t.create,n=t.level,i=t.name;i&&this.unuse({stack:e,name:i});var o=this._middlewares[e]||(this._middlewares[e]=[]);return o.push({stack:e,create:r,level:null==n?10:n,name:i}),o.sort((function(t,e){return t.level-e.level})),this},t.prototype.unuse=function(t){var e=t.stack,r=t.name,n=t.create;return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((function(t){return n?t.create!==n:!!r&&t.name!==r}))),this},t.prototype.open=function(){return bs(this)},t.prototype.close=function(){var t=bo.indexOf(this),e=this._state;if(t>=0&&bo.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(t){}this.idbdb=null}this._options.autoOpen=!1,e.dbOpenError=new ii.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError),e.dbReadyPromise=new Fi((function(t){e.dbReadyResolve=t})),e.openCanceller=new Fi((function(t,r){e.cancelOpen=r}))},t.prototype.delete=function(){var t=this,e=arguments.length>0,r=this._state;return new Fi((function(n,i){var o=function(){t.close();var e=t._deps.indexedDB.deleteDatabase(t.name);e.onsuccess=$i((function(){As.remove(t.name),n()})),e.onerror=Jo(i),e.onblocked=t._fireOnBlocked};if(e)throw new ii.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()}))},t.prototype.backendDB=function(){return this.idbdb},t.prototype.isOpen=function(){return null!==this.idbdb},t.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&"DatabaseClosed"===t.name},t.prototype.hasFailed=function(){return null!==this._state.dbOpenError},t.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(t.prototype,"tables",{get:function(){var t=this;return sn(this._allTables).map((function(e){return t._allTables[e]}))},enumerable:!0,configurable:!0}),t.prototype.transaction=function(){var t=vs.apply(this,arguments);return this._transaction.apply(this,t)},t.prototype._transaction=function(t,e,r){var n=this,i=Pi.trans;i&&i.db===this&&-1===t.indexOf("!")||(i=null);var o,s,a=-1!==t.indexOf("?");t=t.replace("!","").replace("?","");try{if(s=e.map((function(t){var e=t instanceof n.Table?t.name:t;if("string"!=typeof e)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return e})),"r"==t||"readonly"===t)o="readonly";else{if("rw"!=t&&"readwrite"!=t)throw new ii.InvalidArgument("Invalid transaction mode: "+t);o="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===o){if(!a)throw new ii.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&s.forEach((function(t){if(i&&-1===i.storeNames.indexOf(t)){if(!a)throw new ii.SubTransaction("Table "+t+" not included in parent transaction.");i=null}})),a&&i&&!i.active&&(i=null)}}catch(t){return i?i._promise(null,(function(e,r){r(t)})):Eo(t)}var u=Ss.bind(null,this,o,s,i,r);return i?i._promise(o,u,"lock"):Pi.trans?wo(Pi.transless,(function(){return n._whenReady(u)})):this._whenReady(u)},t.prototype.table=function(t){if(!dn(this._allTables,t))throw new ii.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},t}(),Ds=Os;fn(Ds,nn(nn({},si),{delete:function(t){return new Ds(t).delete()},exists:function(t){return new Ds(t,{addons:[]}).open().then((function(t){return t.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(t){return As?As.getDatabaseNames().then(t):Fi.resolve([])},defineClass:function(){return function(t){ln(this,t)}},ignoreTransaction:function(t){return Pi.trans?wo(Pi.transless,t):t()},vip:Cs,async:function(t){return function(){try{var e=Is(t.apply(this,arguments));return e&&"function"==typeof e.then?e:Fi.resolve(e)}catch(t){return Eo(t)}}},spawn:function(t,e,r){try{var n=Is(t.apply(r,e||[]));return n&&"function"==typeof n.then?n:Fi.resolve(n)}catch(t){return Eo(t)}},currentTransaction:{get:function(){return Pi.trans||null}},waitFor:function(t,e){var r=Fi.resolve("function"==typeof t?Ds.ignoreTransaction(t):t).timeout(e||6e4);return Pi.trans?Pi.trans.waitFor(r):r},Promise:Fi,debug:{get:function(){return Gn},set:function(t){Xn(t,"dexie"===t?function(){return!0}:To)}},derive:pn,extend:ln,props:fn,override:yn,Events:Do,getByKeyPath:vn,setByKeyPath:Sn,delByKeyPath:function(t,e){"string"==typeof e?Sn(t,e,void 0):"length"in e&&[].map.call(e,(function(e){Sn(t,e,void 0)}))},shallowClone:Tn,deepClone:Mn,getObjectDiff:xn,asap:bn,minKey:-(1/0),addons:[],connections:bo,errnames:ri,dependencies:function(){try{return{indexedDB:un.indexedDB||un.mozIndexedDB||un.webkitIndexedDB||un.msIndexedDB,IDBKeyRange:un.IDBKeyRange||un.webkitIDBKeyRange}}catch(t){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:"3.0.2",version:"3.0.2".split(".").map((function(t){return parseInt(t)})).reduce((function(t,e,r){return t+e/Math.pow(10,2*r)})),default:Ds,Dexie:Ds})),Ds.maxKey=Qo(Ds.dependencies.IDBKeyRange),function(t){try{As=function(t){var e,r=t&&"function"==typeof t.databases;if(!r){var n=new Os("__dbnames",{addons:[]});n.version(1).stores({dbnames:"name"}),e=n.table("dbnames")}return{getDatabaseNames:function(){return r?Fi.resolve(t.databases()).then((function(t){return t.map((function(t){return t.name})).filter((function(t){return"__dbnames"!==t}))})):e.toCollection().primaryKeys()},add:function(t){return!r&&"__dbnames"!==t&&e.put({name:t}).catch(ai)},remove:function(t){return!r&&"__dbnames"!==t&&e.delete(t).catch(ai)}}}(t)}catch(t){}}(Os.dependencies.indexedDB),Fi.rejectionMapper=function(t,e){if(!t||t instanceof Jn||t instanceof TypeError||t instanceof SyntaxError||!t.name||!oi[t.name])return t;var r=new oi[t.name](e||t.message,t);return"stack"in t&&wn(r,"stack",{get:function(){return this.inner.stack}}),r},Xn(Gn,To);export{Os as Dexie,Br as QRCode,Pr as ZXing,rn as oom,Wt as pako};